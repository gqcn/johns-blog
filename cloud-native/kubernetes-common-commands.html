<!doctype html><html lang=en dir=ltr class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-docs/云原生/Kubernetes/Kubernetes使用笔记/Kubernetes常用命令" data-has-hydrated=false><meta charset=UTF-8><meta name=generator content="Docusaurus v3.6.3"><title data-rh=true>Kubernetes常用命令 | John's Blog</title><meta data-rh=true name=viewport content="width=device-width,initial-scale=1.0"><meta data-rh=true name=twitter:card content=summary_large_image><meta data-rh=true property=og:url content=https://johng.cn/cloud-native/kubernetes-common-commands><meta data-rh=true property=og:locale content=en><meta data-rh=true name=docusaurus_locale content=en><meta data-rh=true name=docsearch:language content=en><meta data-rh=true name=author content="John Guo"><meta data-rh=true property=og:image content=https://johng.cn/img/favicon.png><meta data-rh=true name=docusaurus_version content=current><meta data-rh=true name=docusaurus_tag content=docs-default-current><meta data-rh=true name=docsearch:version content=current><meta data-rh=true name=docsearch:docusaurus_tag content=docs-default-current><meta data-rh=true property=og:title content="Kubernetes常用命令 | John's Blog"><meta data-rh=true name=description content="详细介绍 Kubernetes 常用命令的使用方法，包括 create、edit、scale、port-forward 等关键操作的实践指南"><meta data-rh=true property=og:description content="详细介绍 Kubernetes 常用命令的使用方法，包括 create、edit、scale、port-forward 等关键操作的实践指南"><meta data-rh=true name=keywords content=Kubernetes,kubectl,命令行,集群管理,常用命令,运维操作><link data-rh=true rel=icon href=/img/favicon.ico><link data-rh=true rel=canonical href=https://johng.cn/cloud-native/kubernetes-common-commands><link data-rh=true rel=alternate href=https://johng.cn/cloud-native/kubernetes-common-commands hreflang=en><link data-rh=true rel=alternate href=https://johng.cn/cloud-native/kubernetes-common-commands hreflang=x-default><link data-rh=true rel=preconnect href=https://XGS1CPQERK-dsn.algolia.net crossorigin><link rel=alternate type=application/rss+xml href=/blog/rss.xml title="John's Blog RSS Feed"><link rel=alternate type=application/atom+xml href=/blog/atom.xml title="John's Blog Atom Feed"><link rel=search type=application/opensearchdescription+xml title="John's Blog" href=/opensearch.xml><script src=https://hm.baidu.com/hm.js?6b4ae23dc83ee5efe875b7172af6c7c1 async></script><link rel=stylesheet href=/assets/css/styles.3503e6ad.css><script src=/assets/js/runtime~main.f7dbfc3f.js defer></script><script src=/assets/js/main.4830e2a2.js defer></script><body class=navigation-with-keyboard><script>!function(){var t,e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();t=null!==e?e:"light",document.documentElement.setAttribute("data-theme",t)}(),function(){try{for(var[t,e]of new URLSearchParams(window.location.search).entries())if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id=__docusaurus><div role=region aria-label="Skip to main content"><a class=skipToContent_fXgn href=#__docusaurus_skipToContent_fallback>Skip to main content</a></div><nav aria-label=Main class="navbar navbar--fixed-top"><div class=navbar__inner><div class=navbar__items><button aria-label="Toggle navigation bar" aria-expanded=false class="navbar__toggle clean-btn" type=button><svg width=30 height=30 viewBox="0 0 30 30" aria-hidden=true><path stroke=currentColor stroke-linecap=round stroke-miterlimit=10 stroke-width=2 d="M4 7h22M4 15h22M4 23h22"/></svg></button><a class=navbar__brand href=/><b class="navbar__title text--truncate">John's Blog</b></a><a class="navbar__item navbar__link" href=/ai>AI技术</a><a aria-current=page class="navbar__item navbar__link navbar__link--active" href=/cloud-native>云原生</a><a class="navbar__item navbar__link" href=/notes>日常笔记</a><a class="navbar__item navbar__link" href=/programming>开发语言</a><a class="navbar__item navbar__link" href=/architecture>技术架构</a><a class="navbar__item navbar__link" href=/observability>可观测性</a><a class="navbar__item navbar__link" href=/database-and-middleware>数据库与中间件</a><a class="navbar__item navbar__link" href=/life>生活笔记</a></div><div class="navbar__items navbar__items--right"><a class="navbar__item navbar__link" href=/aboutme>关于我</a><a class="navbar__item navbar__link" href=/blog>博客</a><a href=https://goframe.org/ target=_blank rel="noopener noreferrer" class="navbar__item navbar__link header-goframe-link"></a><a href=https://github.com/gqcn target=_blank rel="noopener noreferrer" class="navbar__item navbar__link header-github-link"></a><div class=navbarSearchContainer_Bca1><button type=button class="DocSearch DocSearch-Button" aria-label="Search (Command+K)"><span class=DocSearch-Button-Container><svg width=20 height=20 class=DocSearch-Search-Icon viewBox="0 0 20 20" aria-hidden=true><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke=currentColor fill=none fill-rule=evenodd stroke-linecap=round stroke-linejoin=round /></svg><span class=DocSearch-Button-Placeholder>Search</span></span><span class=DocSearch-Button-Keys></span></button></div></div></div><div role=presentation class=navbar-sidebar__backdrop></div></nav><div id=__docusaurus_skipToContent_fallback class="main-wrapper mainWrapper_z2l0"><div class=docsWrapper_hBAB><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type=button></button><div class=docRoot_UBD9><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class=sidebarViewport_aRkj><div class=sidebar_njMd><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="menu__link menu__link--sublist" href=/ai>AI技术</a><button aria-label="Expand sidebar category 'AI技术'" aria-expanded=false type=button class="clean-btn menu__caret"></button></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class=menu__list-item-collapsible><a class="menu__link menu__link--sublist menu__link--active" href=/cloud-native>云原生</a><button aria-label="Collapse sidebar category '云原生'" aria-expanded=true type=button class="clean-btn menu__caret"></button></div><ul style=display:block;overflow:visible;height:auto class=menu__list><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="menu__link menu__link--sublist" tabindex=0 href=/cloud-native/container>Container</a><button aria-label="Expand sidebar category 'Container'" aria-expanded=false type=button class="clean-btn menu__caret"></button></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class=menu__list-item-collapsible><a class="menu__link menu__link--sublist menu__link--active" tabindex=0 href=/cloud-native/kubernetes>Kubernetes</a><button aria-label="Collapse sidebar category 'Kubernetes'" aria-expanded=true type=button class="clean-btn menu__caret"></button></div><ul style=display:block;overflow:visible;height:auto class=menu__list><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item"><div class=menu__list-item-collapsible><a class="menu__link menu__link--sublist menu__link--active" tabindex=0 href=/cloud-native/kubernetes-usage-notes>Kubernetes使用笔记</a><button aria-label="Collapse sidebar category 'Kubernetes使用笔记'" aria-expanded=true type=button class="clean-btn menu__caret"></button></div><ul style=display:block;overflow:visible;height:auto class=menu__list><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link menu__link--active" aria-current=page tabindex=0 href=/cloud-native/kubernetes-common-commands>Kubernetes常用命令</a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class=menu__link tabindex=0 href=/cloud-native/kubernetes-krew-plugins>Kubernetes krew常用插件</a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class=menu__link tabindex=0 href=/cloud-native/kubernetes-kustomize>Kubernetes kustomize</a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class=menu__link tabindex=0 href=/cloud-native/kubernetes-generate-bearer-token>Kubernetes生成Bearer Token</a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class=menu__link tabindex=0 href=/cloud-native/kubernetes-audit-log>Kubernetes审计日志开启与查看</a></ul><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="menu__link menu__link--sublist" tabindex=0 href=/cloud-native/kubernetes-extension-development>Kubernetes扩展开发</a><button aria-label="Expand sidebar category 'Kubernetes扩展开发'" aria-expanded=false type=button class="clean-btn menu__caret"></button></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="menu__link menu__link--sublist" tabindex=0 href=/cloud-native/kubernetes-troubleshooting>Kubernetes问题排查</a><button aria-label="Expand sidebar category 'Kubernetes问题排查'" aria-expanded=false type=button class="clean-btn menu__caret"></button></div><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class=menu__link tabindex=0 href=/cloud-native/kubernetes-network-policy>Kubernetes NetworkPolicy</a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class=menu__link tabindex=0 href=/cloud-native/kubernetes-device-plugin>Kubernetes Device Plugin</a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class=menu__link tabindex=0 href=/cloud-native/kubernetes-kubelet-pod-eviction-process>Kubelet驱逐Pod详细流程</a></ul><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="menu__link menu__link--sublist" tabindex=0 href=/cloud-native/argo-workflow>Argo Workflow</a><button aria-label="Expand sidebar category 'Argo Workflow'" aria-expanded=false type=button class="clean-btn menu__caret"></button></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="menu__link menu__link--sublist" tabindex=0 href=/cloud-native/volcano>Volcano</a><button aria-label="Expand sidebar category 'Volcano'" aria-expanded=false type=button class="clean-btn menu__caret"></button></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="menu__link menu__link--sublist" tabindex=0 href=/cloud-native/kind>Kind</a><button aria-label="Expand sidebar category 'Kind'" aria-expanded=false type=button class="clean-btn menu__caret"></button></div><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class=menu__link tabindex=0 href=/cloud-native/helm>Helm常用指令</a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class=menu__link tabindex=0 href=/cloud-native/dragonfly>Dragonfly介绍</a></ul><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="menu__link menu__link--sublist" href=/notes>日常笔记</a><button aria-label="Expand sidebar category '日常笔记'" aria-expanded=false type=button class="clean-btn menu__caret"></button></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="menu__link menu__link--sublist" href=/programming>开发语言</a><button aria-label="Expand sidebar category '开发语言'" aria-expanded=false type=button class="clean-btn menu__caret"></button></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="menu__link menu__link--sublist" href=/architecture>技术架构</a><button aria-label="Expand sidebar category '技术架构'" aria-expanded=false type=button class="clean-btn menu__caret"></button></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="menu__link menu__link--sublist" href=/management>技术管理</a><button aria-label="Expand sidebar category '技术管理'" aria-expanded=false type=button class="clean-btn menu__caret"></button></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="menu__link menu__link--sublist" href=/observability>可观测性</a><button aria-label="Expand sidebar category '可观测性'" aria-expanded=false type=button class="clean-btn menu__caret"></button></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="menu__link menu__link--sublist" href=/database-and-middleware>数据库与中间件</a><button aria-label="Expand sidebar category '数据库与中间件'" aria-expanded=false type=button class="clean-btn menu__caret"></button></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="menu__link menu__link--sublist" href=/operating-systems-and-networks>操作系统和网络</a><button aria-label="Expand sidebar category '操作系统和网络'" aria-expanded=false type=button class="clean-btn menu__caret"></button></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="menu__link menu__link--sublist" href=/life>生活笔记</a><button aria-label="Expand sidebar category '生活笔记'" aria-expanded=false type=button class="clean-btn menu__caret"></button></div></ul></nav></div></div></aside><main class=docMainContainer_TBSr><div class="container padding-top--md padding-bottom--lg"><div class=row><div class="col docItemCol_VOVn"><div class=docItemContainer_Djhp><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label=Breadcrumbs><ul class=breadcrumbs itemscope itemtype=https://schema.org/BreadcrumbList><li class=breadcrumbs__item><a aria-label="Home page" class=breadcrumbs__link href=/><svg viewBox="0 0 24 24" class=breadcrumbHomeIcon_YNFT><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill=currentColor /></svg></a><li itemscope itemprop=itemListElement itemtype=https://schema.org/ListItem class=breadcrumbs__item><a class=breadcrumbs__link itemprop=item href=/cloud-native><span itemprop=name>云原生</span></a><meta itemprop=position content=1><li itemscope itemprop=itemListElement itemtype=https://schema.org/ListItem class=breadcrumbs__item><a class=breadcrumbs__link itemprop=item href=/cloud-native/kubernetes><span itemprop=name>Kubernetes</span></a><meta itemprop=position content=2><li itemscope itemprop=itemListElement itemtype=https://schema.org/ListItem class=breadcrumbs__item><a class=breadcrumbs__link itemprop=item href=/cloud-native/kubernetes-usage-notes><span itemprop=name>Kubernetes使用笔记</span></a><meta itemprop=position content=3><li itemscope itemprop=itemListElement itemtype=https://schema.org/ListItem class="breadcrumbs__item breadcrumbs__item--active"><span class=breadcrumbs__link itemprop=name>Kubernetes常用命令</span><meta itemprop=position content=4></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type=button class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><p><code>kubernetes</code>通过<code>kube-apiserver</code>作为整个集群管理的入口。<code>apiserver</code>是整个集群的主管理节点，用户通过<code>apiserver</code>配置和组织集群，同时集群中各个节点同<code>etcd</code>存储的交互也是通过<code>apiserver</code>进行交互。<code>apiserver</code>实现了一套<code>RESTfull</code>的接口，用户可以直接使用<code>API</code>同<code>apiserver</code>交互。另外官方还提供了一个客户端<code>kubectl</code>随工具集打包，用于可直接通过<code>kubectl</code>以命令行的方式同集群交互。</p>
<div class="theme-admonition theme-admonition-tip admonition_xJq3 alert alert--success"><div class=admonitionHeading_Gvgb><span class=admonitionIcon_Rf37><svg viewBox="0 0 12 16"><path fill-rule=evenodd d="M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"/></svg></span>tip</div><div class=admonitionContent_BuS1><p>本文只介绍平时工作中常用到的<code>kubectl</code>命令，更详细的命令介绍可以参考官方文档：<a href=http://docs.kubernetes.org.cn/683.html target=_blank rel="noopener noreferrer">http://docs.kubernetes.org.cn/683.html</a></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id=help>help<a href=#help class=hash-link aria-label="Direct link to help" title="Direct link to help">​</a></h2>
<p><code>kubectl</code>的命令行参数比较多，若有什么不清楚地，都可以通过帮助提示来了解。如下图所示，<code>kubectl</code>使用方式为：</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#f8f8f2;--prism-background-color:#272822><div class=codeBlockContent_biex><pre tabindex=0 class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style=color:#f8f8f2;background-color:#272822><code class=codeBlockLines_e6Vv><span class=token-line style=color:#f8f8f2><span class="token plain">kubectl</span><span class="token punctuation" style=color:#f8f8f2>[</span><span class="token plain">flags</span><span class="token punctuation" style=color:#f8f8f2>]</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">kubectl</span><span class="token punctuation" style=color:#f8f8f2>[</span><span class="token plain">commond</span><span class="token punctuation" style=color:#f8f8f2>]</span><br></span></code></pre><div class=buttonGroup__atx><button type=button aria-label="Copy code to clipboard" title=Copy class=clean-btn><span class=copyButtonIcons_eSgA aria-hidden=true><svg viewBox="0 0 24 24" class=copyButtonIcon_y97N><path fill=currentColor d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"/></svg><svg viewBox="0 0 24 24" class=copyButtonSuccessIcon_LjdS><path fill=currentColor d=M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z /></svg></span></button></div></div></div>
<p>另外所有的命令选项都可以通过执行 <code>--help </code> 获得<strong>特定命令</strong>的帮助信息。 </p>
<p><img decoding=async loading=lazy src=/assets/images/image2022-4-24_16-56-32-864cbd931fefeff91cfc97664bb4736f.png width=3840 height=2110 class=img_ev3q></p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id=get>get<a href=#get class=hash-link aria-label="Direct link to get" title="Direct link to get">​</a></h2>
<p><code>get</code>命令用于获取集群的一个或一些<code>resource</code>信息。使用<code>--help</code>查看详细信息。<code>kubectl</code>的帮助信息、示例相当详细，而且简单易懂。建议大家习惯使用帮助信息。<code>kubectl</code>可以列出集群所有<code>resource</code>的详细。<code>resource</code>包括集群节点、运行的<code>pod、deployment、service</code>等。</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#f8f8f2;--prism-background-color:#272822><div class=codeBlockContent_biex><pre tabindex=0 class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style=color:#f8f8f2;background-color:#272822><code class=codeBlockLines_e6Vv><span class=token-line style=color:#f8f8f2><span class="token plain">kubectl get </span><span class="token punctuation" style=color:#f8f8f2>[</span><span class="token punctuation" style=color:#f8f8f2>(</span><span class="token plain">-o</span><span class="token operator" style=color:#66d9ef>|</span><span class="token plain">--output</span><span class="token operator" style=color:#66d9ef>=</span><span class="token punctuation" style=color:#f8f8f2>)</span><span class="token plain">json</span><span class="token operator" style=color:#66d9ef>|</span><span class="token plain">yaml</span><span class="token operator" style=color:#66d9ef>|</span><span class="token plain">wide</span><span class="token operator" style=color:#66d9ef>|</span><span class="token plain">go-template</span><span class="token operator" style=color:#66d9ef>=</span><span class="token punctuation" style=color:#f8f8f2>..</span><span class="token plain">.</span><span class="token operator" style=color:#66d9ef>|</span><span class="token plain">go-template-file</span><span class="token operator" style=color:#66d9ef>=</span><span class="token punctuation" style=color:#f8f8f2>..</span><span class="token plain">.</span><span class="token operator" style=color:#66d9ef>|</span><span class="token assign-left variable" style=color:#f8f8f2>jsonpath</span><span class="token operator" style=color:#66d9ef>=</span><span class="token punctuation" style=color:#f8f8f2>..</span><span class="token plain">.</span><span class="token operator" style=color:#66d9ef>|</span><span class="token plain">jsonpath-file</span><span class="token operator" style=color:#66d9ef>=</span><span class="token punctuation" style=color:#f8f8f2>..</span><span class="token plain">.</span><span class="token punctuation" style=color:#f8f8f2>]</span><span class="token plain"> </span><span class="token punctuation" style=color:#f8f8f2>(</span><span class="token plain">TYPE </span><span class="token punctuation" style=color:#f8f8f2>[</span><span class="token plain">NAME </span><span class="token operator" style=color:#66d9ef>|</span><span class="token plain"> </span><span class="token parameter variable" style=color:#f8f8f2>-l</span><span class="token plain"> label</span><span class="token punctuation" style=color:#f8f8f2>]</span><span class="token plain"> </span><span class="token operator" style=color:#66d9ef>|</span><span class="token plain"> TYPE/NAME </span><span class="token punctuation" style=color:#f8f8f2>..</span><span class="token plain">.</span><span class="token punctuation" style=color:#f8f8f2>)</span><span class="token plain"> </span><span class="token punctuation" style=color:#f8f8f2>[</span><span class="token plain">flags</span><span class="token punctuation" style=color:#f8f8f2>]</span><span class="token plain"> </span><span class="token punctuation" style=color:#f8f8f2>[</span><span class="token plain">flags</span><span class="token punctuation" style=color:#f8f8f2>]</span><br></span></code></pre><div class=buttonGroup__atx><button type=button aria-label="Copy code to clipboard" title=Copy class=clean-btn><span class=copyButtonIcons_eSgA aria-hidden=true><svg viewBox="0 0 24 24" class=copyButtonIcon_y97N><path fill=currentColor d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"/></svg><svg viewBox="0 0 24 24" class=copyButtonSuccessIcon_LjdS><path fill=currentColor d=M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z /></svg></span></button></div></div></div>
<p><strong>获取<code>pod</code>信息：</strong></p>
<p>可以直接使用 <code>kubectl get po</code> 获取当前运行的所有<code>pods</code>的信息，或使用 <code>kubectl get po -o wide</code> 获取<code>pod</code>运行在哪个节点上的信息。注意：集群中可以创建多个<code>namespace</code>，未显示的指定<code>namespace</code>的情况下，所有操作都是针对<code>default namespace</code>。如下图所示列出了<code>default</code> 和<code>kube-system</code>的<code>pods</code>：</p>
<p><img decoding=async loading=lazy src=/assets/images/20160425212037227-d0e4024d453a05504f6f03deb6c1c647.png width=1402 height=768 class=img_ev3q></p>
<p><strong>获取<code>namespace</code>信息：</strong></p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#f8f8f2;--prism-background-color:#272822><div class=codeBlockContent_biex><pre tabindex=0 class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style=color:#f8f8f2;background-color:#272822><code class=codeBlockLines_e6Vv><span class=token-line style=color:#f8f8f2><span class="token plain">kubectl get namespace</span><br></span></code></pre><div class=buttonGroup__atx><button type=button aria-label="Copy code to clipboard" title=Copy class=clean-btn><span class=copyButtonIcons_eSgA aria-hidden=true><svg viewBox="0 0 24 24" class=copyButtonIcon_y97N><path fill=currentColor d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"/></svg><svg viewBox="0 0 24 24" class=copyButtonSuccessIcon_LjdS><path fill=currentColor d=M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z /></svg></span></button></div></div></div>
<p><strong>获取其他<code>resource</code>：</strong></p>
<p>类似可以使用<code>kubectl get rc、kubectl get svc、kubectl get nodes</code>等获取其他<code>resource</code>信息。</p>
<p><strong>获取一些更具体的信息：</strong></p>
<p>可以通过使用选项<code>-o</code>。如：<br>
<!-- -->1）<code>kubectl get po -o yaml</code>以<code>yaml</code>格式输出<code>pod</code>的详细信息。</p>
<p><img decoding=async loading=lazy src=/assets/images/20160425213027232-5c2bbde4c83070aa832cfaf1db6c1af8.png width=519 height=313 class=img_ev3q></p>
<p>2）<code>kubectl get po -o json</code>以<code>json</code>格式输出<code>pod</code>的详细信息。</p>
<p><img decoding=async loading=lazy src=/assets/images/20160425213047717-981fe5318f4a18d966602b7b481d22bf.png width=572 height=281 class=img_ev3q></p>
<p>3）另外还可以使用 <code>-o=custom-columns=</code> 定义直接获取指定内容的值。如前面使用<code>json</code>和<code>yaml</code>格式的输出中，<code>metadata.labels.app</code>的值可以使用如下命令获取。 </p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#f8f8f2;--prism-background-color:#272822><div class=codeBlockContent_biex><pre tabindex=0 class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style=color:#f8f8f2;background-color:#272822><code class=codeBlockLines_e6Vv><span class=token-line style=color:#f8f8f2><span class="token plain">kubectl get po rc-nginx-2-btv4j </span><span class="token parameter variable" style=color:#f8f8f2>-o</span><span class="token operator" style=color:#66d9ef>=</span><span class="token plain">custom-columns</span><span class="token operator" style=color:#66d9ef>=</span><span class="token plain">LABELS:.metadata.labels.app</span><br></span></code></pre><div class=buttonGroup__atx><button type=button aria-label="Copy code to clipboard" title=Copy class=clean-btn><span class=copyButtonIcons_eSgA aria-hidden=true><svg viewBox="0 0 24 24" class=copyButtonIcon_y97N><path fill=currentColor d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"/></svg><svg viewBox="0 0 24 24" class=copyButtonSuccessIcon_LjdS><path fill=currentColor d=M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z /></svg></span></button></div></div></div>
<p>其中<code>LABELS</code>为显示的列标题，<code>.metadata.labels.app</code>为查询的域名</p>
<p>4）其他资源也可以使用类似的方式。</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id=describe>describe<a href=#describe class=hash-link aria-label="Direct link to describe" title="Direct link to describe">​</a></h2>
<p><code>describe</code>类似于<code>get</code>，同样用于获取<code>resource</code>的相关信息。不同的是，<code>get</code>获得的是更详细的<code>resource</code>个性的详细信息，<code>describe</code>获得的是<code>resource</code>集群相关的信息。<code>describe</code>命令同<code>get</code>类似，但是<code>describe</code>不支持<code>-o</code>选项，对于同一类型<code>resource</code>，<code>describe</code>输出的信息格式，内容域相同。 注意：如果发现是查询某个<code>resource</code>的信息，使用<code>get</code>命令能够获取更加详尽的信息。但是如果想要查询某个<code>resource</code>的状态，如某个<code>pod</code>并不是在<code>running</code>状态，这时需要获取更详尽的状态信息时，就应该使用<code>describe</code>命令。 </p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#f8f8f2;--prism-background-color:#272822><div class=codeBlockContent_biex><pre tabindex=0 class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style=color:#f8f8f2;background-color:#272822><code class=codeBlockLines_e6Vv><span class=token-line style=color:#f8f8f2><span class="token plain">kubectl describe po rc-nginx-2-btv4j</span><br></span></code></pre><div class=buttonGroup__atx><button type=button aria-label="Copy code to clipboard" title=Copy class=clean-btn><span class=copyButtonIcons_eSgA aria-hidden=true><svg viewBox="0 0 24 24" class=copyButtonIcon_y97N><path fill=currentColor d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"/></svg><svg viewBox="0 0 24 24" class=copyButtonSuccessIcon_LjdS><path fill=currentColor d=M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z /></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id=create>create<a href=#create class=hash-link aria-label="Direct link to create" title="Direct link to create">​</a></h2>
<p><code>kubectl</code>命令用于根据文件或输入创建集群<code>resource</code>。如果已经定义了相应<code>resource</code>的<code>yaml</code>或<code>json</code>文件，直接 <code>kubectl create -f filename </code> 即可创建文件内定义的<code>resource</code>。也可以直接只用子命令 <code>[namespace/secret/configmap/serviceaccount]</code> 等直接创建相应的<code>resource</code>。从追踪和维护的角度出发，建议使用<code>json</code>或<code>yaml</code>的方式定义资源。 <br>
<!-- -->如，前面<code>get</code>中获取的两个<code>nginx pod</code>的<code>replication controller</code>文件内容如下。文件名为：<code>rc-nginx.yaml</code></p>
<div class="language-yaml codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#f8f8f2;--prism-background-color:#272822><div class=codeBlockContent_biex><pre tabindex=0 class="prism-code language-yaml codeBlock_bY9V thin-scrollbar" style=color:#f8f8f2;background-color:#272822><code class=codeBlockLines_e6Vv><span class=token-line style=color:#f8f8f2><span class="token key atrule">apiVersion</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"> v1</span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain"></span><span class="token key atrule">kind</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"> ReplicationController</span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain"></span><span class="token key atrule">metadata</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">  </span><span class="token key atrule">name</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"> rc</span><span class="token punctuation" style=color:#f8f8f2>-</span><span class="token plain">nginx</span><span class="token punctuation" style=color:#f8f8f2>-</span><span class="token number" style=color:#ae81ff>2</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain"></span><span class="token key atrule">spec</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">  </span><span class="token key atrule">replicas</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"> </span><span class="token number" style=color:#ae81ff>2</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">  </span><span class="token key atrule">template</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">    </span><span class="token key atrule">metadata</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">      </span><span class="token key atrule">labels</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">        </span><span class="token key atrule">app</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"> nginx</span><span class="token punctuation" style=color:#f8f8f2>-</span><span class="token number" style=color:#ae81ff>2</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">    </span><span class="token key atrule">spec</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">      </span><span class="token key atrule">containers</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">      </span><span class="token punctuation" style=color:#f8f8f2>-</span><span class="token plain"> </span><span class="token key atrule">name</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"> nginx</span><span class="token punctuation" style=color:#f8f8f2>-</span><span class="token number" style=color:#ae81ff>2</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">        </span><span class="token key atrule">image</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"> xingwangc.docker.rg/nginx</span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">        </span><span class="token key atrule">ports</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">        </span><span class="token punctuation" style=color:#f8f8f2>-</span><span class="token plain"> </span><span class="token key atrule">containerPort</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"> </span><span class="token number" style=color:#ae81ff>80</span><br></span></code></pre><div class=buttonGroup__atx><button type=button aria-label="Copy code to clipboard" title=Copy class=clean-btn><span class=copyButtonIcons_eSgA aria-hidden=true><svg viewBox="0 0 24 24" class=copyButtonIcon_y97N><path fill=currentColor d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"/></svg><svg viewBox="0 0 24 24" class=copyButtonSuccessIcon_LjdS><path fill=currentColor d=M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z /></svg></span></button></div></div></div>
<p>直接使用<code>create</code>则可以基于<code>rc-nginx.yaml</code>文件创建出<code>ReplicationController(rc)</code>，<code>rc</code>会创建两个副本：</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#f8f8f2;--prism-background-color:#272822><div class=codeBlockContent_biex><pre tabindex=0 class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style=color:#f8f8f2;background-color:#272822><code class=codeBlockLines_e6Vv><span class=token-line style=color:#f8f8f2><span class="token plain">kubectl create </span><span class="token parameter variable" style=color:#f8f8f2>-f</span><span class="token plain"> rc-nginx.yaml</span><br></span></code></pre><div class=buttonGroup__atx><button type=button aria-label="Copy code to clipboard" title=Copy class=clean-btn><span class=copyButtonIcons_eSgA aria-hidden=true><svg viewBox="0 0 24 24" class=copyButtonIcon_y97N><path fill=currentColor d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"/></svg><svg viewBox="0 0 24 24" class=copyButtonSuccessIcon_LjdS><path fill=currentColor d=M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z /></svg></span></button></div></div></div>
<p>创建后，使用 <code>kubectl get rc</code> 可以看到一个名为<code>rc-nginx-2</code>的<code>ReplicationController</code>将被创建，同时 <code>kubectl get po</code> 的结果中会多出两个前缀为 <code>rc-nginx-2-</code> 的<code>pod</code>。</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id=replace>replace<a href=#replace class=hash-link aria-label="Direct link to replace" title="Direct link to replace">​</a></h2>
<p><code>replace</code>命令用于对已有资源进行更新、替换。如前面<code>create</code>中创建的<code>nginx</code>，当我们需要更新<code>resource</code>的一些属性的时候，如果修改副本数量，增加、修改<code>label</code>，更改<code>image</code>版本，修改端口等。都可以直接修改原<code>yaml</code>文件，然后执行<code>replace</code>命令。</p>
<p><strong>注意：名字不能被更更新</strong>。另外，如果是更新<code>label</code>，原有标签的<code>pod</code>将会与更新<code>label</code>后的<code>rc</code>断开联系，有新<code>label</code>的<code>rc</code>将会创建指定副本数的新的<code>pod</code>，但是默认并不会删除原来的<code>pod</code>。所以此时如果使用<code>get po</code>将会发现<code>pod</code>数翻倍，进一步<code>check</code>会发现原来的<code>pod</code>已经不会被新<code>rc</code>控制，此处只介绍命令不详谈此问题，好奇者可自行实验。</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#f8f8f2;--prism-background-color:#272822><div class=codeBlockContent_biex><pre tabindex=0 class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style=color:#f8f8f2;background-color:#272822><code class=codeBlockLines_e6Vv><span class=token-line style=color:#f8f8f2><span class="token plain">kubectl replace </span><span class="token parameter variable" style=color:#f8f8f2>-f</span><span class="token plain"> rc-nginx.yaml </span><br></span></code></pre><div class=buttonGroup__atx><button type=button aria-label="Copy code to clipboard" title=Copy class=clean-btn><span class=copyButtonIcons_eSgA aria-hidden=true><svg viewBox="0 0 24 24" class=copyButtonIcon_y97N><path fill=currentColor d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"/></svg><svg viewBox="0 0 24 24" class=copyButtonSuccessIcon_LjdS><path fill=currentColor d=M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z /></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id=patch>patch<a href=#patch class=hash-link aria-label="Direct link to patch" title="Direct link to patch">​</a></h2>
<p>如果一个容器已经在运行，这时需要对一些容器属性进行修改，又不想删除容器，或不方便通过<code>replace</code>的方式进行更新。<code>kubernetes</code>还提供了一种在容器运行时，直接对容器进行修改的方式，就是<code>patch</code>命令。如前面创建<code>pod</code>的<code>label</code>是<code>app=nginx-2</code>，如果在运行过程中，需要把其<code>label</code>改为<code>app=nginx-3</code>，这<code>patch</code>命令如下：</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#f8f8f2;--prism-background-color:#272822><div class=codeBlockContent_biex><pre tabindex=0 class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style=color:#f8f8f2;background-color:#272822><code class=codeBlockLines_e6Vv><span class=token-line style=color:#f8f8f2><span class="token plain">kubectl patch pod rc-nginx-2-kpiqt </span><span class="token parameter variable" style=color:#f8f8f2>-p</span><span class="token plain"> </span><span class="token string" style=color:#a6e22e>'{"metadata":{"labels":{"app":"nginx-3"}}}'</span><span class="token plain"> </span><br></span></code></pre><div class=buttonGroup__atx><button type=button aria-label="Copy code to clipboard" title=Copy class=clean-btn><span class=copyButtonIcons_eSgA aria-hidden=true><svg viewBox="0 0 24 24" class=copyButtonIcon_y97N><path fill=currentColor d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"/></svg><svg viewBox="0 0 24 24" class=copyButtonSuccessIcon_LjdS><path fill=currentColor d=M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z /></svg></span></button></div></div></div>
<p>此外，<code>patch</code>命令还可以用于对<code>deployment</code>进行平滑重启，比如通过<code>patch</code>修改<code>deployment</code>中一些无关紧要的属性，那么<code>deployment</code>对应的<code>pods</code>会执行平滑重启：</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#f8f8f2;--prism-background-color:#272822><div class=codeBlockContent_biex><pre tabindex=0 class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style=color:#f8f8f2;background-color:#272822><code class=codeBlockLines_e6Vv><span class=token-line style=color:#f8f8f2><span class="token plain">kubectl patch deployment your-deployment </span><span class="token parameter variable" style=color:#f8f8f2>-p</span><span class="token plain"> </span><span class="token string" style=color:#a6e22e>"{</span><span class="token string entity" style=color:#a6e22e>\"</span><span class="token string" style=color:#a6e22e>spec</span><span class="token string entity" style=color:#a6e22e>\"</span><span class="token string" style=color:#a6e22e>:{</span><span class="token string entity" style=color:#a6e22e>\"</span><span class="token string" style=color:#a6e22e>template</span><span class="token string entity" style=color:#a6e22e>\"</span><span class="token string" style=color:#a6e22e>:{</span><span class="token string entity" style=color:#a6e22e>\"</span><span class="token string" style=color:#a6e22e>metadata</span><span class="token string entity" style=color:#a6e22e>\"</span><span class="token string" style=color:#a6e22e>:{</span><span class="token string entity" style=color:#a6e22e>\"</span><span class="token string" style=color:#a6e22e>labels</span><span class="token string entity" style=color:#a6e22e>\"</span><span class="token string" style=color:#a6e22e>:{</span><span class="token string entity" style=color:#a6e22e>\"</span><span class="token string" style=color:#a6e22e>date</span><span class="token string entity" style=color:#a6e22e>\"</span><span class="token string" style=color:#a6e22e>:</span><span class="token string entity" style=color:#a6e22e>\"</span><span class="token string variable" style=color:#f8f8f2>$(</span><span class="token string variable function" style=color:#e6db74>date</span><span class="token string variable" style=color:#f8f8f2> +%s</span><span class="token string variable" style=color:#f8f8f2>)</span><span class="token string entity" style=color:#a6e22e>\"</span><span class="token string" style=color:#a6e22e>}}}}}"</span><br></span></code></pre><div class=buttonGroup__atx><button type=button aria-label="Copy code to clipboard" title=Copy class=clean-btn><span class=copyButtonIcons_eSgA aria-hidden=true><svg viewBox="0 0 24 24" class=copyButtonIcon_y97N><path fill=currentColor d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"/></svg><svg viewBox="0 0 24 24" class=copyButtonSuccessIcon_LjdS><path fill=currentColor d=M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z /></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id=edit>edit<a href=#edit class=hash-link aria-label="Direct link to edit" title="Direct link to edit">​</a></h2>
<p><code>edit</code>提供了另一种更新<code>resource</code>源的操作，通过<code>edit</code>能够灵活的在一个<code>common</code>的<code>resource</code>基础上，发展出更过的<code>significant resource</code>。例如，使用<code>edit</code>直接更新前面创建的<code>pod</code>的命令为：</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#f8f8f2;--prism-background-color:#272822><div class=codeBlockContent_biex><pre tabindex=0 class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style=color:#f8f8f2;background-color:#272822><code class=codeBlockLines_e6Vv><span class=token-line style=color:#f8f8f2><span class="token plain">kubectl edit po rc-nginx-btv4j </span><br></span></code></pre><div class=buttonGroup__atx><button type=button aria-label="Copy code to clipboard" title=Copy class=clean-btn><span class=copyButtonIcons_eSgA aria-hidden=true><svg viewBox="0 0 24 24" class=copyButtonIcon_y97N><path fill=currentColor d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"/></svg><svg viewBox="0 0 24 24" class=copyButtonSuccessIcon_LjdS><path fill=currentColor d=M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z /></svg></span></button></div></div></div>
<p>上面命令的效果等效于：</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#f8f8f2;--prism-background-color:#272822><div class=codeBlockContent_biex><pre tabindex=0 class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style=color:#f8f8f2;background-color:#272822><code class=codeBlockLines_e6Vv><span class=token-line style=color:#f8f8f2><span class="token plain">kubectl get po rc-nginx-btv4j </span><span class="token parameter variable" style=color:#f8f8f2>-o</span><span class="token plain"> yaml </span><span class="token operator" style=color:#66d9ef>>></span><span class="token plain"> /tmp/nginx-tmp.yaml </span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain"></span><span class="token function" style=color:#e6db74>vim</span><span class="token plain"> /tmp/nginx-tmp.yaml </span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">/*do some changes here */ </span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">kubectl replace </span><span class="token parameter variable" style=color:#f8f8f2>-f</span><span class="token plain"> /tmp/nginx-tmp.yaml </span><br></span></code></pre><div class=buttonGroup__atx><button type=button aria-label="Copy code to clipboard" title=Copy class=clean-btn><span class=copyButtonIcons_eSgA aria-hidden=true><svg viewBox="0 0 24 24" class=copyButtonIcon_y97N><path fill=currentColor d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"/></svg><svg viewBox="0 0 24 24" class=copyButtonSuccessIcon_LjdS><path fill=currentColor d=M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z /></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id=delete>delete<a href=#delete class=hash-link aria-label="Direct link to delete" title="Direct link to delete">​</a></h2>
<p>根据<code>resource</code>名或<code>label</code>删除<code>resource</code>。</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#f8f8f2;--prism-background-color:#272822><div class=codeBlockContent_biex><pre tabindex=0 class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style=color:#f8f8f2;background-color:#272822><code class=codeBlockLines_e6Vv><span class=token-line style=color:#f8f8f2><span class="token plain">kubectl delete </span><span class="token parameter variable" style=color:#f8f8f2>-f</span><span class="token plain"> rc-nginx.yaml </span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">kubectl delete po rc-nginx-btv4j </span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">kubectl delete po </span><span class="token parameter variable" style=color:#f8f8f2>-lapp</span><span class="token operator" style=color:#66d9ef>=</span><span class="token plain">nginx-2</span><br></span></code></pre><div class=buttonGroup__atx><button type=button aria-label="Copy code to clipboard" title=Copy class=clean-btn><span class=copyButtonIcons_eSgA aria-hidden=true><svg viewBox="0 0 24 24" class=copyButtonIcon_y97N><path fill=currentColor d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"/></svg><svg viewBox="0 0 24 24" class=copyButtonSuccessIcon_LjdS><path fill=currentColor d=M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z /></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id=apply>apply<a href=#apply class=hash-link aria-label="Direct link to apply" title="Direct link to apply">​</a></h2>
<p><code>apply</code>命令提供了比<code>patch</code>，<code>edit</code>等更严格的更新<code>resource</code>的方式。通过<code>apply</code>，用户可以将<code>resource</code>的<code>configuration</code>使用<code>source control</code>的方式维护在版本库中。每次有更新时，将配置文件<code>push</code>到<code>server</code>，然后使用<code>kubectl apply</code>将更新应用到<code>resource</code>。<code>kubernetes</code>会在引用更新前将当前配置文件中的配置同已经应用的配置做比较，并只更新更改的部分，而不会主动更改任何用户未指定的部分。 </p>
<p><code>apply</code>命令的使用方式同<code>replace</code>相同，不同的是，<code>apply</code>不会删除原有<code>resource</code>，然后创建新的。<code>apply</code>直接在原有<code>resource</code>的基础上进行更新。同时<code>kubectl apply</code>还会<code>resource</code>中添加一条注释，标记当前的<code>apply</code>。类似于<code>git</code>操作。</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id=logs>logs<a href=#logs class=hash-link aria-label="Direct link to logs" title="Direct link to logs">​</a></h2>
<p><code>logs</code>命令用于显示<code>pod</code>运行中，容器内程序输出到标准输出的内容。跟<code>docker</code>的<code>logs</code>命令类似。如果要获得<code>tail -f</code>的方式，也可以使用<code>-f</code>选项。</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#f8f8f2;--prism-background-color:#272822><div class=codeBlockContent_biex><pre tabindex=0 class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style=color:#f8f8f2;background-color:#272822><code class=codeBlockLines_e6Vv><span class=token-line style=color:#f8f8f2><span class="token plain">kubectl logs rc-nginx-2-kpiqt </span><br></span></code></pre><div class=buttonGroup__atx><button type=button aria-label="Copy code to clipboard" title=Copy class=clean-btn><span class=copyButtonIcons_eSgA aria-hidden=true><svg viewBox="0 0 24 24" class=copyButtonIcon_y97N><path fill=currentColor d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"/></svg><svg viewBox="0 0 24 24" class=copyButtonSuccessIcon_LjdS><path fill=currentColor d=M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z /></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id=exec>exec<a href=#exec class=hash-link aria-label="Direct link to exec" title="Direct link to exec">​</a></h2>
<p><code>exec</code>命令同样类似于<code>docker</code>的<code>exec</code>命令，为在一个已经运行的容器中执行一条<code>shell</code>命令，如果一个<code>pod</code>容器中，有多个容器，需要使用<code>-c</code>选项指定容器。</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id=rolling-update>rolling-update<a href=#rolling-update class=hash-link aria-label="Direct link to rolling-update" title="Direct link to rolling-update">​</a></h2>
<p><code>rolling-update</code>是一个非常重要的命令，对于已经部署并且正在运行的业务，<code>rolling-update</code>提供了不中断业务的更新方式。<code>rolling-update</code>每次起一个新的<code>pod</code>，等新<code>pod</code>完全起来后删除一个旧的<code>pod</code>，然后再起一个新的<code>pod</code>替换旧的<code>pod</code>，直到替换掉所有的<code>pod</code>。<code>rolling-update</code>需要确保新的版本有不同的<code>name</code>、<code>version</code>和<code>label</code>，否则会报错。</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#f8f8f2;--prism-background-color:#272822><div class=codeBlockContent_biex><pre tabindex=0 class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style=color:#f8f8f2;background-color:#272822><code class=codeBlockLines_e6Vv><span class=token-line style=color:#f8f8f2><span class="token plain">kubectl rolling-update rc-nginx-2 </span><span class="token parameter variable" style=color:#f8f8f2>-f</span><span class="token plain"> rc-nginx.yaml </span><br></span></code></pre><div class=buttonGroup__atx><button type=button aria-label="Copy code to clipboard" title=Copy class=clean-btn><span class=copyButtonIcons_eSgA aria-hidden=true><svg viewBox="0 0 24 24" class=copyButtonIcon_y97N><path fill=currentColor d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"/></svg><svg viewBox="0 0 24 24" class=copyButtonSuccessIcon_LjdS><path fill=currentColor d=M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z /></svg></span></button></div></div></div>
<p>如果在升级过程中，发现有问题还可以中途停止<code>update</code>，并回滚到前面版本。</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#f8f8f2;--prism-background-color:#272822><div class=codeBlockContent_biex><pre tabindex=0 class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style=color:#f8f8f2;background-color:#272822><code class=codeBlockLines_e6Vv><span class=token-line style=color:#f8f8f2><span class="token plain">kubectl rolling-update rc-nginx-2 </span><span class="token parameter variable" style=color:#f8f8f2>--rollback</span><span class="token plain"> </span><br></span></code></pre><div class=buttonGroup__atx><button type=button aria-label="Copy code to clipboard" title=Copy class=clean-btn><span class=copyButtonIcons_eSgA aria-hidden=true><svg viewBox="0 0 24 24" class=copyButtonIcon_y97N><path fill=currentColor d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"/></svg><svg viewBox="0 0 24 24" class=copyButtonSuccessIcon_LjdS><path fill=currentColor d=M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z /></svg></span></button></div></div></div>
<p><code>rolling-update</code>还有很多其他选项提供丰富的功能，如<code>--update-period</code>指定间隔周期，使用时可以使用<code>-h</code>查看<code>help</code>信息。</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id=scale>scale<a href=#scale class=hash-link aria-label="Direct link to scale" title="Direct link to scale">​</a></h2>
<p><code>scale</code>用于程序在负载加重或缩小时副本进行扩容或缩小，如前面创建的<code>nginx</code>有两个副本，可以轻松的使用<code>scale</code>命令对副本数进行扩展或缩小。</p>
<p>例如，扩展副本数到<code>4</code>：</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#f8f8f2;--prism-background-color:#272822><div class=codeBlockContent_biex><pre tabindex=0 class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style=color:#f8f8f2;background-color:#272822><code class=codeBlockLines_e6Vv><span class=token-line style=color:#f8f8f2><span class="token plain">kubectl scale rc rc-nginx-3 </span><span class="token parameter variable" style=color:#f8f8f2>--replicas</span><span class="token operator" style=color:#66d9ef>=</span><span class="token number" style=color:#ae81ff>4</span><span class="token plain"> </span><br></span></code></pre><div class=buttonGroup__atx><button type=button aria-label="Copy code to clipboard" title=Copy class=clean-btn><span class=copyButtonIcons_eSgA aria-hidden=true><svg viewBox="0 0 24 24" class=copyButtonIcon_y97N><path fill=currentColor d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"/></svg><svg viewBox="0 0 24 24" class=copyButtonSuccessIcon_LjdS><path fill=currentColor d=M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z /></svg></span></button></div></div></div>
<p>重新缩减副本数到<code>2</code>：</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#f8f8f2;--prism-background-color:#272822><div class=codeBlockContent_biex><pre tabindex=0 class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style=color:#f8f8f2;background-color:#272822><code class=codeBlockLines_e6Vv><span class=token-line style=color:#f8f8f2><span class="token plain">kubectl scale rc rc-nginx-3 </span><span class="token parameter variable" style=color:#f8f8f2>--replicas</span><span class="token operator" style=color:#66d9ef>=</span><span class="token number" style=color:#ae81ff>2</span><span class="token plain"> </span><br></span></code></pre><div class=buttonGroup__atx><button type=button aria-label="Copy code to clipboard" title=Copy class=clean-btn><span class=copyButtonIcons_eSgA aria-hidden=true><svg viewBox="0 0 24 24" class=copyButtonIcon_y97N><path fill=currentColor d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"/></svg><svg viewBox="0 0 24 24" class=copyButtonSuccessIcon_LjdS><path fill=currentColor d=M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z /></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id=autoscale>autoscale<a href=#autoscale class=hash-link aria-label="Direct link to autoscale" title="Direct link to autoscale">​</a></h2>
<p><code>scale</code>虽然能够很方便的对副本数进行扩展或缩小，但是仍然需要人工介入，不能实时自动的根据系统负载对副本数进行扩/缩。<code>autoscale</code>命令提供了自动根据<code>pod</code>负载对其副本进行扩缩的功能。<code>autoscale</code>命令会给一个<code>rc</code>指定一个副本数的范围，在实际运行中根据<code>pod</code>中运行的程序的负载自动在指定的范围内对<code>pod</code>进行扩容或缩容。如前面创建的<code>nginx</code>，可以用如下命令指定副本范围在<code>1~4</code>：</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#f8f8f2;--prism-background-color:#272822><div class=codeBlockContent_biex><pre tabindex=0 class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style=color:#f8f8f2;background-color:#272822><code class=codeBlockLines_e6Vv><span class=token-line style=color:#f8f8f2><span class="token plain">kubectl autoscale rc rc-nginx-3 </span><span class="token parameter variable" style=color:#f8f8f2>--min</span><span class="token operator" style=color:#66d9ef>=</span><span class="token number" style=color:#ae81ff>1</span><span class="token plain"> </span><span class="token parameter variable" style=color:#f8f8f2>--max</span><span class="token operator" style=color:#66d9ef>=</span><span class="token number" style=color:#ae81ff>4</span><span class="token plain"> </span><br></span></code></pre><div class=buttonGroup__atx><button type=button aria-label="Copy code to clipboard" title=Copy class=clean-btn><span class=copyButtonIcons_eSgA aria-hidden=true><svg viewBox="0 0 24 24" class=copyButtonIcon_y97N><path fill=currentColor d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"/></svg><svg viewBox="0 0 24 24" class=copyButtonSuccessIcon_LjdS><path fill=currentColor d=M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z /></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id=attach>attach<a href=#attach class=hash-link aria-label="Direct link to attach" title="Direct link to attach">​</a></h2>
<p><code>attach</code>命令类似于<code>docker</code>的<code>attach</code>命令，可以直接查看容器中以<code>daemon</code>形式运行的进程的输出，效果类似于<code>logs -f</code>，退出查看使用<code>ctrl-c</code>。如果一个<code>pod</code>中有多个容器，要查看具体的某个容器的的输出，需要在<code>pod</code>名后使用<code>-c containers name</code>指定运行的容器。如下示例的命令为查看<code>kube-system namespace</code>中的<code>kube-dns-v9-rcfuk pod</code>中的<code>skydns</code>容器的输出。 </p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#f8f8f2;--prism-background-color:#272822><div class=codeBlockContent_biex><pre tabindex=0 class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style=color:#f8f8f2;background-color:#272822><code class=codeBlockLines_e6Vv><span class=token-line style=color:#f8f8f2><span class="token plain">kubectl attach kube-dns-v9-rcfuk </span><span class="token parameter variable" style=color:#f8f8f2>-c</span><span class="token plain"> skydns —namespace</span><span class="token operator" style=color:#66d9ef>=</span><span class="token plain">kube-system </span><br></span></code></pre><div class=buttonGroup__atx><button type=button aria-label="Copy code to clipboard" title=Copy class=clean-btn><span class=copyButtonIcons_eSgA aria-hidden=true><svg viewBox="0 0 24 24" class=copyButtonIcon_y97N><path fill=currentColor d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"/></svg><svg viewBox="0 0 24 24" class=copyButtonSuccessIcon_LjdS><path fill=currentColor d=M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z /></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id=config>config<a href=#config class=hash-link aria-label="Direct link to config" title="Direct link to config">​</a></h2>
<p>查看集群信息</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#f8f8f2;--prism-background-color:#272822><div class=codeBlockContent_biex><pre tabindex=0 class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style=color:#f8f8f2;background-color:#272822><code class=codeBlockLines_e6Vv><span class=token-line style=color:#f8f8f2><span class="token plain">kubectl config view</span><br></span></code></pre><div class=buttonGroup__atx><button type=button aria-label="Copy code to clipboard" title=Copy class=clean-btn><span class=copyButtonIcons_eSgA aria-hidden=true><svg viewBox="0 0 24 24" class=copyButtonIcon_y97N><path fill=currentColor d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"/></svg><svg viewBox="0 0 24 24" class=copyButtonSuccessIcon_LjdS><path fill=currentColor d=M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z /></svg></span></button></div></div></div>
<p><img decoding=async loading=lazy src=/assets/images/image2021-5-17_16-34-18-0e7bb4e7f63dc66edd0c5fb11175f6a4.png width=1114 height=1458 class=img_ev3q></p>
<p>切换当前操作集群</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#f8f8f2;--prism-background-color:#272822><div class=codeBlockContent_biex><pre tabindex=0 class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style=color:#f8f8f2;background-color:#272822><code class=codeBlockLines_e6Vv><span class=token-line style=color:#f8f8f2><span class="token plain">kubectl config user-context 集群名称</span><br></span></code></pre><div class=buttonGroup__atx><button type=button aria-label="Copy code to clipboard" title=Copy class=clean-btn><span class=copyButtonIcons_eSgA aria-hidden=true><svg viewBox="0 0 24 24" class=copyButtonIcon_y97N><path fill=currentColor d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"/></svg><svg viewBox="0 0 24 24" class=copyButtonSuccessIcon_LjdS><path fill=currentColor d=M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z /></svg></span></button></div></div></div>
<p><img decoding=async loading=lazy src=/assets/images/image2021-5-17_16-34-53-329709c9f46f1404331e1abb65328641.png width=1388 height=1550 class=img_ev3q></p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id=port-forward>port-forward<a href=#port-forward class=hash-link aria-label="Direct link to port-forward" title="Direct link to port-forward">​</a></h2>
<p><code>port-forward</code>通过端口转发映射本地端口到指定的应用端口。在需要调试部署的<code>pod</code>、<code>svc</code>等资源是否提供正常访问时使用。</p>
<p>命令格式：</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#f8f8f2;--prism-background-color:#272822><div class=codeBlockContent_biex><pre tabindex=0 class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style=color:#f8f8f2;background-color:#272822><code class=codeBlockLines_e6Vv><span class=token-line style=color:#f8f8f2><span class="token plain">kubectl port-forward </span><span class="token operator" style=color:#66d9ef>&lt;</span><span class="token plain">pod_name</span><span class="token operator" style=color:#66d9ef>></span><span class="token plain"> </span><span class="token operator" style=color:#66d9ef>&lt;</span><span class="token plain">forward_port</span><span class="token operator" style=color:#66d9ef>></span><span class="token plain"> </span><span class="token parameter variable" style=color:#f8f8f2>--namespace</span><span class="token plain"> </span><span class="token operator" style=color:#66d9ef>&lt;</span><span class="token plain">namespace</span><span class="token operator" style=color:#66d9ef>></span><span class="token plain"> </span><span class="token parameter variable" style=color:#f8f8f2>--address</span><span class="token plain"> </span><span class="token operator" style=color:#66d9ef>&lt;</span><span class="token plain">IP默认：127.0.0.</span><span class="token operator file-descriptor important" style=color:#66d9ef>1</span><span class="token operator" style=color:#66d9ef>></span><br></span></code></pre><div class=buttonGroup__atx><button type=button aria-label="Copy code to clipboard" title=Copy class=clean-btn><span class=copyButtonIcons_eSgA aria-hidden=true><svg viewBox="0 0 24 24" class=copyButtonIcon_y97N><path fill=currentColor d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"/></svg><svg viewBox="0 0 24 24" class=copyButtonSuccessIcon_LjdS><path fill=currentColor d=M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z /></svg></span></button></div></div></div>
<p>示例：</p>
<ol>
<li>
<p>我在<code>k8s</code>集群中部署了<code>prometheus</code>的<code>node-exporter</code>服务，用于收集系统的信息<code>node-exporter</code>的<code>svc</code>采用的是<code>ClusterIP</code>模式，端口不能直接对外访问，但是我现在想通过<code>nodeip</code>：<code>port</code>的方式在浏览器测试<code>node-exporter</code>资源是否正常，用<code>port-forward</code>实现，其实这种方法访问方式就类似使用<code>NodePort</code>的访问模式。</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#f8f8f2;--prism-background-color:#272822><div class=codeBlockContent_biex><pre tabindex=0 class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style=color:#f8f8f2;background-color:#272822><code class=codeBlockLines_e6Vv><span class=token-line style=color:#f8f8f2><span class="token punctuation" style=color:#f8f8f2>[</span><span class="token plain">root@localhost ~</span><span class="token punctuation" style=color:#f8f8f2>]</span><span class="token plain"> kubectl get svc </span><span class="token parameter variable" style=color:#f8f8f2>-n</span><span class="token plain"> monitoring</span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">NAME                    TYPE        CLUSTER-IP       EXTERNAL-IP   PORT</span><span class="token punctuation" style=color:#f8f8f2>(</span><span class="token plain">S</span><span class="token punctuation" style=color:#f8f8f2>)</span><span class="token plain">                      AGE</span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">grafana                 NodePort    </span><span class="token number" style=color:#ae81ff>192.168</span><span class="token plain">.87.255   </span><span class="token operator" style=color:#66d9ef>&lt;</span><span class="token plain">none</span><span class="token operator" style=color:#66d9ef>></span><span class="token plain">        </span><span class="token number" style=color:#ae81ff>3000</span><span class="token plain">:30712/TCP               2d3h</span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">kube-state-metrics      ClusterIP   None             </span><span class="token operator" style=color:#66d9ef>&lt;</span><span class="token plain">none</span><span class="token operator" style=color:#66d9ef>></span><span class="token plain">        </span><span class="token number" style=color:#ae81ff>8443</span><span class="token plain">/TCP,9443/TCP            2d3h</span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">node-exporter           ClusterIP   None             </span><span class="token operator" style=color:#66d9ef>&lt;</span><span class="token plain">none</span><span class="token operator" style=color:#66d9ef>></span><span class="token plain">        </span><span class="token number" style=color:#ae81ff>9100</span><span class="token plain">/TCP                     2d3h</span><br></span></code></pre><div class=buttonGroup__atx><button type=button aria-label="Copy code to clipboard" title=Copy class=clean-btn><span class=copyButtonIcons_eSgA aria-hidden=true><svg viewBox="0 0 24 24" class=copyButtonIcon_y97N><path fill=currentColor d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"/></svg><svg viewBox="0 0 24 24" class=copyButtonSuccessIcon_LjdS><path fill=currentColor d=M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z /></svg></span></button></div></div></div>
</li>
<li>
<p>将本地端口<code>9800</code>映射到<code>svc</code>的<code>9100</code>端口，如果不指定<code>address</code>则默认为<code>127.0.0.1</code>的地址。</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#f8f8f2;--prism-background-color:#272822><div class=codeBlockContent_biex><pre tabindex=0 class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style=color:#f8f8f2;background-color:#272822><code class=codeBlockLines_e6Vv><span class=token-line style=color:#f8f8f2><span class="token punctuation" style=color:#f8f8f2>[</span><span class="token plain">root@localhost manifests</span><span class="token punctuation" style=color:#f8f8f2>]</span><span class="token plain"> kubectl </span><span class="token parameter variable" style=color:#f8f8f2>-n</span><span class="token plain"> monitoring port-forward svc/node-exporter </span><span class="token number" style=color:#ae81ff>9800</span><span class="token plain">:9100 </span><span class="token parameter variable" style=color:#f8f8f2>--address</span><span class="token plain"> </span><span class="token number" style=color:#ae81ff>10.0</span><span class="token plain">.8.101</span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">Forwarding from </span><span class="token number" style=color:#ae81ff>10.0</span><span class="token plain">.8.101:9800 -</span><span class="token operator" style=color:#66d9ef>></span><span class="token plain"> </span><span class="token number" style=color:#ae81ff>9100</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">Handling connection </span><span class="token keyword" style=color:#66d9ef>for</span><span class="token plain"> </span><span class="token number" style=color:#ae81ff>9800</span><br></span></code></pre><div class=buttonGroup__atx><button type=button aria-label="Copy code to clipboard" title=Copy class=clean-btn><span class=copyButtonIcons_eSgA aria-hidden=true><svg viewBox="0 0 24 24" class=copyButtonIcon_y97N><path fill=currentColor d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"/></svg><svg viewBox="0 0 24 24" class=copyButtonSuccessIcon_LjdS><path fill=currentColor d=M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z /></svg></span></button></div></div></div>
</li>
<li>
<p>在浏览器输入<code>nodeip:本地9800端口</code>进行访问。</p>
<p><img decoding=async loading=lazy src=/assets/images/830887-20210508141329187-1863523021-12190cab1d69b84712bf75dedb434c4f.png width=1322 height=358 class=img_ev3q></p>
</li>
<li>
<p>访问<code>pod</code>。</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#f8f8f2;--prism-background-color:#272822><div class=codeBlockContent_biex><pre tabindex=0 class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style=color:#f8f8f2;background-color:#272822><code class=codeBlockLines_e6Vv><span class=token-line style=color:#f8f8f2><span class="token punctuation" style=color:#f8f8f2>[</span><span class="token plain">root@localhost </span><span class="token punctuation" style=color:#f8f8f2>]</span><span class="token plain"> kubectl get pod </span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">NAME                          READY   STATUS    RESTARTS   AGE</span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">temp-chart-6d4cf56db6-rnbwb   </span><span class="token number" style=color:#ae81ff>1</span><span class="token plain">/1     Running   </span><span class="token number" style=color:#ae81ff>0</span><span class="token plain">          29m</span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">temp-chart-6d4cf56db6-rsxhr   </span><span class="token number" style=color:#ae81ff>1</span><span class="token plain">/1     Running   </span><span class="token number" style=color:#ae81ff>0</span><span class="token plain">          29m</span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain"></span><span class="token punctuation" style=color:#f8f8f2>[</span><span class="token plain">root@localhost </span><span class="token punctuation" style=color:#f8f8f2>]</span><span class="token plain"> </span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain"></span><span class="token punctuation" style=color:#f8f8f2>[</span><span class="token plain">root@localhost </span><span class="token punctuation" style=color:#f8f8f2>]</span><span class="token plain"> kubectl port-forward temp-chart-6d4cf56db6-rsxhr </span><span class="token number" style=color:#ae81ff>8090</span><span class="token plain">:80 </span><span class="token parameter variable" style=color:#f8f8f2>--address</span><span class="token plain"> </span><span class="token number" style=color:#ae81ff>10.0</span><span class="token plain">.8.101</span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">Forwarding from </span><span class="token number" style=color:#ae81ff>10.0</span><span class="token plain">.8.101:8090 -</span><span class="token operator" style=color:#66d9ef>></span><span class="token plain"> </span><span class="token number" style=color:#ae81ff>80</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">Handling connection </span><span class="token keyword" style=color:#66d9ef>for</span><span class="token plain"> </span><span class="token number" style=color:#ae81ff>8090</span><br></span></code></pre><div class=buttonGroup__atx><button type=button aria-label="Copy code to clipboard" title=Copy class=clean-btn><span class=copyButtonIcons_eSgA aria-hidden=true><svg viewBox="0 0 24 24" class=copyButtonIcon_y97N><path fill=currentColor d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"/></svg><svg viewBox="0 0 24 24" class=copyButtonSuccessIcon_LjdS><path fill=currentColor d=M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z /></svg></span></button></div></div></div>
</li>
</ol>
<p> <br>
<!-- --> </div></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href=/cloud-native/kubernetes-usage-notes><div class=pagination-nav__sublabel>Previous</div><div class=pagination-nav__label>Kubernetes使用笔记</div></a><a class="pagination-nav__link pagination-nav__link--next" href=/cloud-native/kubernetes-krew-plugins><div class=pagination-nav__sublabel>Next</div><div class=pagination-nav__label>Kubernetes krew常用插件</div></a></nav><div class=docusaurus-mt-lg></div></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href=#help class="table-of-contents__link toc-highlight">help</a><li><a href=#get class="table-of-contents__link toc-highlight">get</a><li><a href=#describe class="table-of-contents__link toc-highlight">describe</a><li><a href=#create class="table-of-contents__link toc-highlight">create</a><li><a href=#replace class="table-of-contents__link toc-highlight">replace</a><li><a href=#patch class="table-of-contents__link toc-highlight">patch</a><li><a href=#edit class="table-of-contents__link toc-highlight">edit</a><li><a href=#delete class="table-of-contents__link toc-highlight">delete</a><li><a href=#apply class="table-of-contents__link toc-highlight">apply</a><li><a href=#logs class="table-of-contents__link toc-highlight">logs</a><li><a href=#exec class="table-of-contents__link toc-highlight">exec</a><li><a href=#rolling-update class="table-of-contents__link toc-highlight">rolling-update</a><li><a href=#scale class="table-of-contents__link toc-highlight">scale</a><li><a href=#autoscale class="table-of-contents__link toc-highlight">autoscale</a><li><a href=#attach class="table-of-contents__link toc-highlight">attach</a><li><a href=#config class="table-of-contents__link toc-highlight">config</a><li><a href=#port-forward class="table-of-contents__link toc-highlight">port-forward</a></ul></div></div></div></div></main></div></div></div><footer class=footer><div class="container container-fluid"><div class="footer__bottom text--center"><div class=footer__copyright>Copyright 2025 johng.cn</div></div></div></footer></div>