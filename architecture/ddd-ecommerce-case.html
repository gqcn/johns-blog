<!doctype html><html lang=en dir=ltr class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-docs/技术架构/软件架构/DDD流程，以电商系统为场景" data-has-hydrated=false><meta charset=UTF-8><meta name=generator content="Docusaurus v3.6.3"><title data-rh=true>DDD流程，以电商系统为场景 | John's Blog</title><meta data-rh=true name=viewport content="width=device-width,initial-scale=1.0"><meta data-rh=true name=twitter:card content=summary_large_image><meta data-rh=true property=og:url content=https://johng.cn/architecture/ddd-ecommerce-case><meta data-rh=true property=og:locale content=en><meta data-rh=true name=docusaurus_locale content=en><meta data-rh=true name=docsearch:language content=en><meta data-rh=true name=docusaurus_version content=current><meta data-rh=true name=docusaurus_tag content=docs-default-current><meta data-rh=true name=docsearch:version content=current><meta data-rh=true name=docsearch:docusaurus_tag content=docs-default-current><meta data-rh=true property=og:title content="DDD流程，以电商系统为场景 | John's Blog"><meta data-rh=true name=description content=通过电商系统的具体场景，详细讲解DDD（领域驱动设计）的实践流程，包括战略设计和战术设计两个阶段><meta data-rh=true property=og:description content=通过电商系统的具体场景，详细讲解DDD（领域驱动设计）的实践流程，包括战略设计和战术设计两个阶段><meta data-rh=true name=keywords content=DDD,领域驱动设计,电商系统,战略设计,战术设计,领域建模><link data-rh=true rel=icon href=/img/favicon.ico><link data-rh=true rel=canonical href=https://johng.cn/architecture/ddd-ecommerce-case><link data-rh=true rel=alternate href=https://johng.cn/architecture/ddd-ecommerce-case hreflang=en><link data-rh=true rel=alternate href=https://johng.cn/architecture/ddd-ecommerce-case hreflang=x-default><link data-rh=true rel=preconnect href=https://XGS1CPQERK-dsn.algolia.net crossorigin><link rel=search type=application/opensearchdescription+xml title="John's Blog" href=/opensearch.xml><script src=https://hm.baidu.com/hm.js?6b4ae23dc83ee5efe875b7172af6c7c1 async></script><script src=https://cdn.wwads.cn/js/makemoney.js async></script><link rel=stylesheet href=/assets/css/styles.96de5670.css><script src=/assets/js/runtime~main.8160ab72.js defer></script><script src=/assets/js/main.1dfd30ac.js defer></script><body class=navigation-with-keyboard><script>!function(){var t,e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();t=null!==e?e:"light",document.documentElement.setAttribute("data-theme",t)}(),function(){try{for(var[t,e]of new URLSearchParams(window.location.search).entries())if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id=__docusaurus><div role=region aria-label="Skip to main content"><a class=skipToContent_fXgn href=#__docusaurus_skipToContent_fallback>Skip to main content</a></div><nav aria-label=Main class="navbar navbar--fixed-top"><div class=navbar__inner><div class=navbar__items><button aria-label="Toggle navigation bar" aria-expanded=false class="navbar__toggle clean-btn" type=button><svg width=30 height=30 viewBox="0 0 30 30" aria-hidden=true><path stroke=currentColor stroke-linecap=round stroke-miterlimit=10 stroke-width=2 d="M4 7h22M4 15h22M4 23h22"/></svg></button><a class=navbar__brand href=/><b class="navbar__title text--truncate">John's Blog</b></a><a aria-current=page class="navbar__item navbar__link navbar__link--active" sidebarid=mainSidebar href=/architecture>技术架构</a><a class="navbar__item navbar__link" sidebarid=mainSidebar href=/programming>开发语言</a><a class="navbar__item navbar__link" sidebarid=mainSidebar href=/cloud-native>云原生</a><a class="navbar__item navbar__link" sidebarid=mainSidebar href=/ai>AI技术</a><a class="navbar__item navbar__link" sidebarid=mainSidebar href=/observability>可观测性</a><a class="navbar__item navbar__link" sidebarid=mainSidebar href=/database-and-middleware>数据库与中间件</a><a class="navbar__item navbar__link" sidebarid=mainSidebar href=/notes>日常笔记</a><a class="navbar__item navbar__link" href=/aboutme>关于我</a></div><div class="navbar__items navbar__items--right"><a href=https://goframe.org/ target=_blank rel="noopener noreferrer" class="navbar__item navbar__link header-goframe-link"></a><a href=https://github.com/gqcn target=_blank rel="noopener noreferrer" class="navbar__item navbar__link header-github-link"></a><div class=navbarSearchContainer_Bca1><button type=button class="DocSearch DocSearch-Button" aria-label="Search (Command+K)"><span class=DocSearch-Button-Container><svg width=20 height=20 class=DocSearch-Search-Icon viewBox="0 0 20 20" aria-hidden=true><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke=currentColor fill=none fill-rule=evenodd stroke-linecap=round stroke-linejoin=round /></svg><span class=DocSearch-Button-Placeholder>Search</span></span><span class=DocSearch-Button-Keys></span></button></div></div></div><div role=presentation class=navbar-sidebar__backdrop></div></nav><div id=__docusaurus_skipToContent_fallback class="main-wrapper mainWrapper_z2l0"><div class=docsWrapper_hBAB><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type=button></button><div class=docRoot_UBD9><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class=sidebarViewport_aRkj><div class=sidebar_njMd><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class=menu__list-item-collapsible><a class="menu__link menu__link--sublist menu__link--active" href=/architecture>技术架构</a><button aria-label="Collapse sidebar category '技术架构'" aria-expanded=true type=button class="clean-btn menu__caret"></button></div><ul style=display:block;overflow:visible;height:auto class=menu__list><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class=menu__list-item-collapsible><a class="menu__link menu__link--sublist menu__link--active" tabindex=0 href=/architecture/software-architecture>软件架构</a><button aria-label="Collapse sidebar category '软件架构'" aria-expanded=true type=button class="clean-btn menu__caret"></button></div><ul style=display:block;overflow:visible;height:auto class=menu__list><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class=menu__link tabindex=0 href=/architecture/clean-architecture-thoughts>阅读《架构简洁之道》的思考</a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class=menu__link tabindex=0 href=/architecture/architecture-diagramming>架构制图：工具与方法论</a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class=menu__link tabindex=0 href=/architecture/cap-and-base>CAP原理和BASE思想</a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class=menu__link tabindex=0 href=/architecture/distributed-transactions-microservices>为什么说分布式事务不再适用于微服务架构</a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class=menu__link tabindex=0 href=/architecture/architectural-thinking>架构思维：抽象、分层、分治、演化</a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link menu__link--active" aria-current=page tabindex=0 href=/architecture/ddd-ecommerce-case>DDD流程，以电商系统为场景</a></ul><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="menu__link menu__link--sublist" tabindex=0 href=/architecture/microservice-architecture>微服务架构</a><button aria-label="Expand sidebar category '微服务架构'" aria-expanded=false type=button class="clean-btn menu__caret"></button></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="menu__link menu__link--sublist" tabindex=0 href=/architecture/middle-platform-architecture>中台架构相关</a><button aria-label="Expand sidebar category '中台架构相关'" aria-expanded=false type=button class="clean-btn menu__caret"></button></div></ul><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="menu__link menu__link--sublist" href=/management>技术管理</a><button aria-label="Expand sidebar category '技术管理'" aria-expanded=false type=button class="clean-btn menu__caret"></button></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="menu__link menu__link--sublist" href=/programming>开发语言</a><button aria-label="Expand sidebar category '开发语言'" aria-expanded=false type=button class="clean-btn menu__caret"></button></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="menu__link menu__link--sublist" href=/cloud-native>云原生</a><button aria-label="Expand sidebar category '云原生'" aria-expanded=false type=button class="clean-btn menu__caret"></button></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="menu__link menu__link--sublist" href=/ai>AI技术</a><button aria-label="Expand sidebar category 'AI技术'" aria-expanded=false type=button class="clean-btn menu__caret"></button></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="menu__link menu__link--sublist" href=/observability>可观测性</a><button aria-label="Expand sidebar category '可观测性'" aria-expanded=false type=button class="clean-btn menu__caret"></button></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="menu__link menu__link--sublist" href=/database-and-middleware>数据库与中间件</a><button aria-label="Expand sidebar category '数据库与中间件'" aria-expanded=false type=button class="clean-btn menu__caret"></button></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="menu__link menu__link--sublist" href=/operating-systems-and-networks>操作系统和网络</a><button aria-label="Expand sidebar category '操作系统和网络'" aria-expanded=false type=button class="clean-btn menu__caret"></button></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="menu__link menu__link--sublist" href=/notes>日常笔记</a><button aria-label="Expand sidebar category '日常笔记'" aria-expanded=false type=button class="clean-btn menu__caret"></button></div></ul></nav></div></div></aside><main class=docMainContainer_TBSr><div class="container padding-top--md padding-bottom--lg"><div class=row><div class="col docItemCol_VOVn"><div class=docItemContainer_Djhp><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label=Breadcrumbs><ul class=breadcrumbs itemscope itemtype=https://schema.org/BreadcrumbList><li class=breadcrumbs__item><a aria-label="Home page" class=breadcrumbs__link href=/><svg viewBox="0 0 24 24" class=breadcrumbHomeIcon_YNFT><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill=currentColor /></svg></a><li itemscope itemprop=itemListElement itemtype=https://schema.org/ListItem class=breadcrumbs__item><a class=breadcrumbs__link itemprop=item href=/architecture><span itemprop=name>技术架构</span></a><meta itemprop=position content=1><li itemscope itemprop=itemListElement itemtype=https://schema.org/ListItem class=breadcrumbs__item><a class=breadcrumbs__link itemprop=item href=/architecture/software-architecture><span itemprop=name>软件架构</span></a><meta itemprop=position content=2><li itemscope itemprop=itemListElement itemtype=https://schema.org/ListItem class="breadcrumbs__item breadcrumbs__item--active"><span class=breadcrumbs__link itemprop=name>DDD流程，以电商系统为场景</span><meta itemprop=position content=3></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type=button class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><h2 class="anchor anchorWithStickyNavbar_LWe7" id=领域驱动设计介绍>领域驱动设计介绍<a href=#领域驱动设计介绍 class=hash-link aria-label="Direct link to 领域驱动设计介绍" title="Direct link to 领域驱动设计介绍">​</a></h2>
<p>领域驱动设计（Domain-driven Design，DDD）是一种软件设计方法，该方法的核心思想是将业务领域作为设计和开发的中心，强调对业务领域的深入理解、业务语言的建模以及领域对象的设计和实现。</p>
<p>这样可以更好地将软件设计和业务需求紧密结合起来，从而提高软件的可维护性、可扩展性和可重用性，使得软件更加贴近业务需求。</p>
<p>DDD设计的两个阶段包括两部分，战略设计部分和战术设计部分：</p>
<p><strong>第1步： 战略设计</strong></p>
<p>战略设计主要从业务视角出发，包括了业务场景分析、领域建模、划分边界上下文三个阶段。限界上下文可以作为微服务设计的参考边界。</p>
<p><strong>第2步：战术设计</strong></p>
<p>战术设计则从技术视角出发，侧重于领域模型的技术实现，完成软件开发和落地，</p>
<p>战术设计包括：聚合根、实体、值对象、领域服务、应用服务和资源库等代码逻辑的技术设计和技术设计。</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id=第1步战略设计>第1步：战略设计<a href=#第1步战略设计 class=hash-link aria-label="Direct link to 第1步：战略设计" title="Direct link to 第1步：战略设计">​</a></h4>
<p>在战略设计阶段，我们最主要的过程大致包括了业务场景分析、领域建模、划分边界上下文三个阶段。</p>
<p>实际上战略设计是 DDD 过程中的核心步骤。</p>
<h6 class="anchor anchorWithStickyNavbar_LWe7" id=1业务分析>1、业务分析<a href=#1业务分析 class=hash-link aria-label="Direct link to 1、业务分析" title="Direct link to 1、业务分析">​</a></h6>
<p>在这个阶段我们所有做的就是进行全面的业务梳理，把业务中涉及到的所有细节都梳理出来，为后续进行领域建模分析提供足够的、全面的业务输入。</p>
<p>战略设计 经常使用到的业务场景分析方法主要包括</p>
<ul>
<li>用例分析法</li>
<li>事件风暴法</li>
<li>四色建模法。</li>
</ul>
<p>一般使用事件风暴法。</p>
<p><strong>事件风暴</strong>是一种快速，轻量级且未得到充分认可的<strong>群体建模技术</strong>，它对于加速开发团队而言非常强大，有趣且有用。</p>
<p><strong>事件风暴业务分析的核心环节</strong></p>
<p>这里我们使用事件风暴进行业务场景的分析以及梳理。</p>
<p><strong>（1）事前准备</strong></p>
<p>在进行事件风暴之前我们需要进行一些准备，主要包括贴纸、笔以及讨论的会议室，</p>
<p>会议室中最好不要有椅子，目的是想让大家都能够站立在一起、全神贯注的去进行业务讨论。</p>
<p><strong>（2）邀请参会的人</strong></p>
<p>会议的参与方主要包括用户、产品经理、PD、研发、测试、架构师等。</p>
<p>其中，PD为产品设计师，也可能叫产品规划师、需求分析师、小产品经理。</p>
<p>PD侧重于将对应用做功能级的设计，在这个模块上，PD类似是一个小产品经理、模块级别的产品经理。</p>
<p>架构师（系统分析师）会与PD紧密合作，架构师 这时候开始考虑技术可行性，性价比。</p>
<p>PD的职位描述：</p>
<p>（1）调查市场并研究需求，形成市场需求文档。</p>
<p>（2）负责新产品设计，拟定设计规划和方案。</p>
<p>（3）负责新产品的原型设计。</p>
<p>（4）组织产品开发团队，协调资源，跟进产品的开发，保证日程进度。</p>
<p>（5）分析产品运营数据，收集运营意见，及时调整产品形态，优化产品，并提出合理的运营建议。</p>
<p>（6） 以用户体验为中心，改进现有产品，或设计新产品。</p>
<p><strong>（3）业务讨论</strong></p>
<p>首先确定我们今天需要讨论的业务是什么，目标是什么。</p>
<p>咱们业务场景中，如果讨论的业务就是电商，那么，目标就是完成业务梳理，确保没有业务方面的理解 gap，在团队中达成业务理解的的一致性。</p>
<p>事件风暴过程需要问题驱动，一般通过提问的方式来驱动交流。</p>
<p><strong>a、分析业务中的事件，搞清楚事件发生的前因后果</strong></p>
<ul>
<li>什么动作会导致当前事件的发生，</li>
<li>当前这个事件发生后又会导致怎样的后果。</li>
</ul>
<p>这些我们都需要梳理清楚。</p>
<p>还有一点需要注意， 需要全面梳理</p>
<ul>
<li>不但要关注正常的业务流程，</li>
<li>还要关注异常的业务流程。</li>
</ul>
<p><strong>b、寻找业务逻辑和业务规则</strong></p>
<p><strong>注</strong>：在进行事件风暴过程中，所有的参与人都要全身投入整个过程，</p>
<p>大家都是站立形式，聚焦全部注意力，</p>
<p>大家都放下手机以及电脑，一起参与整个业务梳理过程，只有这样，事件风暴才可能有比较好的效果。</p>
<p>在前面的事件风暴业务梳理中，我们已经把电商业务涉及到的参与者、动作以及事件等都进行了全面的梳理。</p>
<p>参与者、动作以及事件 整个协作流程，是一个粗粒度的 业务流程， 非常粗。</p>
<h6 class="anchor anchorWithStickyNavbar_LWe7" id=2领域建模>2、领域建模<a href=#2领域建模 class=hash-link aria-label="Direct link to 2、领域建模" title="Direct link to 2、领域建模">​</a></h6>
<p>那么接下来我们就要在此基础之上，进行细粒度的 领域建模，这是整个 DDD 的核心。</p>
<p>DDD领域模型 细分为两步骤，第一步是发散，产生很多<strong>实体、命令、事件</strong>等领域对象，</p>
<p>DDD领域模型 细分为两步骤，第二步是收敛，我们从不同的维度对进行聚类形成聚合，建立最终领域模型， 这是一个收敛的过程。</p>
<p><strong>（1）发散阶段：领域对象分析</strong></p>
<p>领域对象分析，也就 <strong>实体、值对象、领域事件、领域命令</strong>的分析。</p>
<p><strong>（2）收敛阶段：构建业务聚合</strong></p>
<p>完成领域对象分析之后，我们需要构建业务聚合。</p>
<p>想要构建聚合，那么首先就要在实体中找到聚合根。</p>
<p>来看看，一个 聚合根的特点：</p>
<ul>
<li>聚合根一定是实体，那么它具有全局唯一的标识，</li>
<li>聚合根是具备生命周期的</li>
<li>聚合根需要专门的模块来进行管理。</li>
</ul>
<h6 class="anchor anchorWithStickyNavbar_LWe7" id=3划分边界上下文>3、划分边界上下文<a href=#3划分边界上下文 class=hash-link aria-label="Direct link to 3、划分边界上下文" title="Direct link to 3、划分边界上下文">​</a></h6>
<p>获得了整个业务流程中的所有聚合后，我们需要更具业务语义上下文将具体的聚合划分到对应的上下文中，</p>
<ul>
<li><strong>域的拆分</strong>
<ul>
<li>按业务抽象进行划分</li>
<li>一个业务拆分成几个独立的域，每个域又可细拆成不同子域</li>
</ul>
</li>
<li><strong>防腐</strong>
<ul>
<li>一个域在访问其他域的模型时，把获取到的模型做层转换映射到自己域的模型中（不直接使用别的域模型作为自己域模型中的一部分）</li>
<li>防止源域模型发生变更，依赖源域模型的调用方，在需要源域模型新功能时，必须要全局依赖修改，才在能兼容</li>
<li>防止域上下文不一致产生的冲突</li>
</ul>
</li>
<li><strong>限界上下文之间的映射关系</strong>
<ul>
<li>合作关系（Partnership）：两个上下文紧密合作的关系，一荣俱荣，一损俱损。</li>
<li>共享内核（Shared Kernel）：两个上下文依赖部分共享的模型。</li>
<li>客户方-供应方开发（Customer-Supplier Development）：上下文之间有组织的上下游依赖。</li>
<li>遵奉者（Conformist）：下游上下文只能盲目依赖上游上下文。</li>
<li>防腐层（Anticorruption Layer）：一个上下文通过一些适配和转换与另一个上下文交互。</li>
<li>开放主机服务（Open Host Service）：定义一种协议来让其他上下文来对本上下文进行访问。</li>
<li>发布语言（Published Language）：通常与OHS一起使用，用于定义开放主机的协议。</li>
<li>大泥球（Big Ball of Mud）：混杂在一起的上下文关系，边界不清晰。</li>
<li>另谋他路（SeparateWay）：两个完全没有任何联系的上下文。</li>
</ul>
</li>
</ul>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id=第2步战术设计>第2步：战术设计<a href=#第2步战术设计 class=hash-link aria-label="Direct link to 第2步：战术设计" title="Direct link to 第2步：战术设计">​</a></h4>
<p>在战略设计阶段，我们通过事件风暴法对整体的业务进行了全部的梳理，同时构建了领域模型，以及划分了边界下文。</p>
<p>那么接下来我们就要将领域模型映射到工程结构，以及代码中实现最终的实现落地。</p>
<p>另外在这个阶段实际还有很多细节需要明确的。</p>
<h6 class="anchor anchorWithStickyNavbar_LWe7" id=1领域服务设计>1、领域服务设计<a href=#1领域服务设计 class=hash-link aria-label="Direct link to 1、领域服务设计" title="Direct link to 1、领域服务设计">​</a></h6>
<p>需要哪些领域服务，领域服务依赖哪些属性，依赖哪些实体，依赖哪些值对象，这些都是需要在战术设计阶段明确下来。</p>
<h6 class="anchor anchorWithStickyNavbar_LWe7" id=2领域分层>2、领域分层<a href=#2领域分层 class=hash-link aria-label="Direct link to 2、领域分层" title="Direct link to 2、领域分层">​</a></h6>
<p>在领域分层方面，可以按照cola分层结构来进行，这个后面结合cola框架进行说明。</p>
<h6 class="anchor anchorWithStickyNavbar_LWe7" id=3代码结构>3、代码结构<a href=#3代码结构 class=hash-link aria-label="Direct link to 3、代码结构" title="Direct link to 3、代码结构">​</a></h6>
<p>当我们把领域对象进行进一步的细化之后，同时把对应的领域服务敲定之后，我们可以把这些分析后的内容映射成工程分层后的代码了。</p>
<p>所以，后续就进入到阶段了，还有很多工作要做，比如详细设计、编写代码以及功能测试，</p>
<p>特别实在详细设计阶段，我们还要涉及很多的细节问题的敲定，比如数据库表的设计、比如使用什么 MQ，用不用缓存，怎么保证缓存和数据库的数据一致性问题，分布式服务有没有分布式事务的问题，应该怎么解决？</p>
<p>有没有服务幂等问题，应该怎么解决？</p>
<p>这些都是需要在详细设计阶段进行确定的。</p>
<p>因此 DDD 就像是框架，通过它把业务映射成为领域对象以及领域服务和领域事件，再把这些领域相关内容再读映射为实际的代码。</p>
<p>使得我们的服务更加的逻辑清晰以及扩展性更强，但是分布式的技术实现细节，我们还是需要有对应的解决方案来进行解决。</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id=电商的领域驱动设计>电商的领域驱动设计<a href=#电商的领域驱动设计 class=hash-link aria-label="Direct link to 电商的领域驱动设计" title="Direct link to 电商的领域驱动设计">​</a></h2>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id=第1步战略设计-1>第1步：战略设计<a href=#第1步战略设计-1 class=hash-link aria-label="Direct link to 第1步：战略设计" title="Direct link to 第1步：战略设计">​</a></h4>
<h6 class="anchor anchorWithStickyNavbar_LWe7" id=1事件风暴参与者动作以及事件-整个协作流程梳理>1、事件风暴：参与者、动作以及事件 整个协作流程梳理<a href=#1事件风暴参与者动作以及事件-整个协作流程梳理 class=hash-link aria-label="Direct link to 1、事件风暴：参与者、动作以及事件 整个协作流程梳理" title="Direct link to 1、事件风暴：参与者、动作以及事件 整个协作流程梳理">​</a></h6>
<p>大致可以梳理出下面的参与者、动作以及事件</p>
<ol>
<li><strong>订单创建事件</strong>：当用户下单后，系统需要创建一个新的订单，并触发订单创建事件。</li>
<li><strong>订单支付事件</strong>：当用户完成订单支付后，系统需要将订单状态设置为已支付，并触发订单支付事件。</li>
<li><strong>订单发货事件</strong>：当商家完成订单发货后，系统需要将订单状态设置为已发货，并触发订单发货事件。</li>
<li><strong>订单退款事件</strong>：当用户申请退款并经过审核后，系统需要将订单状态设置为已退款，并触发订单退款事件。</li>
<li><strong>商品上架事件</strong>：当商家将商品上架时，系统需要将商品状态设置为上架，并触发商品上架事件。</li>
<li><strong>商品下架事件</strong>：当商家将商品下架时，系统需要将商品状态设置为下架，并触发商品下架事件。</li>
<li><strong>库存变更事件</strong>：当用户下单后，系统需要检查商品库存是否充足，并对库存进行相应的变更，并触发库存变更事件。</li>
<li><strong>物流状态变更事件</strong>：当订单状态变更为已发货时，系统需要记录物流信息，并触发物流状态变更事件。</li>
</ol>
<p>通过对领域事件的记录和处理，可以在电商系统中实现更加复杂的业务逻辑，提高系统的灵活性和可维护性。</p>
<h6 class="anchor anchorWithStickyNavbar_LWe7" id=2领域建模与边界上下文划分>2、领域建模与边界上下文划分<a href=#2领域建模与边界上下文划分 class=hash-link aria-label="Direct link to 2、领域建模与边界上下文划分" title="Direct link to 2、领域建模与边界上下文划分">​</a></h6>
<p>电商系统中的聚合和聚合根是什么？</p>
<p>在电商系统中，可以将订单作为一个聚合，其中包括多个领域对象，例如订单项、收货地址、发票信息等。</p>
<p>订单作为一个聚合，它的内部领域对象之间有明确的关联关系，并且需要满足一些业务规则，例如订单项的数量不能为负数，订单状态必须是待付款、待发货、待收货、已完成等状态之一。</p>
<p>在订单聚合中，可以将订单对象作为聚合根，用于保证订单聚合的完整性和一致性。订单对象具有唯一标识和全局访问权限，它可以被其他领域对象引用，例如订单项和收货地址等。</p>
<p>使用聚合和聚合根可以将复杂的业务逻辑封装在一个边界内，提高系统的可维护性和可扩展性。</p>
<p>电商系统是一个涉及到多个业务领域的复杂应用系统，经过上下文建模和边界上下文划分，最后确定电商系统所包含了众多的子域。</p>
<p>以下是电商系统中常见的一些子域：</p>
<ol>
<li><strong>商品子域</strong>：包括商品分类、商品管理、商品展示等功能。</li>
<li><strong>订单子域</strong>：包括下单、订单管理、订单配送、订单支付等功能。</li>
<li><strong>营销子域</strong>：包括促销活动、优惠券、积分、礼品卡等功能。</li>
<li><strong>用户子域</strong>：包括用户注册、用户登录、用户个人信息管理等功能。</li>
<li><strong>支付子域</strong>：包括支付方式、支付渠道、支付接口等功能。</li>
<li><strong>物流子域</strong>：包括订单配送、物流跟踪、运费计算等功能。</li>
<li><strong>客服子域</strong>：包括售后服务、用户反馈、在线客服等功能。</li>
<li><strong>数据统计子域</strong>：包括用户行为分析、交易数据统计、业务数据报表等功能。</li>
</ol>
<p>在实际的电商应用系统中，可能会根据业务需求进一步细分和扩展各个子域。每个子域都可以作为一个独立的微服务进行设计和开发，从而实现更好的业务解耦和系统扩展性。</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id=第2步战术阶段>第2步：战术阶段<a href=#第2步战术阶段 class=hash-link aria-label="Direct link to 第2步：战术阶段" title="Direct link to 第2步：战术阶段">​</a></h4>
<p>核心是领域服务设计</p>
<p>电商系统中包括的领域服务，主要如下：</p>
<ol>
<li><strong>商品服务</strong>：负责管理商品的上架、下架、库存等信息，并提供商品的查询、搜索、推荐等功能。</li>
<li><strong>订单服务</strong>：负责管理订单的创建、支付、发货、退款等流程，并提供订单的查询、取消、评价等功能。</li>
<li><strong>用户服务</strong>：负责管理用户的注册、登录、个人信息管理等功能，并提供用户评价、收藏、关注等功能。</li>
<li><strong>支付服务</strong>：负责管理系统的支付方式、支付账户等信息，并提供支付的流程和接口。</li>
<li><strong>物流服务</strong>：负责管理物流的配送、快递信息等，并提供物流的查询、跟踪等功能。</li>
<li><strong>营销服务</strong>：负责管理系统的促销活动、优惠券等信息，并提供优惠券领取、使用等功能。</li>
<li><strong>数据统计服务</strong>：负责收集、分析、展示系统的数据统计信息，例如订单量、销售额、用户活跃度等。</li>
<li><strong>客服服务</strong>：负责管理系统的客户服务、投诉处理等工作，并提供在线客服、电话客服等渠道。</li>
</ol>
<p>这些领域服务之间相互协作，共同实现电商系统的核心功能和业务流程。</p>
<p>通过领域服务的划分和封装，可以提高系统的可扩展性和可维护性，降低系统的耦合度和复杂度。</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id=领域驱动设计与微服务的关系>领域驱动设计与微服务的关系<a href=#领域驱动设计与微服务的关系 class=hash-link aria-label="Direct link to 领域驱动设计与微服务的关系" title="Direct link to 领域驱动设计与微服务的关系">​</a></h2>
<p>领域驱动设计（DDD）和微服务是两种不同的概念，但它们可以结合在一起来提高软件的质量和可维护性。</p>
<p>微服务架构是一种将应用程序拆分成多个小型、自治的服务的架构模式，每个服务专注于某个特定的业务功能，通过轻量级通信机制进行协作。</p>
<p>微服务架构通常需要处理大量的业务逻辑，因此需要一个清晰的领域模型来管理这些业务逻辑，这时领域驱动设计就能够发挥作用了。</p>
<p>通过领域驱动设计，开发人员可以更好地理解业务需求，更好地建模业务领域，将领域模型作为微服务架构的核心，从而更好地支持微服务架构。</p>
<p>具体来说，领域驱动设计可以帮助实现以下方面：</p>
<ol>
<li>
<p><strong>微服务的拆分和划分</strong>：通过领域驱动设计，可以将业务领域划分为不同的子域，并将每个子域划分为一个或多个微服务，从而实现微服务的拆分和划分。</p>
</li>
<li>
<p><strong>服务间的通信</strong>：微服务架构中的服务需要通过通信机制进行协作。</p>
<p>通过领域驱动设计，可以在微服务之间定义明确的接口和协议，使得服务之间的通信更加清晰和稳定。</p>
</li>
<li>
<p><strong>微服务的扩展和维护</strong>：通过领域驱动设计，可以将业务逻辑清晰地划分为不同的领域模型，从而使得微服务的扩展和维护更加容易。例如，在需要修改业务逻辑时，只需要修改对应的领域模型和微服务，而不需要修改整个应用程序。</p>
</li>
</ol>
<p>因此，领域驱动设计可以帮助开发人员更好地支持微服务架构，并实现更好的软件设计和开发。</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id=领域驱动设计与敏捷开发相结合>领域驱动设计与敏捷开发相结合<a href=#领域驱动设计与敏捷开发相结合 class=hash-link aria-label="Direct link to 领域驱动设计与敏捷开发相结合" title="Direct link to 领域驱动设计与敏捷开发相结合">​</a></h2>
<p>领域驱动设计和敏捷开发是两种不同的方法论，但可以相互结合，提高开发效率和软件质量。</p>
<p>在敏捷开发过程中，团队通常采用迭代式的开发模式，不断地根据用户反馈和需求变化进行调整和优化。</p>
<p>这种敏捷开发模式与领域驱动设计的思想相契合，因为领域驱动设计强调将业务领域建模为一个相对独立的系统，同时也强调不断优化和迭代。</p>
<p>以下是一些结合领域驱动设计和敏捷开发的方法：</p>
<ol>
<li><strong>划分迭代周期</strong>：在敏捷开发中，团队通常会划分出多个迭代周期来实现软件的开发和交付。在每个迭代周期中，可以采用领域驱动设计方法进行领域建模和设计，以确保软件系统的质量和可维护性。</li>
<li><strong>与领域专家和用户紧密合作</strong>：在敏捷开发中，团队需要与领域专家和用户紧密合作，及时获取用户反馈和需求变化。在领域驱动设计中，也需要与领域专家和用户紧密合作，以确保领域建模的准确性和实用性。</li>
<li><strong>重构和优化</strong>：敏捷开发中，团队需要不断地重构和优化代码，以提高软件系统的质量和可维护性。在领域驱动设计中，也需要不断地优化领域建模和设计，以提高系统的可扩展性和可维护性。</li>
<li><strong>测试和验收</strong>：在敏捷开发中，团队需要进行测试和验收，以确保软件系统的质量和稳定性。在领域驱动设计中，也需要进行测试和验收，以确保领域建模和设计的准确性和实用性。</li>
</ol>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id=参考链接>参考链接<a href=#参考链接 class=hash-link aria-label="Direct link to 参考链接" title="Direct link to 参考链接">​</a></h2>
<ul>
<li>
<p><a href=https://blog.csdn.net/crazymakercircle/article/details/134365111 target=_blank rel="noopener noreferrer">https://blog.csdn.net/crazymakercircle/article/details/134365111</a></p>
</li>
<li>
<p><a href=https://github.com/ihezebin/go-template-ddd target=_blank rel="noopener noreferrer">https://github.com/ihezebin/go-template-ddd</a></p>
</li>
</ul></div></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href=/architecture/architectural-thinking><div class=pagination-nav__sublabel>Previous</div><div class=pagination-nav__label>架构思维：抽象、分层、分治、演化</div></a><a class="pagination-nav__link pagination-nav__link--next" href=/architecture/microservice-architecture><div class=pagination-nav__sublabel>Next</div><div class=pagination-nav__label>微服务架构</div></a></nav><div class=docusaurus-mt-lg></div></div></div><div class="col col--3"><div class=tocContainer_PXzm><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href=#领域驱动设计介绍 class="table-of-contents__link toc-highlight">领域驱动设计介绍</a><li><a href=#电商的领域驱动设计 class="table-of-contents__link toc-highlight">电商的领域驱动设计</a><li><a href=#领域驱动设计与微服务的关系 class="table-of-contents__link toc-highlight">领域驱动设计与微服务的关系</a><li><a href=#领域驱动设计与敏捷开发相结合 class="table-of-contents__link toc-highlight">领域驱动设计与敏捷开发相结合</a><li><a href=#参考链接 class="table-of-contents__link toc-highlight">参考链接</a></ul></div><div class=tocAdBanner_imxD></div></div></div></div></div></main></div></div></div><footer class=footer><div class="container container-fluid"><div class="footer__bottom text--center"><div class=footer__copyright>Copyright 2025 johng.cn</div></div></div></footer></div>