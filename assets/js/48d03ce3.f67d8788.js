"use strict";(self.webpackChunkgf_site=self.webpackChunkgf_site||[]).push([["1089"],{61538:function(e,s,r){r.r(s),r.d(s,{metadata:()=>d,contentTitle:()=>o,default:()=>l,assets:()=>x,toc:()=>j,frontMatter:()=>t});var d=JSON.parse('{"id":"docs/\u53EF\u89C2\u6D4B\u6027/\u76D1\u63A7\u6280\u672F/prometheus: \u5E38\u7528\u544A\u8B66PromeQL","title":"prometheus: \u5E38\u7528\u544A\u8B66PromeQL","description":"\u603B\u7ED3 Prometheus \u5E38\u7528\u7684\u544A\u8B66\u89C4\u5219\u548C PromQL \u67E5\u8BE2\u8BED\u53E5\uFF0C\u5E2E\u52A9\u8FD0\u7EF4\u4EBA\u5458\u5FEB\u901F\u914D\u7F6E\u548C\u7BA1\u7406\u76D1\u63A7\u544A\u8B66","source":"@site/docs/docs/5000-\u53EF\u89C2\u6D4B\u6027/1-\u76D1\u63A7\u6280\u672F/3000-prometheus: \u5E38\u7528\u544A\u8B66PromeQL.md","sourceDirName":"docs/5000-\u53EF\u89C2\u6D4B\u6027/1-\u76D1\u63A7\u6280\u672F","slug":"/observability/prometheus-alert-rules","permalink":"/observability/prometheus-alert-rules","draft":false,"unlisted":false,"tags":[],"version":"current","sidebarPosition":3000,"frontMatter":{"slug":"/observability/prometheus-alert-rules","title":"prometheus: \u5E38\u7528\u544A\u8B66PromeQL","hide_title":true,"keywords":["Prometheus","AlertManager","PromQL","\u76D1\u63A7\u544A\u8B66","\u544A\u8B66\u89C4\u5219","\u76D1\u63A7\u8FD0\u7EF4"],"description":"\u603B\u7ED3 Prometheus \u5E38\u7528\u7684\u544A\u8B66\u89C4\u5219\u548C PromQL \u67E5\u8BE2\u8BED\u53E5\uFF0C\u5E2E\u52A9\u8FD0\u7EF4\u4EBA\u5458\u5FEB\u901F\u914D\u7F6E\u548C\u7BA1\u7406\u76D1\u63A7\u544A\u8B66"},"sidebar":"mainSidebar","previous":{"title":"promtheus: rate\u4E0Eirate","permalink":"/observability/prometheus-rate-irate"},"next":{"title":"Linux\u4E2D\u8FDB\u7A0B\u5185\u5B58\u53CAcgroup\u5185\u5B58\u7EDF\u8BA1\u5DEE\u5F02","permalink":"/observability/linux-memory-cgroup-statistics"}}'),n=r("85893"),c=r("50065");let t={slug:"/observability/prometheus-alert-rules",title:"prometheus: \u5E38\u7528\u544A\u8B66PromeQL",hide_title:!0,keywords:["Prometheus","AlertManager","PromQL","\u76D1\u63A7\u544A\u8B66","\u544A\u8B66\u89C4\u5219","\u76D1\u63A7\u8FD0\u7EF4"],description:"\u603B\u7ED3 Prometheus \u5E38\u7528\u7684\u544A\u8B66\u89C4\u5219\u548C PromQL \u67E5\u8BE2\u8BED\u53E5\uFF0C\u5E2E\u52A9\u8FD0\u7EF4\u4EBA\u5458\u5FEB\u901F\u914D\u7F6E\u548C\u7BA1\u7406\u76D1\u63A7\u544A\u8B66"},o=void 0,x={},j=[{value:"\u544A\u8B66\u68B3\u7406",id:"\u544A\u8B66\u68B3\u7406",level:2},{value:"\u96C6\u7FA4\u7EAC\u5EA6",id:"\u96C6\u7FA4\u7EAC\u5EA6",level:2},{value:"\u8282\u70B9\u7EAC\u5EA6",id:"\u8282\u70B9\u7EAC\u5EA6",level:2},{value:"\u5BB9\u5668\u7EAC\u5EA6",id:"\u5BB9\u5668\u7EAC\u5EA6",level:2},{value:"Pod\u7EAC\u5EA6",id:"pod\u7EAC\u5EA6",level:2},{value:"\u670D\u52A1\u7EAC\u5EA6",id:"\u670D\u52A1\u7EAC\u5EA6",level:2},{value:"\u4E91\u5DE2\u7EC4\u4EF6",id:"\u4E91\u5DE2\u7EC4\u4EF6",level:3},{value:"vmagent",id:"vmagent",level:4},{value:"Kubernetes\u7EC4\u4EF6",id:"kubernetes\u7EC4\u4EF6",level:3},{value:"etcd",id:"etcd",level:4},{value:"apiserver",id:"apiserver",level:4},{value:"\u53C2\u8003\u8D44\u6599",id:"\u53C2\u8003\u8D44\u6599",level:2}];function i(e){let s={a:"a",code:"code",em:"em",h2:"h2",h3:"h3",h4:"h4",li:"li",p:"p",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,c.a)(),...e.components};return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(s.h2,{id:"\u544A\u8B66\u68B3\u7406",children:"\u544A\u8B66\u68B3\u7406"}),"\n",(0,n.jsx)(s.p,{children:"\u68B3\u7406\u9700\u8981\u7528\u4E8E\u76D1\u63A7\u7684\u6307\u6807\u4EE5\u53CA\u89C4\u5219\u3002\u544A\u8B66\u89C4\u5219\u524D\u7F6E\u8BBE\u5B9A\u5982\u4E0B\uFF1A"}),"\n",(0,n.jsxs)(s.ul,{children:["\n",(0,n.jsxs)(s.li,{children:["\n",(0,n.jsxs)(s.p,{children:[(0,n.jsx)(s.strong,{children:"\u6267\u884C\u95F4\u9694"}),"\uFF1A\u4EE5 ",(0,n.jsx)(s.code,{children:"1"})," \u5206\u949F\u4F5C\u4E3A\u9ED8\u8BA4\u7684\u544A\u8B66\u89C4\u5219\u6267\u884C\u95F4\u9694\u3002"]}),"\n"]}),"\n",(0,n.jsxs)(s.li,{children:["\n",(0,n.jsxs)(s.p,{children:[(0,n.jsx)(s.strong,{children:"\u89E6\u53D1\u9608\u503C"}),"\uFF1A\u4EE5\u8FDE\u7EED",(0,n.jsx)(s.code,{children:"3"}),"\u6B21\u8FBE\u5230\u89E6\u53D1\u9608\u503C\u4E3A\u524D\u63D0\u624D\u89E6\u53D1\u4E00\u6B21\u544A\u8B66\u3002",(0,n.jsx)(s.strong,{children:"\u9608\u503C\u89E6\u53D1\u5728\u672A\u7279\u6B8A\u63D0\u9192\u7684\u524D\u63D0\u4E0B\uFF0C\u7EDF\u4E00\u4F7F\u7528"})," ",(0,n.jsx)(s.code,{children:">="})," ",(0,n.jsx)(s.strong,{children:"\u7684\u8BA1\u7B97\u65B9\u5F0F"}),"\u3002"]}),"\n"]}),"\n",(0,n.jsxs)(s.li,{children:["\n",(0,n.jsxs)(s.p,{children:[(0,n.jsx)(s.strong,{children:"\u544A\u8B66\u5206\u7EA7"}),"\uFF1A\u544A\u8B66\u5206",(0,n.jsx)(s.code,{children:"3"}),"\u4E2A\u4F18\u5148\u7EA7\uFF0C",(0,n.jsx)(s.strong,{children:"\u666E\u901A"}),"\u544A\u8B66(",(0,n.jsx)(s.code,{children:"info"}),")\u3001",(0,n.jsx)(s.strong,{children:"\u4E25\u91CD"}),"\u544A\u8B66(",(0,n.jsx)(s.code,{children:"warn"}),")\u3001",(0,n.jsx)(s.strong,{children:"\u81F4\u547D"}),"\u544A\u8B66(",(0,n.jsx)(s.code,{children:"crit"}),")\uFF0C\u5206\u522B\u5BF9\u5E94",(0,n.jsx)(s.code,{children:"3"}),"\u4E2A\u4E0D\u540C\u7684\u9608\u503C\u3002"]}),"\n"]}),"\n"]}),"\n",(0,n.jsx)(s.p,{children:"\u4EE5\u4E0B\u544A\u8B66\u9608\u503C\u521D\u59CB\u503C\u4E3A\u7ECF\u9A8C\u8BBE\u5B9A\uFF0C\u5728\u73B0\u7F51\u914D\u7F6E\u65F6\u4F1A\u9700\u8981\u6839\u636E\u5B9E\u9645\u60C5\u51B5\u8FDB\u884C\u9002\u5F53\u8C03\u6574\uFF0C\u5E76\u4E0D\u65AD\u5B8C\u5584\u8BE5\u6587\u6863\u3002"}),"\n",(0,n.jsx)(s.h2,{id:"\u96C6\u7FA4\u7EAC\u5EA6",children:"\u96C6\u7FA4\u7EAC\u5EA6"}),"\n",(0,n.jsxs)(s.table,{children:[(0,n.jsx)(s.thead,{children:(0,n.jsxs)(s.tr,{children:[(0,n.jsx)(s.th,{children:(0,n.jsx)(s.strong,{children:"\u544A\u8B66\u540D\u79F0"})}),(0,n.jsx)(s.th,{children:(0,n.jsx)(s.strong,{children:"\u544A\u8B66\u63CF\u8FF0"})}),(0,n.jsx)(s.th,{children:(0,n.jsx)(s.strong,{children:"\u8868\u8FBE\u5F0F"})}),(0,n.jsx)(s.th,{children:(0,n.jsx)(s.strong,{children:"\u9608\u503C\u8BBE\u7F6E"})})]})}),(0,n.jsxs)(s.tbody,{children:[(0,n.jsxs)(s.tr,{children:[(0,n.jsxs)(s.td,{children:[(0,n.jsx)(s.strong,{children:"\u96C6\u7FA4CPU\u4F7F\u7528\u7387"}),(0,n.jsx)("br",{}),(0,n.jsx)("br",{}),(0,n.jsx)(s.code,{children:"alert.cluster.cpu.usage_rate"}),(0,n.jsx)("br",{}),(0,n.jsx)("br",{}),"\u91CD\u8981\u7A0B\u5E8F\uFF1A\u4E00\u822C"]}),(0,n.jsxs)(s.td,{children:["\u96C6\u7FA4\u7684",(0,n.jsx)(s.code,{children:"CPU"}),"\u4F7F\u7528\u7387\u8FC7\u9AD8\u65F6\uFF0C\u610F\u5473\u7740\u9700\u8981\u6392\u67E5\u4E2A\u522B\u5BB9\u5668\u662F\u5426\u6709\u5F02\u5E38\uFF0C\u4EA6\u6216\u9700\u8981\u6269\u5C55\u8282\u70B9\u8D44\u6E90\u3002",(0,n.jsx)("br",{}),(0,n.jsx)("br",{}),"\u5355\u4F4D",(0,n.jsx)(s.code,{children:"%"}),"\u3002"]}),(0,n.jsx)(s.td,{children:(0,n.jsx)(s.code,{children:'sum(rate(container_cpu_usage_seconds_total{id="/"}[5m])) by (khaos_product,khaos_cluster) / sum (machine_cpu_cores{}) by (khaos_product,khaos_cluster) * 100'})}),(0,n.jsxs)(s.td,{children:[(0,n.jsx)(s.code,{children:"info: 80"}),(0,n.jsx)("br",{}),(0,n.jsx)("br",{}),(0,n.jsx)(s.code,{children:"warn: 90"}),(0,n.jsx)("br",{}),(0,n.jsx)("br",{}),(0,n.jsx)(s.code,{children:"crit: 95"})]})]}),(0,n.jsxs)(s.tr,{children:[(0,n.jsxs)(s.td,{children:[(0,n.jsx)(s.strong,{children:"\u96C6\u7FA4\u5185\u5B58\u4F7F\u7528\u7387"}),(0,n.jsx)("br",{}),(0,n.jsx)("br",{}),(0,n.jsx)(s.code,{children:"alert.cluster.memory.usage_rate"}),(0,n.jsx)("br",{}),(0,n.jsx)("br",{}),"\u91CD\u8981\u7A0B\u5E8F\uFF1A\u4E00\u822C"]}),(0,n.jsxs)(s.td,{children:["\u96C6\u7FA4\u7684\u5185\u5B58\u4F7F\u7528\u7387\u8FC7\u9AD8\u65F6\uFF0C\u610F\u5473\u7740\u9700\u8981\u6392\u67E5\u4E2A\u522B\u5BB9\u5668\u662F\u5426\u6709\u5F02\u5E38\uFF0C\u6291\u6216\u9700\u8981\u6269\u5C55\u8282\u70B9\u8D44\u6E90\u3002",(0,n.jsx)("br",{}),(0,n.jsx)("br",{}),"\u5355\u4F4D",(0,n.jsx)(s.code,{children:"%"}),"\u3002"]}),(0,n.jsx)(s.td,{children:(0,n.jsx)(s.code,{children:'sum (container_memory_working_set_bytes{id="/"}) by (khaos_product,khaos_cluster) / sum (machine_memory_bytes{}) by (khaos_product,khaos_cluster) * 100'})}),(0,n.jsxs)(s.td,{children:[(0,n.jsx)(s.code,{children:"info: 80"}),(0,n.jsx)("br",{}),(0,n.jsx)("br",{}),(0,n.jsx)(s.code,{children:"warn: 90"}),(0,n.jsx)("br",{}),(0,n.jsx)("br",{}),(0,n.jsx)(s.code,{children:"crit: 95"})]})]}),(0,n.jsxs)(s.tr,{children:[(0,n.jsxs)(s.td,{children:[(0,n.jsx)(s.strong,{children:"\u96C6\u7FA4Pods\u4F7F\u7528\u7387"}),(0,n.jsx)("br",{}),(0,n.jsx)("br",{}),(0,n.jsx)(s.code,{children:"alert.cluster.pods.usage_rate"}),(0,n.jsx)("br",{}),(0,n.jsx)("br",{}),"\u91CD\u8981\u7A0B\u5E8F\uFF1A\u53EF\u6709\u53EF\u65E0"]}),(0,n.jsxs)(s.td,{children:["\u6BCF\u4E2A",(0,n.jsx)(s.code,{children:"Node"}),"\u8282\u70B9\u80FD\u591F\u7EF4\u62A4\u7684",(0,n.jsx)(s.code,{children:"Pods"}),"\u6570\u91CF\u662F\u6709\u9650\u5236\u7684\uFF0C\u5F53\u6BCF\u4E2A",(0,n.jsx)(s.code,{children:"Node"}),"\u7684",(0,n.jsx)(s.code,{children:"Pods"}),"\u4F7F\u7528\u7387\u8FC7\u9AD8\u65F6\u4F1A\u5F15\u53D1\u96C6\u7FA4\u7684",(0,n.jsx)(s.code,{children:"Pods"}),"\u4F7F\u7528\u7387\u8FC7\u9AD8\uFF0C\u4F1A\u5F71\u54CD",(0,n.jsx)(s.code,{children:"Pod"}),"\u7684\u8C03\u5EA6\uFF0C\u751A\u81F3\u65E0\u6CD5\u521B\u5EFA",(0,n.jsx)(s.code,{children:"Pod"}),"\u3002",(0,n.jsx)("br",{}),(0,n.jsx)("br",{}),"\u5355\u4F4D",(0,n.jsx)(s.code,{children:"%"}),"\u3002",(0,n.jsx)("br",{}),(0,n.jsx)("br",{}),"\u8BE5\u89C4\u5219\u9ED8\u8BA4\u4E0D\u542F\u7528\u3002"]}),(0,n.jsx)(s.td,{children:(0,n.jsx)(s.code,{children:'sum(kube_pod_status_phase{phase="Running"})) by (khaos_product,khaos_cluster) / sum(kube_node_status_allocatable{resource="pods"}) by (khaos_product,khaos_cluster) * 100'})}),(0,n.jsxs)(s.td,{children:[(0,n.jsx)(s.code,{children:"info: 80"}),(0,n.jsx)("br",{}),(0,n.jsx)("br",{}),(0,n.jsx)(s.code,{children:"warn: 90"}),(0,n.jsx)("br",{}),(0,n.jsx)("br",{}),(0,n.jsx)(s.code,{children:"crit: 95"})]})]})]})]}),"\n",(0,n.jsx)(s.h2,{id:"\u8282\u70B9\u7EAC\u5EA6",children:"\u8282\u70B9\u7EAC\u5EA6"}),"\n",(0,n.jsxs)(s.table,{children:[(0,n.jsx)(s.thead,{children:(0,n.jsxs)(s.tr,{children:[(0,n.jsx)(s.th,{children:(0,n.jsx)(s.strong,{children:"\u544A\u8B66\u540D\u79F0"})}),(0,n.jsx)(s.th,{children:(0,n.jsx)(s.strong,{children:"\u544A\u8B66\u63CF\u8FF0"})}),(0,n.jsx)(s.th,{children:(0,n.jsx)(s.strong,{children:"\u8868\u8FBE\u5F0F"})}),(0,n.jsx)(s.th,{children:(0,n.jsx)(s.strong,{children:"\u9608\u503C\u8BBE\u7F6E"})})]})}),(0,n.jsxs)(s.tbody,{children:[(0,n.jsxs)(s.tr,{children:[(0,n.jsxs)(s.td,{children:[(0,n.jsx)(s.strong,{children:"\u8282\u70B9CPU\u4F7F\u7528\u7387"}),(0,n.jsx)("br",{}),(0,n.jsx)("br",{}),(0,n.jsx)(s.code,{children:"alert.node.cpu.usage_rate"}),(0,n.jsx)("br",{}),(0,n.jsx)("br",{}),"\u91CD\u8981\u7A0B\u5E8F\uFF1A\u91CD\u8981"]}),(0,n.jsxs)(s.td,{children:[(0,n.jsx)(s.code,{children:"CPU"}),"\u4F7F\u7528\u7387\u8FC7\u9AD8\u4F1A\u5BFC\u81F4\u8FDB\u7A0B\u54CD\u5E94\u6162\u3002",(0,n.jsx)("br",{}),(0,n.jsx)("br",{}),"\u5355\u4F4D",(0,n.jsx)(s.code,{children:"%"}),"\u3002"]}),(0,n.jsx)(s.td,{children:(0,n.jsx)(s.code,{children:'sum by(khaos_product,khaos_cluster,instance) (irate(node_cpu_seconds_total{mode!="idle"}[5m])) / on(khaos_product,khaos_cluster,instance) group_left sum by (khaos_product,khaos_cluster,instance)((irate(node_cpu_seconds_total{}[5m]))) * 100'})}),(0,n.jsxs)(s.td,{children:[(0,n.jsx)(s.code,{children:"info: 80"}),(0,n.jsx)("br",{}),(0,n.jsx)("br",{}),(0,n.jsx)(s.code,{children:"warn: 90"}),(0,n.jsx)("br",{}),(0,n.jsx)("br",{}),(0,n.jsx)(s.code,{children:"crit: 95"})]})]}),(0,n.jsxs)(s.tr,{children:[(0,n.jsxs)(s.td,{children:[(0,n.jsx)(s.strong,{children:"\u8282\u70B9\u5185\u5B58\u4F7F\u7528\u7387"}),(0,n.jsx)("br",{}),(0,n.jsx)("br",{}),(0,n.jsx)(s.code,{children:"alert.node.memory.usage_rate"}),(0,n.jsx)("br",{}),(0,n.jsx)("br",{}),"\u91CD\u8981\u7A0B\u5E8F\uFF1A\u91CD\u8981"]}),(0,n.jsxs)(s.td,{children:["\u4E3B\u673A\u5185\u5B58\u5229\u7528\u7387\u9AD8\u4F1A\u5BFC\u81F4\u8FDB\u7A0B\u54CD\u5E94\u6162\u3002",(0,n.jsx)("br",{}),(0,n.jsx)("br",{}),"\u5355\u4F4D",(0,n.jsx)(s.code,{children:"%"}),"\u3002"]}),(0,n.jsx)(s.td,{children:(0,n.jsx)(s.code,{children:"100 - ((avg_over_time(node_memory_MemAvailable_bytes{}[5m]) * 100) / avg_over_time(node_memory_MemTotal_bytes{}[5m]))"})}),(0,n.jsxs)(s.td,{children:[(0,n.jsx)(s.code,{children:"info: 80"}),(0,n.jsx)("br",{}),(0,n.jsx)("br",{}),(0,n.jsx)(s.code,{children:"warn: 90"}),(0,n.jsx)("br",{}),(0,n.jsx)("br",{}),(0,n.jsx)(s.code,{children:"crit: 95"})]})]}),(0,n.jsxs)(s.tr,{children:[(0,n.jsxs)(s.td,{children:[(0,n.jsx)(s.strong,{children:"\u8282\u70B9\u78C1\u76D8\u4F7F\u7528\u7387"}),(0,n.jsx)("br",{}),(0,n.jsx)("br",{}),(0,n.jsx)(s.code,{children:"alert.node.storage.usage_rate"}),(0,n.jsx)("br",{}),(0,n.jsx)("br",{}),"\u91CD\u8981\u7A0B\u5E8F\uFF1A\u53EF\u6709\u53EF\u65E0"]}),(0,n.jsxs)(s.td,{children:["\u7531\u4E8E\u8282\u70B9\u4E0A\u6302\u8F7D\u7684\u78C1\u76D8\u6BD4\u8F83\u591A\uFF0C\u6211\u4EEC\u5E76\u4E0D\u9700\u8981\u5173\u5FC3\u6240\u6709\u6302\u8F7D\u70B9\u7684\u78C1\u76D8\u4F7F\u7528\u7387\uFF0C\u56E0\u6B64\u8BE5\u89C4\u5219\u9ED8\u8BA4\u4E0D\u542F\u7528\u3002",(0,n.jsx)("br",{}),(0,n.jsx)("br",{}),"\u5355\u4F4D",(0,n.jsx)(s.code,{children:"%"}),"\u3002"]}),(0,n.jsx)(s.td,{children:(0,n.jsx)(s.code,{children:'100 - 100*(sum(node_filesystem_avail_bytes{device=~"/dev.*", mountpoint!~".*pods.*|.*pvc.*"}) by(khaos_product,khaos_cluster, instance, device) / sum(node_filesystem_size_bytes{device=~"/dev.*", mountpoint!~".*pods.*|.*pvc.*"}) by (khaos_product,khaos_cluster, instance, device))'})}),(0,n.jsxs)(s.td,{children:[(0,n.jsx)(s.code,{children:"info: 80"}),(0,n.jsx)("br",{}),(0,n.jsx)("br",{}),(0,n.jsx)(s.code,{children:"warn: 90"}),(0,n.jsx)("br",{}),(0,n.jsx)("br",{}),(0,n.jsx)(s.code,{children:"crit: 95"})]})]}),(0,n.jsxs)(s.tr,{children:[(0,n.jsxs)(s.td,{children:[(0,n.jsx)(s.strong,{children:"\u8282\u70B9\u7CFB\u7EDF\u78C1\u76D8\u4F7F\u7528\u7387"}),(0,n.jsx)("br",{}),(0,n.jsx)("br",{}),(0,n.jsx)(s.code,{children:"alert.node.storage.root.usage_rate"}),(0,n.jsx)("br",{}),(0,n.jsx)("br",{}),"\u91CD\u8981\u7A0B\u5E8F\uFF1A\u91CD\u8981"]}),(0,n.jsxs)(s.td,{children:[(0,n.jsx)(s.strong,{children:"\u7CFB\u7EDF\u76D8"}),"\u4F7F\u7528\u7387\u8FC7\u9AD8\u4F1A\u5F71\u54CD\u7CFB\u7EDF\u7A33\u5B9A\u6027\u3002",(0,n.jsx)("br",{}),(0,n.jsx)("br",{}),"\u5355\u4F4D",(0,n.jsx)(s.code,{children:"%"}),"\u3002"]}),(0,n.jsx)(s.td,{children:(0,n.jsx)(s.code,{children:'100 - 100*(sum(node_filesystem_avail_bytes{device=~"/dev.*", mountpoint="/"}) by(khaos_product,khaos_cluster, instance, device) / sum(node_filesystem_size_bytes{device=~"/dev.*", mountpoint="/"}) by (khaos_product,khaos_cluster, instance, device))'})}),(0,n.jsxs)(s.td,{children:[(0,n.jsx)(s.code,{children:"info: 80"}),(0,n.jsx)("br",{}),(0,n.jsx)("br",{}),(0,n.jsx)(s.code,{children:"warn: 90"}),(0,n.jsx)("br",{}),(0,n.jsx)("br",{}),(0,n.jsx)(s.code,{children:"crit: 95"})]})]}),(0,n.jsxs)(s.tr,{children:[(0,n.jsxs)(s.td,{children:[(0,n.jsx)(s.strong,{children:"\u78C1\u76D8"})," ",(0,n.jsx)(s.code,{children:"inode"})," ",(0,n.jsx)(s.strong,{children:"\u4F7F\u7528\u7387"}),(0,n.jsx)("br",{}),(0,n.jsx)("br",{}),(0,n.jsx)(s.code,{children:"alert.node.storage.inode.usage_rate"}),(0,n.jsx)("br",{}),(0,n.jsx)("br",{}),"\u91CD\u8981\u7A0B\u5E8F\uFF1A\u91CD\u8981"]}),(0,n.jsxs)(s.td,{children:["\u4F7F\u7528\u7387\u5982\u679C\u8FBE\u5230",(0,n.jsx)(s.code,{children:"100%"}),"\u4F1A\u5F71\u54CD\u78C1\u76D8\u6587\u4EF6\u7684\u521B\u5EFA\u3002",(0,n.jsx)("br",{}),(0,n.jsx)("br",{}),"\u5355\u4F4D",(0,n.jsx)(s.code,{children:"%"}),"\u3002"]}),(0,n.jsx)(s.td,{children:(0,n.jsx)(s.code,{children:'100 - node_filesystem_files_free{fstype=~"ext4|xfs"}/node_filesystem_files{fstype=~"ext4|xfs"} * 100'})}),(0,n.jsxs)(s.td,{children:[(0,n.jsx)(s.code,{children:"info: 80"}),(0,n.jsx)("br",{}),(0,n.jsx)("br",{}),(0,n.jsx)(s.code,{children:"warn: 90"}),(0,n.jsx)("br",{}),(0,n.jsx)("br",{}),(0,n.jsx)(s.code,{children:"crit: 95"})]})]}),(0,n.jsxs)(s.tr,{children:[(0,n.jsxs)(s.td,{children:[(0,n.jsx)(s.strong,{children:"\u78C1\u76D8\u8BFB\u5EF6\u8FDF\u8FC7\u9AD8"}),(0,n.jsx)("br",{}),(0,n.jsx)("br",{}),(0,n.jsx)(s.code,{children:"alert.node.storage.io_delay_ms.read"}),(0,n.jsx)("br",{}),(0,n.jsx)("br",{}),"\u91CD\u8981\u7A0B\u5E8F\uFF1A\u91CD\u8981"]}),(0,n.jsxs)(s.td,{children:["\u5F71\u54CD\u78C1\u76D8\u5185\u5BB9\u8BFB\u53D6\u3002",(0,n.jsx)("br",{}),(0,n.jsx)("br",{}),"\u5355\u4F4D",(0,n.jsx)(s.code,{children:"ms"}),"\u3002"]}),(0,n.jsx)(s.td,{children:(0,n.jsx)(s.code,{children:"rate(node_disk_read_time_seconds_total{}[5m]) / (rate(node_disk_reads_completed_total{}[5m])>0) * 1000"})}),(0,n.jsxs)(s.td,{children:[(0,n.jsx)(s.code,{children:"info: 1000"}),(0,n.jsx)("br",{}),(0,n.jsx)("br",{}),(0,n.jsx)(s.code,{children:"warn: 3000"}),(0,n.jsx)("br",{}),(0,n.jsx)("br",{}),(0,n.jsx)(s.code,{children:"crit: 5000"})]})]}),(0,n.jsxs)(s.tr,{children:[(0,n.jsxs)(s.td,{children:[(0,n.jsx)(s.strong,{children:"\u78C1\u76D8\u5199\u5EF6\u8FDF\u8FC7\u9AD8"}),(0,n.jsx)("br",{}),(0,n.jsx)("br",{}),(0,n.jsx)(s.code,{children:"alert.node.storage.io_delay_ms.write"}),(0,n.jsx)("br",{}),(0,n.jsx)("br",{}),"\u91CD\u8981\u7A0B\u5E8F\uFF1A\u91CD\u8981"]}),(0,n.jsxs)(s.td,{children:["\u5F71\u54CD\u78C1\u76D8\u5185\u5BB9\u5199\u5165\u3002",(0,n.jsx)("br",{}),(0,n.jsx)("br",{}),"\u5355\u4F4D",(0,n.jsx)(s.code,{children:"ms"}),"\u3002"]}),(0,n.jsx)(s.td,{children:(0,n.jsx)(s.code,{children:"rate(node_disk_write_time_seconds_total{}[5m]) / (rate(node_disk_writes_completed_total{}[5m])>0) * 1000"})}),(0,n.jsxs)(s.td,{children:[(0,n.jsx)(s.code,{children:"info: 1000"}),(0,n.jsx)("br",{}),(0,n.jsx)("br",{}),(0,n.jsx)(s.code,{children:"warn: 3000"}),(0,n.jsx)("br",{}),(0,n.jsx)("br",{}),(0,n.jsx)(s.code,{children:"crit: 5000"})]})]}),(0,n.jsxs)(s.tr,{children:[(0,n.jsxs)(s.td,{children:[(0,n.jsx)(s.strong,{children:"\u8282\u70B9TCP\u6BCF\u79D2\u51FA\u5305\u9519\u8BEF\u7387"}),(0,n.jsx)("br",{}),(0,n.jsx)("br",{}),(0,n.jsx)(s.code,{children:"alert.node.network.tcp.error_rate.out"}),(0,n.jsx)("br",{}),(0,n.jsx)("br",{}),"\u91CD\u8981\u7A0B\u5E8F\uFF1A\u91CD\u8981"]}),(0,n.jsxs)(s.td,{children:["\u7F51\u7EDC\u51FA\u5165\u5305\u9519\u8BEF\u7387\u8FC7\u9AD8\u4F1A\u4E25\u91CD\u5F71\u54CD\u6570\u636E\u9762\u53CA\u7BA1\u63A7\u9762\u7F51\u7EDC\u8BBF\u95EE\u3002",(0,n.jsx)("br",{}),(0,n.jsx)("br",{}),(0,n.jsx)(s.code,{children:"5m"}),"\u5185\u7684\u5E73\u5747\u7F51\u7EDC\u51FA\u5305\u9519\u8BEF\u7387\u3002",(0,n.jsx)("br",{}),(0,n.jsx)("br",{}),"\u5355\u4F4D",(0,n.jsx)(s.code,{children:"%"}),"\u3002"]}),(0,n.jsx)(s.td,{children:(0,n.jsx)(s.code,{children:'100*(sum(node_network_transmit_errs_total{device="eth0"}[5m]) by (khaos_product,khaos_cluster, device, instance)/sum(node_network_transmit_packets_total{device="eth0"}[5m]) by (khaos_product,khaos_cluster, device, instance))'})}),(0,n.jsxs)(s.td,{children:[(0,n.jsx)(s.code,{children:"info: 5"}),(0,n.jsx)("br",{}),(0,n.jsx)("br",{}),(0,n.jsx)(s.code,{children:"warn: 10"}),(0,n.jsx)("br",{}),(0,n.jsx)("br",{}),(0,n.jsx)(s.code,{children:"crit: 30"})]})]}),(0,n.jsxs)(s.tr,{children:[(0,n.jsxs)(s.td,{children:[(0,n.jsx)(s.strong,{children:"\u8282\u70B9TCP\u6BCF\u79D2\u5165\u5305\u9519\u8BEF\u7387"}),(0,n.jsx)("br",{}),(0,n.jsx)("br",{}),(0,n.jsx)(s.a,{href:"http://alert.node.network.tcp.error_rate.in",children:"alert.node.network.tcp.error_rate.in"}),(0,n.jsx)("br",{}),(0,n.jsx)("br",{}),"\u91CD\u8981\u7A0B\u5E8F\uFF1A\u91CD\u8981"]}),(0,n.jsxs)(s.td,{children:["\u7F51\u7EDC\u51FA\u5165\u5305\u9519\u8BEF\u7387\u8FC7\u9AD8\u4F1A\u4E25\u91CD\u5F71\u54CD\u6570\u636E\u9762\u53CA\u7BA1\u63A7\u9762\u7F51\u7EDC\u8BBF\u95EE\u3002",(0,n.jsx)("br",{}),(0,n.jsx)("br",{}),(0,n.jsx)(s.code,{children:"5m"}),"\u5185\u7684\u5E73\u5747\u7F51\u7EDC\u5165\u5305\u9519\u8BEF\u7387\u3002",(0,n.jsx)("br",{}),(0,n.jsx)("br",{}),"\u5355\u4F4D",(0,n.jsx)(s.code,{children:"%"}),"\u3002"]}),(0,n.jsx)(s.td,{children:(0,n.jsx)(s.code,{children:'100*(sum(node_network_receive_errs_total{device="eth0"}[5m]) by (khaos_product,khaos_cluster, device, instance)/sum(node_network_receive_packets_total{device="eth0"}[5m]) by (khaos_product,khaos_cluster, device, instance))'})}),(0,n.jsxs)(s.td,{children:[(0,n.jsx)(s.code,{children:"info: 5"}),(0,n.jsx)("br",{}),(0,n.jsx)("br",{}),(0,n.jsx)(s.code,{children:"warn: 10"}),(0,n.jsx)("br",{}),(0,n.jsx)("br",{}),(0,n.jsx)(s.code,{children:"crit: 30"})]})]}),(0,n.jsxs)(s.tr,{children:[(0,n.jsxs)(s.td,{children:[(0,n.jsx)(s.strong,{children:"\u8282\u70B9\u7F51\u7EDC\u6D41\u91CF\u8FC7\u5927"}),(0,n.jsx)("br",{}),(0,n.jsx)("br",{}),(0,n.jsx)(s.code,{children:"alert.node.network.flow"}),(0,n.jsx)("br",{}),(0,n.jsx)("br",{}),"\u91CD\u8981\u7A0B\u5E8F\uFF1A\u91CD\u8981"]}),(0,n.jsxs)(s.td,{children:["\u6D41\u91CF\u8FC7\u5927\u53EF\u80FD\u4F1A\u5F71\u54CD\u8282\u70B9\u4E0A\u6240\u6709\u8FDB\u7A0B\u7684\u7F51\u7EDC\u901A\u4FE1\u3002\u539F\u7406\u662F",(0,n.jsx)(s.code,{children:"1"}),"\u5206\u949F\u5185",(0,n.jsx)(s.strong,{children:"\u5BF9\u5916\u7F51\u5361"}),"\u7684",(0,n.jsx)(s.strong,{children:"\u5E73\u5747\u6D41\u91CF"}),"\uFF0C\u5305\u542B",(0,n.jsx)(s.strong,{children:"\u51FA+\u5165"}),"\u7684\u6D41\u91CF\u3002\u6D41\u91CF\u9608\u503C\u6839\u636E\u96C6\u7FA4\u786C\u4EF6\u6761\u4EF6\u7075\u6D3B\u914D\u7F6E\u3002",(0,n.jsx)("br",{}),(0,n.jsx)("br",{}),"\u5355\u4F4D",(0,n.jsx)(s.code,{children:"mb/s"}),"\u3002"]}),(0,n.jsx)(s.td,{children:(0,n.jsx)(s.code,{children:'(rate(node_network_receive_bytes_total{device=~"eth.+"}[1m])+rate(node_network_transmit_bytes_total{device=~"eth.+"}[1m]))/1024/1024'})}),(0,n.jsxs)(s.td,{children:[(0,n.jsx)(s.code,{children:"info: 5000"}),(0,n.jsx)("br",{}),(0,n.jsx)("br",{}),(0,n.jsx)(s.code,{children:"warn: 8000"}),(0,n.jsx)("br",{}),(0,n.jsx)("br",{}),(0,n.jsx)(s.code,{children:"crit: 9000"})]})]}),(0,n.jsxs)(s.tr,{children:[(0,n.jsxs)(s.td,{children:[(0,n.jsx)(s.strong,{children:"\u8282\u70B9\u7F51\u7EDC\u5E26\u5BBD\u4F7F\u7528\u7387"}),(0,n.jsx)("br",{}),(0,n.jsx)("br",{}),(0,n.jsx)(s.code,{children:"alert.node.network.bandwidth_usage_rate"}),(0,n.jsx)("br",{}),(0,n.jsx)("br",{}),"\u91CD\u8981\u7A0B\u5E8F\uFF1A\u91CD\u8981"]}),(0,n.jsxs)(s.td,{children:["\u6D41\u91CF\u8FC7\u5927\u53EF\u80FD\u4F1A\u5F71\u54CD\u8282\u70B9\u4E0A\u6240\u6709\u8FDB\u7A0B\u7684\u7F51\u7EDC\u901A\u4FE1\u3002\u539F\u7406\u662F",(0,n.jsx)(s.code,{children:"1"}),"\u5206\u949F\u5185",(0,n.jsx)(s.strong,{children:"\u5BF9\u5916\u7F51\u5361"}),"\u7684\u5E73\u5747\u6D41\u91CF\u5360\u7528\u603B\u4F53\u7F51\u5361\u5E26\u5BBD\u7684\u767E\u5206\u6BD4\u3002",(0,n.jsx)("br",{}),(0,n.jsx)("br",{}),"\u5355\u4F4D",(0,n.jsx)(s.code,{children:"%"}),"\u3002",(0,n.jsx)("br",{}),(0,n.jsx)("br",{}),(0,n.jsx)(s.strong,{children:"\u6CE8\u610F\u4E8B\u9879\uFF1A"}),(0,n.jsx)("br",{}),(0,n.jsx)("br",{}),(0,n.jsx)(s.code,{children:"node_network_speed_bytes"})," ",(0,n.jsx)(s.strong,{children:"\u6307\u6807\u4EC5\u5728\u7269\u7406\u673A\u4E0B\u6709\u6548\uFF0C\u865A\u62DF\u673A\u4E0B\u7684\u8BE5\u6307\u6807\u53EF\u80FD\u4F1A\u8D1F\u503C\u6216\u8005\u65E0\u6548\u3002\u56E0\u6B64\u8BE5\u544A\u8B66\u4F5C\u4E3A\u6D41\u91CF\u544A\u8B66\u7684\u8F85\u52A9\u544A\u8B66\u89C4\u5219\u3002"})]}),(0,n.jsx)(s.td,{children:(0,n.jsx)(s.code,{children:'100*(rate(node_network_receive_bytes_total{device=~"eth.+"}[1m])+rate(node_network_transmit_bytes_total{device=~"eth.+"}[1m]))/(node_network_speed_bytes{device=~"eth.+"} > 0)'})}),(0,n.jsxs)(s.td,{children:[(0,n.jsx)(s.code,{children:"info: 80"}),(0,n.jsx)("br",{}),(0,n.jsx)("br",{}),(0,n.jsx)(s.code,{children:"warn: 90"}),(0,n.jsx)("br",{}),(0,n.jsx)("br",{}),(0,n.jsx)(s.code,{children:"crit: 95"})]})]}),(0,n.jsxs)(s.tr,{children:[(0,n.jsxs)(s.td,{children:[(0,n.jsx)(s.strong,{children:"\u8282\u70B9"})," ",(0,n.jsx)(s.code,{children:"NotReady"})," ",(0,n.jsx)(s.strong,{children:"\u6301\u7EED\u65F6\u95F4(5\u5206\u949F)"}),(0,n.jsx)("br",{}),(0,n.jsx)("br",{}),(0,n.jsx)(s.code,{children:"alert.node.status.not_ready5"}),(0,n.jsx)("br",{}),(0,n.jsx)("br",{}),"\u91CD\u8981\u7A0B\u5E8F\uFF1A\u91CD\u8981"]}),(0,n.jsxs)(s.td,{children:["\u4E3B\u673A\u4E0A\u7684",(0,n.jsx)(s.code,{children:"kubelet"}),"\u65E0\u6CD5\u4E0A\u62A5\u4E3B\u673A\u72B6\u6001\uFF0C\u53EF\u80FD\u4E3B\u673A\u5B95\u673A\u6216\u8005\u4E0D\u7A33\u5B9A\uFF0C\u53EF\u80FD\u4F1A\u5F15\u53D1\u540E\u7EED",(0,n.jsx)(s.code,{children:"Kubernetes"}),"\u96C6\u7FA4\u5185\u90E8\u9488\u5BF9\u8BE5\u8282\u70B9\u7684\u8C03\u5EA6\u3001\u7F51\u7EDC\u8BBF\u95EE\u7B49\u95EE\u9898\u3002",(0,n.jsx)("br",{}),(0,n.jsx)("br",{}),(0,n.jsx)(s.strong,{children:"\u6309\u7167\u6301\u7EED\u65F6\u95F4\u5212\u5206\u4E0D\u540C\u544A\u8B66\u7EA7\u522B\u3002"})]}),(0,n.jsx)(s.td,{children:(0,n.jsx)(s.code,{children:'kube_node_status_condition{condition="Ready",status="true"} == 0'})}),(0,n.jsx)(s.td,{children:(0,n.jsx)(s.code,{children:"info: 1"})})]}),(0,n.jsxs)(s.tr,{children:[(0,n.jsxs)(s.td,{children:[(0,n.jsx)(s.strong,{children:"\u8282\u70B9"})," ",(0,n.jsx)(s.code,{children:"NotReady"})," ",(0,n.jsx)(s.strong,{children:"\u6301\u7EED\u65F6\u95F4(10\u5206\u949F)"}),(0,n.jsx)("br",{}),(0,n.jsx)("br",{}),(0,n.jsx)(s.code,{children:"alert.node.status.not_ready10"}),(0,n.jsx)("br",{}),(0,n.jsx)("br",{}),"\u91CD\u8981\u7A0B\u5E8F\uFF1A\u91CD\u8981"]}),(0,n.jsx)(s.td,{children:(0,n.jsx)(s.code,{children:"warn: 1"})}),(0,n.jsx)(s.td,{}),(0,n.jsx)(s.td,{})]}),(0,n.jsxs)(s.tr,{children:[(0,n.jsxs)(s.td,{children:[(0,n.jsx)(s.strong,{children:"\u8282\u70B9"})," ",(0,n.jsx)(s.code,{children:"NotReady"})," ",(0,n.jsx)(s.strong,{children:"\u6301\u7EED\u65F6\u95F4(15\u5206\u949F)"}),(0,n.jsx)("br",{}),(0,n.jsx)("br",{}),(0,n.jsx)(s.code,{children:"alert.node.status.not_ready15"}),(0,n.jsx)("br",{}),(0,n.jsx)("br",{}),"\u91CD\u8981\u7A0B\u5E8F\uFF1A\u91CD\u8981"]}),(0,n.jsx)(s.td,{children:(0,n.jsx)(s.code,{children:"crit: 1"})}),(0,n.jsx)(s.td,{}),(0,n.jsx)(s.td,{})]}),(0,n.jsxs)(s.tr,{children:[(0,n.jsxs)(s.td,{children:[(0,n.jsx)(s.strong,{children:"\u8282\u70B9Pods\u4F7F\u7528\u7387"}),(0,n.jsx)("br",{}),(0,n.jsx)("br",{}),(0,n.jsx)(s.code,{children:"alert.node.status.pods.usage_rate"}),(0,n.jsx)("br",{}),(0,n.jsx)("br",{}),"\u91CD\u8981\u7A0B\u5E8F\uFF1A\u53EF\u6709\u53EF\u65E0"]}),(0,n.jsxs)(s.td,{children:["\u6BCF\u4E2A",(0,n.jsx)(s.code,{children:"Node"}),"\u8282\u70B9\u80FD\u591F\u7EF4\u62A4\u7684",(0,n.jsx)(s.code,{children:"Pods"}),"\u6570\u91CF\u662F\u6709\u9650\u5236\u7684\uFF0C\u5F53\u4F7F\u7528\u7387\u8FC7\u9AD8\u65F6\uFF0C",(0,n.jsx)(s.code,{children:"Kuberntes"}),"\u8C03\u5EA6\u5668\u5C06\u6CD5\u8C03\u5EA6\u65B0\u7684",(0,n.jsx)(s.code,{children:"Pod"}),"\u5230\u8BE5\u8282\u70B9\uFF0C\u4ECE\u800C\u5F71\u54CD\u8282\u70B9\u4E0A\u7684",(0,n.jsx)(s.code,{children:"Pod"}),"\u88C5\u7BB1\u3002",(0,n.jsx)("br",{}),(0,n.jsx)("br",{}),"\u8BE5\u89C4\u5219\u9ED8\u8BA4\u4E0D\u542F\u7528\u3002",(0,n.jsx)("br",{}),(0,n.jsx)("br",{}),"\u5355\u4F4D",(0,n.jsx)(s.code,{children:"%"}),"\u3002"]}),(0,n.jsx)(s.td,{children:(0,n.jsx)(s.code,{children:'100*sum(kube_pod_info{}) by (khaos_product,khaos_cluster,node) / sum(kube_node_status_allocatable{resource="pods"}) by (khaos_product,khaos_cluster,node)'})}),(0,n.jsxs)(s.td,{children:[(0,n.jsx)(s.code,{children:"info: 80"}),(0,n.jsx)("br",{}),(0,n.jsx)("br",{}),(0,n.jsx)(s.code,{children:"warn: 90"}),(0,n.jsx)("br",{}),(0,n.jsx)("br",{}),(0,n.jsx)(s.code,{children:"crit: 95"})]})]}),(0,n.jsxs)(s.tr,{children:[(0,n.jsxs)(s.td,{children:[(0,n.jsx)(s.strong,{children:"\u8282\u70B9\u5F02\u5E38\u5173\u673A\u6216\u91CD\u542F"}),(0,n.jsx)("br",{}),(0,n.jsx)("br",{}),(0,n.jsx)(s.code,{children:"alert.node.status.shut_reboot"}),(0,n.jsx)("br",{}),(0,n.jsx)("br",{}),"\u91CD\u8981\u7A0B\u5E8F\uFF1A\u91CD\u8981"]}),(0,n.jsxs)(s.td,{children:["\u8282\u70B9",(0,n.jsx)(s.strong,{children:"5\u5206\u949F\u5185"}),"\u7CFB\u7EDF\u542F\u52A8\u65F6\u95F4\u53D1\u751F\u53D8\u5316\uFF0C\u53EF\u80FD\u53D1\u751F\u5F02\u5E38\u5173\u673A\u6216\u8005\u91CD\u542F\uFF0C\u8BF7\u6CE8\u610F\u67E5\u770B\u3002"]}),(0,n.jsx)(s.td,{children:(0,n.jsx)(s.code,{children:"abs((node_boot_time_seconds{} or 0) - node_boot_time_seconds{} offset 5m != 0)"})}),(0,n.jsx)(s.td,{children:(0,n.jsx)(s.code,{children:"crit: 1"})})]})]})]}),"\n",(0,n.jsx)(s.h2,{id:"\u5BB9\u5668\u7EAC\u5EA6",children:"\u5BB9\u5668\u7EAC\u5EA6"}),"\n",(0,n.jsxs)(s.table,{children:[(0,n.jsx)(s.thead,{children:(0,n.jsxs)(s.tr,{children:[(0,n.jsx)(s.th,{children:(0,n.jsx)(s.strong,{children:"\u544A\u8B66\u540D\u79F0"})}),(0,n.jsx)(s.th,{children:(0,n.jsx)(s.strong,{children:"\u544A\u8B66\u63CF\u8FF0"})}),(0,n.jsx)(s.th,{children:(0,n.jsx)(s.strong,{children:"\u5904\u7406\u65B9\u5F0F"})}),(0,n.jsx)(s.th,{children:(0,n.jsx)(s.strong,{children:"\u8868\u8FBE\u5F0F"})}),(0,n.jsx)(s.th,{children:(0,n.jsx)(s.strong,{children:"\u9608\u503C\u8BBE\u7F6E"})})]})}),(0,n.jsxs)(s.tbody,{children:[(0,n.jsxs)(s.tr,{children:[(0,n.jsxs)(s.td,{children:[(0,n.jsx)(s.strong,{children:"\u5BB9\u5668CPU\u4F7F\u7528\u7387"}),(0,n.jsx)("br",{}),(0,n.jsx)("br",{}),(0,n.jsx)(s.code,{children:"alert.container.cpu.usage_rate"}),(0,n.jsx)("br",{}),(0,n.jsx)("br",{}),"\u91CD\u8981\u7A0B\u5E8F\uFF1A\u53EF\u6709\u53EF\u65E0"]}),(0,n.jsxs)(s.td,{children:["\u524D\u7F6E\u6761\u4EF6\uFF1A\u53EA\u6709\u5728\u5BB9\u5668\u914D\u7F6E\u4E86",(0,n.jsx)(s.code,{children:"resources.limits.cpu"}),"\u6761\u4EF6\u4E0B\u624D\u80FD\u4F7F\u7528\u3002",(0,n.jsx)("br",{}),(0,n.jsx)("br",{}),"\u5355\u4F4D",(0,n.jsx)(s.code,{children:"%"}),"\u3002",(0,n.jsx)("br",{}),(0,n.jsx)("br",{}),"\u8BE5\u89C4\u5219\u9ED8\u8BA4\u4E0D\u542F\u7528\u3002"]}),(0,n.jsx)(s.td,{}),(0,n.jsx)(s.td,{children:(0,n.jsx)(s.code,{children:'100*sum(rate(container_cpu_usage_seconds_total{namespace=~"argo|khaos|obs|kube-system"}[5m])) by (khaos_product,khaos_cluster,namespace,app_name,pod,container)/sum(container_spec_cpu_quota{namespace=~"argo|khaos|obs|kube-system"}/container_spec_cpu_period{namespace=~"argo|khaos|obs|kube-system"}) by (khaos_product,khaos_cluster,namespace,app_name,pod,container)'})}),(0,n.jsxs)(s.td,{children:[(0,n.jsx)(s.code,{children:"info: 80"}),(0,n.jsx)("br",{}),(0,n.jsx)("br",{}),(0,n.jsx)(s.code,{children:"warn: 90"}),(0,n.jsx)("br",{}),(0,n.jsx)("br",{}),(0,n.jsx)(s.code,{children:"crit: 95"})]})]}),(0,n.jsxs)(s.tr,{children:[(0,n.jsxs)(s.td,{children:[(0,n.jsx)(s.strong,{children:"\u5BB9\u5668\u5185\u5B58\u4F7F\u7528\u7387"}),(0,n.jsx)("br",{}),(0,n.jsx)("br",{}),(0,n.jsx)(s.code,{children:"alert.container.memory.usage_rate"}),(0,n.jsx)("br",{}),(0,n.jsx)("br",{}),"\u91CD\u8981\u7A0B\u5E8F\uFF1A\u53EF\u6709\u53EF\u65E0"]}),(0,n.jsxs)(s.td,{children:["\u524D\u7F6E\u6761\u4EF6\uFF1A\u53EA\u6709\u5728\u5BB9\u5668\u914D\u7F6E\u4E86",(0,n.jsx)(s.code,{children:"resources.limits.memory"}),"\u6761\u4EF6\u4E0B\u624D\u80FD\u4F7F\u7528\u3002",(0,n.jsx)("br",{}),(0,n.jsx)("br",{}),"\u5355\u4F4D",(0,n.jsx)(s.code,{children:"%"}),"\u3002",(0,n.jsx)("br",{}),(0,n.jsx)("br",{}),"\u8BE5\u89C4\u5219\u9ED8\u8BA4\u4E0D\u542F\u7528\u3002"]}),(0,n.jsx)(s.td,{}),(0,n.jsx)(s.td,{children:(0,n.jsx)(s.code,{children:'100*(sum (container_memory_working_set_bytes{namespace=~"argo|khaos|obs|kube-system"}) by (khaos_product,khaos_cluster,namespace,app_name,pod,container)/sum (container_spec_memory_limit_bytes{namespace=~"argo|khaos|obs|kube-system"}) by (khaos_product,khaos_cluster,namespace,app_name,pod,container) <= 1)'})}),(0,n.jsxs)(s.td,{children:[(0,n.jsx)(s.code,{children:"info: 80"}),(0,n.jsx)("br",{}),(0,n.jsx)("br",{}),(0,n.jsx)(s.code,{children:"warn: 90"}),(0,n.jsx)("br",{}),(0,n.jsx)("br",{}),(0,n.jsx)(s.code,{children:"crit: 95"})]})]}),(0,n.jsxs)(s.tr,{children:[(0,n.jsxs)(s.td,{children:[(0,n.jsx)(s.strong,{children:"\u5BB9\u5668\u78C1\u76D8\u4F7F\u7528\u7387"}),(0,n.jsx)("br",{}),(0,n.jsx)("br",{}),(0,n.jsx)(s.code,{children:"alert.container.storage.usage_rate"}),(0,n.jsx)("br",{}),(0,n.jsx)("br",{}),"\u91CD\u8981\u7A0B\u5E8F\uFF1A\u53EF\u6709\u53EF\u65E0"]}),(0,n.jsxs)(s.td,{children:["\u7531\u4E8E\u5BB9\u5668\u5185\u90E8\u7684\u6302\u8F7D\u70B9\u53EF\u80FD\u5F88\u591A\uFF0C\u5E76\u4E14\u5728",(0,n.jsx)(s.code,{children:"Kubernetes"}),"\u4E0B\u90FD\u662F\u901A\u8FC7",(0,n.jsx)(s.code,{children:"pv"}),"\u7684\u65B9\u5F0F\u7533\u8BF7\u5B58\u50A8\uFF0C\u5BF9\u5E94\u4E5F\u6709",(0,n.jsx)(s.code,{children:"pv"}),"\u7684\u78C1\u76D8\u4F7F\u7528\u7387\u544A\u8B66\uFF0C\u56E0\u6B64\u8BE5\u544A\u8B66\u89C4\u5219\u9ED8\u8BA4\u672A\u542F\u7528\u3002",(0,n.jsx)("br",{}),(0,n.jsx)("br",{}),"\u5355\u4F4D",(0,n.jsx)(s.code,{children:"%"}),"\u3002"]}),(0,n.jsx)(s.td,{}),(0,n.jsx)(s.td,{children:(0,n.jsx)(s.code,{children:'100*sum(container_fs_usage_bytes{namespace=~"argo|khaos|obs|kube-system"} / (container_fs_limit_bytes{namespace=~"argo|khaos|obs|kube-system"} != 0 )) by (khaos_product,khaos_cluster,namespace,app_name,pod,container,device)'})}),(0,n.jsxs)(s.td,{children:[(0,n.jsx)(s.code,{children:"info: 80"}),(0,n.jsx)("br",{}),(0,n.jsx)("br",{}),(0,n.jsx)(s.code,{children:"warn: 90"}),(0,n.jsx)("br",{}),(0,n.jsx)("br",{}),(0,n.jsx)(s.code,{children:"crit: 95"})]})]}),(0,n.jsxs)(s.tr,{children:[(0,n.jsxs)(s.td,{children:[(0,n.jsx)(s.strong,{children:"\u5BB9\u5668\u6301\u7EED"})," ",(0,n.jsx)(s.code,{children:"10"})," ",(0,n.jsx)(s.strong,{children:"\u5206\u949F"})," ",(0,n.jsx)(s.code,{children:"NotReady"}),(0,n.jsx)("br",{}),(0,n.jsx)("br",{}),"(",(0,n.jsx)(s.strong,{children:"\u8BE5\u544A\u8B66\u5305\u542B\u6570\u636E\u9762\u5BB9\u5668"}),")",(0,n.jsx)("br",{}),(0,n.jsx)("br",{}),(0,n.jsx)(s.code,{children:"alert.container.not_ready10"}),(0,n.jsx)("br",{}),(0,n.jsx)("br",{}),"\u91CD\u8981\u7A0B\u5E8F\uFF1A\u91CD\u8981"]}),(0,n.jsxs)(s.td,{children:["\u901A\u8FC7",(0,n.jsx)(s.code,{children:"reason"}),"\u5B57\u6BB5\u544A\u8B66\u5177\u4F53\u539F\u56E0\uFF0C",(0,n.jsx)(s.code,{children:"reason"}),"\u5B57\u6BB5\u53EF\u80FD\u5F97\u53D6\u503C\u5982\u4E0B\uFF1A",(0,n.jsx)("br",{}),(0,n.jsx)("br",{}),"*   ",(0,n.jsx)(s.code,{children:"ContainerCreating"}),(0,n.jsx)("br",{}),"    ",(0,n.jsx)("br",{}),"*   ",(0,n.jsx)(s.code,{children:"CrashLoopBackOff"}),(0,n.jsx)("br",{}),"    ",(0,n.jsx)("br",{}),"*   ",(0,n.jsx)(s.code,{children:"CreateContainerConfigError"}),(0,n.jsx)("br",{}),"    ",(0,n.jsx)("br",{}),"*   ",(0,n.jsx)(s.code,{children:"ErrImagePull"}),(0,n.jsx)("br",{}),"    ",(0,n.jsx)("br",{}),"*   ",(0,n.jsx)(s.code,{children:"ImagePullBackOff"}),(0,n.jsx)("br",{}),"    ",(0,n.jsx)("br",{}),"*   ",(0,n.jsx)(s.code,{children:"PodInitializing"}),(0,n.jsx)("br",{}),"    ",(0,n.jsx)("br",{}),"*   ",(0,n.jsx)(s.code,{children:"OOMKilled"}),(0,n.jsx)("br",{}),"    ",(0,n.jsx)("br",{}),"*   ",(0,n.jsx)(s.code,{children:"StartError"}),(0,n.jsx)("br",{}),"    ",(0,n.jsx)("br",{}),"*   ",(0,n.jsx)(s.code,{children:"Error"}),(0,n.jsx)("br",{}),"    ",(0,n.jsx)("br",{}),"*   ",(0,n.jsx)(s.code,{children:"ContainerStatusUnknown"}),(0,n.jsx)("br",{}),"    ",(0,n.jsx)("br",{}),"*   ",(0,n.jsx)(s.code,{children:"Unknown"}),(0,n.jsx)("br",{}),"    ",(0,n.jsx)("br",{}),(0,n.jsx)("br",{}),(0,n.jsx)(s.strong,{children:"\u9700\u8981\u6CE8\u610F\uFF1A"}),(0,n.jsx)("br",{}),(0,n.jsx)("br",{}),(0,n.jsx)(s.strong,{children:'\u6570\u636E\u9762\u7684\u544A\u8B66\u4EC5\u9488\u5BF9\u5185\u6838\u5BB9\u5668\uFF0C\u6309\u7167container="khaos-biz"\u901A\u7528\u914D\u7F6E\uFF0C\u5E76\u4E0D\u5173\u5FC3\u4E1A\u52A1Pod\u4E2D\u7684sidecar\u5BB9\u5668\u3002'}),(0,n.jsx)("br",{}),(0,n.jsx)("br",{}),(0,n.jsx)(s.strong,{children:"\u6309\u7167\u6301\u7EED\u65F6\u95F4\u5212\u5206\u4E0D\u540C\u544A\u8B66\u7EA7\u522B\u3002"})]}),(0,n.jsxs)(s.td,{children:["\u901A\u8FC7\u8DF3\u677F\u673A\u767B\u5F55",(0,n.jsx)(s.code,{children:"kubernetes"}),"\u96C6\u7FA4\u67E5\u770B",(0,n.jsx)(s.code,{children:"Pod"}),"\u72B6\u6001\uFF0C\u5F02\u5E38\u5BB9\u5668\u65E5\u5FD7\u5B9A\u4F4D\u51C6\u786E\u539F\u56E0\u3002"]}),(0,n.jsxs)(s.td,{children:[(0,n.jsx)(s.strong,{children:"\u7BA1\u63A7\u9762\uFF1A"}),(0,n.jsx)("br",{}),(0,n.jsx)("br",{}),(0,n.jsx)(s.em,{children:"\u7BA1\u63A7\u9762\u5BB9\u5668\u5904\u4E8E\u5F02\u5E38\u72B6\u6001\uFF0C\u8BE5\u5BB9\u5668\u63D0\u4F9B\u7684\u7BA1\u63A7\u80FD\u529B\u5931\u6548\u3002"}),(0,n.jsx)("br",{}),(0,n.jsx)("br",{}),"\u5E26",(0,n.jsx)(s.code,{children:"reason"}),"\u7684\u5F02\u5E38\u5BB9\u5668\uFF1A",(0,n.jsx)("br",{}),(0,n.jsx)("br",{}),(0,n.jsx)(s.code,{children:"("}),"  ",(0,n.jsx)("br",{}),(0,n.jsx)(s.code,{children:'(kube_pod_container_status_terminated_reason{reason!="Completed",namespace=~"argo|khaos|obs|kube-system"} + kube_pod_container_status_terminated_reason{reason!="Completed",namespace=~"argo|khaos|obs|kube-system"} offset 10m) == 2'}),"  ",(0,n.jsx)("br",{}),(0,n.jsx)(s.code,{children:"or"}),"  ",(0,n.jsx)("br",{}),(0,n.jsx)(s.code,{children:'(kube_pod_container_status_waiting_reason{reason!="Completed",namespace=~"argo|khaos|obs|kube-system"} + kube_pod_container_status_waiting_reason{reason!="Completed",namespace=~"argo|khaos|obs|kube-system"} offset 10m) == 2'}),"  ",(0,n.jsx)("br",{}),(0,n.jsx)(s.code,{children:")"}),(0,n.jsx)("br",{}),(0,n.jsx)("br",{}),(0,n.jsx)(s.code,{children:"unkhown"}),"\u7684\u5F02\u5E38\u5BB9\u5668\uFF1A",(0,n.jsx)("br",{}),(0,n.jsx)("br",{}),(0,n.jsx)(s.code,{children:'((kube_pod_container_status_ready{namespace=~"argo|khaos|obs|kube-system"} + kube_pod_container_status_ready{namespace=~"argo|khaos|obs|kube-system"} offset 10m) == 0)'}),"  ",(0,n.jsx)("br",{}),(0,n.jsx)(s.code,{children:"unless on(uid)"}),"  ",(0,n.jsx)("br",{}),(0,n.jsx)(s.code,{children:"("}),"  ",(0,n.jsx)("br",{}),(0,n.jsx)(s.code,{children:'kube_pod_container_status_terminated_reason{namespace=~"argo|khaos|obs|kube-system"}'}),"  ",(0,n.jsx)("br",{}),(0,n.jsx)(s.code,{children:"or"}),"  ",(0,n.jsx)("br",{}),(0,n.jsx)(s.code,{children:'kube_pod_container_status_waiting_reason{namespace=~"argo|khaos|obs|kube-system"}'}),"  ",(0,n.jsx)("br",{}),(0,n.jsx)(s.code,{children:")"}),(0,n.jsx)("br",{}),(0,n.jsx)("br",{}),(0,n.jsx)(s.strong,{children:"\u6570\u636E\u9762\uFF1A"}),(0,n.jsx)("br",{}),(0,n.jsx)("br",{}),(0,n.jsx)(s.em,{children:"\u6570\u636E\u9762\u5BB9\u5668\u5F02\u5E38\uFF0C\u4F1A\u5F71\u54CD\u7528\u6237\u5B9E\u4F8B\uFF0C\u8BF7\u4F18\u5148\u67E5\u770B\uFF01"}),(0,n.jsx)("br",{}),(0,n.jsx)("br",{}),"\u5E26",(0,n.jsx)(s.code,{children:"reason"}),"\u7684\u5F02\u5E38\u5BB9\u5668\uFF1A",(0,n.jsx)("br",{}),(0,n.jsx)("br",{}),(0,n.jsx)(s.code,{children:"("}),"  ",(0,n.jsx)("br",{}),(0,n.jsx)(s.code,{children:'(kube_pod_container_status_terminated_reason{reason!="Completed",container="khaos-biz"} + kube_pod_container_status_terminated_reason{reason!="Completed",container="khaos-biz"} offset 10m) == 2'}),"  ",(0,n.jsx)("br",{}),(0,n.jsx)(s.code,{children:"or"}),"  ",(0,n.jsx)("br",{}),(0,n.jsx)(s.code,{children:'(kube_pod_container_status_waiting_reason{reason!="Completed",container="khaos-biz"} + kube_pod_container_status_waiting_reason{reason!="Completed",container="khaos-biz"} offset 10m) == 2'}),"  ",(0,n.jsx)("br",{}),(0,n.jsx)(s.code,{children:")"}),(0,n.jsx)("br",{}),(0,n.jsx)("br",{}),(0,n.jsx)(s.code,{children:"unkhown"}),"\u7684\u5F02\u5E38\u5BB9\u5668\uFF1A",(0,n.jsx)("br",{}),(0,n.jsx)("br",{}),(0,n.jsx)(s.code,{children:'((kube_pod_container_status_ready{container="khaos-biz"} + kube_pod_container_status_ready{container="khaos-biz"} offset 10m) == 0)'}),"  ",(0,n.jsx)("br",{}),(0,n.jsx)(s.code,{children:"unless on(uid)"}),"  ",(0,n.jsx)("br",{}),(0,n.jsx)(s.code,{children:"("}),"  ",(0,n.jsx)("br",{}),(0,n.jsx)(s.code,{children:'kube_pod_container_status_terminated_reason{container="khaos-biz"}'}),"  ",(0,n.jsx)("br",{}),(0,n.jsx)(s.code,{children:"or"}),"  ",(0,n.jsx)("br",{}),(0,n.jsx)(s.code,{children:'kube_pod_container_status_waiting_reason{container="khaos-biz"}'}),"  ",(0,n.jsx)("br",{}),(0,n.jsx)(s.code,{children:")"})]}),(0,n.jsx)(s.td,{children:(0,n.jsx)(s.code,{children:"info: 1"})})]}),(0,n.jsxs)(s.tr,{children:[(0,n.jsxs)(s.td,{children:[(0,n.jsx)(s.strong,{children:"\u5BB9\u5668\u6301\u7EED"})," ",(0,n.jsx)(s.code,{children:"20"})," ",(0,n.jsx)(s.strong,{children:"\u5206\u949F"})," ",(0,n.jsx)(s.code,{children:"NotReady"}),(0,n.jsx)("br",{}),(0,n.jsx)("br",{}),"(",(0,n.jsx)(s.strong,{children:"\u8BE5\u544A\u8B66\u5305\u542B\u6570\u636E\u9762\u5BB9\u5668"}),")",(0,n.jsx)("br",{}),(0,n.jsx)("br",{}),(0,n.jsx)(s.code,{children:"alert.container.not_ready20"}),(0,n.jsx)("br",{}),(0,n.jsx)("br",{}),"\u91CD\u8981\u7A0B\u5E8F\uFF1A\u91CD\u8981"]}),(0,n.jsx)(s.td,{children:(0,n.jsx)(s.code,{children:"warn: 1"})}),(0,n.jsx)(s.td,{}),(0,n.jsx)(s.td,{}),(0,n.jsx)(s.td,{})]}),(0,n.jsxs)(s.tr,{children:[(0,n.jsxs)(s.td,{children:[(0,n.jsx)(s.strong,{children:"\u5BB9\u5668\u6301\u7EED"})," ",(0,n.jsx)(s.code,{children:"30"})," ",(0,n.jsx)(s.strong,{children:"\u5206\u949F"})," ",(0,n.jsx)(s.code,{children:"NotReady"}),(0,n.jsx)("br",{}),(0,n.jsx)("br",{}),"(",(0,n.jsx)(s.strong,{children:"\u8BE5\u544A\u8B66\u5305\u542B\u6570\u636E\u9762\u5BB9\u5668"}),")",(0,n.jsx)("br",{}),(0,n.jsx)("br",{}),(0,n.jsx)(s.code,{children:"alert.container.not_ready30"}),(0,n.jsx)("br",{}),(0,n.jsx)("br",{}),"\u91CD\u8981\u7A0B\u5E8F\uFF1A\u91CD\u8981"]}),(0,n.jsx)(s.td,{children:(0,n.jsx)(s.code,{children:"crit: 1"})}),(0,n.jsx)(s.td,{}),(0,n.jsx)(s.td,{}),(0,n.jsx)(s.td,{})]}),(0,n.jsxs)(s.tr,{children:[(0,n.jsxs)(s.td,{children:[(0,n.jsx)(s.strong,{children:"\u5BB9\u5668\u53D1\u751F\u6301\u7EED\u91CD\u542F"}),(0,n.jsx)("br",{}),(0,n.jsx)("br",{}),"(",(0,n.jsx)(s.strong,{children:"\u8BE5\u544A\u8B66\u5305\u542B\u6570\u636E\u9762\u5BB9\u5668"}),")",(0,n.jsx)("br",{}),(0,n.jsx)("br",{}),(0,n.jsx)(s.code,{children:"alert.pod.status.crash_loop"}),(0,n.jsx)("br",{}),(0,n.jsx)("br",{}),"\u91CD\u8981\u7A0B\u5E8F\uFF1A\u91CD\u8981"]}),(0,n.jsxs)(s.td,{children:["\u901A\u8FC7",(0,n.jsx)(s.code,{children:"reason"}),"\u5B57\u6BB5\u544A\u8B66\u5177\u4F53\u539F\u56E0\uFF0C",(0,n.jsx)(s.code,{children:"reason"}),"\u5B57\u6BB5\u53EF\u80FD\u5F97\u53D6\u503C\u5982\u4E0B\uFF1A",(0,n.jsx)("br",{}),(0,n.jsx)("br",{}),"*   ",(0,n.jsx)(s.code,{children:"CrashLoopBackOff"}),(0,n.jsx)("br",{}),"    ",(0,n.jsx)("br",{}),"*   ",(0,n.jsx)(s.code,{children:"CreateContainerConfigError"}),(0,n.jsx)("br",{}),"    ",(0,n.jsx)("br",{}),"*   ",(0,n.jsx)(s.code,{children:"ErrImagePull"}),(0,n.jsx)("br",{}),"    ",(0,n.jsx)("br",{}),"*   ",(0,n.jsx)(s.code,{children:"ImagePullBackOff"}),(0,n.jsx)("br",{}),"    ",(0,n.jsx)("br",{}),"*   ",(0,n.jsx)(s.code,{children:"OOMKilled"}),(0,n.jsx)("br",{}),"    ",(0,n.jsx)("br",{}),"*   ",(0,n.jsx)(s.code,{children:"StartError"}),(0,n.jsx)("br",{}),"    ",(0,n.jsx)("br",{}),"*   ",(0,n.jsx)(s.code,{children:"Error"}),(0,n.jsx)("br",{}),"    ",(0,n.jsx)("br",{}),"*   ",(0,n.jsx)(s.code,{children:"ContainerStatusUnknown"}),(0,n.jsx)("br",{}),"    ",(0,n.jsx)("br",{}),"*   ",(0,n.jsx)(s.code,{children:"Unknown"}),(0,n.jsx)("br",{}),"    ",(0,n.jsx)("br",{}),(0,n.jsx)("br",{}),(0,n.jsx)(s.strong,{children:"\u9700\u8981\u6CE8\u610F\uFF1A"}),(0,n.jsx)("br",{}),(0,n.jsx)("br",{}),"*   ",(0,n.jsx)(s.strong,{children:"\u7531\u4E8E\u5BB9\u5668\u91CD\u542F\u4F7F\u7528\u4E86\u65F6\u95F4\u9000\u907F\uFF0C\u6700\u957F\u9000\u907F\u65F6\u95F4\u4E3A5m\uFF0C\u56E0\u6B64\u8FD9\u91CC\u9ED8\u8BA4\u4F7F\u752815m\u4F5C\u4E3A\u95F4\u9694\u6765\u8BA1\u7B97\u91CD\u542F\u9012\u589E\u503C\u3002"})]}),(0,n.jsxs)(s.td,{children:["\u901A\u8FC7\u8DF3\u677F\u673A\u767B\u5F55",(0,n.jsx)(s.code,{children:"kubernetes"}),"\u96C6\u7FA4\u67E5\u770B",(0,n.jsx)(s.code,{children:"Pod"}),"\u72B6\u6001\uFF0C\u5F02\u5E38\u5BB9\u5668\u65E5\u5FD7\u5B9A\u4F4D\u51C6\u786E\u539F\u56E0\u3002"]}),(0,n.jsxs)(s.td,{children:[(0,n.jsx)(s.strong,{children:"\u7BA1\u63A7\u9762\uFF1A"}),(0,n.jsx)("br",{}),(0,n.jsx)("br",{}),(0,n.jsx)(s.code,{children:'(delta(kube_pod_container_status_restarts_total{namespace=~"argo|khaos|obs|kube-system"} [15m]) > 1) + on(khaos_product,khaos_cluster, namespace, app_name, pod, container) group_right(kube_pod_container_status_last_terminated_reason) 0*(kube_pod_container_status_last_terminated_reason{reason!="Completed",namespace=~"argo|khaos|obs|kube-system"})'}),(0,n.jsx)("br",{}),(0,n.jsx)("br",{}),(0,n.jsx)(s.strong,{children:"\u6570\u636E\u9762\uFF08\u975E\u5E73\u53F0\u7BA1\u63A7\u9762\u7A7A\u95F4\uFF09"}),"\uFF1A",(0,n.jsx)("br",{}),(0,n.jsx)("br",{}),(0,n.jsx)(s.code,{children:'(delta(kube_pod_container_status_restarts_total{namespace!~"argo|khaos|obs|kube-system"} [15m]) > 1) + on(khaos_product,khaos_cluster, namespace, app_name, pod, container) group_right(kube_pod_container_status_last_terminated_reason) 0*(kube_pod_container_status_last_terminated_reason{reason!="Completed",namespace!~"argo|khaos|obs|kube-system"})'})]}),(0,n.jsxs)(s.td,{children:[(0,n.jsx)(s.code,{children:"info: 15m 2"}),(0,n.jsx)("br",{}),(0,n.jsx)("br",{}),(0,n.jsx)(s.code,{children:"warn: 20m 4"}),(0,n.jsx)("br",{}),(0,n.jsx)("br",{}),(0,n.jsx)(s.code,{children:"crit: 30m 5"})]})]})]})]}),"\n",(0,n.jsx)(s.h2,{id:"pod\u7EAC\u5EA6",children:"Pod\u7EAC\u5EA6"}),"\n",(0,n.jsxs)(s.table,{children:[(0,n.jsx)(s.thead,{children:(0,n.jsxs)(s.tr,{children:[(0,n.jsx)(s.th,{children:(0,n.jsx)(s.strong,{children:"\u544A\u8B66\u540D\u79F0"})}),(0,n.jsx)(s.th,{children:(0,n.jsx)(s.strong,{children:"\u544A\u8B66\u63CF\u8FF0"})}),(0,n.jsx)(s.th,{children:(0,n.jsx)(s.strong,{children:"\u5904\u7406\u65B9\u5F0F"})}),(0,n.jsx)(s.th,{children:(0,n.jsx)(s.strong,{children:"\u8868\u8FBE\u5F0F"})}),(0,n.jsx)(s.th,{children:(0,n.jsx)(s.strong,{children:"\u9608\u503C\u8BBE\u7F6E"})})]})}),(0,n.jsxs)(s.tbody,{children:[(0,n.jsxs)(s.tr,{children:[(0,n.jsxs)(s.td,{children:[(0,n.jsx)(s.strong,{children:"Pod\u957F\u671F\u5904\u4E8E\u65E0\u6CD5\u8C03\u5EA6\u72B6\u6001"}),(0,n.jsx)("br",{}),(0,n.jsx)("br",{}),"(",(0,n.jsx)(s.strong,{children:"\u8BE5\u544A\u8B66\u5305\u542B\u6570\u636E\u9762\u5BB9\u5668"}),")",(0,n.jsx)("br",{}),(0,n.jsx)("br",{}),(0,n.jsx)(s.code,{children:"alert.pod.status.unschedulable"}),(0,n.jsx)("br",{}),(0,n.jsx)("br",{}),"\u91CD\u8981\u7A0B\u5E8F\uFF1A\u91CD\u8981"]}),(0,n.jsx)(s.td,{children:"Pod\u5728\u4E00\u5B9A\u65F6\u95F4\u5185\u6CA1\u6709\u88AB\u8C03\u5EA6\u6210\u529F\uFF0C\u901A\u5E38\u662FPod\u4F9D\u8D56\u6CA1\u6709\u6EE1\u8DB3\u8981\u6C42\uFF0C\u4F8B\u5982\u8D44\u6E90\u8BF7\u6C42\u3001\u4EB2\u548C\u6027\u7B49\u524D\u7F6E\u6761\u4EF6\u65E0\u6CD5\u6EE1\u8DB3\u3002"}),(0,n.jsxs)(s.td,{children:["\u901A\u8FC7\u8DF3\u677F\u673A\u767B\u5F55\u96C6\u7FA4\uFF0C\u4F7F\u7528",(0,n.jsx)(s.code,{children:"kubectl describe"}),"\u547D\u4EE4\u67E5\u770B\u5177\u4F53\u539F\u56E0\u3002"]}),(0,n.jsx)(s.td,{children:(0,n.jsx)(s.code,{children:"kube_pod_status_unschedulable{}"})}),(0,n.jsxs)(s.td,{children:[(0,n.jsx)(s.code,{children:"info: 10\u5206\u949F"}),(0,n.jsx)("br",{}),(0,n.jsx)("br",{}),(0,n.jsx)(s.code,{children:"warn: 20\u5206\u949F"}),(0,n.jsx)("br",{}),(0,n.jsx)("br",{}),(0,n.jsx)(s.code,{children:"crit: 30\u5206\u949F"})]})]}),(0,n.jsxs)(s.tr,{children:[(0,n.jsxs)(s.td,{children:[(0,n.jsx)(s.strong,{children:"Pod PVC\u4F7F\u7528\u7387"}),(0,n.jsx)("br",{}),(0,n.jsx)("br",{}),"(",(0,n.jsx)(s.strong,{children:"\u8BE5\u544A\u8B66\u5305\u542B\u6570\u636E\u9762\u5BB9\u5668"}),")",(0,n.jsx)("br",{}),(0,n.jsx)("br",{}),(0,n.jsx)(s.code,{children:"alert.pod.storage.volume.usage_rate"}),(0,n.jsx)("br",{}),(0,n.jsx)("br",{}),"\u91CD\u8981\u7A0B\u5E8F\uFF1A\u91CD\u8981"]}),(0,n.jsxs)(s.td,{children:["PVC\u5BF9\u5E94\u7684PV\u4F7F\u7528\u7387\u9AD8\u65F6\uFF0C\u4F1A\u5F71\u54CD\u5B58\u50A8\uFF0C\u8FDB\u800C\u5F71\u54CD\u670D\u52A1\u529F\u80FD\u3002",(0,n.jsx)("br",{}),(0,n.jsx)("br",{}),(0,n.jsx)(s.strong,{children:"\u9700\u8981\u6CE8\u610F\uFF0C\u6570\u636E\u9762\u73B0\u7F51\u7684PVC\u78C1\u76D8\u4F7F\u7528\u7387\u90FD\u5F88\u9AD8\u3002"}),(0,n.jsx)("br",{}),(0,n.jsx)("br",{}),"\u5355\u4F4D",(0,n.jsx)(s.code,{children:"%"}),"\u3002"]}),(0,n.jsx)(s.td,{children:"\u6E05\u7406\u6216\u6269\u5BB9PV\u78C1\u76D8\u3002"}),(0,n.jsx)(s.td,{children:(0,n.jsx)(s.code,{children:"100*(kubelet_volume_stats_used_bytes{}/kubelet_volume_stats_capacity_bytes{})+on(khaos_product,khaos_cluster,persistentvolumeclaim,namespace) group_right(persistentvolumeclaim) 0*kube_pod_spec_volumes_persistentvolumeclaims_info{}"})}),(0,n.jsxs)(s.td,{children:[(0,n.jsx)(s.code,{children:"info: 80"}),(0,n.jsx)("br",{}),(0,n.jsx)("br",{}),(0,n.jsx)(s.code,{children:"warn: 90"}),(0,n.jsx)("br",{}),(0,n.jsx)("br",{}),(0,n.jsx)(s.code,{children:"crit: 95"})]})]}),(0,n.jsxs)(s.tr,{children:[(0,n.jsxs)(s.td,{children:[(0,n.jsx)(s.strong,{children:"Pod\u7F51\u7EDC\u5165\u6D41\u91CF\u8FC7\u5927"}),(0,n.jsx)("br",{}),(0,n.jsx)("br",{}),(0,n.jsx)(s.a,{href:"http://alert.pod.network.flow_rate.in",children:"alert.pod.network.flow_rate.in"}),(0,n.jsx)("br",{}),(0,n.jsx)("br",{}),"\u91CD\u8981\u7A0B\u5E8F\uFF1A\u4E00\u822C"]}),(0,n.jsxs)(s.td,{children:["\u539F\u7406\u662F",(0,n.jsx)(s.code,{children:"1"}),"\u5206\u949F\u5185\u7684\u5E73\u5747\u6D41\u91CF\u3002\u9700\u8981\u6CE8\u610F\uFF0C",(0,n.jsx)(s.code,{children:"Pod"}),"\u7684\u7F51\u7EDC\u6D41\u91CF\u5927\u90E8\u5206\u5C5E\u4E8E\u96C6\u7FA4\u5185\u90E8\u7684\u5185\u7F51\u6D41\u91CF\u3002",(0,n.jsx)("br",{}),(0,n.jsx)("br",{}),"\u5355\u4F4D",(0,n.jsx)(s.code,{children:"mb/s"}),"\u3002"]}),(0,n.jsx)(s.td,{}),(0,n.jsx)(s.td,{children:(0,n.jsx)(s.code,{children:'rate(container_network_receive_bytes_total{image!="",interface=~"eth.+",namespace=~"argo|khaos|obs|kube-system"}[1m])/1024/1024'})}),(0,n.jsxs)(s.td,{children:[(0,n.jsx)(s.code,{children:"info: 800"}),(0,n.jsx)("br",{}),(0,n.jsx)("br",{}),(0,n.jsx)(s.code,{children:"warn: 900"}),(0,n.jsx)("br",{}),(0,n.jsx)("br",{}),(0,n.jsx)(s.code,{children:"crit: 1000"})]})]}),(0,n.jsxs)(s.tr,{children:[(0,n.jsxs)(s.td,{children:[(0,n.jsx)(s.strong,{children:"Pod\u7F51\u7EDC\u51FA\u6D41\u91CF\u8FC7\u5927"}),(0,n.jsx)("br",{}),(0,n.jsx)("br",{}),(0,n.jsx)(s.code,{children:"alert.pod.network.flow_rate.out"}),(0,n.jsx)("br",{}),(0,n.jsx)("br",{}),"\u91CD\u8981\u7A0B\u5E8F\uFF1A\u4E00\u822C"]}),(0,n.jsxs)(s.td,{children:["\u539F\u7406\u662F",(0,n.jsx)(s.code,{children:"1"}),"\u5206\u949F\u5185\u7684\u5E73\u5747\u6D41\u91CF\u3002\u9700\u8981\u6CE8\u610F\uFF0C",(0,n.jsx)(s.code,{children:"Pod"}),"\u7684\u7F51\u7EDC\u6D41\u91CF\u5927\u90E8\u5206\u5C5E\u4E8E\u96C6\u7FA4\u5185\u90E8\u7684\u5185\u7F51\u6D41\u91CF\u3002",(0,n.jsx)("br",{}),(0,n.jsx)("br",{}),"\u5355\u4F4D",(0,n.jsx)(s.code,{children:"mb/s"}),"\u3002"]}),(0,n.jsx)(s.td,{}),(0,n.jsx)(s.td,{children:(0,n.jsx)(s.code,{children:'rate(container_network_transmit_bytes_total{image!="",interface=~"eth.+",namespace=~"argo|khaos|obs|kube-system"}[1m])/1024/1024'})}),(0,n.jsxs)(s.td,{children:[(0,n.jsx)(s.code,{children:"info: 800"}),(0,n.jsx)("br",{}),(0,n.jsx)("br",{}),(0,n.jsx)(s.code,{children:"warn: 900"}),(0,n.jsx)("br",{}),(0,n.jsx)("br",{}),(0,n.jsx)(s.code,{children:"crit: 1000"})]})]})]})]}),"\n",(0,n.jsx)(s.h2,{id:"\u670D\u52A1\u7EAC\u5EA6",children:"\u670D\u52A1\u7EAC\u5EA6"}),"\n",(0,n.jsx)(s.h3,{id:"\u4E91\u5DE2\u7EC4\u4EF6",children:"\u4E91\u5DE2\u7EC4\u4EF6"}),"\n",(0,n.jsx)(s.h4,{id:"vmagent",children:"vmagent"}),"\n",(0,n.jsxs)(s.table,{children:[(0,n.jsx)(s.thead,{children:(0,n.jsxs)(s.tr,{children:[(0,n.jsx)(s.th,{children:(0,n.jsx)(s.strong,{children:"\u544A\u8B66\u540D\u79F0"})}),(0,n.jsx)(s.th,{children:(0,n.jsx)(s.strong,{children:"\u544A\u8B66\u63CF\u8FF0"})}),(0,n.jsx)(s.th,{children:(0,n.jsx)(s.strong,{children:"\u5904\u7406\u65B9\u5F0F"})}),(0,n.jsx)(s.th,{children:(0,n.jsx)(s.strong,{children:"\u8868\u8FBE\u5F0F"})}),(0,n.jsx)(s.th,{children:(0,n.jsx)(s.strong,{children:"\u9608\u503C\u8BBE\u7F6E"})})]})}),(0,n.jsxs)(s.tbody,{children:[(0,n.jsxs)(s.tr,{children:[(0,n.jsxs)(s.td,{children:[(0,n.jsx)(s.code,{children:"vmagent"})," ",(0,n.jsx)(s.strong,{children:"\u5B58\u5728\u9519\u8BEF\u7684\u96C6\u7FA4ID\u914D\u7F6E"}),(0,n.jsx)("br",{}),(0,n.jsx)("br",{}),(0,n.jsx)(s.code,{children:"alert.service.khaos.vmagent.incorrect_khaos_cluster"}),(0,n.jsx)("br",{}),(0,n.jsx)("br",{}),"\u91CD\u8981\u7A0B\u5E8F\uFF1A\u4E00\u822C"]}),(0,n.jsxs)(s.td,{children:["\u6709\u90E8\u5206\u96C6\u7FA4\u7684",(0,n.jsx)(s.strong,{children:"\u96C6\u7FA4ID"}),"\u6CA1\u6709\u66F4\u65B0\u5230",(0,n.jsx)(s.code,{children:"vmagent"}),"\u914D\u7F6E\u4E2D\uFF0C\u53EF\u80FD\u662F\u96C6\u7FA4\u7684",(0,n.jsx)(s.code,{children:"cluster_values.yaml"}),"\u914D\u7F6E\u6216\u8005",(0,n.jsx)(s.code,{children:"CI"}),"\u811A\u672C\u5B58\u5728\u95EE\u9898\u3002",(0,n.jsx)("br",{}),(0,n.jsx)("br",{}),"\u5F53\u96C6\u7FA4ID\u914D\u7F6E\u9519\u8BEF\u65F6\uFF0C\u53EF\u80FD\u4F1A\u5F71\u54CD\u4E0A\u5C42\u7684\u544A\u8B66\u901A\u77E5\u3001\u5927\u76D8\u5C55\u793A\uFF0C\u5F71\u54CD\u95EE\u9898\u7684\u51C6\u786E\u5B9A\u4F4D\u3002",(0,n.jsx)("br",{}),(0,n.jsx)("br",{}),"\u8BE5\u95EE\u9898\u901A\u5E38\u4E0E\u96C6\u7FA4ID\u914D\u7F6E\u9519\u8BEF\u4E00\u8D77\u51FA\u73B0\u3002"]}),(0,n.jsxs)(s.td,{children:["\u9996\u5148\u5728",(0,n.jsx)(s.code,{children:"catalog"}),"\u4ED3\u5E93\u4E2D\u7684",(0,n.jsx)(s.code,{children:"tencentcloud/arcod/deploys"}),"\u76EE\u5F55\u68C0\u7D22\u5173\u952E\u5B57",(0,n.jsx)(s.code,{children:"khaos-cluster"}),"\u770B\u770B\u54EA\u4E2A\u96C6\u7FA4\u7684\u914D\u7F6E\u6587\u4EF6\u6709\u95EE\u9898\u3002",(0,n.jsx)("br",{}),(0,n.jsx)("br",{}),"\u5982\u679C\u65E0\u6CD5\u627E\u5230\uFF0C\u90A3\u4E48\u4F7F\u7528",(0,n.jsx)(s.code,{children:'count(kube_pod_info{khaos_cluster="khaos-cluster"})by(namespace)'}),"\u770B\u770B\u662F\u54EA\u4E2A\u4EA7\u54C1\u7684\u5B9E\u4F8B\uFF0C\u968F\u540E\u5BF9\u8BE5\u4EA7\u54C1\u7684\u6240\u6709\u96C6\u7FA4\u904D\u5386\u67E5\u627E",(0,n.jsx)(s.code,{children:"ns"}),"\u5B9A\u4F4D\u662F\u5426\u8BE5\u96C6\u7FA4\u3002"]}),(0,n.jsx)(s.td,{children:(0,n.jsx)(s.code,{children:'count(kube_pod_info{khaos_cluster="khaos-cluster"})'})}),(0,n.jsx)(s.td,{children:(0,n.jsx)(s.code,{children:"info: 1"})})]}),(0,n.jsxs)(s.tr,{children:[(0,n.jsxs)(s.td,{children:[(0,n.jsx)(s.code,{children:"vmagent"})," ",(0,n.jsx)(s.strong,{children:"\u5B58\u5728\u9519\u8BEF\u7684\u4EA7\u54C1\u6807\u8BC6\u914D\u7F6E"}),(0,n.jsx)("br",{}),(0,n.jsx)("br",{}),(0,n.jsx)(s.code,{children:"alert.service.khaos.vmagent.incorrect_khaos_product"}),(0,n.jsx)("br",{}),(0,n.jsx)("br",{}),"\u91CD\u8981\u7A0B\u5E8F\uFF1A\u4E00\u822C"]}),(0,n.jsxs)(s.td,{children:["\u6709\u90E8\u5206\u96C6\u7FA4\u7684",(0,n.jsx)(s.strong,{children:"\u4EA7\u54C1\u6807\u8BC6"}),"\u6CA1\u6709\u66F4\u65B0\u5230",(0,n.jsx)(s.code,{children:"vmagent"}),"\u914D\u7F6E\u4E2D\uFF0C\u53EF\u80FD\u662F\u96C6\u7FA4\u7684",(0,n.jsx)(s.code,{children:"cluster_values.yaml"}),"\u914D\u7F6E\u6216\u8005",(0,n.jsx)(s.code,{children:"CI"}),"\u811A\u672C\u5B58\u5728\u95EE\u9898\u3002",(0,n.jsx)("br",{}),(0,n.jsx)("br",{}),"\u5F53\u96C6\u7FA4ID\u914D\u7F6E\u9519\u8BEF\u65F6\uFF0C\u53EF\u80FD\u4F1A\u5F71\u54CD\u4E0A\u5C42\u7684\u544A\u8B66\u901A\u77E5\u3001\u5927\u76D8\u5C55\u793A\uFF0C\u5F71\u54CD\u95EE\u9898\u7684\u51C6\u786E\u5B9A\u4F4D\u3002",(0,n.jsx)("br",{}),(0,n.jsx)("br",{}),"\u8BE5\u95EE\u9898\u901A\u5E38\u4E0E\u96C6\u7FA4ID\u914D\u7F6E\u9519\u8BEF\u4E00\u8D77\u51FA\u73B0\u3002"]}),(0,n.jsx)(s.td,{children:"\u540C\u4E0A\u3002"}),(0,n.jsx)(s.td,{children:(0,n.jsx)(s.code,{children:'count(kube_pod_info{khaos_product=""})'})}),(0,n.jsx)(s.td,{children:(0,n.jsx)(s.code,{children:"info: 1"})})]}),(0,n.jsxs)(s.tr,{children:[(0,n.jsxs)(s.td,{children:[(0,n.jsx)(s.code,{children:"vmagent"})," ",(0,n.jsx)(s.strong,{children:"\u9519\u8BEF\u65E5\u5FD7\u6FC0\u589E"}),(0,n.jsx)("br",{}),(0,n.jsx)("br",{}),(0,n.jsx)(s.code,{children:"alert.service.khaos.vmagent.log_errors"}),(0,n.jsx)("br",{}),(0,n.jsx)("br",{}),"\u91CD\u8981\u7A0B\u5E8F\uFF1A\u91CD\u8981"]}),(0,n.jsxs)(s.td,{children:["\u9519\u8BEF\u65E5\u5FD7\u4E00\u6BB5\u65F6\u95F4\u5185\u589E\u52A0\u8FC7\u591A\uFF0C\u53EF\u80FD\u4F1A\u5F71\u54CD\u76D1\u63A7\u91C7\u96C6\u80FD\u529B\u3002",(0,n.jsx)("br",{}),(0,n.jsx)("br",{}),"\u5355\u4F4D",(0,n.jsx)(s.code,{children:"\u6761"}),"\u3002"]}),(0,n.jsxs)(s.td,{children:["\u9700\u8981\u53BB\u63A7\u5236\u53F0\u67E5\u770B",(0,n.jsx)(s.code,{children:"vmagent pod"}),"\u7684\u65E5\u5FD7\u786E\u5B9A\u539F\u56E0\u3002"]}),(0,n.jsx)(s.td,{children:(0,n.jsx)(s.code,{children:'sum(increase(vm_log_messages_total{level!="info"}[10m])) by (khaos_product, khaos_cluster, app_name, namespace, pod)'})}),(0,n.jsxs)(s.td,{children:[(0,n.jsx)(s.code,{children:"info: 1000"}),(0,n.jsx)("br",{}),(0,n.jsx)("br",{}),(0,n.jsx)(s.code,{children:"warn: 3000"}),(0,n.jsx)("br",{}),(0,n.jsx)("br",{}),(0,n.jsx)(s.code,{children:"crit: 5000"})]})]}),(0,n.jsxs)(s.tr,{children:[(0,n.jsxs)(s.td,{children:[(0,n.jsx)(s.code,{children:"vmagent"})," ",(0,n.jsx)(s.strong,{children:"\u672C\u5730\u7F13\u5B58\u6FC0\u589E"}),(0,n.jsx)("br",{}),(0,n.jsx)("br",{}),(0,n.jsx)(s.code,{children:"alert.service.khaos.vmagent.local_cache"}),(0,n.jsx)("br",{}),(0,n.jsx)("br",{}),"\u91CD\u8981\u7A0B\u5E8F\uFF1A\u91CD\u8981"]}),(0,n.jsxs)(s.td,{children:["\u5F53",(0,n.jsx)(s.code,{children:"vmagent"}),"\u4E0A\u62A5\u5931\u8D25\u65F6\uFF0C\u4F1A\u6309\u7167\u8FDC\u7AEF\u5730\u5740\u7F13\u5B58\u672C\u5730\u6570\u636E\uFF0C\u5982\u679C\u672C\u5730\u7F13\u5B58\u6570\u636E\u6FC0\u589E\uFF0C\u8868\u793A\u8FDC\u7AEF\u5199\u5165\u5931\u8D25\u8FC7\u591A\u3002",(0,n.jsx)("br",{}),(0,n.jsx)("br",{}),"\u5355\u4F4D",(0,n.jsx)(s.code,{children:"mb"}),"\u3002"]}),(0,n.jsxs)(s.td,{children:["\u9700\u8981\u53BB\u63A7\u5236\u53F0\u67E5\u770B",(0,n.jsx)(s.code,{children:"vmagent pod"}),"\u7684\u65E5\u5FD7\u786E\u5B9A\u539F\u56E0\u3002\u5224\u65AD\u662F\u5426\u5730\u5740\u914D\u7F6E\u9519\u8BEF\uFF0C\u6216\u8005\u8FDC\u7AEF\u5199\u5165\u5730\u5740\u5BF9\u5E94\u7684\u670D\u52A1\u5F02\u5E38\u3002"]}),(0,n.jsx)(s.td,{children:(0,n.jsx)(s.code,{children:"sum(vmagent_remotewrite_pending_data_bytes{}) by (job, url)/1024/1024"})}),(0,n.jsxs)(s.td,{children:[(0,n.jsx)(s.code,{children:"info: 100"}),(0,n.jsx)("br",{}),(0,n.jsx)("br",{}),(0,n.jsx)(s.code,{children:"warn: 500"}),(0,n.jsx)("br",{}),(0,n.jsx)("br",{}),(0,n.jsx)(s.code,{children:"crit: 1000"})]})]})]})]}),"\n",(0,n.jsx)(s.h3,{id:"kubernetes\u7EC4\u4EF6",children:"Kubernetes\u7EC4\u4EF6"}),"\n",(0,n.jsx)(s.h4,{id:"etcd",children:"etcd"}),"\n",(0,n.jsxs)(s.table,{children:[(0,n.jsx)(s.thead,{children:(0,n.jsxs)(s.tr,{children:[(0,n.jsx)(s.th,{children:(0,n.jsx)(s.strong,{children:"\u544A\u8B66\u540D\u79F0"})}),(0,n.jsx)(s.th,{children:(0,n.jsx)(s.strong,{children:"\u544A\u8B66\u63CF\u8FF0"})}),(0,n.jsx)(s.th,{children:(0,n.jsx)(s.strong,{children:"\u8868\u8FBE\u5F0F"})}),(0,n.jsx)(s.th,{children:(0,n.jsx)(s.strong,{children:"\u9608\u503C\u8BBE\u7F6E"})})]})}),(0,n.jsx)(s.tbody,{children:(0,n.jsxs)(s.tr,{children:[(0,n.jsxs)(s.td,{children:[(0,n.jsx)(s.code,{children:"etcd"})," ",(0,n.jsx)(s.strong,{children:"\u662F\u5426\u5B58\u5728\u4E3B\u8282\u70B9"}),(0,n.jsx)("br",{}),(0,n.jsx)("br",{}),(0,n.jsx)(s.code,{children:"alert.service.kube.etcd.has_leader"}),(0,n.jsx)("br",{}),(0,n.jsx)("br",{}),"\u91CD\u8981\u7A0B\u5E8F\uFF1A\u91CD\u8981"]}),(0,n.jsxs)(s.td,{children:["\u8868\u793A",(0,n.jsx)(s.code,{children:"etcd"}),"\u662F\u5426\u53EF\u7528\u3002",(0,n.jsx)("br",{}),(0,n.jsx)("br",{}),(0,n.jsx)(s.strong,{children:"\u9700\u8981\u6CE8\u610F\uFF1ATKE\u6258\u7BA1\u7C7B\u578B\u96C6\u7FA4\u7684"})," ",(0,n.jsx)(s.code,{children:"etcd"})," ",(0,n.jsx)(s.strong,{children:"\u670D\u52A1\u7531\u4E8E\u90E8\u7F72\u5728\u5176\u4ED6\u72EC\u7ACB\u7684\u96C6\u7FA4\u4E2D\uFF0C\u5F53\u524D\u96C6\u7FA4\u5185\u7684\u76D1\u63A7\u7EC4\u4EF6\u6CA1\u6709\u6743\u9650\u8BBF\u95EE\u56E0\u6B64\u65E0\u6CD5\u91C7\u96C6\u5176\u6307\u6807\u3002"})]}),(0,n.jsx)(s.td,{children:(0,n.jsx)(s.code,{children:"etcd_server_has_leader{}"})}),(0,n.jsx)(s.td,{children:(0,n.jsx)(s.code,{children:"crit: ==0"})})]})})]}),"\n",(0,n.jsx)(s.h4,{id:"apiserver",children:"apiserver"}),"\n",(0,n.jsxs)(s.table,{children:[(0,n.jsx)(s.thead,{children:(0,n.jsxs)(s.tr,{children:[(0,n.jsx)(s.th,{children:(0,n.jsx)(s.strong,{children:"\u544A\u8B66\u82F1\u6587\u540D"})}),(0,n.jsx)(s.th,{children:(0,n.jsx)(s.strong,{children:"\u544A\u8B66\u63CF\u8FF0"})}),(0,n.jsx)(s.th,{children:(0,n.jsx)(s.strong,{children:"\u8868\u8FBE\u5F0F"})}),(0,n.jsx)(s.th,{children:(0,n.jsx)(s.strong,{children:"\u9608\u503C\u8BBE\u7F6E"})})]})}),(0,n.jsxs)(s.tbody,{children:[(0,n.jsxs)(s.tr,{children:[(0,n.jsxs)(s.td,{children:[(0,n.jsx)(s.code,{children:"apiserver"})," ",(0,n.jsx)(s.strong,{children:"\u670D\u52A1\u7AEF\u8BF7\u6C42\u9519\u8BEF\u7387"}),(0,n.jsx)("br",{}),(0,n.jsx)("br",{}),(0,n.jsx)(s.code,{children:"alert.service.kube.apiserver.server.error_rate"}),(0,n.jsx)("br",{}),(0,n.jsx)("br",{}),"\u91CD\u8981\u7A0B\u5E8F\uFF1A\u91CD\u8981"]}),(0,n.jsxs)(s.td,{children:[(0,n.jsx)(s.code,{children:"5"}),"\u5206\u949F\u5185",(0,n.jsx)(s.code,{children:"apiserver"}),"\u5904\u7406\u7684\u8BF7\u6C42\u9519\u8BEF\u7387\u8F83\u9AD8\u3002",(0,n.jsx)("br",{}),(0,n.jsx)("br",{}),"\u5355\u4F4D",(0,n.jsx)(s.code,{children:"%"}),"\u3002"]}),(0,n.jsx)(s.td,{children:(0,n.jsx)(s.code,{children:'100*sum(rate(apiserver_request_total{code=~"(?:5..)"}[5m])) by (khaos_product,khaos_cluster,app_name,instance,group,version,resource) / sum(rate(apiserver_request_total{}[5m])) by (khaos_product,khaos_cluster,app_name,instance,group,version,resource)'})}),(0,n.jsxs)(s.td,{children:[(0,n.jsx)(s.code,{children:"info: 50"}),(0,n.jsx)("br",{}),(0,n.jsx)("br",{}),(0,n.jsx)(s.code,{children:"warn: 80"}),(0,n.jsx)("br",{}),(0,n.jsx)("br",{}),(0,n.jsx)(s.code,{children:"crit: 90"})]})]}),(0,n.jsxs)(s.tr,{children:[(0,n.jsxs)(s.td,{children:[(0,n.jsx)(s.strong,{children:"\u5BA2\u6237\u7AEF\u5411"})," ",(0,n.jsx)(s.code,{children:"apiserver"})," ",(0,n.jsx)(s.strong,{children:"\u8BF7\u6C42\u9519\u8BEF\u7387"}),(0,n.jsx)("br",{}),(0,n.jsx)("br",{}),(0,n.jsx)(s.code,{children:"alert.service.kube.apiserver.client.error_rate"}),(0,n.jsx)("br",{}),(0,n.jsx)("br",{}),"\u91CD\u8981\u7A0B\u5E8F\uFF1A\u91CD\u8981"]}),(0,n.jsxs)(s.td,{children:[(0,n.jsx)(s.code,{children:"5"}),"\u5206\u949F\u5185\u5BA2\u6237\u7AEF\u8BF7\u6C42",(0,n.jsx)(s.code,{children:"apiserver"}),"\u7684\u9519\u8BEF\u7387\u8F83\u9AD8\u3002",(0,n.jsx)(s.code,{children:"instance"}),"\u4E3A\u5BA2\u6237\u7AEF\uFF0C",(0,n.jsx)(s.code,{children:"host"}),"\u4E3A\u76EE\u6807\u7AEF\uFF0C",(0,n.jsx)(s.code,{children:"job"}),"\u7528\u4E8E\u8BC6\u522B\u662F\u5426",(0,n.jsx)(s.code,{children:"kubelet"}),"\u8BBF\u95EE\u3002",(0,n.jsx)("br",{}),(0,n.jsx)("br",{}),"  ",(0,n.jsx)("br",{}),(0,n.jsx)("br",{}),"\u5355\u4F4D",(0,n.jsx)(s.code,{children:"%"}),"\u3002"]}),(0,n.jsx)(s.td,{children:(0,n.jsx)(s.code,{children:'100*(sum(rate(rest_client_requests_total{code=~"(4|5).."}[5m])) by (khaos_product,khaos_cluster,app_name,instance,host) / sum(rate(rest_client_requests_total[5m])) by (khaos_product,khaos_cluster,app_name,instance,host))'})}),(0,n.jsxs)(s.td,{children:[(0,n.jsx)(s.code,{children:"info: 50"}),(0,n.jsx)("br",{}),(0,n.jsx)("br",{}),(0,n.jsx)(s.code,{children:"warn: 80"}),(0,n.jsx)("br",{}),(0,n.jsx)("br",{}),(0,n.jsx)(s.code,{children:"crit: 90"})]})]}),(0,n.jsxs)(s.tr,{children:[(0,n.jsxs)(s.td,{children:[(0,n.jsx)(s.code,{children:"apiserver"})," ",(0,n.jsx)(s.strong,{children:"\u670D\u52A1\u7AEF\u8BF7\u6C42\u5904\u7406\u5EF6\u8FDF"}),(0,n.jsx)("br",{}),(0,n.jsx)("br",{}),(0,n.jsx)(s.code,{children:"alert.service.kube.apiserver.latency"}),(0,n.jsx)("br",{}),(0,n.jsx)("br",{}),"\u91CD\u8981\u7A0B\u5E8F\uFF1A\u91CD\u8981"]}),(0,n.jsxs)(s.td,{children:[(0,n.jsx)(s.code,{children:"5"}),"\u5206\u949F\u5185",(0,n.jsx)(s.code,{children:"p99"}),"\u7684\u8BF7\u6C42\u5904\u7406\u5EF6\u8FDF\u8F83\u9AD8\u3002",(0,n.jsx)("br",{}),(0,n.jsx)("br",{}),"\u5355\u4F4D",(0,n.jsx)(s.code,{children:"ms"}),"\u3002"]}),(0,n.jsx)(s.td,{children:(0,n.jsx)(s.code,{children:'1000*histogram_quantile(0.99, sum(rate(apiserver_request_duration_seconds_bucket{verb!~"(?:CONNECT|WATCHLIST|WATCH|PROXY)"} [5m])) without (subresource))'})}),(0,n.jsxs)(s.td,{children:[(0,n.jsx)(s.code,{children:"info: 3000"}),(0,n.jsx)("br",{}),(0,n.jsx)("br",{}),(0,n.jsx)(s.code,{children:"warn: 5000"}),(0,n.jsx)("br",{}),(0,n.jsx)("br",{}),(0,n.jsx)(s.code,{children:"crit: 10000"})]})]})]})]}),"\n",(0,n.jsx)(s.h2,{id:"\u53C2\u8003\u8D44\u6599",children:"\u53C2\u8003\u8D44\u6599"}),"\n",(0,n.jsxs)(s.ul,{children:["\n",(0,n.jsxs)(s.li,{children:["\n",(0,n.jsx)(s.p,{children:(0,n.jsx)(s.a,{href:"https://github.com/samber/awesome-prometheus-alerts",children:"https://github.com/samber/awesome-prometheus-alerts"})}),"\n"]}),"\n",(0,n.jsxs)(s.li,{children:["\n",(0,n.jsx)(s.p,{children:(0,n.jsx)(s.a,{href:"https://sysdig.com/blog/monitor-kubernetes-api-server/",children:"https://sysdig.com/blog/monitor-kubernetes-api-server"})}),"\n"]}),"\n"]})]})}function l(e={}){let{wrapper:s}={...(0,c.a)(),...e.components};return s?(0,n.jsx)(s,{...e,children:(0,n.jsx)(i,{...e})}):i(e)}},50065:function(e,s,r){r.d(s,{Z:function(){return o},a:function(){return t}});var d=r(67294);let n={},c=d.createContext(n);function t(e){let s=d.useContext(c);return d.useMemo(function(){return"function"==typeof e?e(s):{...s,...e}},[s,e])}function o(e){let s;return s=e.disableParentContext?"function"==typeof e.components?e.components(n):e.components||n:t(e.components),d.createElement(c.Provider,{value:s},e.children)}}}]);