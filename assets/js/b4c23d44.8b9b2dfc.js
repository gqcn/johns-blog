"use strict";(self.webpackChunkgf_site=self.webpackChunkgf_site||[]).push([["6241"],{87773:function(n,e,s){s.r(e),s.d(e,{metadata:()=>i,contentTitle:()=>t,default:()=>a,assets:()=>l,toc:()=>d,frontMatter:()=>r});var i=JSON.parse('{"id":"docs/\u65E5\u5E38\u7B14\u8BB0/\u4F7F\u7528docusaurus\u642D\u5EFA\u9759\u6001\u7F51\u7AD9\u7B14\u8BB0","title":"\u4F7F\u7528Docusaurus\u642D\u5EFA\u9759\u6001\u7F51\u7AD9\u7B14\u8BB0","description":"\u8BE6\u7EC6\u8BB0\u5F55\u4F7F\u7528Docusaurus\u642D\u5EFA\u4E2A\u4EBA\u535A\u5BA2\u7F51\u7AD9\u7684\u5B8C\u6574\u6D41\u7A0B\uFF0C\u5305\u62ECGitHub\u4ED3\u5E93\u642D\u5EFA\u3001GitHub Actions\u81EA\u52A8\u90E8\u7F72\u3001Linux\u670D\u52A1\u5668\u914D\u7F6E\u3001SSL\u8BC1\u4E66\u7533\u8BF7\u3001Nginx\u914D\u7F6E\u548C\u5B9A\u65F6\u4EFB\u52A1\u8BBE\u7F6E\u7B49\u5B9E\u8DF5\u7ECF\u9A8C","source":"@site/docs/docs/2500-\u65E5\u5E38\u7B14\u8BB0/\u4F7F\u7528docusaurus\u642D\u5EFA\u9759\u6001\u7F51\u7AD9\u7B14\u8BB0.md","sourceDirName":"docs/2500-\u65E5\u5E38\u7B14\u8BB0","slug":"/notes/docusaurus-site-notes","permalink":"/notes/docusaurus-site-notes","draft":false,"unlisted":false,"tags":[],"version":"current","frontMatter":{"slug":"/notes/docusaurus-site-notes","title":"\u4F7F\u7528Docusaurus\u642D\u5EFA\u9759\u6001\u7F51\u7AD9\u7B14\u8BB0","hide_title":true,"description":"\u8BE6\u7EC6\u8BB0\u5F55\u4F7F\u7528Docusaurus\u642D\u5EFA\u4E2A\u4EBA\u535A\u5BA2\u7F51\u7AD9\u7684\u5B8C\u6574\u6D41\u7A0B\uFF0C\u5305\u62ECGitHub\u4ED3\u5E93\u642D\u5EFA\u3001GitHub Actions\u81EA\u52A8\u90E8\u7F72\u3001Linux\u670D\u52A1\u5668\u914D\u7F6E\u3001SSL\u8BC1\u4E66\u7533\u8BF7\u3001Nginx\u914D\u7F6E\u548C\u5B9A\u65F6\u4EFB\u52A1\u8BBE\u7F6E\u7B49\u5B9E\u8DF5\u7ECF\u9A8C","keywords":["docusaurus","\u9759\u6001\u7F51\u7AD9","github actions","nginx","ssl\u8BC1\u4E66","certbot","\u4E2A\u4EBA\u535A\u5BA2","\u7F51\u7AD9\u90E8\u7F72","\u81EA\u52A8\u5316\u90E8\u7F72","linux\u670D\u52A1\u5668"]},"sidebar":"mainSidebar","previous":{"title":"Github PR\u4EE3\u7801\u591A\u4EBA\u534F\u4F5C","permalink":"/notes/github-pr-collaboration"},"next":{"title":"\u89E3\u51B3linux\u4E0Bvim\u4E71\u7801\u7684\u60C5\u51B5","permalink":"/notes/linux-vim-encoding-fix"}}'),o=s("85893"),c=s("50065");let r={slug:"/notes/docusaurus-site-notes",title:"\u4F7F\u7528Docusaurus\u642D\u5EFA\u9759\u6001\u7F51\u7AD9\u7B14\u8BB0",hide_title:!0,description:"\u8BE6\u7EC6\u8BB0\u5F55\u4F7F\u7528Docusaurus\u642D\u5EFA\u4E2A\u4EBA\u535A\u5BA2\u7F51\u7AD9\u7684\u5B8C\u6574\u6D41\u7A0B\uFF0C\u5305\u62ECGitHub\u4ED3\u5E93\u642D\u5EFA\u3001GitHub Actions\u81EA\u52A8\u90E8\u7F72\u3001Linux\u670D\u52A1\u5668\u914D\u7F6E\u3001SSL\u8BC1\u4E66\u7533\u8BF7\u3001Nginx\u914D\u7F6E\u548C\u5B9A\u65F6\u4EFB\u52A1\u8BBE\u7F6E\u7B49\u5B9E\u8DF5\u7ECF\u9A8C",keywords:["docusaurus","\u9759\u6001\u7F51\u7AD9","github actions","nginx","ssl\u8BC1\u4E66","certbot","\u4E2A\u4EBA\u535A\u5BA2","\u7F51\u7AD9\u90E8\u7F72","\u81EA\u52A8\u5316\u90E8\u7F72","linux\u670D\u52A1\u5668"]},t=void 0,l={},d=[{value:"docusaurus\u4ED3\u5E93\u642D\u5EFA",id:"docusaurus\u4ED3\u5E93\u642D\u5EFA",level:2},{value:"docusaurus\u9759\u6001\u9875\u9762\u6784\u5EFA",id:"docusaurus\u9759\u6001\u9875\u9762\u6784\u5EFA",level:2},{value:"\u670D\u52A1\u5668\u914D\u7F6E",id:"\u670D\u52A1\u5668\u914D\u7F6E",level:2},{value:"SSL\u8BC1\u4E66\u7533\u8BF7",id:"ssl\u8BC1\u4E66\u7533\u8BF7",level:3},{value:"\u914D\u7F6E<code>nginx</code>",id:"\u914D\u7F6Enginx",level:3},{value:"\u4FEE\u6539nginx\u8FD0\u884C\u7528\u6237",id:"\u4FEE\u6539nginx\u8FD0\u884C\u7528\u6237",level:3},{value:"\u914D\u7F6E\u5B9A\u65F6\u4EFB\u52A1",id:"\u914D\u7F6E\u5B9A\u65F6\u4EFB\u52A1",level:3}];function u(n){let e={a:"a",code:"code",h2:"h2",h3:"h3",img:"img",p:"p",pre:"pre",...(0,c.a)(),...n.components};return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(e.h2,{id:"docusaurus\u4ED3\u5E93\u642D\u5EFA",children:"docusaurus\u4ED3\u5E93\u642D\u5EFA"}),"\n",(0,o.jsxs)(e.p,{children:["\u4F7F\u7528",(0,o.jsx)(e.code,{children:"github"}),"\uFF0C\u65E2\u7136\u5185\u5BB9\u90FD\u662F\u516C\u5F00\u7684\uFF0C\u90A3\u4E48\u4F7F\u7528\u5F00\u6E90\u9879\u76EE\u5373\u53EF\uFF0C\u4ED3\u5E93\u5730\u5740\uFF1A",(0,o.jsx)(e.a,{href:"https://github.com/gqcn/johns-blog",children:"https://github.com/gqcn/johns-blog"})]}),"\n",(0,o.jsx)(e.h2,{id:"docusaurus\u9759\u6001\u9875\u9762\u6784\u5EFA",children:"docusaurus\u9759\u6001\u9875\u9762\u6784\u5EFA"}),"\n",(0,o.jsxs)(e.p,{children:["\u4F7F\u7528",(0,o.jsx)(e.code,{children:"github"}),"\u7684",(0,o.jsx)(e.code,{children:"action"}),"\u5373\u53EF\uFF0Cworkflow\u914D\u7F6E\uFF1A",(0,o.jsx)(e.a,{href:"https://github.com/gqcn/johns-blog/blob/main/.github/workflows/build-and-deploy.yml",children:"https://github.com/gqcn/johns-blog/blob/main/.github/workflows/build-and-deploy.yml"})]}),"\n",(0,o.jsxs)(e.p,{children:["\u540C\u65F6\u9700\u8981\u914D\u7F6E",(0,o.jsx)(e.code,{children:"github pages"}),"\u90E8\u7F72\u7684\u5206\u652F\uFF0C\u5728",(0,o.jsx)(e.code,{children:"Environments / Configure github-pages"}),"\u4E2D\u914D\u7F6E\uFF1A"]}),"\n",(0,o.jsx)(e.p,{children:(0,o.jsx)(e.img,{alt:"alt text",src:s(65364).Z+"",width:"2580",height:"1430"})}),"\n",(0,o.jsx)(e.h2,{id:"\u670D\u52A1\u5668\u914D\u7F6E",children:"\u670D\u52A1\u5668\u914D\u7F6E"}),"\n",(0,o.jsxs)(e.p,{children:["\u6211\u6CA1\u6709\u4F7F\u7528",(0,o.jsx)(e.code,{children:"github pages"}),"\uFF0C\u800C\u662F\u4F7F\u7528\u7684\u662F\u67D0\u4E91\u7684",(0,o.jsx)(e.code,{children:"Linux"}),"\u670D\u52A1\u5668\uFF0C\u56FD\u5185\u8BBF\u95EE\u4F1A\u5FEB\u4E00\u4E9B\u3002"]}),"\n",(0,o.jsx)(e.h3,{id:"ssl\u8BC1\u4E66\u7533\u8BF7",children:"SSL\u8BC1\u4E66\u7533\u8BF7"}),"\n",(0,o.jsxs)(e.p,{children:["\u5173\u95ED",(0,o.jsx)(e.code,{children:"nginx"}),"\u670D\u52A1\uFF0C\u907F\u514D",(0,o.jsx)(e.code,{children:"80"}),"\u7AEF\u53E3\u5360\u7528\uFF0C\u968F\u540E\u901A\u8FC7\u4EE5\u4E0B\u547D\u4EE4\u7533\u8BF7",(0,o.jsx)(e.code,{children:"SSL"}),"\u8BC1\u4E66\uFF1A"]}),"\n",(0,o.jsx)(e.pre,{children:(0,o.jsx)(e.code,{className:"language-bash",children:"certbot certonly --standalone -d johng.cn --staple-ocsp -m john@johng.cn --agree-tos\ncertbot certonly --standalone -d www.johng.cn --staple-ocsp -m john@johng.cn --agree-tos\n"})}),"\n",(0,o.jsxs)(e.p,{children:["\u8FD9\u91CC\u7533\u8BF7\u4E86\u4E24\u4E2A\u57DF\u540D\u7684\u8BC1\u4E66\uFF0C\u5E26",(0,o.jsx)(e.code,{children:"www"}),"\u7684\u548C\u4E0D\u5E26",(0,o.jsx)(e.code,{children:"www"}),"\u7684\u3002"]}),"\n",(0,o.jsxs)(e.h3,{id:"\u914D\u7F6Enginx",children:["\u914D\u7F6E",(0,o.jsx)(e.code,{children:"nginx"})]}),"\n",(0,o.jsx)(e.p,{children:"\u914D\u7F6E\u6587\u4EF6\u5982\u4E0B\uFF1A"}),"\n",(0,o.jsx)(e.pre,{children:(0,o.jsx)(e.code,{className:"language-nginx",children:"# johng.cn:80 -> 443\nserver {\n    listen      80;\n    server_name johng.cn;\n    location / {\n        rewrite ^/(.*) https://johng.cn permanent;\n    }\n}\n\n\n# www.johng.cn:443\nserver {\n    listen      443;\n    server_name www.johng.cn;\n    ssl                       on;\n    ssl_certificate           /etc/letsencrypt/live/www.johng.cn/fullchain.pem;\n    ssl_certificate_key       /etc/letsencrypt/live/www.johng.cn/privkey.pem;\n    ssl_protocols             TLSv1 TLSv1.1 TLSv1.2;\n    ssl_prefer_server_ciphers on;\n\n    access_log   /var/log/nginx/www.johng.cn.access.log;\n    error_log    /var/log/nginx/www.johng.cn.error.log;\n\n    location / {\n        rewrite ^/(.*) https://johng.cn/$1 permanent;\n    }\n}\n\n# johng.cn:443\nserver {\n    listen      443;\n    server_name johng.cn;\n    ssl                       on;\n    ssl_certificate           /etc/letsencrypt/live/johng.cn/fullchain.pem;\n    ssl_certificate_key       /etc/letsencrypt/live/johng.cn/privkey.pem;\n    ssl_protocols             TLSv1 TLSv1.1 TLSv1.2;\n    ssl_prefer_server_ciphers on;\n\n    root  /home/www/johng.cn;\n    index index.html index.htm;\n    \n    access_log /var/log/nginx/johng.cn.access.log;\n    error_log  /var/log/nginx/johng.cn.error.log;\n\n    location ~ /\\.git {\n        deny all;\n        return 403;\n    }\n\n    location / {\n        try_files $uri $uri.html $uri/ =404;\n    }\n\n    location ~* \\.(jpg|jpeg|png|gif|ico|css|js)$ {\n        expires    30d;  \n        access_log off;\n    }\n\n    gzip on;\n    gzip_types text/css application/javascript application/x-javascript text/javascript;\n    gzip_min_length 1024;\n}\n"})}),"\n",(0,o.jsx)(e.h3,{id:"\u4FEE\u6539nginx\u8FD0\u884C\u7528\u6237",children:"\u4FEE\u6539nginx\u8FD0\u884C\u7528\u6237"}),"\n",(0,o.jsxs)(e.p,{children:["\u4FEE\u6539",(0,o.jsx)(e.code,{children:"nginx"}),"\u8FD0\u884C\u7528\u6237\uFF0C\u9ED8\u8BA4\u7528\u6237\u4E3A",(0,o.jsx)(e.code,{children:"www-data"}),"\uFF0C\u9700\u8981\u4FEE\u6539\u4E3A",(0,o.jsx)(e.code,{children:"root"}),"\uFF0C\u4E3A\u907F\u514D",(0,o.jsx)(e.code,{children:"nginx"}),"\u65E0\u6CD5\u8BBF\u95EE",(0,o.jsx)(e.code,{children:"/home/www/"}),"\u8DEF\u5F84\u4E0B\u7684\u7F51\u7AD9\u6587\u4EF6\uFF0C\u4F1A\u62A5\u9519",(0,o.jsx)(e.code,{children:"Permission denied"}),"\u3002"]}),"\n",(0,o.jsx)(e.pre,{children:(0,o.jsx)(e.code,{className:"language-nginx",metastring:'title="/etc/nginx/nginx.conf"',children:"user root;\nworker_processes auto;\npid /run/nginx.pid;\nerror_log /var/log/nginx/error.log;\ninclude /etc/nginx/modules-enabled/*.conf;\n\n# ...\n"})}),"\n",(0,o.jsx)(e.h3,{id:"\u914D\u7F6E\u5B9A\u65F6\u4EFB\u52A1",children:"\u914D\u7F6E\u5B9A\u65F6\u4EFB\u52A1"}),"\n",(0,o.jsxs)(e.p,{children:["\u914D\u7F6E\u5B9A\u65F6\u4EFB\u52A1\uFF0C\u81EA\u52A8\u4ECE",(0,o.jsx)(e.code,{children:"github"}),"\u62C9\u53D6\u6700\u65B0\u4EE3\u7801\uFF0C\u5E76\u4E14\u81EA\u52A8\u7EED\u671F",(0,o.jsx)(e.code,{children:"SSL"}),"\u8BC1\u4E66\u3002\u5B9A\u65F6\u4EFB\u52A1\u914D\u7F6E\u6587\u4EF6\u8DEF\u5F84",(0,o.jsx)(e.code,{children:"/etc/crontab"}),"\u3002"]}),"\n",(0,o.jsx)(e.pre,{children:(0,o.jsx)(e.code,{className:"language-ini",children:"# \u5B9A\u65F6\u62C9\u53D6\u6700\u65B0\u7684\u5B98\u7F51\u9759\u6001\u9875\u6784\u5EFA\u7ED3\u679C\n*/5 * * * * www cd /home/www/johng.cn && git pull origin gh-pages > ~/github-pull-johng.cn.log\n\n# \u6BCF\u5929\u5C1D\u8BD5\u7EED\u671F\u4E00\u6B21\uFF0C\u8BC1\u4E66\u7EED\u671F\u9700\u8981\u5148\u5173\u95ED80\u7AEF\u53E3\u7684WebServer\u76D1\u542C\n0 3 * * * root service nginx stop \n5 3 * * * root certbot renew --quiet\n8 3 * * * root service nginx start\n"})}),"\n",(0,o.jsxs)(e.p,{children:["\u5982\u679C\u6CA1\u6709\u542F\u52A8",(0,o.jsx)(e.code,{children:"cron"}),"\u670D\u52A1\u7684\u8BDD\uFF0C\u9700\u8981\u542F\u52A8",(0,o.jsx)(e.code,{children:"cron"}),"\u670D\u52A1\uFF1A"]}),"\n",(0,o.jsx)(e.pre,{children:(0,o.jsx)(e.code,{className:"language-bash",children:"service cron start\n"})})]})}function a(n={}){let{wrapper:e}={...(0,c.a)(),...n.components};return e?(0,o.jsx)(e,{...n,children:(0,o.jsx)(u,{...n})}):u(n)}},65364:function(n,e,s){s.d(e,{Z:function(){return i}});let i=s.p+"assets/images/image-8f49181fed5d53972a120338837a8a04.png"},50065:function(n,e,s){s.d(e,{Z:function(){return t},a:function(){return r}});var i=s(67294);let o={},c=i.createContext(o);function r(n){let e=i.useContext(c);return i.useMemo(function(){return"function"==typeof n?n(e):{...e,...n}},[e,n])}function t(n){let e;return e=n.disableParentContext?"function"==typeof n.components?n.components(o):n.components||o:r(n.components),i.createElement(c.Provider,{value:e},n.children)}}}]);