"use strict";(self.webpackChunkgf_site=self.webpackChunkgf_site||[]).push([["5614"],{21045:function(e,n,i){i.r(n),i.d(n,{metadata:()=>r,contentTitle:()=>l,default:()=>h,assets:()=>d,toc:()=>o,frontMatter:()=>a});var r=JSON.parse('{"id":"docs/AI\u6280\u672F/AI\u57FA\u7840\u67B6\u6784/NVIDIA/GPU MIG\u62C6\u5361\u540E\u4F7F\u7528docker\u6307\u5B9A\u5B50\u5361\u6267\u884C","title":"GPU MIG\u62C6\u5361\u540E\u4F7F\u7528docker\u6307\u5B9A\u5B50\u5361\u6267\u884C","description":"\u8BE6\u7EC6\u4ECB\u7ECDNVIDIA GPU\u901A\u8FC7MIG\u62C6\u5361\u540E\uFF0C\u5982\u4F55\u5728Docker\u5BB9\u5668\u4E2D\u6307\u5B9A\u7279\u5B9AMIG\u5B50\u5361\u6267\u884C\u4EFB\u52A1\u7684\u4E24\u79CD\u65B9\u6CD5\uFF1A\u901A\u8FC7docker device\u53C2\u6570\u548CNVIDIA_VISIBLE_DEVICES\u73AF\u5883\u53D8\u91CF\uFF0C\u652F\u6301UUID\u548C\u7D22\u5F15\u4E24\u79CD\u65B9\u5F0F","source":"@site/docs/docs/1000-AI\u6280\u672F/200-AI\u57FA\u7840\u67B6\u6784/100-NVIDIA/7500-GPU MIG\u62C6\u5361\u540E\u4F7F\u7528docker\u6307\u5B9A\u5B50\u5361\u6267\u884C.md","sourceDirName":"docs/1000-AI\u6280\u672F/200-AI\u57FA\u7840\u67B6\u6784/100-NVIDIA","slug":"/ai/gpu-mig-docker-specify-subcard","permalink":"/ai/gpu-mig-docker-specify-subcard","draft":false,"unlisted":false,"tags":[],"version":"current","sidebarPosition":7500,"frontMatter":{"slug":"/ai/gpu-mig-docker-specify-subcard","title":"GPU MIG\u62C6\u5361\u540E\u4F7F\u7528docker\u6307\u5B9A\u5B50\u5361\u6267\u884C","hide_title":true,"keywords":["GPU MIG","MIG\u62C6\u5361","docker","NVIDIA H200","\u5B50\u5361\u6307\u5B9A","NVIDIA_VISIBLE_DEVICES","MIG Manager","GPU\u865A\u62DF\u5316","\u5BB9\u5668GPU\u8C03\u5EA6","MIG UUID","MIG\u7D22\u5F15","nvidia-container-runtime"],"description":"\u8BE6\u7EC6\u4ECB\u7ECDNVIDIA GPU\u901A\u8FC7MIG\u62C6\u5361\u540E\uFF0C\u5982\u4F55\u5728Docker\u5BB9\u5668\u4E2D\u6307\u5B9A\u7279\u5B9AMIG\u5B50\u5361\u6267\u884C\u4EFB\u52A1\u7684\u4E24\u79CD\u65B9\u6CD5\uFF1A\u901A\u8FC7docker device\u53C2\u6570\u548CNVIDIA_VISIBLE_DEVICES\u73AF\u5883\u53D8\u91CF\uFF0C\u652F\u6301UUID\u548C\u7D22\u5F15\u4E24\u79CD\u65B9\u5F0F"},"sidebar":"mainSidebar","previous":{"title":"GPU Share MPS&MIG\u5177\u4F53\u64CD\u4F5C\u4E0E\u6CE8\u610F\u4E8B\u9879","permalink":"/ai/gpu-share-mps-mig"},"next":{"title":"GPU MIG\u62C6\u5361\u540EPod\u5076\u53D1Pending/Terminating\u72B6\u6001\u963B\u585E\u95EE\u9898\u6392\u67E5","permalink":"/ai/gpu-mig-pod-pending-terminating-troubleshooting"}}'),s=i("85893"),c=i("50065");let a={slug:"/ai/gpu-mig-docker-specify-subcard",title:"GPU MIG\u62C6\u5361\u540E\u4F7F\u7528docker\u6307\u5B9A\u5B50\u5361\u6267\u884C",hide_title:!0,keywords:["GPU MIG","MIG\u62C6\u5361","docker","NVIDIA H200","\u5B50\u5361\u6307\u5B9A","NVIDIA_VISIBLE_DEVICES","MIG Manager","GPU\u865A\u62DF\u5316","\u5BB9\u5668GPU\u8C03\u5EA6","MIG UUID","MIG\u7D22\u5F15","nvidia-container-runtime"],description:"\u8BE6\u7EC6\u4ECB\u7ECDNVIDIA GPU\u901A\u8FC7MIG\u62C6\u5361\u540E\uFF0C\u5982\u4F55\u5728Docker\u5BB9\u5668\u4E2D\u6307\u5B9A\u7279\u5B9AMIG\u5B50\u5361\u6267\u884C\u4EFB\u52A1\u7684\u4E24\u79CD\u65B9\u6CD5\uFF1A\u901A\u8FC7docker device\u53C2\u6570\u548CNVIDIA_VISIBLE_DEVICES\u73AF\u5883\u53D8\u91CF\uFF0C\u652F\u6301UUID\u548C\u7D22\u5F15\u4E24\u79CD\u65B9\u5F0F"},l=void 0,d={},o=[{value:"1. \u80CC\u666F\u4ECB\u7ECD",id:"1-\u80CC\u666F\u4ECB\u7ECD",level:2},{value:"2. \u89E3\u51B3\u65B9\u6848",id:"2-\u89E3\u51B3\u65B9\u6848",level:2},{value:"2.1 \u4F7F\u7528\u955C\u50CF",id:"21-\u4F7F\u7528\u955C\u50CF",level:3},{value:"2.2 \u6307\u5B9Aruntime",id:"22-\u6307\u5B9Aruntime",level:3},{value:"2.3 \u6307\u5B9A\u4F7F\u7528MIG\u5B50\u5361",id:"23-\u6307\u5B9A\u4F7F\u7528mig\u5B50\u5361",level:3},{value:"2.3.1 \u901A\u8FC7docker device\u6307\u5B9A\u5B50\u5361",id:"231-\u901A\u8FC7docker-device\u6307\u5B9A\u5B50\u5361",level:4},{value:"2.3.1.1 \u901A\u8FC7\u6307\u5B9AUUID",id:"2311-\u901A\u8FC7\u6307\u5B9Auuid",level:5},{value:"2.3.1.2 \u901A\u8FC7\u6307\u5B9A\u5B50\u5361\u7D22\u5F15",id:"2312-\u901A\u8FC7\u6307\u5B9A\u5B50\u5361\u7D22\u5F15",level:5},{value:"2.3.2 \u901A\u8FC7\u73AF\u5883\u53D8\u91CF\u6307\u5B9A\u5B50\u5361",id:"232-\u901A\u8FC7\u73AF\u5883\u53D8\u91CF\u6307\u5B9A\u5B50\u5361",level:3},{value:"2.3.2.1 \u901A\u8FC7\u6307\u5B9AUUID",id:"2321-\u901A\u8FC7\u6307\u5B9Auuid",level:4},{value:"2.3.2.2 \u901A\u8FC7\u6307\u5B9A\u5B50\u5361\u7D22\u5F15",id:"2322-\u901A\u8FC7\u6307\u5B9A\u5B50\u5361\u7D22\u5F15",level:4},{value:"3. \u76F8\u5173\u95EE\u9898",id:"3-\u76F8\u5173\u95EE\u9898",level:2},{value:"3.1 sglang v0.4.9.post4\u4EE5\u4E0B\u7248\u672C\u4E0D\u652F\u6301\u6307\u5B9AMIG\u5B50\u5361",id:"31-sglang-v049post4\u4EE5\u4E0B\u7248\u672C\u4E0D\u652F\u6301\u6307\u5B9Amig\u5B50\u5361",level:3},{value:"3.1.1 \u95EE\u9898\u63CF\u8FF0",id:"311-\u95EE\u9898\u63CF\u8FF0",level:4},{value:"3.1.2 \u95EE\u9898\u539F\u56E0",id:"312-\u95EE\u9898\u539F\u56E0",level:4},{value:"3.1.3 \u9A8C\u8BC1\u65B9\u5F0F",id:"313-\u9A8C\u8BC1\u65B9\u5F0F",level:4},{value:"3.1.4 \u89E3\u51B3\u65B9\u6848",id:"314-\u89E3\u51B3\u65B9\u6848",level:4}];function t(e){let n={a:"a",code:"code",h2:"h2",h3:"h3",h4:"h4",h5:"h5",img:"img",li:"li",ol:"ol",p:"p",pre:"pre",ul:"ul",...(0,c.a)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.h2,{id:"1-\u80CC\u666F\u4ECB\u7ECD",children:"1. \u80CC\u666F\u4ECB\u7ECD"}),"\n",(0,s.jsxs)(n.p,{children:["\u5BF9",(0,s.jsx)(n.code,{children:"H200"}),"\u8FDB\u884C",(0,s.jsx)(n.code,{children:"MIG"}),"\u62C6\u5361\uFF0C\u62C6\u5206\u4E3A",(0,s.jsx)(n.code,{children:"1"}),"\u5F20",(0,s.jsx)(n.code,{children:"2g35gb"}),"\uFF0C",(0,s.jsx)(n.code,{children:"5"}),"\u5F20",(0,s.jsx)(n.code,{children:"1g18gb"}),"\uFF0C\u62C6\u5361\u5DF2\u7ECF\u901A\u8FC7",(0,s.jsx)(n.code,{children:"Kubernetes MIG Manager"}),"\u5B9E\u73B0\u3002\u5728\u8282\u70B9\u4E0A\u4F7F\u7528",(0,s.jsx)(n.code,{children:"nvidia-smi -L"}),"\u67E5\u770B\uFF0C\u5982\u4E0B\uFF1A"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"$ nvidia-smi -L\nGPU 0: NVIDIA H200 (UUID: GPU-b2acda36-db78-a209-f9ef-d07b4336c449)\n  MIG 2g.35gb     Device  0: (UUID: MIG-b05c0034-4d0e-5d3c-a25c-e6795d1779df)\n  MIG 1g.18gb     Device  1: (UUID: MIG-be041b89-b751-5c96-84aa-85315833c669)\n  MIG 1g.18gb     Device  2: (UUID: MIG-605bf89c-7be6-586e-a729-a2369e833b3e)\n  MIG 1g.18gb     Device  3: (UUID: MIG-02b4e55e-29a1-5d28-b9ee-8e9445e355f0)\n  MIG 1g.18gb     Device  4: (UUID: MIG-dc7ad5d3-20d8-5dcb-adf7-fb22c2459352)\n  MIG 1g.18gb     Device  5: (UUID: MIG-148a1759-0dd2-59c6-9605-26206ae0e79b)\nGPU 1: NVIDIA H200 (UUID: GPU-af5e38ec-d1d6-1c20-67c8-c8001109e6d8)\nGPU 2: NVIDIA H200 (UUID: GPU-da9f3cba-5f87-5830-26d6-b3f5a545ae34)\nGPU 3: NVIDIA H200 (UUID: GPU-f2c60745-001d-1948-52bb-c9616b34da97)\nGPU 4: NVIDIA H200 (UUID: GPU-7b8f55d1-e1d9-30a2-590b-3eff9b86ae05)\nGPU 5: NVIDIA H200 (UUID: GPU-a73089ba-c8f9-f9dc-bd1e-9da99cb2104b)\nGPU 6: NVIDIA H200 (UUID: GPU-4e19f7d9-e5d6-1223-e9d2-983f01ef45f6)\nGPU 7: NVIDIA H200 (UUID: GPU-5b73e21c-9b5d-4156-8b8d-aed96f9f8d86)\n"})}),"\n",(0,s.jsx)(n.h2,{id:"2-\u89E3\u51B3\u65B9\u6848",children:"2. \u89E3\u51B3\u65B9\u6848"}),"\n",(0,s.jsxs)(n.p,{children:["\u53C2\u8003\u5B98\u65B9\u6587\u6863\uFF1A",(0,s.jsx)(n.a,{href:"https://docs.nvidia.com/datacenter/cloud-native/container-toolkit/latest/docker-specialized.html",children:"https://docs.nvidia.com/datacenter/cloud-native/container-toolkit/latest/docker-specialized.html"})]}),"\n",(0,s.jsx)(n.h3,{id:"21-\u4F7F\u7528\u955C\u50CF",children:"2.1 \u4F7F\u7528\u955C\u50CF"}),"\n",(0,s.jsxs)(n.p,{children:["\u8FD9\u91CC\u4F7F\u7528\u5230\u4E86\u516C\u53F8\u6D4B\u8BD5\u73AF\u5883\u7684\u5185\u7F51\u955C\u50CF\uFF1A",(0,s.jsx)(n.code,{children:"aiharbor.msxf.local/test/sglang:0.4.8.post1-cu128"}),"\n\u5982\u679C\u9700\u8981\u4F7F\u7528\u516C\u7F51\u955C\u50CF\uFF0C\u90A3\u4E48\u53EF\u4EE5\u4F7F\u7528",(0,s.jsx)(n.code,{children:"nvidia"}),"\u5B98\u65B9\u63D0\u4F9B\u7684\u955C\u50CF\uFF1A",(0,s.jsx)(n.code,{children:"nvidia/cuda"})]}),"\n",(0,s.jsx)(n.h3,{id:"22-\u6307\u5B9Aruntime",children:"2.2 \u6307\u5B9Aruntime"}),"\n",(0,s.jsxs)(n.p,{children:["\u9996\u5148\u9700\u8981\u4FDD\u8BC1",(0,s.jsx)(n.code,{children:"docker"}),"\u7684",(0,s.jsx)(n.code,{children:"runtime"}),"\u914D\u7F6E\u4E3A",(0,s.jsx)(n.code,{children:"nvidia"}),"\uFF1A"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:'$ cat /etc/docker/daemon.json\n  {\n      "bip":"192.168.99.1/16",\n      "exec-opts": ["native.cgroupdriver=cgroupfs"],\n      "default-runtime":"nvidia",\n      "runtimes": {\n          "nvidia": {\n              "path": "/usr/bin/nvidia-container-runtime",\n              "runtimeArgs": []\n          }\n      },\n          "data-root": "/home/docker/data",\n          "insecure-registries": ["harbor.maip.io","aiharbor.msxf.local"],\n          "experimental": true,\n          "live-restore": true\n  }\n'})}),"\n",(0,s.jsxs)(n.p,{children:["\u5982\u679C\u6CA1\u6709\u914D\u7F6E",(0,s.jsx)(n.code,{children:"default-runtime"}),"\u4E3A",(0,s.jsx)(n.code,{children:"nvidia"}),"\uFF0C\u90A3\u4E48\u5728",(0,s.jsx)(n.code,{children:"docker"}),"\u6267\u884C\u547D\u4EE4\u4E2D\u9700\u8981\u589E\u52A0\u6307\u5B9A",(0,s.jsx)(n.code,{children:"runtime"}),"\u7684\u53C2\u6570\uFF0C\u4F8B\u5982\uFF1A"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"docker run --rm --runtime=nvidia -e NVIDIA_VISIBLE_DEVICES=2,3 aiharbor.msxf.local/test/sglang:0.4.8.post1-cu128 nvidia-smi\n"})}),"\n",(0,s.jsx)(n.h3,{id:"23-\u6307\u5B9A\u4F7F\u7528mig\u5B50\u5361",children:"2.3 \u6307\u5B9A\u4F7F\u7528MIG\u5B50\u5361"}),"\n",(0,s.jsx)(n.h4,{id:"231-\u901A\u8FC7docker-device\u6307\u5B9A\u5B50\u5361",children:"2.3.1 \u901A\u8FC7docker device\u6307\u5B9A\u5B50\u5361"}),"\n",(0,s.jsxs)(n.p,{children:["\u6307\u5B9A\u5B50\u5361\u6267\u884C",(0,s.jsx)(n.code,{children:"docker"}),"\u955C\u50CF\u3002\u53EF\u4EE5\u901A\u8FC7\u5B50\u5361\u7684",(0,s.jsx)(n.code,{children:"UUID"}),"\u6216\u8005",(0,s.jsx)(n.code,{children:"\u7D22\u5F15\u53F7"}),"\u6765\u6307\u5B9A\u3002"]}),"\n",(0,s.jsx)(n.h5,{id:"2311-\u901A\u8FC7\u6307\u5B9Auuid",children:"2.3.1.1 \u901A\u8FC7\u6307\u5B9AUUID"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"docker run --rm --gpus device=MIG-b05c0034-4d0e-5d3c-a25c-e6795d1779df aiharbor.msxf.local/test/sglang:0.4.8.post1-cu128 nvidia-smi\n"})}),"\n",(0,s.jsx)(n.p,{children:"\u6267\u884C\u540E\uFF0C\u7EC8\u7AEF\u8F93\u51FA\uFF1A"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-text",children:"Mon Jul 28 01:58:33 2025\n+-----------------------------------------------------------------------------------------+\n| NVIDIA-SMI 570.86.15              Driver Version: 570.86.15      CUDA Version: 12.8     |\n|-----------------------------------------+------------------------+----------------------+\n| GPU  Name                 Persistence-M | Bus-Id          Disp.A | Volatile Uncorr. ECC |\n| Fan  Temp   Perf          Pwr:Usage/Cap |           Memory-Usage | GPU-Util  Compute M. |\n|                                         |                        |               MIG M. |\n|=========================================+========================+======================|\n|   0  NVIDIA H200                    Off |   00000000:2A:00.0 Off |                   On |\n| N/A   30C    P0             76W /  700W |                  N/A   |     N/A      Default |\n|                                         |                        |              Enabled |\n+-----------------------------------------+------------------------+----------------------+\n\n+-----------------------------------------------------------------------------------------+\n| MIG devices:                                                                            |\n+------------------+----------------------------------+-----------+-----------------------+\n| GPU  GI  CI  MIG |                     Memory-Usage |        Vol|        Shared         |\n|      ID  ID  Dev |                       BAR1-Usage | SM     Unc| CE ENC  DEC  OFA  JPG |\n|                  |                                  |        ECC|                       |\n|==================+==================================+===========+=======================|\n|  0    5   0   0  |              29MiB / 33280MiB    | 32      0 |  2   0    2    0    2 |\n|                  |                 0MiB / 65535MiB  |           |                       |\n+------------------+----------------------------------+-----------+-----------------------+\n\n+-----------------------------------------------------------------------------------------+\n| Processes:                                                                              |\n|  GPU   GI   CI              PID   Type   Process name                        GPU Memory |\n|        ID   ID                                                               Usage      |\n|=========================================================================================|\n|  No running processes found                                                             |\n+-----------------------------------------------------------------------------------------+\n"})}),"\n",(0,s.jsx)(n.h5,{id:"2312-\u901A\u8FC7\u6307\u5B9A\u5B50\u5361\u7D22\u5F15",children:"2.3.1.2 \u901A\u8FC7\u6307\u5B9A\u5B50\u5361\u7D22\u5F15"}),"\n",(0,s.jsx)(n.p,{children:"\u6CE8\u610F\u8FD9\u91CC\u6307\u5B9A\u7684\u5B50\u5361\u7D22\u5F15:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"docker run --rm --gpus '\"device=0:0,0:1\"' aiharbor.msxf.local/test/sglang:0.4.8.post1-cu128 nvidia-smi\n"})}),"\n",(0,s.jsx)(n.p,{children:"\u6267\u884C\u540E\uFF0C\u7EC8\u7AEF\u8F93\u51FA\uFF1A"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-text",children:"Mon Jul 28 02:00:04 2025\n+-----------------------------------------------------------------------------------------+\n| NVIDIA-SMI 570.86.15              Driver Version: 570.86.15      CUDA Version: 12.8     |\n|-----------------------------------------+------------------------+----------------------+\n| GPU  Name                 Persistence-M | Bus-Id          Disp.A | Volatile Uncorr. ECC |\n| Fan  Temp   Perf          Pwr:Usage/Cap |           Memory-Usage | GPU-Util  Compute M. |\n|                                         |                        |               MIG M. |\n|=========================================+========================+======================|\n|   0  NVIDIA H200                    Off |   00000000:2A:00.0 Off |                   On |\n| N/A   31C    P0             76W /  700W |                  N/A   |     N/A      Default |\n|                                         |                        |              Enabled |\n+-----------------------------------------+------------------------+----------------------+\n\n+-----------------------------------------------------------------------------------------+\n| MIG devices:                                                                            |\n+------------------+----------------------------------+-----------+-----------------------+\n| GPU  GI  CI  MIG |                     Memory-Usage |        Vol|        Shared         |\n|      ID  ID  Dev |                       BAR1-Usage | SM     Unc| CE ENC  DEC  OFA  JPG |\n|                  |                                  |        ECC|                       |\n|==================+==================================+===========+=======================|\n|  0    5   0   0  |              29MiB / 33280MiB    | 32      0 |  2   0    2    0    2 |\n|                  |                 0MiB / 65535MiB  |           |                       |\n+------------------+----------------------------------+-----------+-----------------------+\n|  0    7   0   1  |              15MiB / 16384MiB    | 16      0 |  1   0    1    0    1 |\n|                  |                 0MiB / 32767MiB  |           |                       |\n+------------------+----------------------------------+-----------+-----------------------+\n\n+-----------------------------------------------------------------------------------------+\n| Processes:                                                                              |\n|  GPU   GI   CI              PID   Type   Process name                        GPU Memory |\n|        ID   ID                                                               Usage      |\n|=========================================================================================|\n|  No running processes found                                                             |\n+-----------------------------------------------------------------------------------------+\n"})}),"\n",(0,s.jsx)(n.h3,{id:"232-\u901A\u8FC7\u73AF\u5883\u53D8\u91CF\u6307\u5B9A\u5B50\u5361",children:"2.3.2 \u901A\u8FC7\u73AF\u5883\u53D8\u91CF\u6307\u5B9A\u5B50\u5361"}),"\n",(0,s.jsxs)(n.p,{children:["\u4E5F\u53EF\u4EE5\u901A\u8FC7",(0,s.jsx)(n.code,{children:"NVIDIA_VISIBLE_DEVICES"}),"\u73AF\u5883\u53D8\u91CF\u6765\u6307\u5B9A\u4F7F\u7528\u7684\u5B50\u5361\uFF0C\u5F53\u7136\u8BE5\u73AF\u5883\u53D8\u91CF\u4E5F\u652F\u6301\u4F7F\u7528\u5B50\u5361\u7684",(0,s.jsx)(n.code,{children:"UUID"}),"\u6216\u8005",(0,s.jsx)(n.code,{children:"\u7D22\u5F15\u53F7"}),"\u3002"]}),"\n",(0,s.jsx)(n.h4,{id:"2321-\u901A\u8FC7\u6307\u5B9Auuid",children:"2.3.2.1 \u901A\u8FC7\u6307\u5B9AUUID"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"docker run -e NVIDIA_VISIBLE_DEVICES=MIG-b05c0034-4d0e-5d3c-a25c-e6795d1779df,MIG-be041b89-b751-5c96-84aa-85315833c669 aiharbor.msxf.local/test/sglang:0.4.8.post1-cu128 nvidia-smi\n"})}),"\n",(0,s.jsx)(n.p,{children:"\u6267\u884C\u540E\uFF0C\u7EC8\u7AEF\u8F93\u51FA\uFF1A"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-text",children:"Mon Jul 28 02:04:51 2025\n+-----------------------------------------------------------------------------------------+\n| NVIDIA-SMI 570.86.15              Driver Version: 570.86.15      CUDA Version: 12.8     |\n|-----------------------------------------+------------------------+----------------------+\n| GPU  Name                 Persistence-M | Bus-Id          Disp.A | Volatile Uncorr. ECC |\n| Fan  Temp   Perf          Pwr:Usage/Cap |           Memory-Usage | GPU-Util  Compute M. |\n|                                         |                        |               MIG M. |\n|=========================================+========================+======================|\n|   0  NVIDIA H200                    Off |   00000000:2A:00.0 Off |                   On |\n| N/A   31C    P0             77W /  700W |                  N/A   |     N/A      Default |\n|                                         |                        |              Enabled |\n+-----------------------------------------+------------------------+----------------------+\n\n+-----------------------------------------------------------------------------------------+\n| MIG devices:                                                                            |\n+------------------+----------------------------------+-----------+-----------------------+\n| GPU  GI  CI  MIG |                     Memory-Usage |        Vol|        Shared         |\n|      ID  ID  Dev |                       BAR1-Usage | SM     Unc| CE ENC  DEC  OFA  JPG |\n|                  |                                  |        ECC|                       |\n|==================+==================================+===========+=======================|\n|  0    5   0   0  |              29MiB / 33280MiB    | 32      0 |  2   0    2    0    2 |\n|                  |                 0MiB / 65535MiB  |           |                       |\n+------------------+----------------------------------+-----------+-----------------------+\n|  0    7   0   1  |              15MiB / 16384MiB    | 16      0 |  1   0    1    0    1 |\n|                  |                 0MiB / 32767MiB  |           |                       |\n+------------------+----------------------------------+-----------+-----------------------+\n\n+-----------------------------------------------------------------------------------------+\n| Processes:                                                                              |\n|  GPU   GI   CI              PID   Type   Process name                        GPU Memory |\n|        ID   ID                                                               Usage      |\n|=========================================================================================|\n|  No running processes found                                                             |\n+-----------------------------------------------------------------------------------------+\n"})}),"\n",(0,s.jsx)(n.h4,{id:"2322-\u901A\u8FC7\u6307\u5B9A\u5B50\u5361\u7D22\u5F15",children:"2.3.2.2 \u901A\u8FC7\u6307\u5B9A\u5B50\u5361\u7D22\u5F15"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"docker run -e NVIDIA_VISIBLE_DEVICES=0:0,0:1 aiharbor.msxf.local/test/sglang:0.4.8.post1-cu128 nvidia-smi\n"})}),"\n",(0,s.jsx)(n.p,{children:"\u6267\u884C\u540E\uFF0C\u7EC8\u7AEF\u8F93\u51FA\uFF1A"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-text",children:"Mon Jul 28 02:02:51 2025\n+-----------------------------------------------------------------------------------------+\n| NVIDIA-SMI 570.86.15              Driver Version: 570.86.15      CUDA Version: 12.8     |\n|-----------------------------------------+------------------------+----------------------+\n| GPU  Name                 Persistence-M | Bus-Id          Disp.A | Volatile Uncorr. ECC |\n| Fan  Temp   Perf          Pwr:Usage/Cap |           Memory-Usage | GPU-Util  Compute M. |\n|                                         |                        |               MIG M. |\n|=========================================+========================+======================|\n|   0  NVIDIA H200                    Off |   00000000:2A:00.0 Off |                   On |\n| N/A   31C    P0             76W /  700W |                  N/A   |     N/A      Default |\n|                                         |                        |              Enabled |\n+-----------------------------------------+------------------------+----------------------+\n\n+-----------------------------------------------------------------------------------------+\n| MIG devices:                                                                            |\n+------------------+----------------------------------+-----------+-----------------------+\n| GPU  GI  CI  MIG |                     Memory-Usage |        Vol|        Shared         |\n|      ID  ID  Dev |                       BAR1-Usage | SM     Unc| CE ENC  DEC  OFA  JPG |\n|                  |                                  |        ECC|                       |\n|==================+==================================+===========+=======================|\n|  0    5   0   0  |              29MiB / 33280MiB    | 32      0 |  2   0    2    0    2 |\n|                  |                 0MiB / 65535MiB  |           |                       |\n+------------------+----------------------------------+-----------+-----------------------+\n|  0    7   0   1  |              15MiB / 16384MiB    | 16      0 |  1   0    1    0    1 |\n|                  |                 0MiB / 32767MiB  |           |                       |\n+------------------+----------------------------------+-----------+-----------------------+\n\n+-----------------------------------------------------------------------------------------+\n| Processes:                                                                              |\n|  GPU   GI   CI              PID   Type   Process name                        GPU Memory |\n|        ID   ID                                                               Usage      |\n|=========================================================================================|\n|  No running processes found                                                             |\n+-----------------------------------------------------------------------------------------+\n"})}),"\n",(0,s.jsx)(n.h2,{id:"3-\u76F8\u5173\u95EE\u9898",children:"3. \u76F8\u5173\u95EE\u9898"}),"\n",(0,s.jsx)(n.h3,{id:"31-sglang-v049post4\u4EE5\u4E0B\u7248\u672C\u4E0D\u652F\u6301\u6307\u5B9Amig\u5B50\u5361",children:"3.1 sglang v0.4.9.post4\u4EE5\u4E0B\u7248\u672C\u4E0D\u652F\u6301\u6307\u5B9AMIG\u5B50\u5361"}),"\n",(0,s.jsx)(n.h4,{id:"311-\u95EE\u9898\u63CF\u8FF0",children:"3.1.1 \u95EE\u9898\u63CF\u8FF0"}),"\n",(0,s.jsxs)(n.p,{children:["\u5C1D\u8BD5\u5728",(0,s.jsx)(n.code,{children:"H200"}),"\u7684\u8282\u70B9\u4E0A\u6307\u5B9A",(0,s.jsx)(n.code,{children:"MIG"}),"\u5B50\u5361\uFF0C\u6267\u884C\u4EE5\u4E0B\u547D\u4EE4\u8FD0\u884C\u63A8\u7406\u670D\u52A1\uFF1A"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"docker run -it --rm \\\n--name Qwen2.5-7b-fp8 \\\n--gpus='\"device=MIG-b05c0034-4d0e-5d3c-a25c-e6795d1779df\"' \\\n-v /share:/share \\\n-p 9800:8000 \\\naiharbor.msxf.local/test/sglang:0.4.8.post1-cu128 \\\npython3 -m sglang.launch_server \\\n        --model-path /share/global/models/Qwen2.5-7B-Instruct/ \\\n        --host 0.0.0.0 \\\n        --port 8000 \\\n        --disable-radix-cache \\\n        --served-model-name Qwen2.5-7b-fp8 \\\n        --tensor-parallel-size 1 \\\n        --quantization fp8 \\\n        --dtype auto\n"})}),"\n",(0,s.jsx)(n.p,{children:"\u6267\u884C\u540E\uFF0C\u5C06\u4F1A\u51FA\u73B0\u62A5\u9519\uFF1A"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-text",children:'2025-07-28 06:24:08.068 | INFO     | vllm.platforms:resolve_current_platform_cls_qualname:244 - Automatically detected platform cuda.\n/tmp/pinpointdxbgbm_2\nTraceback (most recent call last):\n  File "<frozen runpy>", line 198, in _run_module_as_main\n  File "<frozen runpy>", line 88, in _run_code\n  File "/usr/local/python3/lib/python3.12/site-packages/sglang/launch_server.py", line 16, in <module>\n    server_args = prepare_server_args(sys.argv[1:])\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/python3/lib/python3.12/site-packages/sglang/srt/server_args.py", line 1689, in prepare_server_args\n    server_args = ServerArgs.from_cli_args(raw_args)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/python3/lib/python3.12/site-packages/sglang/srt/server_args.py", line 1632, in from_cli_args\n    return cls(**{attr: getattr(args, attr) for attr in attrs})\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "<string>", line 165, in __init__\n  File "/usr/local/python3/lib/python3.12/site-packages/sglang/srt/server_args.py", line 273, in __post_init__\n    gpu_mem = get_device_memory_capacity(self.device)\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/python3/lib/python3.12/site-packages/sglang/srt/utils.py", line 1316, in get_device_memory_capacity\n    gpu_mem = get_nvgpu_memory_capacity()\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/python3/lib/python3.12/site-packages/sglang/srt/utils.py", line 1263, in get_nvgpu_memory_capacity\n    raise ValueError("No GPU memory values found.")\nValueError: No GPU memory values found.\n'})}),"\n",(0,s.jsx)(n.h4,{id:"312-\u95EE\u9898\u539F\u56E0",children:"3.1.2 \u95EE\u9898\u539F\u56E0"}),"\n",(0,s.jsxs)(n.p,{children:["\u6839\u636E\u793E\u533A\u68C0\u7D22\u548C\u6E90\u7801\u6392\u67E5\uFF0C\u6700\u7EC8\u786E\u5B9A\u95EE\u9898\u51FA\u5728",(0,s.jsx)(n.code,{children:"sglang"}),"\u4E0A\uFF0C\u76F8\u5173\u8FDE\u63A5\uFF1A",(0,s.jsx)(n.a,{href:"https://github.com/sgl-project/sglang/pull/8167",children:"https://github.com/sgl-project/sglang/pull/8167"})]}),"\n",(0,s.jsxs)(n.p,{children:["\u95EE\u9898\u539F\u56E0\u662F",(0,s.jsx)(n.code,{children:"sglang"}),"\u5F53\u524D\u7248\u672C\uFF08",(0,s.jsx)(n.code,{children:"v0.4.8"}),"\uFF09\u9ED8\u8BA4\u901A\u8FC7\u547D\u4EE4\u884C\u7684\u65B9\u5F0F\u53BB\u83B7\u53D6",(0,s.jsx)(n.code,{children:"GPU"}),"\u5361\u7684\u5185\u5B58\u4FE1\u606F\uFF0C\u7136\u540E\u6574\u5361\u7684\u5185\u5B58\u83B7\u53D6\u548C",(0,s.jsx)(n.code,{children:"MIG"}),"\u5B50\u5361\u7684\u5185\u5B58\u83B7\u53D6\u65B9\u5F0F\u4F1A\u4E0D\u592A\u4E00\u6837\uFF0C\u5177\u4F53\u6E90\u7801\u5728\u8FD9\u91CC\uFF1A",(0,s.jsx)(n.a,{href:"https://github.com/sgl-project/sglang/blob/7c3a12c0002e33fed1e72f4157e74a64a998f251/python/sglang/srt/utils.py#L1235",children:"https://github.com/sgl-project/sglang/blob/7c3a12c0002e33fed1e72f4157e74a64a998f251/python/sglang/srt/utils.py#L1235"})]}),"\n",(0,s.jsxs)(n.p,{children:["\u8FD9\u79CD\u663E\u5B58\u83B7\u53D6\u65B9\u5F0F\u6BD4\u8F83\u539F\u59CB\uFF0C\u901A\u8FC7\u547D\u4EE4\u884C\u5B50\u8FDB\u7A0B\u7684\u65B9\u5F0F\u83B7\u53D6\uFF0C\u611F\u89C9\u8FD9\u91CC",(0,s.jsx)(n.code,{children:"sglang"}),"\u7684\u6E90\u7801\u53EF\u4EE5\u6539\u8FDB\u4E0B\uFF0C\u901A\u8FC7",(0,s.jsx)(n.code,{children:"nvml"}),"\u83B7\u53D6\u9760\u8C31\u4E00\u4E9B\u3002"]}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.img,{alt:"alt text",src:i(62165).Z+"",width:"1918",height:"1218"})}),"\n",(0,s.jsx)(n.h4,{id:"313-\u9A8C\u8BC1\u65B9\u5F0F",children:"3.1.3 \u9A8C\u8BC1\u65B9\u5F0F"}),"\n",(0,s.jsxs)(n.p,{children:["\u6839\u636E\u6E90\u7801\u5206\u6790\uFF0C\u5F53\u524D",(0,s.jsx)(n.code,{children:"sglang"}),"\u7248\u672C\u4E5F\u5C31\u662F\u901A\u8FC7\u4EE5\u4E0B\u65B9\u5F0F\u83B7\u53D6\u663E\u5B58\u5927\u5C0F\uFF1A"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"docker run --rm --gpus '\"device=MIG-b05c0034-4d0e-5d3c-a25c-e6795d1779df\"'  aiharbor.msxf.local/test/sglang:0.4.8.post1-cu128 nvidia-smi --query-gpu=memory.total --format=csv,noheader,nounits\n"})}),"\n",(0,s.jsxs)(n.p,{children:["\u5F53\u76F4\u63A5\u5C06\u8BE5\u547D\u4EE4\u5728\u8282\u70B9\u4E0A\u6267\u884C\u540E\uFF0C\u7EC8\u7AEF\u4F1A\u8F93\u51FA",(0,s.jsx)(n.code,{children:"Insufficient Permissions"}),"\u7684\u9519\u8BEF\uFF0C\u56E0\u6B64",(0,s.jsx)(n.code,{children:"sglang"}),"\u6E90\u7801\u4E2D\u83B7\u53D6\u663E\u5B58\u4E5F\u5C31\u5931\u8D25\u4E86\uFF0C\u76F4\u63A5\u9000\u51FA\u6267\u884C\u3002"]}),"\n",(0,s.jsxs)(n.p,{children:["\u53EF\u4EE5\u901A\u8FC7\u4EE5\u4E0B\u65B9\u5F0F\u9A8C\u8BC1",(0,s.jsx)(n.code,{children:"Github"}),"\u4E0A",(0,s.jsx)(n.code,{children:"PR"}),"\u65B9\u6848\u7684\u53EF\u884C\u6027\uFF1A"]}),"\n",(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsxs)(n.li,{children:["\u624B\u52A8\u6267\u884C\u8FDB\u5165\u5BB9\u5668","\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"docker run -it --rm --gpus '\"device=MIG-b05c0034-4d0e-5d3c-a25c-e6795d1779df\"' aiharbor.msxf.local/test/sglang:0.4.8.post1-cu128 bash \n"})}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\u6267\u884C\u4EE5\u4E0B",(0,s.jsx)(n.code,{children:"python"}),"\u811A\u672C\u9A8C\u8BC1","\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-python",children:"python3 -c \"\nimport torch\nprint('CUDA available:', torch.cuda.is_available())\nprint('Device count:', torch.cuda.device_count())\nif torch.cuda.is_available():\n    print('Device name:', torch.cuda.get_device_name(0))\n    print('Memory:', torch.cuda.get_device_properties(0).total_memory / 1024**3, 'GB')\n\"\n"})}),"\n","\u7EC8\u7AEF\u8F93\u51FA\uFF1A","\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-text",children:"CUDA available: True\nDevice count: 1\nDevice name: NVIDIA H200 MIG 2g.35gb\nMemory: 32.5 GB\n"})}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\u4E5F\u53EF\u4EE5\u901A\u8FC7\u53E6\u5916",(0,s.jsx)(n.code,{children:"python"}),"\u811A\u672C\u9A8C\u8BC1\uFF0C\u8BE5\u811A\u672C\u5B9E\u73B0\u65B9\u5F0F\u6765\u6E90\u4E8E",(0,s.jsx)(n.code,{children:"PR"}),"\u63D0\u4EA4\u5185\u5BB9","\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-python",children:"python3 -c \"\nimport torch\nprint('CUDA available:', torch.cuda.is_available())\nprint('Device count:', torch.cuda.device_count())\nif torch.cuda.is_available():\n    print('Device name:', torch.cuda.get_device_name(0))\n    print('Memory:', torch.cuda.mem_get_info()[1] / 1024**3, 'GB')\n\"\n"})}),"\n","\u7EC8\u7AEF\u8F93\u51FA\uFF1A","\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-text",children:"CUDA available: True\nDevice count: 1\nDevice name: NVIDIA H200 MIG 2g.35gb\nMemory: 32.5 GB\n"})}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(n.h4,{id:"314-\u89E3\u51B3\u65B9\u6848",children:"3.1.4 \u89E3\u51B3\u65B9\u6848"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["\u3010\u63A8\u8350\u3011\u5347\u7EA7\u4F7F\u7528\u7684",(0,s.jsx)(n.code,{children:"sglang"}),"\u7248\u672C\u5230",(0,s.jsx)(n.code,{children:"v0.4.9.post4"}),"\u6216\u4EE5\u4E0A\u89E3\u51B3\u8BE5\u95EE\u9898\u3002"]}),"\n",(0,s.jsxs)(n.li,{children:["\u8003\u8651\u5207\u6362\u5230",(0,s.jsx)(n.code,{children:"vllm"}),"\u6846\u67B6\uFF0C\u5E76\u53C2\u8003",(0,s.jsx)(n.code,{children:"vllm"}),"\u6846\u67B6\u89E3\u51B3\u65B9\u6848\u3002"]}),"\n"]})]})}function h(e={}){let{wrapper:n}={...(0,c.a)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(t,{...e})}):t(e)}},62165:function(e,n,i){i.d(n,{Z:function(){return r}});let r=i.p+"assets/images/image-4c2ed68e7ee41f6892a8745c75ddf384.png"},50065:function(e,n,i){i.d(n,{Z:function(){return l},a:function(){return a}});var r=i(67294);let s={},c=r.createContext(s);function a(e){let n=r.useContext(c);return r.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function l(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:a(e.components),r.createElement(c.Provider,{value:n},e.children)}}}]);