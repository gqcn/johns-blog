"use strict";(self.webpackChunkgf_site=self.webpackChunkgf_site||[]).push([["3345"],{55e3:function(e,n,c){c.r(n),c.d(n,{metadata:()=>i,contentTitle:()=>s,default:()=>t,assets:()=>r,toc:()=>a,frontMatter:()=>l});var i=JSON.parse('{"id":"docs/AI\u6280\u672F/\u57FA\u7840\u67B6\u6784/vGPU/HAMi Volcano\u5B89\u88C5\u6D4B\u8BD5","title":"HAMi Volcano\u5B89\u88C5\u6D4B\u8BD5","description":"\u8BE6\u7EC6\u4ECB\u7ECDVolcano vGPU\u7684\u5B8C\u6574\u90E8\u7F72\u6D41\u7A0B\uFF0C\u5305\u62ECvolcano-vgpu-device-plugin\u7EC4\u4EF6\u5B89\u88C5\u3001\u8C03\u5EA6\u5668\u914D\u7F6E\u3001\u8282\u70B9\u6807\u7B7E\u6C61\u70B9\u8BBE\u7F6E\u3001\u8D44\u6E90\u540D\u79F0\u517C\u5BB9\u6027\u914D\u7F6E\u3001\u5B9E\u9645\u6D4B\u8BD5\u9A8C\u8BC1\u548C\u5E38\u89C1\u95EE\u9898\u6392\u67E5\u3002\u57FA\u4E8EHAMi Core\u5B9E\u73B0GPU\u786C\u9694\u79BB\uFF0C\u652F\u6301\u4E0ENVIDIA Device Plugin\u8D44\u6E90\u540D\u79F0\u517C\u5BB9\u3002","source":"@site/docs/docs/1000-AI\u6280\u672F/800-\u57FA\u7840\u67B6\u6784/100-vGPU/3000-HAMi Volcano\u5B89\u88C5\u6D4B\u8BD5.md","sourceDirName":"docs/1000-AI\u6280\u672F/800-\u57FA\u7840\u67B6\u6784/100-vGPU","slug":"/ai/vgpu-hami-test-with-volcano","permalink":"/ai/vgpu-hami-test-with-volcano","draft":false,"unlisted":false,"tags":[],"version":"current","sidebarPosition":3000,"frontMatter":{"slug":"/ai/vgpu-hami-test-with-volcano","title":"HAMi Volcano\u5B89\u88C5\u6D4B\u8BD5","hide_title":true,"keywords":["Volcano vGPU","volcano-vgpu-device-plugin","HAMi Core","GPU\u5171\u4EAB","deviceshare\u63D2\u4EF6","Kubernetes GPU\u8C03\u5EA6","vGPU\u90E8\u7F72","\u8D44\u6E90\u540D\u79F0\u517C\u5BB9","Prometheus\u76D1\u63A7","GPU\u8282\u70B9\u914D\u7F6E"],"description":"\u8BE6\u7EC6\u4ECB\u7ECDVolcano vGPU\u7684\u5B8C\u6574\u90E8\u7F72\u6D41\u7A0B\uFF0C\u5305\u62ECvolcano-vgpu-device-plugin\u7EC4\u4EF6\u5B89\u88C5\u3001\u8C03\u5EA6\u5668\u914D\u7F6E\u3001\u8282\u70B9\u6807\u7B7E\u6C61\u70B9\u8BBE\u7F6E\u3001\u8D44\u6E90\u540D\u79F0\u517C\u5BB9\u6027\u914D\u7F6E\u3001\u5B9E\u9645\u6D4B\u8BD5\u9A8C\u8BC1\u548C\u5E38\u89C1\u95EE\u9898\u6392\u67E5\u3002\u57FA\u4E8EHAMi Core\u5B9E\u73B0GPU\u786C\u9694\u79BB\uFF0C\u652F\u6301\u4E0ENVIDIA Device Plugin\u8D44\u6E90\u540D\u79F0\u517C\u5BB9\u3002"},"sidebar":"mainSidebar","previous":{"title":"HAMi With Volcano","permalink":"/ai/vgpu-hami-with-volcano"},"next":{"title":"HAMi CUDA Driver API","permalink":"/ai/vgpu-hami-cuda-driver-api"}}'),d=c("85893"),o=c("50065");let l={slug:"/ai/vgpu-hami-test-with-volcano",title:"HAMi Volcano\u5B89\u88C5\u6D4B\u8BD5",hide_title:!0,keywords:["Volcano vGPU","volcano-vgpu-device-plugin","HAMi Core","GPU\u5171\u4EAB","deviceshare\u63D2\u4EF6","Kubernetes GPU\u8C03\u5EA6","vGPU\u90E8\u7F72","\u8D44\u6E90\u540D\u79F0\u517C\u5BB9","Prometheus\u76D1\u63A7","GPU\u8282\u70B9\u914D\u7F6E"],description:"\u8BE6\u7EC6\u4ECB\u7ECDVolcano vGPU\u7684\u5B8C\u6574\u90E8\u7F72\u6D41\u7A0B\uFF0C\u5305\u62ECvolcano-vgpu-device-plugin\u7EC4\u4EF6\u5B89\u88C5\u3001\u8C03\u5EA6\u5668\u914D\u7F6E\u3001\u8282\u70B9\u6807\u7B7E\u6C61\u70B9\u8BBE\u7F6E\u3001\u8D44\u6E90\u540D\u79F0\u517C\u5BB9\u6027\u914D\u7F6E\u3001\u5B9E\u9645\u6D4B\u8BD5\u9A8C\u8BC1\u548C\u5E38\u89C1\u95EE\u9898\u6392\u67E5\u3002\u57FA\u4E8EHAMi Core\u5B9E\u73B0GPU\u786C\u9694\u79BB\uFF0C\u652F\u6301\u4E0ENVIDIA Device Plugin\u8D44\u6E90\u540D\u79F0\u517C\u5BB9\u3002"},s=void 0,r={},a=[{value:"\u51C6\u5907\u5DE5\u4F5C",id:"\u51C6\u5907\u5DE5\u4F5C",level:2},{value:"\u955C\u50CF\u51C6\u5907",id:"\u955C\u50CF\u51C6\u5907",level:3},{value:"\u8282\u70B9\u51C6\u5907",id:"\u8282\u70B9\u51C6\u5907",level:3},{value:"vGPU\u8282\u70B9\u6807\u7B7E",id:"vgpu\u8282\u70B9\u6807\u7B7E",level:4},{value:"\u5378\u8F7DvGPU\u8282\u70B9\u7684nvidia-device-plugin",id:"\u5378\u8F7Dvgpu\u8282\u70B9\u7684nvidia-device-plugin",level:4},{value:"\u80CC\u666F\u8BF4\u660E",id:"\u80CC\u666F\u8BF4\u660E",level:5},{value:"\u89E3\u51B3\u65B9\u6848\uFF1A\u4F7F\u7528NFD\u7684NodeFeatureRule",id:"\u89E3\u51B3\u65B9\u6848\u4F7F\u7528nfd\u7684nodefeaturerule",level:5},{value:"\u6267\u884C\u90E8\u7F72",id:"\u6267\u884C\u90E8\u7F72",level:2},{value:"\u90E8\u7F72volcano-vgpu-device-plugin",id:"\u90E8\u7F72volcano-vgpu-device-plugin",level:3},{value:"\u90E8\u7F72\u6587\u4EF6",id:"\u90E8\u7F72\u6587\u4EF6",level:4},{value:"\u914D\u7F6E\u8BF4\u660E",id:"\u914D\u7F6E\u8BF4\u660E",level:4},{value:"\u6267\u884C\u7ED3\u679C",id:"\u6267\u884C\u7ED3\u679C",level:4},{value:"\u542F\u7528volcano\u8C03\u5EA6\u5668\u652F\u6301vGPU",id:"\u542F\u7528volcano\u8C03\u5EA6\u5668\u652F\u6301vgpu",level:3},{value:"\u8FD0\u884C\u6D4B\u8BD5",id:"\u8FD0\u884C\u6D4B\u8BD5",level:2},{value:"vGPU\u57FA\u672C\u4F7F\u7528",id:"vgpu\u57FA\u672C\u4F7F\u7528",level:3},{value:"\u4F7F\u7528nvidia-device-plugin\u7684\u8D44\u6E90",id:"\u4F7F\u7528nvidia-device-plugin\u7684\u8D44\u6E90",level:3},{value:"vGPU\u8D44\u6E90\u4E0ENVIDIA\u8D44\u6E90\u540D\u79F0\u517C\u5BB9",id:"vgpu\u8D44\u6E90\u4E0Envidia\u8D44\u6E90\u540D\u79F0\u517C\u5BB9",level:3},{value:"\u914D\u7F6E\u6587\u4EF6\u53D8\u5316",id:"\u914D\u7F6E\u6587\u4EF6\u53D8\u5316",level:4},{value:"\u90E8\u7F72\u6587\u4EF6\u793A\u4F8B",id:"\u90E8\u7F72\u6587\u4EF6\u793A\u4F8B",level:4},{value:"\u6D4B\u8BD5\u6587\u4EF6\u793A\u4F8B",id:"\u6D4B\u8BD5\u6587\u4EF6\u793A\u4F8B",level:4},{value:"\u76D1\u63A7\u6307\u6807",id:"\u76D1\u63A7\u6307\u6807",level:2},{value:"\u5E38\u89C1\u95EE\u9898",id:"\u5E38\u89C1\u95EE\u9898",level:2},{value:"vGPU Pod\u90E8\u7F72\u65F6\u62A5\u9519UnexpectedAdmissionError",id:"vgpu-pod\u90E8\u7F72\u65F6\u62A5\u9519unexpectedadmissionerror",level:3}];function h(e){let n={a:"a",code:"code",h2:"h2",h3:"h3",h4:"h4",h5:"h5",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,o.a)(),...e.components};return(0,d.jsxs)(d.Fragment,{children:[(0,d.jsxs)(n.p,{children:["\u4F7F\u7528",(0,d.jsx)(n.code,{children:"volcano-vgpu"}),"\u65F6\uFF0C\u4E0D\u9700\u8981 \u5B89\u88C5",(0,d.jsx)(n.code,{children:"HAMi"}),"\uFF0C\u4EC5\u4F7F\u7528",(0,d.jsx)(n.code,{children:"Volcano vgpu device-plugin"}),"\u5373\u53EF\u3002\u5B83\u53EF\u4EE5\u4E3A\u7531",(0,d.jsx)(n.code,{children:"volcano"}),"\u7BA1\u7406\u7684",(0,d.jsx)(n.code,{children:"NVIDIA"}),"\u8BBE\u5907\u63D0\u4F9B\u8BBE\u5907\u5171\u4EAB\u673A\u5236\u3002\n\u8BE5\u63D2\u4EF6\u6E90\u7801\u57FA\u4E8E",(0,d.jsx)(n.code,{children:"Nvidia Device Plugin"}),"\u5F00\u53D1\uFF0C\u5E76\u4F7F\u7528",(0,d.jsx)(n.code,{children:"HAMi-core"}),"\u5B9E\u73B0\u5BF9",(0,d.jsx)(n.code,{children:"GPU"}),"\u5361\u7684\u786C\u9694\u79BB\u652F\u6301\u3002\n",(0,d.jsx)(n.code,{children:"Volcano vgpu"}),"\u4EC5\u5728",(0,d.jsx)(n.code,{children:"volcano > 1.9"}),"\u7248\u672C\u4E2D\u53EF\u7528\u3002"]}),"\n",(0,d.jsx)(n.h2,{id:"\u51C6\u5907\u5DE5\u4F5C",children:"\u51C6\u5907\u5DE5\u4F5C"}),"\n",(0,d.jsx)(n.h3,{id:"\u955C\u50CF\u51C6\u5907",children:"\u955C\u50CF\u51C6\u5907"}),"\n",(0,d.jsxs)(n.p,{children:[(0,d.jsx)(n.code,{children:"Volcano"}),"\u8C03\u5EA6\u5668\u5DF2\u96C6\u6210\u652F\u6301",(0,d.jsx)(n.code,{children:"HAMI vGPU"}),"\uFF0C\u6211\u4EEC\u9700\u8981\u4EE5\u524D\u51C6\u5907\u4EE5\u4E0B\u955C\u50CF\u5230\u672C\u5730\u96C6\u7FA4\u4E2D\uFF1A"]}),"\n",(0,d.jsx)(n.pre,{children:(0,d.jsx)(n.code,{className:"language-text",children:"docker.io/projecthami/volcano-vgpu-device-plugin:v1.11.0\n"})}),"\n",(0,d.jsxs)(n.p,{children:["\u4E0B\u8F7D\u5230\u672C\u5730",(0,d.jsx)(n.code,{children:"harbor"}),"\u4E2D\uFF0C\u65B0\u5730\u5740\u4E3A\uFF1A"]}),"\n",(0,d.jsx)(n.pre,{children:(0,d.jsx)(n.code,{className:"language-text",children:"aiharbor.msxf.local/test/projecthami/volcano-vgpu-device-plugin:v1.11.0\n"})}),"\n",(0,d.jsx)(n.h3,{id:"\u8282\u70B9\u51C6\u5907",children:"\u8282\u70B9\u51C6\u5907"}),"\n",(0,d.jsx)(n.h4,{id:"vgpu\u8282\u70B9\u6807\u7B7E",children:"vGPU\u8282\u70B9\u6807\u7B7E"}),"\n",(0,d.jsxs)(n.p,{children:["\u9700\u8981\u7ED9\u9700\u8981\u5B89\u88C5",(0,d.jsx)(n.code,{children:"vGPU"}),"\u7EC4\u4EF6\u7684\u8282\u70B9\u6253\u4E0A\u7279\u5B9A\u7684\u6807\u7B7E\uFF0C\u4EE5\u65B9\u4FBF\u6307\u5B9A\u96C6\u7FA4\u4E2D\u90E8\u5206\u8282\u70B9\u542F\u7528",(0,d.jsx)(n.code,{children:"vGPU"}),"\u7279\u6027\u3002\n\u6807\u7B7E\u5982\u4E0B\uFF1A"]}),"\n",(0,d.jsx)(n.pre,{children:(0,d.jsx)(n.code,{className:"language-yaml",children:'volcano.sh/vgpu.enabled: "true"\n'})}),"\n",(0,d.jsx)(n.h4,{id:"\u5378\u8F7Dvgpu\u8282\u70B9\u7684nvidia-device-plugin",children:"\u5378\u8F7DvGPU\u8282\u70B9\u7684nvidia-device-plugin"}),"\n",(0,d.jsx)(n.h5,{id:"\u80CC\u666F\u8BF4\u660E",children:"\u80CC\u666F\u8BF4\u660E"}),"\n",(0,d.jsxs)(n.p,{children:["\u7531\u4E8E",(0,d.jsx)(n.code,{children:"volcano-vgpu-device-plugin"}),"\u548C",(0,d.jsx)(n.code,{children:"nvidia-device-plugin"}),"\u4F1A\u4EA7\u751F\u8D44\u6E90\u7BA1\u7406\u51B2\u7A81\uFF0C\u56E0\u6B64\u9700\u8981\u786E\u4FDD\u542F\u7528\u4E86",(0,d.jsx)(n.code,{children:"vGPU"}),"\u529F\u80FD\u7684\u8282\u70B9\u4E0A\u6CA1\u6709\u8FD0\u884C",(0,d.jsx)(n.code,{children:"nvidia-device-plugin"}),"\u3002"]}),"\n",(0,d.jsxs)(n.p,{children:[(0,d.jsx)(n.code,{children:"GPU Operator"}),"\u5728\u90E8\u7F72",(0,d.jsx)(n.code,{children:"nvidia-device-plugin"}),"\u65F6\uFF0C\u4F1A\u6839\u636E\u8282\u70B9\u4E0A\u7684",(0,d.jsx)(n.code,{children:"nvidia.com/gpu.deploy.device-plugin=true"}),"\u6807\u7B7E\u6765\u51B3\u5B9A\u662F\u5426\u5728\u8BE5\u8282\u70B9\u4E0A\u90E8\u7F72",(0,d.jsx)(n.code,{children:"device plugin"}),"\u3002\u8BE5\u6807\u7B7E\u662F\u7531",(0,d.jsx)(n.code,{children:"GPU Operator"}),"\u5728\u5B89\u88C5\u8FC7\u7A0B\u4E2D\u81EA\u52A8\u6DFB\u52A0\u5230\u8282\u70B9\u4E0A\u7684\uFF0C\u9ED8\u8BA4\u503C\u4E3A",(0,d.jsx)(n.code,{children:"true"}),"\u3002"]}),"\n",(0,d.jsxs)(n.p,{children:["\u5982\u679C\u8BE5\u6807\u7B7E\u503C\u4E3A",(0,d.jsx)(n.code,{children:"false"}),"\u65F6\uFF0C",(0,d.jsx)(n.code,{children:"GPU Operator"}),"\u4F1A\u81EA\u52A8\u8DF3\u8FC7\u8BE5\u8282\u70B9\uFF0C\u4E0D\u5728\u5176\u4E0A\u90E8\u7F72",(0,d.jsx)(n.code,{children:"nvidia-device-plugin"}),"\uFF0C\u5E76\u4E14\u5982\u679C\u8BE5\u8282\u70B9\u4E0A\u5DF2\u7ECF\u8FD0\u884C\u4E86",(0,d.jsx)(n.code,{children:"nvidia-device-plugin"}),"\uFF0C\u4E5F\u4F1A\u81EA\u52A8\u5378\u8F7D\u3002\n\u4F46\u662F\u624B\u52A8\u4FEE\u6539\u8282\u70B9\u4E0A\u7684\u8BE5\u6807\u7B7E\u503C\u4E0D\u53EF\u884C\uFF0C\u56E0\u4E3A",(0,d.jsx)(n.code,{children:"GPU Operator"}),"\u4F1A\u5B9A\u671F\u540C\u6B65\u8282\u70B9\u6807\u7B7E\uFF08\u6216\u8005\u7EC4\u4EF6\u91CD\u542F\u540E\uFF09\uFF0C\u624B\u52A8\u4FEE\u6539\u7684\u6807\u7B7E\u503C\u4F1A\u88AB\u8986\u76D6\u56DE",(0,d.jsx)(n.code,{children:"true"}),"\u3002"]}),"\n",(0,d.jsx)(n.h5,{id:"\u89E3\u51B3\u65B9\u6848\u4F7F\u7528nfd\u7684nodefeaturerule",children:"\u89E3\u51B3\u65B9\u6848\uFF1A\u4F7F\u7528NFD\u7684NodeFeatureRule"}),"\n",(0,d.jsxs)(n.p,{children:["\u901A\u8FC7",(0,d.jsx)(n.code,{children:"NFD\uFF08Node Feature Discovery\uFF09"}),"\u7EC4\u4EF6\u7684",(0,d.jsx)(n.code,{children:"NodeFeatureRule"}),"\u81EA\u52A8\u4E3A\u542F\u7528",(0,d.jsx)(n.code,{children:"vGPU"}),"\u7684\u8282\u70B9\u8BBE\u7F6E",(0,d.jsx)(n.code,{children:"nvidia.com/gpu.deploy.device-plugin=false"}),"\u6807\u7B7E\uFF0C\u5B9E\u73B0\u81EA\u52A8\u5316\u7684\u8BBE\u5907\u63D2\u4EF6\u7BA1\u7406\u3002"]}),"\n",(0,d.jsx)(n.p,{children:(0,d.jsx)(n.strong,{children:"\u4EC0\u4E48\u662FNodeFeatureRule\uFF1F"})}),"\n",(0,d.jsxs)(n.p,{children:[(0,d.jsx)(n.code,{children:"NodeFeatureRule\uFF08NFR\uFF09"}),"\u662F",(0,d.jsx)(n.code,{children:"NFD"}),"\u7EC4\u4EF6\u63D0\u4F9B\u7684\u81EA\u5B9A\u4E49\u8D44\u6E90\uFF08",(0,d.jsx)(n.code,{children:"CRD"}),"\uFF09\uFF0C\u5B83\u5141\u8BB8\u7528\u6237\u5B9A\u4E49\u89C4\u5219\u6765\u81EA\u52A8\u53D1\u73B0\u548C\u6807\u8BB0\u8282\u70B9\u7279\u5F81\u3002",(0,d.jsx)(n.code,{children:"NFD"}),"\u4F5C\u4E3A",(0,d.jsx)(n.code,{children:"Kubernetes"}),"\u96C6\u7FA4\u4E2D\u7684\u5B88\u62A4\u8FDB\u7A0B\uFF0C\u4F1A\u6301\u7EED\u76D1\u63A7\u8282\u70B9\u7684\u786C\u4EF6\u7279\u6027\u3001\u5185\u6838\u914D\u7F6E\u548C\u5176\u4ED6\u7CFB\u7EDF\u5C5E\u6027\uFF0C\u5E76\u6839\u636E",(0,d.jsx)(n.code,{children:"NodeFeatureRule"}),"\u5B9A\u4E49\u7684\u89C4\u5219\u81EA\u52A8\u4E3A\u8282\u70B9\u6DFB\u52A0\u3001\u66F4\u65B0\u6216\u5220\u9664\u6807\u7B7E\u3002"]}),"\n",(0,d.jsx)(n.p,{children:(0,d.jsx)(n.strong,{children:"\u4E3A\u4EC0\u4E48\u80FD\u907F\u514DGPU Operator\u8986\u76D6\u6807\u7B7E\uFF1F"})}),"\n",(0,d.jsxs)(n.p,{children:[(0,d.jsx)(n.code,{children:"GPU Operator"}),"\u548C",(0,d.jsx)(n.code,{children:"NFD"}),"\u90FD\u4F1A\u7BA1\u7406\u8282\u70B9\u6807\u7B7E\uFF0C\u4F46\u5B83\u4EEC\u7684\u4F18\u5148\u7EA7\u548C\u4F5C\u7528\u57DF\u4E0D\u540C\uFF1A"]}),"\n",(0,d.jsxs)(n.ol,{children:["\n",(0,d.jsxs)(n.li,{children:[(0,d.jsx)(n.strong,{children:"NFD\u7684\u4F18\u5148\u7EA7\u66F4\u9AD8"}),"\uFF1A",(0,d.jsx)(n.code,{children:"NFD"}),"\u4F5C\u4E3A\u4E13\u95E8\u7684\u7279\u5F81\u53D1\u73B0\u7EC4\u4EF6\uFF0C\u5176\u8BBE\u7F6E\u7684\u6807\u7B7E\u4F1A\u88AB",(0,d.jsx)(n.code,{children:"Kubernetes"}),'\u8BA4\u4E3A\u662F"\u7CFB\u7EDF\u7EA7\u522B"\u7684\u6807\u7B7E\uFF0C\u5177\u6709\u66F4\u9AD8\u7684\u6743\u5A01\u6027']}),"\n",(0,d.jsxs)(n.li,{children:[(0,d.jsx)(n.strong,{children:"\u6301\u7EED\u76D1\u63A7\u548C\u540C\u6B65"}),"\uFF1A",(0,d.jsx)(n.code,{children:"NFD"}),"\u4F1A\u6301\u7EED\u76D1\u63A7\u8282\u70B9\u72B6\u6001\u548C\u6807\u7B7E\u53D8\u5316\uFF0C\u5F53",(0,d.jsx)(n.code,{children:"GPU Operator"}),"\u5C1D\u8BD5\u8986\u76D6\u6807\u7B7E\u65F6\uFF0C",(0,d.jsx)(n.code,{children:"NFD"}),"\u4F1A\u6839\u636E",(0,d.jsx)(n.code,{children:"NodeFeatureRule"}),"\u89C4\u5219\u7ACB\u5373\u5C06\u6807\u7B7E\u91CD\u65B0\u8BBE\u7F6E\u56DE\u6B63\u786E\u7684\u503C"]}),"\n",(0,d.jsxs)(n.li,{children:[(0,d.jsx)(n.strong,{children:"\u57FA\u4E8E\u6761\u4EF6\u7684\u6807\u7B7E\u7BA1\u7406"}),"\uFF1A\u901A\u8FC7",(0,d.jsx)(n.code,{children:"NodeFeatureRule"}),"\u5B9A\u4E49\u7684\u6807\u7B7E\u662F\u57FA\u4E8E\u8282\u70B9\u6761\u4EF6\uFF08\u5982",(0,d.jsx)(n.code,{children:"volcano.sh/vgpu.enabled=true"}),"\uFF09\u52A8\u6001\u751F\u6210\u7684\uFF0C\u53EA\u8981\u6761\u4EF6\u6EE1\u8DB3\uFF0C",(0,d.jsx)(n.code,{children:"NFD"}),"\u5C31\u4F1A\u786E\u4FDD\u6807\u7B7E\u59CB\u7EC8\u4FDD\u6301\u6B63\u786E\u7684\u503C"]}),"\n",(0,d.jsxs)(n.li,{children:[(0,d.jsx)(n.strong,{children:"\u907F\u514D\u51B2\u7A81\u7684\u8BBE\u8BA1"}),"\uFF1A",(0,d.jsx)(n.code,{children:"GPU Operator"}),"\u5728\u68C0\u6D4B\u5230\u7531",(0,d.jsx)(n.code,{children:"NFD"}),"\u7BA1\u7406\u7684\u6807\u7B7E\u65F6\uFF0C\u901A\u5E38\u4F1A\u5C0A\u91CD\u8FD9\u4E9B\u6807\u7B7E\u7684\u503C\uFF0C\u800C\u4E0D\u662F\u5F3A\u5236\u8986\u76D6\uFF0C\u8FD9\u662F",(0,d.jsx)(n.code,{children:"Kubernetes"}),"\u751F\u6001\u4E2D\u7EC4\u4EF6\u534F\u4F5C\u7684\u6700\u4F73\u5B9E\u8DF5"]}),"\n"]}),"\n",(0,d.jsxs)(n.p,{children:["\u901A\u8FC7\u8FD9\u79CD\u673A\u5236\uFF0C\u5373\u4F7F",(0,d.jsx)(n.code,{children:"GPU Operator"}),"\u91CD\u542F\u6216\u6267\u884C\u540C\u6B65\u64CD\u4F5C\uFF0C",(0,d.jsx)(n.code,{children:"NFD"}),"\u4E5F\u4F1A\u786E\u4FDD",(0,d.jsx)(n.code,{children:"nvidia.com/gpu.deploy.device-plugin"}),"\u6807\u7B7E\u4FDD\u6301\u4E3A",(0,d.jsx)(n.code,{children:"false"}),"\uFF0C\u4ECE\u800C\u5B9E\u73B0\u7A33\u5B9A\u53EF\u9760\u7684\u8BBE\u5907\u63D2\u4EF6\u7BA1\u7406\u3002"]}),"\n",(0,d.jsx)(n.p,{children:(0,d.jsx)(n.strong,{children:"\u6B65\u9AA41\uFF1A\u521B\u5EFANodeFeatureRule"})}),"\n",(0,d.jsxs)(n.p,{children:["\u521B\u5EFA\u4E00\u4E2A",(0,d.jsx)(n.code,{children:"NodeFeatureRule"}),"\u8D44\u6E90\uFF0C\u5F53\u8282\u70B9\u5305\u542B",(0,d.jsx)(n.code,{children:"volcano.sh/vgpu.enabled=true"}),"\u6807\u7B7E\u65F6\uFF0C\u81EA\u52A8\u8BBE\u7F6E",(0,d.jsx)(n.code,{children:"nvidia.com/gpu.deploy.device-plugin=false"}),"\u6807\u7B7E\uFF1A"]}),"\n",(0,d.jsx)(n.pre,{children:(0,d.jsx)(n.code,{className:"language-yaml",metastring:'title="vgpu-node-feature-rule.yaml"',children:'apiVersion: nfd.k8s-sigs.io/v1alpha1\nkind: NodeFeatureRule\nmetadata:\n  name: vgpu-nvidia-device-plugin-control\nspec:\n  rules:\n    - name: "disable-nvidia-device-plugin-on-vgpu-nodes"\n      # \u5339\u914D\u6761\u4EF6\uFF1A\u8282\u70B9\u4E0A\u5B58\u5728 volcano.sh/vgpu.enabled=true \u6807\u7B7E\n      labels:\n        "volcano.sh/vgpu.enabled": "true"\n      # \u8BBE\u7F6E\u6807\u7B7E\uFF1Anvidia.com/gpu.deploy.device-plugin=false\n      labelsTemplate: |\n        nvidia.com/gpu.deploy.device-plugin=false\n'})}),"\n",(0,d.jsx)(n.p,{children:(0,d.jsx)(n.strong,{children:"\u6B65\u9AA42\uFF1A\u5E94\u7528NodeFeatureRule"})}),"\n",(0,d.jsx)(n.pre,{children:(0,d.jsx)(n.code,{className:"language-bash",children:"kubectl apply -f vgpu-node-feature-rule.yaml\n"})}),"\n",(0,d.jsx)(n.p,{children:(0,d.jsx)(n.strong,{children:"\u6B65\u9AA43\uFF1A\u9A8C\u8BC1\u6807\u7B7E\u8BBE\u7F6E"})}),"\n",(0,d.jsxs)(n.p,{children:["\u68C0\u67E5",(0,d.jsx)(n.code,{children:"vGPU"}),"\u8282\u70B9\u4E0A\u7684\u6807\u7B7E\uFF0C\u786E\u8BA4",(0,d.jsx)(n.code,{children:"nvidia.com/gpu.deploy.device-plugin"}),"\u6807\u7B7E\u5DF2\u7ECF\u88AB\u6B63\u786E\u8BBE\u7F6E\uFF1A"]}),"\n",(0,d.jsx)(n.pre,{children:(0,d.jsx)(n.code,{className:"language-bash",children:"kubectl get node <vgpu-node-name> -o jsonpath='{.metadata.labels}' | grep nvidia.com/gpu.deploy.device-plugin\n"})}),"\n",(0,d.jsx)(n.p,{children:"\u9884\u671F\u8F93\u51FA\u5E94\u5305\u542B\uFF1A"}),"\n",(0,d.jsx)(n.pre,{children:(0,d.jsx)(n.code,{className:"language-yaml",children:'"nvidia.com/gpu.deploy.device-plugin":"false"\n'})}),"\n",(0,d.jsx)(n.p,{children:(0,d.jsx)(n.strong,{children:"\u6B65\u9AA44\uFF1A\u89C2\u5BDFnvidia-device-plugin\u81EA\u52A8\u5378\u8F7D"})}),"\n",(0,d.jsxs)(n.p,{children:[(0,d.jsx)(n.code,{children:"GPU Operator"}),"\u4F1A\u76D1\u63A7\u8282\u70B9\u6807\u7B7E\u7684\u53D8\u5316\uFF0C\u5F53\u68C0\u6D4B\u5230",(0,d.jsx)(n.code,{children:"nvidia.com/gpu.deploy.device-plugin=false"}),"\u65F6\uFF0C\u4F1A\u81EA\u52A8\u5220\u9664\u8BE5\u8282\u70B9\u4E0A\u7684",(0,d.jsx)(n.code,{children:"nvidia-device-plugin Pod"}),"\u3002"]}),"\n",(0,d.jsx)(n.h2,{id:"\u6267\u884C\u90E8\u7F72",children:"\u6267\u884C\u90E8\u7F72"}),"\n",(0,d.jsx)(n.h3,{id:"\u90E8\u7F72volcano-vgpu-device-plugin",children:"\u90E8\u7F72volcano-vgpu-device-plugin"}),"\n",(0,d.jsx)(n.h4,{id:"\u90E8\u7F72\u6587\u4EF6",children:"\u90E8\u7F72\u6587\u4EF6"}),"\n",(0,d.jsxs)(n.p,{children:["\u6CE8\u610F\u90E8\u7F72\u6587\u4EF6\u4E2D",(0,d.jsx)(n.code,{children:"Daemonset"}),"\u4E2D\u7684",(0,d.jsx)(n.code,{children:"nodeSelector"}),"\u53CA",(0,d.jsx)(n.code,{children:"tolerations"}),"\uFF1A",(0,d.jsx)(n.a,{target:"_blank","data-noBrokenLinkCheck":!0,href:c(21308).Z+"",children:"volcano-vgpu-device-plugin.yaml"})]}),"\n",(0,d.jsx)(n.h4,{id:"\u914D\u7F6E\u8BF4\u660E",children:"\u914D\u7F6E\u8BF4\u660E"}),"\n",(0,d.jsxs)(n.p,{children:[(0,d.jsx)(n.code,{children:"Volcano vGPU"}),"\u7684\u9ED8\u8BA4\u914D\u7F6E\u5982\u4E0B\uFF1A"]}),"\n",(0,d.jsx)(n.pre,{children:(0,d.jsx)(n.code,{className:"language-yaml",metastring:'title="device-config.yaml"',children:"nvidia:\n  resourceCountName: volcano.sh/vgpu-number\n  resourceMemoryName: volcano.sh/vgpu-memory\n  resourceMemoryPercentageName: volcano.sh/vgpu-memory-percentage\n  resourceCoreName: volcano.sh/vgpu-cores\n  overwriteEnv: false\n  defaultMemory: 0\n  defaultCores: 0\n  defaultGPUNum: 1\n  deviceSplitCount: 10\n  deviceMemoryScaling: 1\n  deviceCoreScaling: 1\n  gpuMemoryFactor: 1\n  knownMigGeometries: []\n"})}),"\n",(0,d.jsx)(n.p,{children:(0,d.jsx)(n.strong,{children:"\u5173\u952E\u914D\u7F6E\u9879\u8BF4\u660E\uFF1A"})}),"\n",(0,d.jsxs)(n.table,{children:[(0,d.jsx)(n.thead,{children:(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.th,{children:"\u914D\u7F6E\u9879"}),(0,d.jsx)(n.th,{children:"\u8BF4\u660E"}),(0,d.jsx)(n.th,{children:"\u793A\u4F8B"})]})}),(0,d.jsxs)(n.tbody,{children:[(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"resourceCountName"})}),(0,d.jsxs)(n.td,{children:[(0,d.jsx)(n.code,{children:"vGPU"}),"\u4E2A\u6570\u7684\u8D44\u6E90\u540D\u79F0"]}),(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"volcano.sh/vgpu-number"})})]}),(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"resourceMemoryName"})}),(0,d.jsxs)(n.td,{children:[(0,d.jsx)(n.code,{children:"vGPU"}),"\u663E\u5B58\u5927\u5C0F\u7684\u8D44\u6E90\u540D\u79F0"]}),(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"volcano.sh/vgpu-memory"})})]}),(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"resourceCoreName"})}),(0,d.jsxs)(n.td,{children:[(0,d.jsx)(n.code,{children:"vGPU"}),"\u7B97\u529B\u7684\u8D44\u6E90\u540D\u79F0"]}),(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"volcano.sh/vgpu-cores"})})]}),(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"resourceMemoryPercentageName"})}),(0,d.jsxs)(n.td,{children:[(0,d.jsx)(n.code,{children:"vGPU"}),"\u663E\u5B58\u6BD4\u4F8B\u7684\u8D44\u6E90\u540D\u79F0\uFF0C\u4EC5\u7528\u5728",(0,d.jsx)(n.code,{children:"Pod"}),"\u7684\u8D44\u6E90\u7533\u8BF7\u4E2D"]}),(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"volcano.sh/vgpu-memory-percentage"})})]}),(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"deviceSplitCount"})}),(0,d.jsxs)(n.td,{children:[(0,d.jsx)(n.code,{children:"GPU"}),"\u5206\u5272\u6570\uFF0C\u6BCF\u5F20",(0,d.jsx)(n.code,{children:"GPU"}),"\u6700\u591A\u53EF\u540C\u65F6\u8FD0\u884C\u7684\u4EFB\u52A1\u6570"]}),(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"10"})})]})]})]}),"\n",(0,d.jsx)(n.h4,{id:"\u6267\u884C\u7ED3\u679C",children:"\u6267\u884C\u7ED3\u679C"}),"\n",(0,d.jsx)(n.pre,{children:(0,d.jsx)(n.code,{className:"language-bash",children:'$ kubectl apply -f volcano-vgpu-device-plugin.yaml\nconfigmap/volcano-vgpu-device-config created\nconfigmap/volcano-vgpu-node-config created\nserviceaccount/volcano-device-plugin created\nclusterrole.rbac.authorization.k8s.io/volcano-device-plugin created\nclusterrolebinding.rbac.authorization.k8s.io/volcano-device-plugin created\nWarning: spec.template.metadata.annotations[scheduler.alpha.kubernetes.io/critical-pod]: non-functional in v1.16+; use the "priorityClassName" field instead\ndaemonset.apps/volcano-device-plugin created\n\n$ kubectl get pod\nNAME                                   READY   STATUS    RESTARTS      AGE\nvolcano-admission-7dc9b78fc6-686tb     1/1     Running   0             20d\nvolcano-admission-7dc9b78fc6-d9vzk     1/1     Running   0             20d\nvolcano-admission-7dc9b78fc6-h2ssl     1/1     Running   0             20d\nvolcano-controllers-855c676dd4-4gpxp   1/1     Running   1 (13d ago)   20d\nvolcano-controllers-855c676dd4-pspzg   1/1     Running   0             20d\nvolcano-controllers-855c676dd4-zl8cd   1/1     Running   0             20d\nvolcano-device-plugin-7g6v2            2/2     Running   0             22s\nvolcano-scheduler-6645c59d6d-56xdc     1/1     Running   0             6m58s\nvolcano-scheduler-6645c59d6d-p549s     1/1     Running   0             6m58s\nvolcano-scheduler-6645c59d6d-pqt68     1/1     Running   0             6m58s\n'})}),"\n",(0,d.jsxs)(n.p,{children:["\u67E5\u770B\u8282\u70B9",(0,d.jsx)(n.code,{children:"vGPU"}),"\u8D44\u6E90\uFF0C\u53EF\u4EE5\u770B\u5230\u539F\u6709\u7684",(0,d.jsx)(n.code,{children:"nvidia device plugin"}),"\u6CE8\u5165\u7684\u8D44\u6E90",(0,d.jsx)(n.code,{children:"nvidia.com/gpu"}),"\u5DF2\u7ECF\u6E05\u7A7A\uFF0C\u65B0\u751F\u6210\u4E86",(0,d.jsx)(n.code,{children:"vGPU"}),"\u76F8\u5173\u7684\u8D44\u6E90",(0,d.jsx)(n.code,{children:"volcano.sh/vgpu-cores"}),"\u3001",(0,d.jsx)(n.code,{children:"volcano.sh/vgpu-memory"}),"\u53CA",(0,d.jsx)(n.code,{children:"volcano.sh/vgpu-number"}),"\u3002"]}),"\n",(0,d.jsx)(n.pre,{children:(0,d.jsx)(n.code,{className:"language-yaml",children:"# ...\nCapacity:\n  cpu:                     128\n  ephemeral-storage:       562291Mi\n  hugepages-1Gi:           0\n  hugepages-2Mi:           0\n  memory:                  263746296Ki\n  nvidia.com/gpu:          0\n  nvidia.com/gpu.shared:   0\n  pods:                    110\n  volcano.sh/vgpu-cores:   800\n  volcano.sh/vgpu-memory:  196512\n  volcano.sh/vgpu-number:  80\nAllocatable:\n  cpu:                     127600m\n  ephemeral-storage:       562291Mi\n  hugepages-1Gi:           0\n  hugepages-2Mi:           0\n  memory:                  256048108548\n  nvidia.com/gpu:          0\n  nvidia.com/gpu.shared:   0\n  pods:                    110\n  volcano.sh/vgpu-cores:   800\n  volcano.sh/vgpu-memory:  196512\n  volcano.sh/vgpu-number:  80\n# ...\n"})}),"\n",(0,d.jsx)(n.p,{children:(0,d.jsx)(n.strong,{children:"\u81EA\u52A8\u751F\u6210\u7684\u8D44\u6E90\u9879\u8BF4\u660E\uFF1A"})}),"\n",(0,d.jsxs)(n.table,{children:[(0,d.jsx)(n.thead,{children:(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.th,{children:"\u8D44\u6E90\u9879"}),(0,d.jsx)(n.th,{children:"\u8BF4\u660E"}),(0,d.jsx)(n.th,{children:"\u793A\u4F8B"})]})}),(0,d.jsxs)(n.tbody,{children:[(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"volcano.sh/vgpu-cores"})}),(0,d.jsxs)(n.td,{children:[(0,d.jsx)(n.code,{children:"vGPU"}),"\u7B97\u529B\u7684\u8D44\u6E90\u91CF\u767E\u5206\u6BD4\uFF0C\u662F\u8282\u70B9\u4E0A",(0,d.jsx)(n.code,{children:"\u603B\u5361\u6570*100"})]}),(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"800"})})]}),(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"volcano.sh/vgpu-memory"})}),(0,d.jsxs)(n.td,{children:[(0,d.jsx)(n.code,{children:"vGPU"}),"\u663E\u5B58\u7684\u603B\u8D44\u6E90\u91CF\uFF0C\u5355\u4F4D",(0,d.jsx)(n.code,{children:"Mi"}),"\uFF0C\u662F\u8282\u70B9\u4E0A",(0,d.jsx)(n.code,{children:"\u603B\u5361\u6570*\u5355\u5361\u663E\u5B58\u6570"}),"\u3002\u7531\u4E8E",(0,d.jsx)(n.code,{children:"4090"}),"\u663E\u5361\u7684\u5355\u5361\u663E\u5B58\u4E3A",(0,d.jsx)(n.code,{children:"24564Mi"}),"\uFF0C\u90A3\u4E48\u8FD9\u91CC\u7684\u603B\u663E\u5B58\u91CF\u4E3A",(0,d.jsx)(n.code,{children:"196512Mi"})]}),(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"196512"})})]}),(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"volcano.sh/vgpu-number"})}),(0,d.jsxs)(n.td,{children:[(0,d.jsx)(n.code,{children:"vGPU"}),"\u4E2A\u6570\uFF0C\u662F\u8282\u70B9\u4E0A",(0,d.jsx)(n.code,{children:"\u603B\u5361\u6570*deviceSplitCount\u914D\u7F6E"})]}),(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"80"})})]})]})]}),"\n",(0,d.jsx)(n.h3,{id:"\u542F\u7528volcano\u8C03\u5EA6\u5668\u652F\u6301vgpu",children:"\u542F\u7528volcano\u8C03\u5EA6\u5668\u652F\u6301vGPU"}),"\n",(0,d.jsxs)(n.p,{children:["\u4FEE\u6539",(0,d.jsx)(n.code,{children:"volcano-scheduler-configmap"}),"\uFF0C\u589E\u52A0\u4EE5\u4E0B\u63D2\u4EF6\u652F\u6301\uFF1A"]}),"\n",(0,d.jsx)(n.pre,{children:(0,d.jsx)(n.code,{className:"language-yaml",children:"- name: deviceshare\n  arguments:\n    # \u662F\u5426\u542F\u7528vgpu\u7279\u6027\n    deviceshare.VGPUEnable: true \n    # volcano-vgpu-device-config\u8FD9\u4E2AConfigMap\u5BF9\u5E94\u7684\u547D\u540D\u7A7A\u95F4\n    # \u4FBF\u4E8E\u8C03\u5EA6\u5668\u81EA\u52A8\u8BFB\u53D6ConfigMap\u5185\u5BB9\n    deviceshare.KnownGeometriesCMNamespace: volcano-system \n"})}),"\n",(0,d.jsxs)(n.p,{children:["\u4FEE\u6539\u540E\u5185\u5BB9\u5982\u4E0B\uFF08\u4EC5\u4F9B\u793A\u4F8B\u53C2\u8003\uFF0C\u5177\u4F53\u6839\u636E\u81EA\u8EAB\u9700\u8981\u8C03\u6574",(0,d.jsx)(n.code,{children:"volcano action"}),"\u548C",(0,d.jsx)(n.code,{children:"plugin"}),"\u914D\u7F6E\uFF09\uFF1A"]}),"\n",(0,d.jsx)(n.pre,{children:(0,d.jsx)(n.code,{className:"language-yaml",children:'actions: "enqueue, allocate, backfill"\ntiers:\n- plugins:\n  - name: priority\n  - name: gang\n    enablePreemptable: false\n  - name: conformance\n- plugins:\n  - name: drf\n    enablePreemptable: false\n  - name: deviceshare\n    arguments:\n      # \u662F\u5426\u542F\u7528vgpu\u7279\u6027\n      deviceshare.VGPUEnable: true \n      # volcano-vgpu-device-config\u8FD9\u4E2AConfigMap\u5BF9\u5E94\u7684\u547D\u540D\u7A7A\u95F4\n      # \u4FBF\u4E8E\u8C03\u5EA6\u5668\u81EA\u52A8\u8BFB\u53D6ConfigMap\u5185\u5BB9\n      deviceshare.KnownGeometriesCMNamespace: volcano-system \n  - name: predicates\n  - name: capacity-card\n    arguments:\n      cardUnlimitedCpuMemory: true\n  - name: nodeorder\n  - name: binpack\n'})}),"\n",(0,d.jsxs)(n.p,{children:["\u4FEE\u6539\u540E\u91CD\u542F",(0,d.jsx)(n.code,{children:"volcano-scheduler"}),"\u3002"]}),"\n",(0,d.jsx)(n.h2,{id:"\u8FD0\u884C\u6D4B\u8BD5",children:"\u8FD0\u884C\u6D4B\u8BD5"}),"\n",(0,d.jsx)(n.h3,{id:"vgpu\u57FA\u672C\u4F7F\u7528",children:"vGPU\u57FA\u672C\u4F7F\u7528"}),"\n",(0,d.jsxs)(n.p,{children:["\u8BE5\u6D4B\u8BD5",(0,d.jsx)(n.code,{children:"Pod"}),"\u4F7F\u7528\u7684\u955C\u50CF\u4E3A",(0,d.jsx)(n.code,{children:"nvidia/cuda:12.2.0-base"}),"\uFF0C\u4E0B\u8F7D\u5230\u672C\u5730\u96C6\u7FA4",(0,d.jsx)(n.code,{children:"harbor"}),"\u4ED3\u5E93\u7684\u955C\u50CF\u5730\u5740",(0,d.jsx)(n.code,{children:"aiharbor.msxf.local/test/nvidia/cuda:12.2.0-base-ubuntu22.04"}),"\uFF1A"]}),"\n",(0,d.jsx)(n.pre,{children:(0,d.jsx)(n.code,{className:"language-yaml",metastring:'title="test-vgpu.yaml"',children:'apiVersion: v1\nkind: Pod\nmetadata:\n  name: test-vgpu\nspec:\n  # \u9700\u8981\u4F7F\u7528volcano\u8C03\u5EA6\u5668\n  schedulerName: volcano\n  # \u5BB9\u5FCD\u6240\u6709\u6C61\u70B9\uFF0C\u4EC5\u505A\u6D4B\u8BD5\n  tolerations:\n  - key: volcano.sh/vgpu\n    operator: Exists\n    effect: NoSchedule\n  - key: nvidia.com/gpu\n    operator: Exists\n    effect: NoSchedule\n  - key: nvidia.com/gpu.product\n    operator: Exists\n    effect: NoSchedule\n  - key: special.accelerate.usage\n    operator: Exists\n    effect: NoSchedule\n  - key: maip.msxf.io/node.usage\n    operator: Exists\n    effect: NoSchedule\n  - key: maip.msxf.io/ib.present\n    operator: Exists\n    effect: NoSchedule\n  containers:\n    - name: cuda-container\n      image: aiharbor.msxf.local/test/nvidia/cuda:12.2.0-base-ubuntu22.04\n      command: ["sleep"]\n      args: ["100000"]\n      resources:\n        requests:\n          volcano.sh/vgpu-number: 2      # \uFF08\u5FC5\u987B\uFF09\u8BF7\u6C42 2 \u5F20 GPU \u5361\n          volcano.sh/vgpu-memory: 3000   # \uFF08\u53EF\u9009\uFF09\u6BCF\u4E2A vGPU \u4F7F\u7528 3G \u663E\u5B58\uFF0C\u8D85\u8FC7\u5355\u5361\u663E\u5B58\u5219\u7528\u6700\u5927\u5355\u5361\u663E\u5B58\n          volcano.sh/vgpu-cores: 50      # \uFF08\u53EF\u9009\uFF09\u6BCF\u4E2A vGPU \u4F7F\u7528 50% \u6838\u5FC3\n        limits:\n          volcano.sh/vgpu-number: 2       \n          volcano.sh/vgpu-memory: 3000   \n          volcano.sh/vgpu-cores: 50    \n'})}),"\n",(0,d.jsxs)(n.p,{children:["\u8FD0\u884C\u540E\uFF0C\u67E5\u770B",(0,d.jsx)(n.code,{children:"Pod"}),"\u4FE1\u606F\uFF1A"]}),"\n",(0,d.jsx)(n.pre,{children:(0,d.jsx)(n.code,{className:"language-bash",children:"$ kubectl get pod\nNAME                                   READY   STATUS    RESTARTS      AGE\ntest-vgpu                              1/1     Running   0             23s\n"})}),"\n",(0,d.jsxs)(n.p,{children:["\u8FDB\u5165",(0,d.jsx)(n.code,{children:"Pod"}),"\u5BB9\u5668\u6267\u884C",(0,d.jsx)(n.code,{children:"nvidia-smi"}),"\u547D\u4EE4\u67E5\u770B",(0,d.jsx)(n.code,{children:"vGPU"}),"\u8D44\u6E90\u4FE1\u606F\uFF0C\u6267\u884C\u4EE5\u4E0B\u6307\u4EE4\uFF1A"]}),"\n",(0,d.jsx)(n.pre,{children:(0,d.jsx)(n.code,{className:"language-bash",children:"kubectl exec -it test-vgpu bash\n"})}),"\n",(0,d.jsxs)(n.p,{children:["\u67E5\u770B",(0,d.jsx)(n.code,{children:"vGPU"}),"\u8D44\u6E90\u4FE1\u606F\u5982\u4E0B\uFF1A"]}),"\n",(0,d.jsx)(n.pre,{children:(0,d.jsx)(n.code,{className:"language-text",children:"root@test-vgpu:/# nvidia-smi\n[HAMI-core Msg(18:140441960732480:libvgpu.c:839)]: Initializing.....\nMon Nov 24 12:13:31 2025       \n+-----------------------------------------------------------------------------------------+\n| NVIDIA-SMI 580.105.08             Driver Version: 580.105.08     CUDA Version: 13.0     |\n+-----------------------------------------+------------------------+----------------------+\n| GPU  Name                 Persistence-M | Bus-Id          Disp.A | Volatile Uncorr. ECC |\n| Fan  Temp   Perf          Pwr:Usage/Cap |           Memory-Usage | GPU-Util  Compute M. |\n|                                         |                        |               MIG M. |\n|=========================================+========================+======================|\n|   0  NVIDIA GeForce RTX 4090        On  |   00000000:BA:00.0 Off |                  Off |\n| 30%   35C    P8             13W /  450W |       0MiB /   3000MiB |      0%      Default |\n|                                         |                        |                  N/A |\n+-----------------------------------------+------------------------+----------------------+\n|   1  NVIDIA GeForce RTX 4090        On  |   00000000:BB:00.0 Off |                  Off |\n| 30%   33C    P8             24W /  450W |       0MiB /   3000MiB |      0%      Default |\n|                                         |                        |                  N/A |\n+-----------------------------------------+------------------------+----------------------+\n\n+-----------------------------------------------------------------------------------------+\n| Processes:                                                                              |\n|  GPU   GI   CI              PID   Type   Process name                        GPU Memory |\n|        ID   ID                                                               Usage      |\n|=========================================================================================|\n|  No running processes found                                                             |\n+-----------------------------------------------------------------------------------------+\n[HAMI-core Msg(18:140441960732480:multiprocess_memory_limit.c:455)]: Calling exit handler 18\nroot@test-vgpu:/# \n"})}),"\n",(0,d.jsxs)(n.p,{children:["\u5728\u6807\u51C6\u8F93\u51FA\u4E2D\u4EE5",(0,d.jsx)(n.code,{children:"HAMI-core"}),"\u5F00\u5934\u7684\u4FE1\u606F\u5C5E\u4E8E",(0,d.jsx)(n.code,{children:"HAMI-core"}),"\u901A\u8FC7",(0,d.jsx)(n.code,{children:"CUDA API"}),"\u52AB\u6301\u7684\u8C03\u8BD5\u4FE1\u606F\uFF0C\u8868\u793A",(0,d.jsx)(n.code,{children:"HAMI-core"}),"\u5B9E\u9645\u4EE5\u53CA\u8D77\u4F5C\u7528\uFF0C\u4F8B\u5982",(0,d.jsx)(n.code,{children:"[HAMI-core Msg(18:140441960732480:multiprocess_memory_limit.c:455)]: Calling exit handler 18"}),"\u8868\u793A\u662F\u7531",(0,d.jsx)(n.code,{children:"HAMi-core"}),"\u7EC4\u4EF6\u6267\u884C\u5B8C\u6210\uFF0C\u5B83\u4F1A\u5728",(0,d.jsx)(n.code,{children:"nvidia-smi"}),"\u547D\u4EE4\u672B\u5C3E\u6267\u884C\u4E00\u4E9B\u8D44\u6E90\u6E05\u7406\u5DE5\u4F5C\u3002"]}),"\n",(0,d.jsx)(n.h3,{id:"\u4F7F\u7528nvidia-device-plugin\u7684\u8D44\u6E90",children:"\u4F7F\u7528nvidia-device-plugin\u7684\u8D44\u6E90"}),"\n",(0,d.jsxs)(n.p,{children:["\u539F\u672C\u4F7F\u7528",(0,d.jsx)(n.code,{children:"nvidia device plugin"}),"\u7684\u8282\u70B9\u8D44\u6E90\u4E0D\u4F1A\u53D7\u5F71\u54CD\uFF0C\u90E8\u7F72\u7684",(0,d.jsx)(n.code,{children:"Pod YAML"}),"\u5982\u4E0B\uFF1A"]}),"\n",(0,d.jsx)(n.pre,{children:(0,d.jsx)(n.code,{className:"language-yaml",metastring:'title="test-nvidia-device-plugin.yaml"',children:'apiVersion: v1\nkind: Pod\nmetadata:\n  name: test-nvidia-device-plugin\nspec:\n  # \u9700\u8981\u4F7F\u7528volcano\u8C03\u5EA6\u5668\n  schedulerName: volcano\n  # \u5BB9\u5FCD\u6240\u6709\u6C61\u70B9\uFF0C\u4EC5\u505A\u6D4B\u8BD5\n  tolerations:\n  - key: volcano.sh/vgpu\n    operator: Exists\n    effect: NoSchedule\n  - key: nvidia.com/gpu\n    operator: Exists\n    effect: NoSchedule\n  - key: nvidia.com/gpu.product\n    operator: Exists\n    effect: NoSchedule\n  - key: special.accelerate.usage\n    operator: Exists\n    effect: NoSchedule\n  - key: maip.msxf.io/node.usage\n    operator: Exists\n    effect: NoSchedule\n  - key: maip.msxf.io/ib.present\n    operator: Exists\n    effect: NoSchedule\n  containers:\n    - name: cuda-container\n      image: aiharbor.msxf.local/test/nvidia/cuda:12.2.0-base-ubuntu22.04\n      command: ["sleep"]\n      args: ["100000"]\n      resources:\n        requests:\n          nvidia.com/gpu: 2 # \u4F7F\u7528nvidia device plugin\u6CE8\u518C\u7684\u8D44\u6E90\n        limits:\n          nvidia.com/gpu: 2\n'})}),"\n",(0,d.jsx)(n.h3,{id:"vgpu\u8D44\u6E90\u4E0Envidia\u8D44\u6E90\u540D\u79F0\u517C\u5BB9",children:"vGPU\u8D44\u6E90\u4E0ENVIDIA\u8D44\u6E90\u540D\u79F0\u517C\u5BB9"}),"\n",(0,d.jsxs)(n.p,{children:["\u6309\u7167\u8282\u70B9\u7EF4\u5EA6\u542F\u7528",(0,d.jsx)(n.code,{children:"vGPU"}),"\u540E\uFF0C\u8BE5",(0,d.jsx)(n.code,{children:"vGPU"}),"\u8282\u70B9\u53EA\u80FD\u4F7F\u7528",(0,d.jsx)(n.code,{children:"vGPU"}),"\u7684\u8D44\u6E90\u540D\u79F0\u8FDB\u884C",(0,d.jsx)(n.code,{children:"Pod"}),"\u8D44\u6E90\u7533\u8BF7\uFF0C\u65E0\u6CD5\u518D\u4F7F\u7528\u539F\u6709\u7684\u8D44\u6E90\u540D\u79F0\u8C03\u5EA6\u5230",(0,d.jsx)(n.code,{children:"vGPU"}),"\u8282\u70B9\u4E0A\u3002\n",(0,d.jsx)(n.code,{children:"Volcano vGPU"}),"\u4E5F\u652F\u6301\u5C06\u6574\u5361\u548C",(0,d.jsx)(n.code,{children:"vGPU"}),"\u8FDB\u884C\u517C\u5BB9\u6027\u7684\u8D44\u6E90\u540D\u79F0\u914D\u7F6E\uFF0C\u4F8B\u5982\u5C06",(0,d.jsx)(n.code,{children:"vGPU"}),"\u7684\u8D44\u6E90\u540D\u79F0\u548C",(0,d.jsx)(n.code,{children:"nvidia"}),"\u7684\u8D44\u6E90\u540D\u79F0\u4FDD\u6301\u4E00\u81F4\uFF08",(0,d.jsx)(n.code,{children:"nvidia.com/gpu"}),"\uFF09\u3002\u6211\u4EEC\u6765\u505A\u4E00\u4E0B\u517C\u5BB9\u6027\u6D4B\u8BD5\u3002"]}),"\n",(0,d.jsx)(n.h4,{id:"\u914D\u7F6E\u6587\u4EF6\u53D8\u5316",children:"\u914D\u7F6E\u6587\u4EF6\u53D8\u5316"}),"\n",(0,d.jsxs)(n.p,{children:["\u8C03\u6574",(0,d.jsx)(n.code,{children:"vGPU"}),"\u5168\u5C40\u8D44\u6E90\u540D\u79F0\u7684\u914D\u7F6E\u5982\u4E0B\uFF08",(0,d.jsx)(n.code,{children:"resourceCountName"}),"\u914D\u7F6E\u4ECE",(0,d.jsx)(n.code,{children:"volcano.sh/vgpu-number"}),"\u6539\u4E3A",(0,d.jsx)(n.code,{children:"nvidia.com/gpu"}),"\uFF09\uFF1A"]}),"\n",(0,d.jsx)(n.pre,{children:(0,d.jsx)(n.code,{className:"language-yaml",children:"nvidia:\n  resourceCountName: nvidia.com/gpu\n  resourceMemoryName: volcano.sh/vgpu-memory\n  resourceMemoryPercentageName: volcano.sh/vgpu-memory-percentage\n  resourceCoreName: volcano.sh/vgpu-cores\n  overwriteEnv: false\n  defaultMemory: 0\n  defaultCores: 0\n  defaultGPUNum: 1\n  deviceSplitCount: 10\n  deviceMemoryScaling: 1\n  deviceCoreScaling: 1\n  gpuMemoryFactor: 1\n  knownMigGeometries: []\n"})}),"\n",(0,d.jsxs)(n.p,{children:["\u968F\u540E\u91CD\u542F",(0,d.jsx)(n.code,{children:"volcano-vgpu-device-plugin"}),"\uFF0C\u53D1\u73B0",(0,d.jsx)(n.code,{children:"volcano-vgpu-device-plugin"}),"\u7EC4\u4EF6\u7684\u8D44\u6E90\u540D\u79F0\u5E76\u672A\u5728\u8282\u70B9\u4E0A\u53D1\u73B0\u6CA1\u6709\u751F\u6548\uFF0C\u7ECF\u8FC7\u67E5\u770B",(0,d.jsx)(n.code,{children:"volcano-vgpu-device-plugin"}),"\u548C",(0,d.jsx)(n.code,{children:"volcano"}),"\u7684",(0,d.jsx)(n.code,{children:"deviceshare"}),"\u63D2\u4EF6\u7684\u6E90\u7801\uFF0C\u53D1\u73B0\uFF1A"]}),"\n",(0,d.jsxs)(n.ul,{children:["\n",(0,d.jsxs)(n.li,{children:[(0,d.jsx)(n.code,{children:"volcano-vgpu-device-config"}),"\u7684",(0,d.jsx)(n.code,{children:"ConfigMap"}),"\u914D\u7F6E\u6587\u4EF6\u53EA\u662F\u7ED9",(0,d.jsx)(n.code,{children:"volcano"}),"\u7684",(0,d.jsx)(n.code,{children:"deviceshare"}),"\u63D2\u4EF6\u4F7F\u7528\u7684\u3002"]}),"\n",(0,d.jsxs)(n.li,{children:[(0,d.jsx)(n.code,{children:"volcano-vgpu-device-plugin"}),"\u7EC4\u4EF6\u7684\u6E90\u7801\u4E2D\u5FFD\u7565\u4E86",(0,d.jsx)(n.code,{children:"ConfigMap"}),"\u7684\u8BE5\u914D\u7F6E\uFF0C\u800C\u662F\u901A\u8FC7\u547D\u4EE4\u884C\u53C2\u6570\u6307\u5B9A\u8D44\u6E90\u540D\u79F0\uFF0C\u5176\u652F\u6301\u7684\u547D\u4EE4\u884C\u53C2\u6570\u5982\u4E0B\uFF1A","\n",(0,d.jsxs)(n.table,{children:[(0,d.jsx)(n.thead,{children:(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.th,{children:"\u547D\u4EE4\u884C\u53C2\u6570"}),(0,d.jsx)(n.th,{children:"\u8BF4\u660E"}),(0,d.jsx)(n.th,{children:"\u9ED8\u8BA4\u503C"})]})}),(0,d.jsxs)(n.tbody,{children:[(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"resource-name"})}),(0,d.jsxs)(n.td,{children:[(0,d.jsx)(n.code,{children:"vGPU"}),"\u4E2A\u6570\u7684\u8D44\u6E90\u540D\u79F0\uFF0C\u751F\u6210\u5230\u8282\u70B9\u4E0A"]}),(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"volcano.sh/vgpu-number"})})]}),(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"resource-memory-name"})}),(0,d.jsxs)(n.td,{children:[(0,d.jsx)(n.code,{children:"vGPU"}),"\u663E\u5B58\u5927\u5C0F\u7684\u8D44\u6E90\u540D\u79F0\uFF0C\u751F\u6210\u5230\u8282\u70B9\u4E0A"]}),(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"volcano.sh/vgpu-memory"})})]}),(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"resource-core-name"})}),(0,d.jsxs)(n.td,{children:[(0,d.jsx)(n.code,{children:"vGPU"}),"\u7B97\u529B\u7684\u8D44\u6E90\u540D\u79F0\uFF0C\u751F\u6210\u5230\u8282\u70B9\u4E0A"]}),(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"volcano.sh/vgpu-cores"})})]}),(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"debug"})}),(0,d.jsx)(n.td,{children:"\u662F\u5426\u5F00\u542F\u8C03\u8BD5\u6A21\u5F0F"}),(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"false"})})]})]})]}),"\n"]}),"\n",(0,d.jsxs)(n.li,{children:["\u8FD9\u4E24\u4E2A\u7EC4\u4EF6\u7684\u76F8\u5173\u914D\u7F6E\u9879\u9700\u8981\u4FDD\u6301\u4E00\u81F4\uFF0C\u5426\u5219\u65E0\u6CD5\u90E8\u7F72",(0,d.jsx)(n.code,{children:"Pod"}),"\u3002"]}),"\n"]}),"\n",(0,d.jsx)(n.p,{children:"\u5C06\u547D\u4EE4\u884C\u53C2\u6570\uFF1A"}),"\n",(0,d.jsx)(n.pre,{children:(0,d.jsx)(n.code,{className:"language-yaml",children:'containers:\n- image: aiharbor.msxf.local/test/projecthami/volcano-vgpu-device-plugin:v1.11.0\n  args: ["--device-split-count=10"]\n'})}),"\n",(0,d.jsx)(n.p,{children:"\u8C03\u6574\u4E3A\uFF1A"}),"\n",(0,d.jsx)(n.pre,{children:(0,d.jsx)(n.code,{className:"language-yaml",children:'containers:\n- image: aiharbor.msxf.local/test/projecthami/volcano-vgpu-device-plugin:v1.11.0\n  args: [\n    "--device-split-count=10",\n    "--resource-name=nvidia.com/gpu"\n  ]\n'})}),"\n",(0,d.jsx)(n.h4,{id:"\u90E8\u7F72\u6587\u4EF6\u793A\u4F8B",children:"\u90E8\u7F72\u6587\u4EF6\u793A\u4F8B"}),"\n",(0,d.jsxs)(n.p,{children:["\u8FD9\u662F\u5B8C\u6574\u7684",(0,d.jsx)(n.code,{children:"volcano-vgpu-device-plugin"}),"\u7EC4\u4EF6\u90E8\u7F72\u6587\u4EF6\uFF0C\u4EC5\u4F9B\u53C2\u8003\uFF1A",(0,d.jsx)(n.a,{target:"_blank","data-noBrokenLinkCheck":!0,href:c(54180).Z+"",children:"volcano-vgpu-device-config.compatible.yaml"})]}),"\n",(0,d.jsxs)(n.p,{children:["\u6267\u884C\u540E\uFF0C",(0,d.jsx)(n.code,{children:"volcano-vgpu-device-plugin"}),"\u7EC4\u4EF6\u4F1A\u91CD\u542F\uFF0C\u540C\u65F6\u624B\u52A8\u91CD\u542F",(0,d.jsx)(n.code,{children:"volcano scheduler"}),"\uFF0C\u968F\u540E\u67E5\u770B",(0,d.jsx)(n.code,{children:"vGPU"}),"\u8282\u70B9\u8D44\u6E90\u60C5\u51B5\u5982\u4E0B\uFF0C\u53EF\u4EE5\u770B\u5230\uFF0C",(0,d.jsx)(n.code,{children:"vGPU"}),"\u7684\u5361\u8D44\u6E90\u540D\u79F0\u548C",(0,d.jsx)(n.code,{children:"NVIDIA"}),"\u4FDD\u6301\u4E00\u81F4\uFF0C\u4F7F\u7528\u7684\u662F",(0,d.jsx)(n.code,{children:"nvidia.com/gpu"}),"\uFF1A"]}),"\n",(0,d.jsx)(n.pre,{children:(0,d.jsx)(n.code,{className:"language-yaml",children:"# ...\nCapacity:\n  cpu:                     128\n  ephemeral-storage:       562291Mi\n  hugepages-1Gi:           0\n  hugepages-2Mi:           0\n  memory:                  263746296Ki\n  nvidia.com/gpu:          80\n  nvidia.com/gpu.shared:   0\n  pods:                    110\n  volcano.sh/vgpu-cores:   800\n  volcano.sh/vgpu-memory:  196512\n  volcano.sh/vgpu-number:  80\nAllocatable:\n  cpu:                     127600m\n  ephemeral-storage:       562291Mi\n  hugepages-1Gi:           0\n  hugepages-2Mi:           0\n  memory:                  256048108548\n  nvidia.com/gpu:          80\n  nvidia.com/gpu.shared:   0\n  pods:                    110\n  volcano.sh/vgpu-cores:   800\n  volcano.sh/vgpu-memory:  196512\n  volcano.sh/vgpu-number:  0\n# ...\n"})}),"\n",(0,d.jsx)(n.h4,{id:"\u6D4B\u8BD5\u6587\u4EF6\u793A\u4F8B",children:"\u6D4B\u8BD5\u6587\u4EF6\u793A\u4F8B"}),"\n",(0,d.jsxs)(n.p,{children:["\u8FD0\u884C\u4EE5\u4E0B\u793A\u4F8B\u5C06",(0,d.jsx)(n.code,{children:"Pod"}),"\u8C03\u5EA6\u5230",(0,d.jsx)(n.code,{children:"vGPU"}),"\u8282\u70B9\u4E0A\uFF1A"]}),"\n",(0,d.jsx)(n.pre,{children:(0,d.jsx)(n.code,{className:"language-yaml",metastring:'title="test-vgpu-compatible.yaml"',children:'apiVersion: v1\nkind: Pod\nmetadata:\n  name: test-vgpu-compatible\nspec:\n  # \u9700\u8981\u4F7F\u7528volcano\u8C03\u5EA6\u5668\n  schedulerName: volcano\n  # \u65B0\u589E\u8282\u70B9\u9009\u62E9\uFF0C\u8FD0\u884C\u5230vGPU\u8282\u70B9\u4E0A\n  nodeSelector:\n    name: dev-app-2-150-master-1\n  # \u5BB9\u5FCD\u6240\u6709\u6C61\u70B9\uFF0C\u4EC5\u505A\u6D4B\u8BD5\n  tolerations:\n  - key: volcano.sh/vgpu\n    operator: Exists\n    effect: NoSchedule\n  - key: nvidia.com/gpu\n    operator: Exists\n    effect: NoSchedule\n  - key: nvidia.com/gpu.product\n    operator: Exists\n    effect: NoSchedule\n  - key: special.accelerate.usage\n    operator: Exists\n    effect: NoSchedule\n  - key: maip.msxf.io/node.usage\n    operator: Exists\n    effect: NoSchedule\n  - key: maip.msxf.io/ib.present\n    operator: Exists\n    effect: NoSchedule\n  containers:\n    - name: cuda-container\n      image: aiharbor.msxf.local/test/nvidia/cuda:12.2.0-base-ubuntu22.04\n      command: ["sleep"]\n      args: ["100000"]\n      resources:\n        requests:\n          nvidia.com/gpu: 2        # \u8BF7\u6C42 2 \u5F20 GPU \u5361\n        limits:\n          nvidia.com/gpu: 2   \n'})}),"\n",(0,d.jsxs)(n.p,{children:["\u6267\u884C\u540E\uFF0C\u53EF\u4EE5\u770B\u5230",(0,d.jsx)(n.code,{children:"Pod"}),"\u5DF2\u7ECF\u88AB\u6210\u529F\u8C03\u5EA6\u548C\u8FD0\u884C\u3002\u8FDB\u5165",(0,d.jsx)(n.code,{children:"Pod"}),"\u5BB9\u5668\u67E5\u770B\u8D44\u6E90\u60C5\u51B5\uFF0C\u53EF\u4EE5\u770B\u5230\u7533\u8BF7\u7684\u7B97\u529B\u548C\u663E\u5B58\u662F\u6309\u7167\u6574\u5361\u6765\u5206\u914D\u7684\uFF0C\u8FD9\u4E5F\u662F",(0,d.jsx)(n.code,{children:"HAMi vGPU"}),"\u9ED8\u8BA4\u7684\u884C\u4E3A\uFF0C\u4EE5\u4FBF\u4E8E\u548C\u539F\u6709\u7684",(0,d.jsx)(n.code,{children:"NVIDIA device plugin"}),"\u517C\u5BB9\uFF1A"]}),"\n",(0,d.jsx)(n.pre,{children:(0,d.jsx)(n.code,{className:"language-text",children:"$ kubectl exec -it test-vgpu-compatible bash\nkubectl exec [POD] [COMMAND] is DEPRECATED and will be removed in a future version. Use kubectl exec [POD] -- [COMMAND] instead.\nroot@test-vgpu-compatible:/# nvidia-smi\n[HAMI-core Msg(15:139748339885888:libvgpu.c:839)]: Initializing.....\nTue Nov 25 09:26:16 2025       \n+-----------------------------------------------------------------------------------------+\n| NVIDIA-SMI 580.105.08             Driver Version: 580.105.08     CUDA Version: 13.0     |\n+-----------------------------------------+------------------------+----------------------+\n| GPU  Name                 Persistence-M | Bus-Id          Disp.A | Volatile Uncorr. ECC |\n| Fan  Temp   Perf          Pwr:Usage/Cap |           Memory-Usage | GPU-Util  Compute M. |\n|                                         |                        |               MIG M. |\n|=========================================+========================+======================|\n|   0  NVIDIA GeForce RTX 4090        On  |   00000000:BA:00.0 Off |                  Off |\n| 30%   34C    P8             13W /  450W |       0MiB /  24564MiB |      0%      Default |\n|                                         |                        |                  N/A |\n+-----------------------------------------+------------------------+----------------------+\n|   1  NVIDIA GeForce RTX 4090        On  |   00000000:BB:00.0 Off |                  Off |\n| 30%   32C    P8             25W /  450W |       0MiB /  24564MiB |      0%      Default |\n|                                         |                        |                  N/A |\n+-----------------------------------------+------------------------+----------------------+\n\n+-----------------------------------------------------------------------------------------+\n| Processes:                                                                              |\n|  GPU   GI   CI              PID   Type   Process name                        GPU Memory |\n|        ID   ID                                                               Usage      |\n|=========================================================================================|\n|  No running processes found                                                             |\n+-----------------------------------------------------------------------------------------+\n[HAMI-core Msg(15:139748339885888:multiprocess_memory_limit.c:455)]: Calling exit handler 15\nroot@test-vgpu-compatible:/# \n"})}),"\n",(0,d.jsx)(n.h2,{id:"\u76D1\u63A7\u6307\u6807",children:"\u76D1\u63A7\u6307\u6807"}),"\n",(0,d.jsxs)(n.p,{children:[(0,d.jsx)(n.code,{children:"Volcano vgpu"}),"\u7684\u6307\u6807\u901A\u8FC7",(0,d.jsx)(n.code,{children:"volcano scheduler"}),"\u66B4\u9732\uFF0C\u53EF\u4EE5\u901A\u8FC7\u8FDB\u5165\u96C6\u7FA4\u4E2D\u4EFB\u4E00\u652F\u6301",(0,d.jsx)(n.code,{children:"curl"}),"\u547D\u4EE4\u7684",(0,d.jsx)(n.code,{children:"Pod"}),"\uFF0C\u968F\u540E",(0,d.jsx)(n.code,{children:"curl"}),"\u4E00\u4E0B",(0,d.jsx)(n.code,{children:"volcano scheduler"}),"\u7684\u63A5\u53E3\u5730\u5740\uFF0C\u4F8B\u5982\uFF1A"]}),"\n",(0,d.jsx)(n.pre,{children:(0,d.jsx)(n.code,{className:"language-yaml",children:"# 10.233.75.65\u4E3A\u4E3Bvolcano scheduler\u7684ClusterIP\ncurl 10.233.75.65:8080/metrics\n"})}),"\n",(0,d.jsxs)(n.p,{children:["\u8FD4\u56DE\u7684\u6307\u6807\u6BD4\u8F83\u91CD\uFF0C\u5176\u4E2D\u4E0E",(0,d.jsx)(n.code,{children:"vGPU"}),"\u76F8\u5173\u7684\u6307\u6807\uFF1A",(0,d.jsx)(n.a,{target:"_blank","data-noBrokenLinkCheck":!0,href:c(95290).Z+"",children:"volcano-vgpu-metrics.txt"})]}),"\n",(0,d.jsx)(n.h2,{id:"\u5E38\u89C1\u95EE\u9898",children:"\u5E38\u89C1\u95EE\u9898"}),"\n",(0,d.jsx)(n.h3,{id:"vgpu-pod\u90E8\u7F72\u65F6\u62A5\u9519unexpectedadmissionerror",children:"vGPU Pod\u90E8\u7F72\u65F6\u62A5\u9519UnexpectedAdmissionError"}),"\n",(0,d.jsxs)(n.p,{children:["\u5728\u8C03\u6574\u5B8C",(0,d.jsx)(n.code,{children:"volcano-vgpu-device-config"}),"\u8FD9\u4E2A",(0,d.jsx)(n.code,{children:"ConfigMap"}),"\u4E2D\u7684",(0,d.jsx)(n.code,{children:"resourceCountName"}),"\u914D\u7F6E\u9879\u4E3A\u81EA\u5B9A\u4E49\u7684\u8D44\u6E90\u540D\u79F0\u540E\uFF0C",(0,d.jsx)(n.code,{children:"Pod"}),"\u90E8\u7F72\u65F6\u72B6\u6001\u4E3A",(0,d.jsx)(n.code,{children:"UnexpectedAdmissionError"}),"\uFF1A"]}),"\n",(0,d.jsx)(n.pre,{children:(0,d.jsx)(n.code,{className:"language-bash",children:"$ kubectl get pod\nNAME                                   READY   STATUS                     RESTARTS   AGE\ntest-vgpu-compatible                   0/1     UnexpectedAdmissionError   0          75s\n"})}),"\n",(0,d.jsxs)(n.p,{children:["\u901A\u8FC7",(0,d.jsx)(n.code,{children:"kubectl describe pod"}),"\u67E5\u770B",(0,d.jsx)(n.code,{children:"Pod"}),"\u7684",(0,d.jsx)(n.code,{children:"Events"}),"\u5982\u4E0B\uFF1A"]}),"\n",(0,d.jsx)(n.pre,{children:(0,d.jsx)(n.code,{className:"language-yaml",children:"Events:\n  Type     Reason                    Age   From     Message\n  ----     ------                    ----  ----     -------\n  Normal   Scheduled                 25s   volcano  Successfully assigned volcano-system/test-vgpu-compatible to dev-app-2-150-master-1\n  Warning  UnexpectedAdmissionError  25s   kubelet  Allocate failed due to rpc error: code = Unknown desc = device request not found, which is unexpected\n"})}),"\n",(0,d.jsxs)(n.p,{children:["\u901A\u8FC7\u7FFB\u67E5",(0,d.jsx)(n.code,{children:"volcano"}),"\u548C",(0,d.jsx)(n.code,{children:"volcano-vgpu-device-plugin"}),"\u6E90\u7801\uFF0C\u7ECF\u8FC7\u6392\u67E5\u662F\u914D\u7F6E\u6587\u4EF6\u4E0D\u4E00\u81F4\u5F15\u8D77\u7684\u3002\u5728\u4FEE\u6539\u8D44\u6E90\u540D\u79F0\u65F6\uFF0C\u6211\u4EEC\u9700\u8981\u4FDD\u8BC1",(0,d.jsx)(n.code,{children:"3"}),"\u4E2A\u5730\u65B9\u7684\u914D\u7F6E\u6B63\u786E\u6027\u548C\u4E00\u81F4\u6027\uFF0C\u62FF",(0,d.jsx)(n.code,{children:"resourceCountName"}),"\u914D\u7F6E\u9879\u4FEE\u6539\u4E3A",(0,d.jsx)(n.code,{children:"nvidia.com/gpu"}),"\u4E3E\u4F8B\uFF0C\u9700\u8981\u8C03\u6574\u4EE5\u4E0B\u5730\u65B9\uFF1A"]}),"\n",(0,d.jsxs)(n.ul,{children:["\n",(0,d.jsxs)(n.li,{children:[(0,d.jsx)(n.code,{children:"volcano-vgpu-device-config"}),"\u7684",(0,d.jsx)(n.code,{children:"resourceCountName: nvidia.com/gpu"})]}),"\n",(0,d.jsxs)(n.li,{children:[(0,d.jsx)(n.code,{children:"volcano-vgpu-device-plugin"}),"\u547D\u4EE4\u884C\u53C2\u6570",(0,d.jsx)(n.code,{children:"--resource-name=nvidia.com/gpu"})]}),"\n",(0,d.jsxs)(n.li,{children:[(0,d.jsx)(n.code,{children:"volcano-scheduler-configmap"}),"\u7684",(0,d.jsx)(n.code,{children:"deviceshare"}),"\u63D2\u4EF6\u9700\u8981\u6307\u5B9A\u6B63\u786E\u7684\u547D\u540D\u7A7A\u95F4\uFF0C\u5982\u4E0B\uFF1A","\n",(0,d.jsx)(n.pre,{children:(0,d.jsx)(n.code,{className:"language-yaml",children:"- name: deviceshare\n  arguments:\n    # \u662F\u5426\u542F\u7528vgpu\u7279\u6027\n    deviceshare.VGPUEnable: true \n    # volcano-vgpu-device-config\u8FD9\u4E2AConfigMap\u5BF9\u5E94\u7684\u547D\u540D\u7A7A\u95F4\n    # \u4FBF\u4E8E\u8C03\u5EA6\u5668\u81EA\u52A8\u8BFB\u53D6ConfigMap\u5185\u5BB9\n    deviceshare.KnownGeometriesCMNamespace: volcano-system \n"})}),"\n","\u53EF\u4EE5\u901A\u8FC7\u67E5\u770B\u8C03\u5EA6\u7684\u65E5\u5FD7\u6765\u6392\u67E5\u8C03\u5EA6\u5668\u4F7F\u7528\u7684\u914D\u7F6E\u6587\u4EF6\u662F\u5426\u6B63\u786E\uFF0C\u547D\u4EE4\u5982\u4E0B\uFF1A","\n",(0,d.jsx)(n.pre,{children:(0,d.jsx)(n.code,{className:"language-bash",children:'$ kubectl logs volcano-scheduler-6645c59d6d-bcw68 | grep "device config"\nI1125 09:11:57.408175       1 config.go:113] "Initializing volcano device config" device-configs={"NvidiaConfig":{"ResourceCountName":"nvidia.com/gpu","ResourceMemoryName":"volcano.sh/vgpu-memory","ResourceCoreName":"volcano.sh/vgpu-cores","ResourceMemoryPercentageName":"volcano.sh/vgpu-memory-percentage","ResourcePriority":"","OverwriteEnv":false,"DefaultMemory":0,"DefaultCores":0,"DefaultGPUNum":1,"DeviceSplitCount":10,"DeviceMemoryScaling":1,"DeviceCoreScaling":1,"DisableCoreLimit":false,"MigGeometriesList":[],"GPUMemoryFactor":1}}\n'})}),"\n"]}),"\n"]})]})}function t(e={}){let{wrapper:n}={...(0,o.a)(),...e.components};return n?(0,d.jsx)(n,{...e,children:(0,d.jsx)(h,{...e})}):h(e)}},54180:function(e,n,c){c.d(n,{Z:function(){return i}});let i=c.p+"assets/files/volcano-vgpu-device-config.compatible-45bbf20921714823fa2950c722826625.yaml"},21308:function(e,n,c){c.d(n,{Z:function(){return i}});let i=c.p+"assets/files/volcano-vgpu-device-plugin-1b4106fa963c611fcf1190146265eaf6.yaml"},95290:function(e,n,c){c.d(n,{Z:function(){return i}});let i=c.p+"assets/files/volcano-vgpu-metrics-3ddb1dcc752b3015e00d18c2dd31969c.txt"},50065:function(e,n,c){c.d(n,{Z:function(){return s},a:function(){return l}});var i=c(67294);let d={},o=i.createContext(d);function l(e){let n=i.useContext(o);return i.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function s(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(d):e.components||d:l(e.components),i.createElement(o.Provider,{value:n},e.children)}}}]);