"use strict";(self.webpackChunkgf_site=self.webpackChunkgf_site||[]).push([["2902"],{80847:function(e,o,r){r.r(o),r.d(o,{metadata:()=>n,contentTitle:()=>d,default:()=>f,assets:()=>l,toc:()=>s,frontMatter:()=>c});var n=JSON.parse('{"id":"docs/\u4E91\u539F\u751F/Argo Workflow/Argo Workflow\u5E38\u89C1\u95EE\u9898/Argo Workflow\u7684GC\u7B56\u7565\uFF0C\u4EC0\u4E48\u65F6\u5019\u4F1A\u53BB\u6E05\u7406Pod","title":"Argo Workflow\u7684GC\u7B56\u7565\uFF0C\u4EC0\u4E48\u65F6\u5019\u4F1A\u53BB\u6E05\u7406Pod","description":"\u8BE6\u7EC6\u8BF4\u660E Argo Workflow \u7684\u5783\u573E\u56DE\u6536\u7B56\u7565\uFF0C\u5305\u62EC Pod \u7684\u751F\u547D\u5468\u671F\u7BA1\u7406\u3001\u6E05\u7406\u65F6\u673A\u548C\u76F8\u5173\u914D\u7F6E\u53C2\u6570\u7684\u89E3\u6790","source":"@site/docs/docs/3000-\u4E91\u539F\u751F/1-Argo Workflow/3-Argo Workflow\u5E38\u89C1\u95EE\u9898/3-Argo Workflow\u7684GC\u7B56\u7565\uFF0C\u4EC0\u4E48\u65F6\u5019\u4F1A\u53BB\u6E05\u7406Pod.md","sourceDirName":"docs/3000-\u4E91\u539F\u751F/1-Argo Workflow/3-Argo Workflow\u5E38\u89C1\u95EE\u9898","slug":"/cloud-native/argo-workflow-gc-policy","permalink":"/cloud-native/argo-workflow-gc-policy","draft":false,"unlisted":false,"tags":[],"version":"current","sidebarPosition":3,"frontMatter":{"slug":"/cloud-native/argo-workflow-gc-policy","title":"Argo Workflow\u7684GC\u7B56\u7565\uFF0C\u4EC0\u4E48\u65F6\u5019\u4F1A\u53BB\u6E05\u7406Pod","hide_title":true,"keywords":["Argo Workflow","GC\u7B56\u7565","Pod\u6E05\u7406","\u8D44\u6E90\u7BA1\u7406","\u5783\u573E\u56DE\u6536","\u6027\u80FD\u4F18\u5316"],"description":"\u8BE6\u7EC6\u8BF4\u660E Argo Workflow \u7684\u5783\u573E\u56DE\u6536\u7B56\u7565\uFF0C\u5305\u62EC Pod \u7684\u751F\u547D\u5468\u671F\u7BA1\u7406\u3001\u6E05\u7406\u65F6\u673A\u548C\u76F8\u5173\u914D\u7F6E\u53C2\u6570\u7684\u89E3\u6790"},"sidebar":"mainSidebar","previous":{"title":"Argo Workflow\u53CATemplate\u6570\u636E\u662F\u5982\u4F55\u5B58\u50A8\u7684","permalink":"/cloud-native/argo-workflow-template-storage"},"next":{"title":"Argo Workflow\u5F00\u53D1\u73AF\u5883\u642D\u5EFA","permalink":"/cloud-native/argo-workflow-development-setup"}}'),t=r("85893"),i=r("50065");let c={slug:"/cloud-native/argo-workflow-gc-policy",title:"Argo Workflow\u7684GC\u7B56\u7565\uFF0C\u4EC0\u4E48\u65F6\u5019\u4F1A\u53BB\u6E05\u7406Pod",hide_title:!0,keywords:["Argo Workflow","GC\u7B56\u7565","Pod\u6E05\u7406","\u8D44\u6E90\u7BA1\u7406","\u5783\u573E\u56DE\u6536","\u6027\u80FD\u4F18\u5316"],description:"\u8BE6\u7EC6\u8BF4\u660E Argo Workflow \u7684\u5783\u573E\u56DE\u6536\u7B56\u7565\uFF0C\u5305\u62EC Pod \u7684\u751F\u547D\u5468\u671F\u7BA1\u7406\u3001\u6E05\u7406\u65F6\u673A\u548C\u76F8\u5173\u914D\u7F6E\u53C2\u6570\u7684\u89E3\u6790"},d=void 0,l={},s=[{value:"\u4E00\u3001<code>TTLStrategy</code>",id:"\u4E00ttlstrategy",level:2},{value:"\u4E8C\u3001<code>PodGC</code>",id:"\u4E8Cpodgc",level:2}];function a(e){let o={a:"a",code:"code",h2:"h2",img:"img",li:"li",p:"p",ul:"ul",...(0,i.a)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)(o.p,{children:["\u6211\u4EEC\u53D1\u73B0\uFF0C\u521B\u5EFA\u7684Workflow\u5728\u6267\u884C\u6210\u529F\u540E\u5E76\u6CA1\u6709\u6E05\u7406\uFF0C\u800C\u662F\u5168\u90E8\u90FD\u4FDD\u7559\u4E86\u4E0B\u6765\uFF0C\u9020\u6210\u7A7A\u95F4\u4E0B\u7684Pod\u8D8A\u79EF\u8D8A\u591A\u3002\u5176\u5B9EArgo Workflow\u662F\u6709\u6E05\u7406\u7B56\u7565\u7684\uFF0C\u6211\u4EEC\u5148\u770B\u770B\u5B98\u65B9\u6587\u6863\u4ECB\u7ECD\uFF1A",(0,t.jsx)(o.a,{href:"https://argoproj.github.io/argo-workflows/cost-optimisation/#limit-the-total-number-of-workflows-and-pods",children:"https://argoproj.github.io/argo-workflows/cost-optimisation/#limit-the-total-number-of-workflows-and-pods"})]}),"\n",(0,t.jsx)(o.p,{children:(0,t.jsx)(o.img,{src:r(39666).Z+"",width:"2964",height:"1712"})}),"\n",(0,t.jsxs)(o.p,{children:["\u5B98\u65B9\u63D0\u4F9B\u4E86\u4E09\u79CD\u5EFA\u8BAE\u6027\u7684\u65B9\u6848\uFF0C\u5176\u4E2D",(0,t.jsx)(o.code,{children:"TTLStrategy"}),"\u548C",(0,t.jsx)(o.code,{children:"PodGC"}),"\u6BD4\u8F83\u5E38\u7528\u4E00\u4E9B\uFF0C\u4E00\u4E2A\u662F",(0,t.jsx)(o.code,{children:"Workflow\u6E05\u7406\u7B56\u7565"}),"\uFF0C\u4E00\u4E2A\u662F",(0,t.jsx)(o.code,{children:"Pod\u6E05\u7406\u7B56\u7565"}),"\u3002\u6211\u4EEC\u6765\u770B\u770B\u8FD9\u4E24\u79CD\u6E05\u7406\u7B56\u7565\u7684\u5177\u4F53\u903B\u8F91\u662F\u600E\u4E48\u6837\u7684\u5427\u3002"]}),"\n",(0,t.jsxs)(o.h2,{id:"\u4E00ttlstrategy",children:["\u4E00\u3001",(0,t.jsx)(o.code,{children:"TTLStrategy"})]}),"\n",(0,t.jsx)(o.p,{children:"\u6267\u884C\u6D41\u7A0B\u56FE\uFF1A"}),"\n",(0,t.jsx)(o.p,{children:(0,t.jsx)(o.img,{src:r(4408).Z+"",width:"1936",height:"1670"})}),"\n",(0,t.jsx)(o.p,{children:"\u6D41\u7A0B\u7B80\u8981\u4ECB\u7ECD\uFF1A"}),"\n",(0,t.jsxs)(o.ul,{children:["\n",(0,t.jsxs)(o.li,{children:["\n",(0,t.jsxs)(o.p,{children:[(0,t.jsx)(o.code,{children:"wfc.runTTLController"})," \u662F\u4F34\u968F\u7740",(0,t.jsx)(o.code,{children:"Argo Workflow Controller"}),"\u4E3B\u6D41\u7A0B\u542F\u52A8\uFF0C\u4F46\u662F\u662F\u5F02\u6B65\u6267\u884C\u7684\u4EFB\u52A1\u3002\u8BE5\u4EFB\u52A1\u8D1F\u8D23TTL\u64CD\u4F5C\u3002"]}),"\n"]}),"\n",(0,t.jsxs)(o.li,{children:["\n",(0,t.jsxs)(o.p,{children:["\u901A\u8FC7",(0,t.jsx)(o.code,{children:"ttlcontroller.NewController"}),"\u65B9\u6CD5\u521B\u5EFA",(0,t.jsx)(o.code,{children:"TTLController"}),"\uFF0C\u5E76\u4E14\u5728\u8FD9\u91CC\u4F1A\u6CE8\u518C\u5BF9\u5E94\u7684",(0,t.jsx)(o.code,{children:"EventHandler"}),"\u7528\u4E8E\u5904\u7406\u5B8C\u6210\u7684",(0,t.jsx)(o.code,{children:"Workflow"}),"\u5BF9\u8C61\uFF1A"]}),"\n"]}),"\n"]}),"\n",(0,t.jsx)(o.p,{children:(0,t.jsx)(o.img,{src:r(90705).Z+"",width:"3456",height:"1252"})}),"\n",(0,t.jsx)(o.p,{children:(0,t.jsx)(o.img,{src:r(12762).Z+"",width:"3052",height:"2292"})}),"\n",(0,t.jsxs)(o.h2,{id:"\u4E8Cpodgc",children:["\u4E8C\u3001",(0,t.jsx)(o.code,{children:"PodGC"})]}),"\n",(0,t.jsxs)(o.p,{children:["\u6211\u4EEC\u5728\u4E4B\u524D\u7684\u6E90\u7801\u5206\u6790\u4E2D\u5DF2\u7ECF\u53D1\u73B0\u6709",(0,t.jsx)(o.code,{children:"podCleanQueue"}),"\u8FD9\u4E48\u4E00\u4E2A\u961F\u5217\uFF0C\u7528\u4E8E\u6E05\u7406",(0,t.jsx)(o.code,{children:"Pod"}),"\u8D44\u6E90\u3002\u5728\u4E4B\u524D\u5BF9",(0,t.jsx)(o.code,{children:"Argo Workflow Controller"}),"\u7684\u6838\u5FC3\u6D41\u7A0B\u7684\u4ECB\u7ECD\u4E2D\u6709\u4E00\u4E2A",(0,t.jsx)(o.code,{children:"woc.operate"}),"\u64CD\u4F5C\uFF0C\u8BE5\u64CD\u4F5C\u6267\u884C\u5B8C\u6210\u540E",(0,t.jsx)(o.code,{children:"Workflow"}),"\u6838\u5FC3\u6D41\u7A0B\u4FBF\u6267\u884C\u5B8C\u6210\u4E86\u3002\u5728\u8FD9\u4E4B\u540E\u8FD8\u6709\u4E00\u4E2A\u64CD\u4F5C\u4FBF\u662F",(0,t.jsx)(o.code,{children:"PodGC\u5904\u7406\u903B\u8F91"}),"\u3002"]}),"\n",(0,t.jsx)(o.p,{children:(0,t.jsx)(o.img,{src:r(53547).Z+"",width:"2020",height:"1096"})}),"\n",(0,t.jsxs)(o.p,{children:["\u6DFB\u52A0\u5230\u961F\u5217\u7684\u64CD\u4F5C\u884C\u4E3A\u662F",(0,t.jsx)(o.code,{children:"deletePod"}),"\uFF0C\u6267\u884C\u903B\u8F91\u4FBF\u662F\u76F4\u63A5\u5220\u9664",(0,t.jsx)(o.code,{children:"Kubernetes"}),"\u4E2D\u5BF9\u5E94\u7684",(0,t.jsx)(o.code,{children:"Pod"}),"\uFF1A"]}),"\n",(0,t.jsx)(o.p,{children:(0,t.jsx)(o.img,{src:r(19058).Z+"",width:"1772",height:"582"})}),"\n",(0,t.jsxs)(o.p,{children:["::: tip\n\u8FD9\u91CC\u9700\u8981\u6CE8\u610F",(0,t.jsx)(o.code,{children:"Completion"}),"\u548C",(0,t.jsx)(o.code,{children:"Success"}),"\u7684\u533A\u522B\u3002\n",(0,t.jsx)(o.code,{children:"Completion"}),"\u8868\u793A",(0,t.jsx)(o.code,{children:"Workflow"}),"\u6267\u884C\u5B8C\u6210\uFF0C",(0,t.jsx)(o.code,{children:"Workflow"}),"\u7684\u72B6\u6001\u4E0D\u662F",(0,t.jsx)(o.code,{children:"Running/Appending/Unknown"}),"\u963B\u585E\u72B6\u6001\u3002\n",(0,t.jsx)(o.code,{children:"Success"}),"\u8868\u793A",(0,t.jsx)(o.code,{children:"Workflow"}),"\u6267\u884C\u5B8C\u6210\uFF0C\u5E76\u4E14",(0,t.jsx)(o.code,{children:"exit code"}),"\u4E3A",(0,t.jsx)(o.code,{children:"0"}),"\uFF0C\u8868\u793A\u6CA1\u6709\u9519\u8BEF\u4EA7\u751F\u3002\n:::"]})]})}function f(e={}){let{wrapper:o}={...(0,i.a)(),...e.components};return o?(0,t.jsx)(o,{...e,children:(0,t.jsx)(a,{...e})}):a(e)}},39666:function(e,o,r){r.d(o,{Z:function(){return n}});let n=r.p+"assets/images/image2021-7-6_16-15-19-90d1a3d3dee70fc7b64953c1c9bb1647.png"},4408:function(e,o,r){r.d(o,{Z:function(){return n}});let n=r.p+"assets/images/image2021-7-6_16-42-1-8f7c4fb8a5fbc40897fc88ecfbeaf207.png"},90705:function(e,o,r){r.d(o,{Z:function(){return n}});let n=r.p+"assets/images/image2021-7-6_16-47-1-59a6a34d132d7293b2084fd1201d5184.png"},12762:function(e,o,r){r.d(o,{Z:function(){return n}});let n=r.p+"assets/images/image2021-7-6_16-50-23-6897a8821373bc68a9f820cb78e17bdf.png"},53547:function(e,o,r){r.d(o,{Z:function(){return n}});let n=r.p+"assets/images/image2021-7-6_17-12-0-7d0a1d8161e397bc775e1dc978061806.png"},19058:function(e,o,r){r.d(o,{Z:function(){return n}});let n=r.p+"assets/images/image2021-7-6_17-14-46-af637befc8ee9942e08a5649d8163696.png"},50065:function(e,o,r){r.d(o,{Z:function(){return d},a:function(){return c}});var n=r(67294);let t={},i=n.createContext(t);function c(e){let o=n.useContext(i);return n.useMemo(function(){return"function"==typeof e?e(o):{...o,...e}},[o,e])}function d(e){let o;return o=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:c(e.components),n.createElement(i.Provider,{value:o},e.children)}}}]);