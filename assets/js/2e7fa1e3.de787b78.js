"use strict";(self.webpackChunkgf_site=self.webpackChunkgf_site||[]).push([["1494"],{90425:function(e,n,c){c.r(n),c.d(n,{metadata:()=>a,contentTitle:()=>s,default:()=>v,assets:()=>r,toc:()=>l,frontMatter:()=>d});var a=JSON.parse('{"id":"docs/AI\u6280\u672F/vGPU/HAMi Volcano\u5B89\u88C5\u6D4B\u8BD5","title":"HAMi Volcano\u5B89\u88C5\u6D4B\u8BD5","description":"\u8BE6\u7EC6\u4ECB\u7ECDVolcano vGPU\u7684\u5B8C\u6574\u90E8\u7F72\u6D41\u7A0B\uFF0C\u5305\u62ECvolcano-vgpu-device-plugin\u7EC4\u4EF6\u5B89\u88C5\u3001\u8C03\u5EA6\u5668\u914D\u7F6E\u3001\u8282\u70B9\u6807\u7B7E\u6C61\u70B9\u8BBE\u7F6E\u3001\u8D44\u6E90\u540D\u79F0\u517C\u5BB9\u6027\u914D\u7F6E\u3001\u5B9E\u9645\u6D4B\u8BD5\u9A8C\u8BC1\u548C\u5E38\u89C1\u95EE\u9898\u6392\u67E5\u3002\u57FA\u4E8EHAMi Core\u5B9E\u73B0GPU\u786C\u9694\u79BB\uFF0C\u652F\u6301\u4E0ENVIDIA Device Plugin\u8D44\u6E90\u540D\u79F0\u517C\u5BB9\u3002","source":"@site/docs/docs/1000-AI\u6280\u672F/500-vGPU/3000-HAMi Volcano\u5B89\u88C5\u6D4B\u8BD5.md","sourceDirName":"docs/1000-AI\u6280\u672F/500-vGPU","slug":"/ai/vgpu-hami-test-with-volcano","permalink":"/ai/vgpu-hami-test-with-volcano","draft":false,"unlisted":false,"tags":[],"version":"current","sidebarPosition":3000,"frontMatter":{"slug":"/ai/vgpu-hami-test-with-volcano","title":"HAMi Volcano\u5B89\u88C5\u6D4B\u8BD5","hide_title":true,"keywords":["Volcano vGPU","volcano-vgpu-device-plugin","HAMi Core","GPU\u5171\u4EAB","deviceshare\u63D2\u4EF6","Kubernetes GPU\u8C03\u5EA6","vGPU\u90E8\u7F72","\u8D44\u6E90\u540D\u79F0\u517C\u5BB9","Prometheus\u76D1\u63A7","GPU\u8282\u70B9\u914D\u7F6E"],"description":"\u8BE6\u7EC6\u4ECB\u7ECDVolcano vGPU\u7684\u5B8C\u6574\u90E8\u7F72\u6D41\u7A0B\uFF0C\u5305\u62ECvolcano-vgpu-device-plugin\u7EC4\u4EF6\u5B89\u88C5\u3001\u8C03\u5EA6\u5668\u914D\u7F6E\u3001\u8282\u70B9\u6807\u7B7E\u6C61\u70B9\u8BBE\u7F6E\u3001\u8D44\u6E90\u540D\u79F0\u517C\u5BB9\u6027\u914D\u7F6E\u3001\u5B9E\u9645\u6D4B\u8BD5\u9A8C\u8BC1\u548C\u5E38\u89C1\u95EE\u9898\u6392\u67E5\u3002\u57FA\u4E8EHAMi Core\u5B9E\u73B0GPU\u786C\u9694\u79BB\uFF0C\u652F\u6301\u4E0ENVIDIA Device Plugin\u8D44\u6E90\u540D\u79F0\u517C\u5BB9\u3002"},"sidebar":"mainSidebar","previous":{"title":"HAMi With Volcano","permalink":"/ai/vgpu-hami-with-volcano"},"next":{"title":"HAMi CUDA Driver API","permalink":"/ai/vgpu-hami-cuda-driver-api"}}'),o=c("85893"),i=c("50065");let d={slug:"/ai/vgpu-hami-test-with-volcano",title:"HAMi Volcano\u5B89\u88C5\u6D4B\u8BD5",hide_title:!0,keywords:["Volcano vGPU","volcano-vgpu-device-plugin","HAMi Core","GPU\u5171\u4EAB","deviceshare\u63D2\u4EF6","Kubernetes GPU\u8C03\u5EA6","vGPU\u90E8\u7F72","\u8D44\u6E90\u540D\u79F0\u517C\u5BB9","Prometheus\u76D1\u63A7","GPU\u8282\u70B9\u914D\u7F6E"],description:"\u8BE6\u7EC6\u4ECB\u7ECDVolcano vGPU\u7684\u5B8C\u6574\u90E8\u7F72\u6D41\u7A0B\uFF0C\u5305\u62ECvolcano-vgpu-device-plugin\u7EC4\u4EF6\u5B89\u88C5\u3001\u8C03\u5EA6\u5668\u914D\u7F6E\u3001\u8282\u70B9\u6807\u7B7E\u6C61\u70B9\u8BBE\u7F6E\u3001\u8D44\u6E90\u540D\u79F0\u517C\u5BB9\u6027\u914D\u7F6E\u3001\u5B9E\u9645\u6D4B\u8BD5\u9A8C\u8BC1\u548C\u5E38\u89C1\u95EE\u9898\u6392\u67E5\u3002\u57FA\u4E8EHAMi Core\u5B9E\u73B0GPU\u786C\u9694\u79BB\uFF0C\u652F\u6301\u4E0ENVIDIA Device Plugin\u8D44\u6E90\u540D\u79F0\u517C\u5BB9\u3002"},s=void 0,r={},l=[{value:"1. \u51C6\u5907\u5DE5\u4F5C",id:"1-\u51C6\u5907\u5DE5\u4F5C",level:2},{value:"1.1 \u955C\u50CF\u51C6\u5907",id:"11-\u955C\u50CF\u51C6\u5907",level:3},{value:"1.2 \u8282\u70B9\u51C6\u5907",id:"12-\u8282\u70B9\u51C6\u5907",level:3},{value:"1.2.1 vGPU\u8282\u70B9\u6807\u7B7E\u6C61\u70B9",id:"121-vgpu\u8282\u70B9\u6807\u7B7E\u6C61\u70B9",level:4},{value:"1.2.2 \u5378\u8F7DvGPU\u8282\u70B9\u7684nvidia-device-plugin",id:"122-\u5378\u8F7Dvgpu\u8282\u70B9\u7684nvidia-device-plugin",level:4},{value:"2. \u6267\u884C\u90E8\u7F72",id:"2-\u6267\u884C\u90E8\u7F72",level:2},{value:"2.1 \u90E8\u7F72volcano-vgpu-device-plugin",id:"21-\u90E8\u7F72volcano-vgpu-device-plugin",level:3},{value:"2.1.1 \u90E8\u7F72\u6587\u4EF6",id:"211-\u90E8\u7F72\u6587\u4EF6",level:4},{value:"2.1.2 \u914D\u7F6E\u8BF4\u660E",id:"212-\u914D\u7F6E\u8BF4\u660E",level:4},{value:"2.1.3 \u6267\u884C\u7ED3\u679C",id:"213-\u6267\u884C\u7ED3\u679C",level:4},{value:"2.2 \u542F\u7528volcano\u8C03\u5EA6\u5668\u652F\u6301vGPU",id:"22-\u542F\u7528volcano\u8C03\u5EA6\u5668\u652F\u6301vgpu",level:3},{value:"3. \u8FD0\u884C\u6D4B\u8BD5",id:"3-\u8FD0\u884C\u6D4B\u8BD5",level:2},{value:"3.1 vGPU\u57FA\u672C\u4F7F\u7528",id:"31-vgpu\u57FA\u672C\u4F7F\u7528",level:3},{value:"3.2 \u4F7F\u7528nvidia-device-plugin\u7684\u8D44\u6E90",id:"32-\u4F7F\u7528nvidia-device-plugin\u7684\u8D44\u6E90",level:3},{value:"3.3 vGPU\u8D44\u6E90\u4E0ENVIDIA\u8D44\u6E90\u540D\u79F0\u517C\u5BB9",id:"33-vgpu\u8D44\u6E90\u4E0Envidia\u8D44\u6E90\u540D\u79F0\u517C\u5BB9",level:3},{value:"3.3.1 \u914D\u7F6E\u6587\u4EF6\u53D8\u5316",id:"331-\u914D\u7F6E\u6587\u4EF6\u53D8\u5316",level:4},{value:"3.3.2 \u90E8\u7F72\u6587\u4EF6\u793A\u4F8B",id:"332-\u90E8\u7F72\u6587\u4EF6\u793A\u4F8B",level:4},{value:"3.3.3 \u6D4B\u8BD5\u6587\u4EF6\u793A\u4F8B",id:"333-\u6D4B\u8BD5\u6587\u4EF6\u793A\u4F8B",level:4},{value:"4. \u76D1\u63A7\u6307\u6807",id:"4-\u76D1\u63A7\u6307\u6807",level:2},{value:"5. \u5E38\u89C1\u95EE\u9898",id:"5-\u5E38\u89C1\u95EE\u9898",level:2},{value:"5.1 vGPU Pod\u90E8\u7F72\u65F6\u62A5\u9519UnexpectedAdmissionError",id:"51-vgpu-pod\u90E8\u7F72\u65F6\u62A5\u9519unexpectedadmissionerror",level:3}];function t(e){let n={code:"code",h2:"h2",h3:"h3",h4:"h4",li:"li",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,i.a)(),...e.components};return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsxs)(n.p,{children:["\u4F7F\u7528",(0,o.jsx)(n.code,{children:"volcano-vgpu"}),"\u65F6\uFF0C\u4E0D\u9700\u8981 \u5B89\u88C5",(0,o.jsx)(n.code,{children:"HAMi"}),"\uFF0C\u4EC5\u4F7F\u7528",(0,o.jsx)(n.code,{children:"Volcano vgpu device-plugin"}),"\u5373\u53EF\u3002\u5B83\u53EF\u4EE5\u4E3A\u7531",(0,o.jsx)(n.code,{children:"volcano"}),"\u7BA1\u7406\u7684",(0,o.jsx)(n.code,{children:"NVIDIA"}),"\u8BBE\u5907\u63D0\u4F9B\u8BBE\u5907\u5171\u4EAB\u673A\u5236\u3002\n\u8BE5\u63D2\u4EF6\u6E90\u7801\u57FA\u4E8E",(0,o.jsx)(n.code,{children:"Nvidia Device Plugin"}),"\u5F00\u53D1\uFF0C\u5E76\u4F7F\u7528",(0,o.jsx)(n.code,{children:"HAMi-core"}),"\u5B9E\u73B0\u5BF9",(0,o.jsx)(n.code,{children:"GPU"}),"\u5361\u7684\u786C\u9694\u79BB\u652F\u6301\u3002\n",(0,o.jsx)(n.code,{children:"Volcano vgpu"}),"\u4EC5\u5728",(0,o.jsx)(n.code,{children:"volcano > 1.9"}),"\u7248\u672C\u4E2D\u53EF\u7528\u3002"]}),"\n",(0,o.jsx)(n.h2,{id:"1-\u51C6\u5907\u5DE5\u4F5C",children:"1. \u51C6\u5907\u5DE5\u4F5C"}),"\n",(0,o.jsx)(n.h3,{id:"11-\u955C\u50CF\u51C6\u5907",children:"1.1 \u955C\u50CF\u51C6\u5907"}),"\n",(0,o.jsxs)(n.p,{children:[(0,o.jsx)(n.code,{children:"Volcano"}),"\u8C03\u5EA6\u5668\u5DF2\u96C6\u6210\u652F\u6301",(0,o.jsx)(n.code,{children:"HAMI vGPU"}),"\uFF0C\u6211\u4EEC\u9700\u8981\u4EE5\u524D\u51C6\u5907\u4EE5\u4E0B\u955C\u50CF\u5230\u672C\u5730\u96C6\u7FA4\u4E2D\uFF1A"]}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-text",children:"docker.io/projecthami/volcano-vgpu-device-plugin:v1.11.0\n"})}),"\n",(0,o.jsxs)(n.p,{children:["\u4E0B\u8F7D\u5230\u672C\u5730",(0,o.jsx)(n.code,{children:"harbor"}),"\u4E2D\uFF0C\u65B0\u5730\u5740\u4E3A\uFF1A"]}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-text",children:"aiharbor.msxf.local/test/projecthami/volcano-vgpu-device-plugin:v1.11.0\n"})}),"\n",(0,o.jsx)(n.h3,{id:"12-\u8282\u70B9\u51C6\u5907",children:"1.2 \u8282\u70B9\u51C6\u5907"}),"\n",(0,o.jsx)(n.h4,{id:"121-vgpu\u8282\u70B9\u6807\u7B7E\u6C61\u70B9",children:"1.2.1 vGPU\u8282\u70B9\u6807\u7B7E\u6C61\u70B9"}),"\n",(0,o.jsxs)(n.p,{children:["\u9700\u8981\u7ED9\u9700\u8981\u5B89\u88C5",(0,o.jsx)(n.code,{children:"vGPU"}),"\u7EC4\u4EF6\u7684\u8282\u70B9\u6253\u4E0A\u7279\u5B9A\u7684\u6807\u7B7E\u548C\u6C61\u70B9\uFF0C\u4EE5\u65B9\u4FBF\u7BA1\u7406\u542F\u7528",(0,o.jsx)(n.code,{children:"vGPU"}),"\u7684\u8282\u70B9\uFF0C\u5E76\u4E14\u907F\u514D\u539F\u6709\u7684",(0,o.jsx)(n.code,{children:"nvidia device plugin"}),"\u5BF9\u8BE5",(0,o.jsx)(n.code,{children:"vGPU"}),"\u8282\u70B9\u7684\u8D44\u6E90\u7BA1\u7406\u9020\u6210\u5F71\u54CD\u548C\u8D44\u6E90\u5206\u914D\u51B2\u7A81\u3002\n\u6807\u7B7E\u5982\u4E0B\uFF1A"]}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-yaml",children:'volcano.sh/vgpu.enabled: "true"\n'})}),"\n",(0,o.jsx)(n.p,{children:"\u6C61\u70B9\u5982\u4E0B\uFF1A"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-yaml",children:"volcano.sh/vgpu=hami:NoSchedule\n"})}),"\n",(0,o.jsx)(n.h4,{id:"122-\u5378\u8F7Dvgpu\u8282\u70B9\u7684nvidia-device-plugin",children:"1.2.2 \u5378\u8F7DvGPU\u8282\u70B9\u7684nvidia-device-plugin"}),"\n",(0,o.jsxs)(n.p,{children:["\u5728\u5DF2\u7ECF\u7ED9",(0,o.jsx)(n.code,{children:"vGPU"}),"\u8282\u70B9\u6807\u8BB0\u6807\u7B7E\u548C\u6C61\u70B9\u540E\uFF0C\u9700\u8981\u901A\u8FC7",(0,o.jsx)(n.code,{children:"kubectl delete"}),"\u6307\u4EE4\u5220\u9664\u5BF9\u5E94",(0,o.jsx)(n.code,{children:"vGPU"}),"\u8282\u70B9\u7684",(0,o.jsx)(n.code,{children:"nvidia device plugin pod"}),"\uFF0C\u4F8B\u5982\uFF1A"]}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-bash",children:"kubectl delete pod nvidia-device-plugin-daemonset-vx6fk\n"})}),"\n",(0,o.jsx)(n.h2,{id:"2-\u6267\u884C\u90E8\u7F72",children:"2. \u6267\u884C\u90E8\u7F72"}),"\n",(0,o.jsx)(n.h3,{id:"21-\u90E8\u7F72volcano-vgpu-device-plugin",children:"2.1 \u90E8\u7F72volcano-vgpu-device-plugin"}),"\n",(0,o.jsx)(n.h4,{id:"211-\u90E8\u7F72\u6587\u4EF6",children:"2.1.1 \u90E8\u7F72\u6587\u4EF6"}),"\n",(0,o.jsxs)(n.p,{children:["\u6CE8\u610F\u4EE5\u4E0B\u90E8\u7F72\u6587\u4EF6\u4E2D",(0,o.jsx)(n.code,{children:"Daemonset"}),"\u4E2D\u7684",(0,o.jsx)(n.code,{children:"nodeSelector"}),"\u53CA",(0,o.jsx)(n.code,{children:"tolerations"}),"\uFF1A"]}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-yaml",children:'# Copyright (c) 2019, NVIDIA CORPORATION.  All rights reserved.\n#\n# Licensed under the Apache License, Version 2.0 (the "License");\n# you may not use this file except in compliance with the License.\n# You may obtain a copy of the License at\n#\n#     http://www.apache.org/licenses/LICENSE-2.0\n#\n# Unless required by applicable law or agreed to in writing, software\n# distributed under the License is distributed on an "AS IS" BASIS,\n# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n# See the License for the specific language governing permissions and\n# limitations under the License.\n---\napiVersion: v1\nkind: ConfigMap\nmetadata:\n  name: volcano-vgpu-device-config\n  namespace: volcano-system\n  labels:\n    app.kubernetes.io/component: volcano-vgpu-device-plugin\ndata:\n  device-config.yaml: |-\n    nvidia:\n      resourceCountName: volcano.sh/vgpu-number\n      resourceMemoryName: volcano.sh/vgpu-memory\n      resourceMemoryPercentageName: volcano.sh/vgpu-memory-percentage\n      resourceCoreName: volcano.sh/vgpu-cores\n      overwriteEnv: false\n      defaultMemory: 0\n      defaultCores: 0\n      defaultGPUNum: 1\n      deviceSplitCount: 10\n      deviceMemoryScaling: 1\n      deviceCoreScaling: 1\n      gpuMemoryFactor: 1\n      knownMigGeometries: []\n---\napiVersion: v1\nkind: ConfigMap\nmetadata:\n  name: volcano-vgpu-node-config\n  namespace: volcano-system\n  labels:\n    app.kubernetes.io/component: volcano-vgpu-node-plugin\ndata:\n  config.json: |\n    {\n        "nodeconfig": []\n    }\n---\napiVersion: v1\nkind: ServiceAccount\nmetadata:\n  name: volcano-device-plugin\n  namespace: volcano-system\n---\nkind: ClusterRole\napiVersion: rbac.authorization.k8s.io/v1\nmetadata:\n  name: volcano-device-plugin\nrules:\n- apiGroups: [""]\n  resources: ["nodes"]\n  verbs: ["get", "list", "watch", "update", "patch"]\n- apiGroups: [""]\n  resources: ["nodes/status"]\n  verbs: ["patch"]\n- apiGroups: [""]\n  resources: ["pods"]\n  verbs: ["get", "list", "update", "patch", "watch"]\n- apiGroups: [""]\n  resources: ["configmaps"]\n  verbs: ["get", "list", "watch", "create", "update"]\n---\nkind: ClusterRoleBinding\napiVersion: rbac.authorization.k8s.io/v1\nmetadata:\n  name: volcano-device-plugin\nsubjects:\n- kind: ServiceAccount\n  name: volcano-device-plugin\n  namespace: volcano-system\nroleRef:\n  kind: ClusterRole\n  name: volcano-device-plugin\n  apiGroup: rbac.authorization.k8s.io\n---\napiVersion: apps/v1\nkind: DaemonSet\nmetadata:\n  name: volcano-device-plugin\n  namespace: volcano-system\nspec:\n  selector:\n    matchLabels:\n      name: volcano-device-plugin\n  updateStrategy:\n    type: RollingUpdate\n  template:\n    metadata:\n      # This annotation is deprecated. Kept here for backward compatibility\n      # See https://kubernetes.io/docs/tasks/administer-cluster/guaranteed-scheduling-critical-addon-pods/\n      annotations:\n        scheduler.alpha.kubernetes.io/critical-pod: ""\n      labels:\n        name: volcano-device-plugin\n    spec:\n      nodeSelector:\n        volcano.sh/vgpu.enabled: "true"\n      tolerations:\n      # This toleration is deprecated. Kept here for backward compatibility\n      # See https://kubernetes.io/docs/tasks/administer-cluster/guaranteed-scheduling-critical-addon-pods/\n      - key: volcano.sh/vgpu\n        operator: Exists\n        effect: NoSchedule\n      - key: nvidia.com/gpu\n        operator: Exists\n        effect: NoSchedule\n      - key: nvidia.com/gpu.product\n        operator: Exists\n        effect: NoSchedule\n      - key: special.accelerate.usage\n        operator: Exists\n        effect: NoSchedule\n      - key: maip.msxf.io/node.usage\n        operator: Exists\n        effect: NoSchedule\n      - key: maip.msxf.io/ib.present\n        operator: Exists\n        effect: NoSchedule\n      # Mark this pod as a critical add-on; when enabled, the critical add-on\n      # scheduler reserves resources for critical add-on pods so that they can\n      # be rescheduled after a failure.\n      # See https://kubernetes.io/docs/tasks/administer-cluster/guaranteed-scheduling-critical-addon-pods/\n      priorityClassName: "system-node-critical"\n      serviceAccount: volcano-device-plugin\n      containers:\n      - image: aiharbor.msxf.local/test/projecthami/volcano-vgpu-device-plugin:v1.11.0\n        args: ["--device-split-count=10"]\n        lifecycle:\n          postStart:\n            exec:\n              command: ["/bin/sh", "-c", "cp -f /k8s-vgpu/lib/nvidia/* /usr/local/vgpu/"]\n        name: volcano-device-plugin\n        env:\n        - name: NODE_NAME\n          valueFrom:\n            fieldRef:\n              fieldPath: spec.nodeName\n        - name: HOOK_PATH\n          value: "/usr/local/vgpu"\n        - name: NVIDIA_VISIBLE_DEVICES\n          value: "all"\n        - name: NVIDIA_MIG_MONITOR_DEVICES\n          value: "all"\n        - name: NVIDIA_DRIVER_CAPABILITIES\n          value: "utility"\n        securityContext:\n          allowPrivilegeEscalation: true\n          privileged: true\n          capabilities:\n            drop: ["ALL"]\n            add: ["SYS_ADMIN"]\n        volumeMounts:\n        - name: deviceconfig\n          mountPath: /config\n        - name: device-plugin\n          mountPath: /var/lib/kubelet/device-plugins\n        - name: lib\n          mountPath: /usr/local/vgpu\n        - name: hosttmp\n          mountPath: /tmp\n      - image: aiharbor.msxf.local/test/projecthami/volcano-vgpu-device-plugin:v1.11.0\n        name: monitor\n        command:\n        - /bin/bash\n        - -c\n        - volcano-vgpu-monitor\n        env:\n        - name: NVIDIA_VISIBLE_DEVICES\n          value: "all"\n        - name: NVIDIA_MIG_MONITOR_DEVICES\n          value: "all"\n        - name: HOOK_PATH\n          value: "/tmp/vgpu"\n        - name: NODE_NAME\n          valueFrom:\n            fieldRef:\n              fieldPath: spec.nodeName\n        securityContext:\n          privileged: true\n          allowPrivilegeEscalation: true\n          capabilities:\n            drop: ["ALL"]\n            add: ["SYS_ADMIN"]\n        volumeMounts:\n        - name: dockers\n          mountPath: /run/docker\n        - name: containerds\n          mountPath: /run/containerd\n        - name: sysinfo\n          mountPath: /sysinfo\n        - name: hostvar\n          mountPath: /hostvar\n        - name: hosttmp\n          mountPath: /tmp\n      volumes:\n      - name: deviceconfig\n        configMap:\n          name: volcano-vgpu-node-config\n      - hostPath:\n          path: /var/lib/kubelet/device-plugins\n          type: Directory\n        name: device-plugin\n      - hostPath:\n          path: /usr/local/vgpu\n          type: DirectoryOrCreate\n        name: lib\n      - name: hosttmp\n        hostPath:\n          path: /tmp\n          type: DirectoryOrCreate\n      - name: dockers\n        hostPath:\n          path: /run/docker\n          type: DirectoryOrCreate\n      - name: containerds\n        hostPath:\n          path: /run/containerd\n          type: DirectoryOrCreate\n      - name: usrbin\n        hostPath:\n          path: /usr/bin\n          type: Directory\n      - name: sysinfo\n        hostPath:\n          path: /sys\n          type: Directory\n      - name: hostvar\n        hostPath:\n          path: /var\n          type: Directory\n'})}),"\n",(0,o.jsx)(n.h4,{id:"212-\u914D\u7F6E\u8BF4\u660E",children:"2.1.2 \u914D\u7F6E\u8BF4\u660E"}),"\n",(0,o.jsxs)(n.p,{children:[(0,o.jsx)(n.code,{children:"Volcano vGPU"}),"\u7684\u9ED8\u8BA4\u914D\u7F6E\u5982\u4E0B\uFF1A"]}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-yaml",children:"nvidia:\n  resourceCountName: volcano.sh/vgpu-number\n  resourceMemoryName: volcano.sh/vgpu-memory\n  resourceMemoryPercentageName: volcano.sh/vgpu-memory-percentage\n  resourceCoreName: volcano.sh/vgpu-cores\n  overwriteEnv: false\n  defaultMemory: 0\n  defaultCores: 0\n  defaultGPUNum: 1\n  deviceSplitCount: 10\n  deviceMemoryScaling: 1\n  deviceCoreScaling: 1\n  gpuMemoryFactor: 1\n  knownMigGeometries: []\n"})}),"\n",(0,o.jsx)(n.p,{children:(0,o.jsx)(n.strong,{children:"\u5173\u952E\u914D\u7F6E\u9879\u8BF4\u660E\uFF1A"})}),"\n",(0,o.jsxs)(n.table,{children:[(0,o.jsx)(n.thead,{children:(0,o.jsxs)(n.tr,{children:[(0,o.jsx)(n.th,{children:"\u914D\u7F6E\u9879"}),(0,o.jsx)(n.th,{children:"\u8BF4\u660E"}),(0,o.jsx)(n.th,{children:"\u793A\u4F8B"})]})}),(0,o.jsxs)(n.tbody,{children:[(0,o.jsxs)(n.tr,{children:[(0,o.jsx)(n.td,{children:(0,o.jsx)(n.code,{children:"resourceCountName"})}),(0,o.jsxs)(n.td,{children:[(0,o.jsx)(n.code,{children:"vGPU"}),"\u4E2A\u6570\u7684\u8D44\u6E90\u540D\u79F0"]}),(0,o.jsx)(n.td,{children:(0,o.jsx)(n.code,{children:"volcano.sh/vgpu-number"})})]}),(0,o.jsxs)(n.tr,{children:[(0,o.jsx)(n.td,{children:(0,o.jsx)(n.code,{children:"resourceMemoryName"})}),(0,o.jsxs)(n.td,{children:[(0,o.jsx)(n.code,{children:"vGPU"}),"\u663E\u5B58\u5927\u5C0F\u7684\u8D44\u6E90\u540D\u79F0"]}),(0,o.jsx)(n.td,{children:(0,o.jsx)(n.code,{children:"volcano.sh/vgpu-memory"})})]}),(0,o.jsxs)(n.tr,{children:[(0,o.jsx)(n.td,{children:(0,o.jsx)(n.code,{children:"resourceCoreName"})}),(0,o.jsxs)(n.td,{children:[(0,o.jsx)(n.code,{children:"vGPU"}),"\u7B97\u529B\u7684\u8D44\u6E90\u540D\u79F0"]}),(0,o.jsx)(n.td,{children:(0,o.jsx)(n.code,{children:"volcano.sh/vgpu-cores"})})]}),(0,o.jsxs)(n.tr,{children:[(0,o.jsx)(n.td,{children:(0,o.jsx)(n.code,{children:"resourceMemoryPercentageName"})}),(0,o.jsxs)(n.td,{children:[(0,o.jsx)(n.code,{children:"vGPU"}),"\u663E\u5B58\u6BD4\u4F8B\u7684\u8D44\u6E90\u540D\u79F0\uFF0C\u4EC5\u7528\u5728",(0,o.jsx)(n.code,{children:"Pod"}),"\u7684\u8D44\u6E90\u7533\u8BF7\u4E2D"]}),(0,o.jsx)(n.td,{children:(0,o.jsx)(n.code,{children:"volcano.sh/vgpu-memory-percentage"})})]}),(0,o.jsxs)(n.tr,{children:[(0,o.jsx)(n.td,{children:(0,o.jsx)(n.code,{children:"deviceSplitCount"})}),(0,o.jsxs)(n.td,{children:[(0,o.jsx)(n.code,{children:"GPU"}),"\u5206\u5272\u6570\uFF0C\u6BCF\u5F20",(0,o.jsx)(n.code,{children:"GPU"}),"\u6700\u591A\u53EF\u540C\u65F6\u8FD0\u884C\u7684\u4EFB\u52A1\u6570"]}),(0,o.jsx)(n.td,{children:(0,o.jsx)(n.code,{children:"10"})})]})]})]}),"\n",(0,o.jsx)(n.h4,{id:"213-\u6267\u884C\u7ED3\u679C",children:"2.1.3 \u6267\u884C\u7ED3\u679C"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-bash",children:'$ k apply -f volcano-vgpu-device-plugin.yaml\nconfigmap/volcano-vgpu-device-config created\nconfigmap/volcano-vgpu-node-config created\nserviceaccount/volcano-device-plugin created\nclusterrole.rbac.authorization.k8s.io/volcano-device-plugin created\nclusterrolebinding.rbac.authorization.k8s.io/volcano-device-plugin created\nWarning: spec.template.metadata.annotations[scheduler.alpha.kubernetes.io/critical-pod]: non-functional in v1.16+; use the "priorityClassName" field instead\ndaemonset.apps/volcano-device-plugin created\n\n$ k get pod\nNAME                                   READY   STATUS    RESTARTS      AGE\nvolcano-admission-7dc9b78fc6-686tb     1/1     Running   0             20d\nvolcano-admission-7dc9b78fc6-d9vzk     1/1     Running   0             20d\nvolcano-admission-7dc9b78fc6-h2ssl     1/1     Running   0             20d\nvolcano-controllers-855c676dd4-4gpxp   1/1     Running   1 (13d ago)   20d\nvolcano-controllers-855c676dd4-pspzg   1/1     Running   0             20d\nvolcano-controllers-855c676dd4-zl8cd   1/1     Running   0             20d\nvolcano-device-plugin-7g6v2            2/2     Running   0             22s\nvolcano-scheduler-6645c59d6d-56xdc     1/1     Running   0             6m58s\nvolcano-scheduler-6645c59d6d-p549s     1/1     Running   0             6m58s\nvolcano-scheduler-6645c59d6d-pqt68     1/1     Running   0             6m58s\n'})}),"\n",(0,o.jsxs)(n.p,{children:["\u67E5\u770B\u8282\u70B9",(0,o.jsx)(n.code,{children:"vGPU"}),"\u8D44\u6E90\uFF0C\u53EF\u4EE5\u770B\u5230\u539F\u6709\u7684",(0,o.jsx)(n.code,{children:"nvidia device plugin"}),"\u6CE8\u5165\u7684\u8D44\u6E90",(0,o.jsx)(n.code,{children:"nvidia.com/gpu"}),"\u5DF2\u7ECF\u6E05\u7A7A\uFF0C\u65B0\u751F\u6210\u4E86",(0,o.jsx)(n.code,{children:"vGPU"}),"\u76F8\u5173\u7684\u8D44\u6E90",(0,o.jsx)(n.code,{children:"volcano.sh/vgpu-cores"}),"\u3001",(0,o.jsx)(n.code,{children:"volcano.sh/vgpu-memory"}),"\u53CA",(0,o.jsx)(n.code,{children:"volcano.sh/vgpu-number"}),"\u3002"]}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-yaml",children:"# ...\nCapacity:\n  cpu:                     128\n  ephemeral-storage:       562291Mi\n  hugepages-1Gi:           0\n  hugepages-2Mi:           0\n  memory:                  263746296Ki\n  nvidia.com/gpu:          0\n  nvidia.com/gpu.shared:   0\n  pods:                    110\n  volcano.sh/vgpu-cores:   800\n  volcano.sh/vgpu-memory:  196512\n  volcano.sh/vgpu-number:  80\nAllocatable:\n  cpu:                     127600m\n  ephemeral-storage:       562291Mi\n  hugepages-1Gi:           0\n  hugepages-2Mi:           0\n  memory:                  256048108548\n  nvidia.com/gpu:          0\n  nvidia.com/gpu.shared:   0\n  pods:                    110\n  volcano.sh/vgpu-cores:   800\n  volcano.sh/vgpu-memory:  196512\n  volcano.sh/vgpu-number:  80\n# ...\n"})}),"\n",(0,o.jsx)(n.p,{children:(0,o.jsx)(n.strong,{children:"\u81EA\u52A8\u751F\u6210\u7684\u8D44\u6E90\u9879\u8BF4\u660E\uFF1A"})}),"\n",(0,o.jsxs)(n.table,{children:[(0,o.jsx)(n.thead,{children:(0,o.jsxs)(n.tr,{children:[(0,o.jsx)(n.th,{children:"\u8D44\u6E90\u9879"}),(0,o.jsx)(n.th,{children:"\u8BF4\u660E"}),(0,o.jsx)(n.th,{children:"\u793A\u4F8B"})]})}),(0,o.jsxs)(n.tbody,{children:[(0,o.jsxs)(n.tr,{children:[(0,o.jsx)(n.td,{children:(0,o.jsx)(n.code,{children:"volcano.sh/vgpu-cores"})}),(0,o.jsxs)(n.td,{children:[(0,o.jsx)(n.code,{children:"vGPU"}),"\u7B97\u529B\u7684\u8D44\u6E90\u91CF\u767E\u5206\u6BD4\uFF0C\u662F\u8282\u70B9\u4E0A",(0,o.jsx)(n.code,{children:"\u603B\u5361\u6570*100"})]}),(0,o.jsx)(n.td,{children:(0,o.jsx)(n.code,{children:"800"})})]}),(0,o.jsxs)(n.tr,{children:[(0,o.jsx)(n.td,{children:(0,o.jsx)(n.code,{children:"volcano.sh/vgpu-memory"})}),(0,o.jsxs)(n.td,{children:[(0,o.jsx)(n.code,{children:"vGPU"}),"\u663E\u5B58\u7684\u603B\u8D44\u6E90\u91CF\uFF0C\u5355\u4F4D",(0,o.jsx)(n.code,{children:"Mi"}),"\uFF0C\u662F\u8282\u70B9\u4E0A",(0,o.jsx)(n.code,{children:"\u603B\u5361\u6570*\u5355\u5361\u663E\u5B58\u6570"}),"\u3002\u7531\u4E8E",(0,o.jsx)(n.code,{children:"4090"}),"\u663E\u5361\u7684\u5355\u5361\u663E\u5B58\u4E3A",(0,o.jsx)(n.code,{children:"24564Mi"}),"\uFF0C\u90A3\u4E48\u8FD9\u91CC\u7684\u603B\u663E\u5B58\u91CF\u4E3A",(0,o.jsx)(n.code,{children:"196512Mi"})]}),(0,o.jsx)(n.td,{children:(0,o.jsx)(n.code,{children:"196512"})})]}),(0,o.jsxs)(n.tr,{children:[(0,o.jsx)(n.td,{children:(0,o.jsx)(n.code,{children:"volcano.sh/vgpu-number"})}),(0,o.jsxs)(n.td,{children:[(0,o.jsx)(n.code,{children:"vGPU"}),"\u4E2A\u6570\uFF0C\u662F\u8282\u70B9\u4E0A",(0,o.jsx)(n.code,{children:"\u603B\u5361\u6570*deviceSplitCount\u914D\u7F6E"})]}),(0,o.jsx)(n.td,{children:(0,o.jsx)(n.code,{children:"80"})})]})]})]}),"\n",(0,o.jsx)(n.h3,{id:"22-\u542F\u7528volcano\u8C03\u5EA6\u5668\u652F\u6301vgpu",children:"2.2 \u542F\u7528volcano\u8C03\u5EA6\u5668\u652F\u6301vGPU"}),"\n",(0,o.jsxs)(n.p,{children:["\u4FEE\u6539",(0,o.jsx)(n.code,{children:"volcano-scheduler-configmap"}),"\uFF0C\u589E\u52A0\u4EE5\u4E0B\u63D2\u4EF6\u652F\u6301\uFF1A"]}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-yaml",children:"- name: deviceshare\n  arguments:\n    # \u662F\u5426\u542F\u7528vgpu\u7279\u6027\n    deviceshare.VGPUEnable: true \n    # volcano-vgpu-device-config\u8FD9\u4E2AConfigMap\u5BF9\u5E94\u7684\u547D\u540D\u7A7A\u95F4\n    # \u4FBF\u4E8E\u8C03\u5EA6\u5668\u81EA\u52A8\u8BFB\u53D6ConfigMap\u5185\u5BB9\n    deviceshare.KnownGeometriesCMNamespace: volcano-system \n"})}),"\n",(0,o.jsxs)(n.p,{children:["\u4FEE\u6539\u540E\u5185\u5BB9\u5982\u4E0B\uFF08\u4EC5\u4F9B\u793A\u4F8B\u53C2\u8003\uFF0C\u5177\u4F53\u6839\u636E\u81EA\u8EAB\u9700\u8981\u8C03\u6574",(0,o.jsx)(n.code,{children:"volcano action"}),"\u548C",(0,o.jsx)(n.code,{children:"plugin"}),"\u914D\u7F6E\uFF09\uFF1A"]}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-yaml",children:'actions: "enqueue, allocate, backfill"\ntiers:\n- plugins:\n  - name: priority\n  - name: gang\n    enablePreemptable: false\n  - name: conformance\n- plugins:\n  - name: drf\n    enablePreemptable: false\n  - name: deviceshare\n    arguments:\n      # \u662F\u5426\u542F\u7528vgpu\u7279\u6027\n      deviceshare.VGPUEnable: true \n      # volcano-vgpu-device-config\u8FD9\u4E2AConfigMap\u5BF9\u5E94\u7684\u547D\u540D\u7A7A\u95F4\n      # \u4FBF\u4E8E\u8C03\u5EA6\u5668\u81EA\u52A8\u8BFB\u53D6ConfigMap\u5185\u5BB9\n      deviceshare.KnownGeometriesCMNamespace: volcano-system \n  - name: predicates\n  - name: capacity-card\n    arguments:\n      cardUnlimitedCpuMemory: true\n  - name: nodeorder\n  - name: binpack\n'})}),"\n",(0,o.jsxs)(n.p,{children:["\u4FEE\u6539\u540E\u91CD\u542F",(0,o.jsx)(n.code,{children:"volcano-scheduler"}),"\u3002"]}),"\n",(0,o.jsx)(n.h2,{id:"3-\u8FD0\u884C\u6D4B\u8BD5",children:"3. \u8FD0\u884C\u6D4B\u8BD5"}),"\n",(0,o.jsx)(n.h3,{id:"31-vgpu\u57FA\u672C\u4F7F\u7528",children:"3.1 vGPU\u57FA\u672C\u4F7F\u7528"}),"\n",(0,o.jsxs)(n.p,{children:["\u8BE5\u6D4B\u8BD5",(0,o.jsx)(n.code,{children:"Pod"}),"\u4F7F\u7528\u7684\u955C\u50CF\u4E3A",(0,o.jsx)(n.code,{children:"nvidia/cuda:12.2.0-base"}),"\uFF0C\u4E0B\u8F7D\u5230\u672C\u5730\u96C6\u7FA4",(0,o.jsx)(n.code,{children:"harbor"}),"\u4ED3\u5E93\u7684\u955C\u50CF\u5730\u5740",(0,o.jsx)(n.code,{children:"aiharbor.msxf.local/test/nvidia/cuda:12.2.0-base-ubuntu22.04"}),"\uFF1A"]}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-yaml",children:'apiVersion: v1\nkind: Pod\nmetadata:\n  name: test-vgpu\nspec:\n  # \u9700\u8981\u4F7F\u7528volcano\u8C03\u5EA6\u5668\n  schedulerName: volcano\n  # \u5BB9\u5FCD\u6240\u6709\u6C61\u70B9\uFF0C\u4EC5\u505A\u6D4B\u8BD5\n  tolerations:\n  - key: volcano.sh/vgpu\n    operator: Exists\n    effect: NoSchedule\n  - key: nvidia.com/gpu\n    operator: Exists\n    effect: NoSchedule\n  - key: nvidia.com/gpu.product\n    operator: Exists\n    effect: NoSchedule\n  - key: special.accelerate.usage\n    operator: Exists\n    effect: NoSchedule\n  - key: maip.msxf.io/node.usage\n    operator: Exists\n    effect: NoSchedule\n  - key: maip.msxf.io/ib.present\n    operator: Exists\n    effect: NoSchedule\n  containers:\n    - name: cuda-container\n      image: aiharbor.msxf.local/test/nvidia/cuda:12.2.0-base-ubuntu22.04\n      command: ["sleep"]\n      args: ["100000"]\n      resources:\n        requests:\n          volcano.sh/vgpu-number: 2        # \u8BF7\u6C42 2 \u5F20 GPU \u5361\n          volcano.sh/vgpu-memory: 3000     # \uFF08\u53EF\u9009\uFF09\u6BCF\u4E2A vGPU \u4F7F\u7528 3G \u663E\u5B58\n          volcano.sh/vgpu-cores: 50        # \uFF08\u53EF\u9009\uFF09\u6BCF\u4E2A vGPU \u4F7F\u7528 50% \u6838\u5FC3\n        limits:\n          volcano.sh/vgpu-number: 2       \n          volcano.sh/vgpu-memory: 3000   \n          volcano.sh/vgpu-cores: 50    \n'})}),"\n",(0,o.jsxs)(n.p,{children:["\u8FD0\u884C\u540E\uFF0C\u67E5\u770B",(0,o.jsx)(n.code,{children:"Pod"}),"\u4FE1\u606F\uFF1A"]}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-bash",children:"$ k get pod\nNAME                                   READY   STATUS    RESTARTS      AGE\ntest-vgpu                              1/1     Running   0             23s\n"})}),"\n",(0,o.jsxs)(n.p,{children:["\u8FDB\u5165",(0,o.jsx)(n.code,{children:"Pod"}),"\u5BB9\u5668\u6267\u884C",(0,o.jsx)(n.code,{children:"nvidia-smi"}),"\u547D\u4EE4\u67E5\u770B",(0,o.jsx)(n.code,{children:"vGPU"}),"\u8D44\u6E90\u4FE1\u606F\uFF0C\u6267\u884C\u4EE5\u4E0B\u6307\u4EE4\uFF1A"]}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-bash",children:"k exec -it test-vgpu bash\n"})}),"\n",(0,o.jsxs)(n.p,{children:["\u67E5\u770B",(0,o.jsx)(n.code,{children:"vGPU"}),"\u8D44\u6E90\u4FE1\u606F\u5982\u4E0B\uFF1A"]}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-text",children:"root@test-vgpu:/# nvidia-smi\n[HAMI-core Msg(18:140441960732480:libvgpu.c:839)]: Initializing.....\nMon Nov 24 12:13:31 2025       \n+-----------------------------------------------------------------------------------------+\n| NVIDIA-SMI 580.105.08             Driver Version: 580.105.08     CUDA Version: 13.0     |\n+-----------------------------------------+------------------------+----------------------+\n| GPU  Name                 Persistence-M | Bus-Id          Disp.A | Volatile Uncorr. ECC |\n| Fan  Temp   Perf          Pwr:Usage/Cap |           Memory-Usage | GPU-Util  Compute M. |\n|                                         |                        |               MIG M. |\n|=========================================+========================+======================|\n|   0  NVIDIA GeForce RTX 4090        On  |   00000000:BA:00.0 Off |                  Off |\n| 30%   35C    P8             13W /  450W |       0MiB /   3000MiB |      0%      Default |\n|                                         |                        |                  N/A |\n+-----------------------------------------+------------------------+----------------------+\n|   1  NVIDIA GeForce RTX 4090        On  |   00000000:BB:00.0 Off |                  Off |\n| 30%   33C    P8             24W /  450W |       0MiB /   3000MiB |      0%      Default |\n|                                         |                        |                  N/A |\n+-----------------------------------------+------------------------+----------------------+\n\n+-----------------------------------------------------------------------------------------+\n| Processes:                                                                              |\n|  GPU   GI   CI              PID   Type   Process name                        GPU Memory |\n|        ID   ID                                                               Usage      |\n|=========================================================================================|\n|  No running processes found                                                             |\n+-----------------------------------------------------------------------------------------+\n[HAMI-core Msg(18:140441960732480:multiprocess_memory_limit.c:455)]: Calling exit handler 18\nroot@test-vgpu:/# \n"})}),"\n",(0,o.jsxs)(n.p,{children:["\u5728\u6807\u51C6\u8F93\u51FA\u4E2D\u4EE5",(0,o.jsx)(n.code,{children:"HAMI-core"}),"\u5F00\u5934\u7684\u4FE1\u606F\u5C5E\u4E8E",(0,o.jsx)(n.code,{children:"HAMI-core"}),"\u901A\u8FC7",(0,o.jsx)(n.code,{children:"CUDA API"}),"\u52AB\u6301\u7684\u8C03\u8BD5\u4FE1\u606F\uFF0C\u8868\u793A",(0,o.jsx)(n.code,{children:"HAMI-core"}),"\u5B9E\u9645\u4EE5\u53CA\u8D77\u4F5C\u7528\uFF0C\u4F8B\u5982",(0,o.jsx)(n.code,{children:"[HAMI-core Msg(18:140441960732480:multiprocess_memory_limit.c:455)]: Calling exit handler 18"}),"\u8868\u793A\u662F\u7531",(0,o.jsx)(n.code,{children:"HAMi-core"}),"\u7EC4\u4EF6\u6267\u884C\u5B8C\u6210\uFF0C\u5B83\u4F1A\u5728",(0,o.jsx)(n.code,{children:"nvidia-smi"}),"\u547D\u4EE4\u672B\u5C3E\u6267\u884C\u4E00\u4E9B\u8D44\u6E90\u6E05\u7406\u5DE5\u4F5C\u3002"]}),"\n",(0,o.jsx)(n.h3,{id:"32-\u4F7F\u7528nvidia-device-plugin\u7684\u8D44\u6E90",children:"3.2 \u4F7F\u7528nvidia-device-plugin\u7684\u8D44\u6E90"}),"\n",(0,o.jsxs)(n.p,{children:["\u539F\u672C\u4F7F\u7528",(0,o.jsx)(n.code,{children:"nvidia device plugin"}),"\u7684\u8282\u70B9\u8D44\u6E90\u4E0D\u4F1A\u53D7\u5F71\u54CD\uFF0C\u90E8\u7F72\u7684",(0,o.jsx)(n.code,{children:"Pod YAML"}),"\u5982\u4E0B\uFF1A"]}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-yaml",children:'apiVersion: v1\nkind: Pod\nmetadata:\n  name: test-nvidia-device-plugin\nspec:\n  # \u9700\u8981\u4F7F\u7528volcano\u8C03\u5EA6\u5668\n  schedulerName: volcano\n  # \u5BB9\u5FCD\u6240\u6709\u6C61\u70B9\uFF0C\u4EC5\u505A\u6D4B\u8BD5\n  tolerations:\n  - key: volcano.sh/vgpu\n    operator: Exists\n    effect: NoSchedule\n  - key: nvidia.com/gpu\n    operator: Exists\n    effect: NoSchedule\n  - key: nvidia.com/gpu.product\n    operator: Exists\n    effect: NoSchedule\n  - key: special.accelerate.usage\n    operator: Exists\n    effect: NoSchedule\n  - key: maip.msxf.io/node.usage\n    operator: Exists\n    effect: NoSchedule\n  - key: maip.msxf.io/ib.present\n    operator: Exists\n    effect: NoSchedule\n  containers:\n    - name: cuda-container\n      image: aiharbor.msxf.local/test/nvidia/cuda:12.2.0-base-ubuntu22.04\n      command: ["sleep"]\n      args: ["100000"]\n      resources:\n        requests:\n          nvidia.com/gpu: 2 # \u4F7F\u7528nvidia device plugin\u6CE8\u518C\u7684\u8D44\u6E90\n        limits:\n          nvidia.com/gpu: 2\n'})}),"\n",(0,o.jsx)(n.h3,{id:"33-vgpu\u8D44\u6E90\u4E0Envidia\u8D44\u6E90\u540D\u79F0\u517C\u5BB9",children:"3.3 vGPU\u8D44\u6E90\u4E0ENVIDIA\u8D44\u6E90\u540D\u79F0\u517C\u5BB9"}),"\n",(0,o.jsxs)(n.p,{children:["\u6309\u7167\u8282\u70B9\u7EF4\u5EA6\u542F\u7528",(0,o.jsx)(n.code,{children:"vGPU"}),"\u540E\uFF0C\u8BE5",(0,o.jsx)(n.code,{children:"vGPU"}),"\u8282\u70B9\u53EA\u80FD\u4F7F\u7528",(0,o.jsx)(n.code,{children:"vGPU"}),"\u7684\u8D44\u6E90\u540D\u79F0\u8FDB\u884C",(0,o.jsx)(n.code,{children:"Pod"}),"\u8D44\u6E90\u7533\u8BF7\uFF0C\u65E0\u6CD5\u518D\u4F7F\u7528\u539F\u6709\u7684\u8D44\u6E90\u540D\u79F0\u8C03\u5EA6\u5230",(0,o.jsx)(n.code,{children:"vGPU"}),"\u8282\u70B9\u4E0A\u3002\u4E5F\u53EF\u4EE5\u5C06\u6574\u5361\u548C",(0,o.jsx)(n.code,{children:"vGPU"}),"\u8FDB\u884C\u517C\u5BB9\u6027\u7684\u8D44\u6E90\u540D\u79F0\u914D\u7F6E\uFF0C\u4F8B\u5982\u5C06",(0,o.jsx)(n.code,{children:"vGPU"}),"\u7684\u8D44\u6E90\u540D\u79F0\u548C",(0,o.jsx)(n.code,{children:"nvidia"}),"\u7684\u8D44\u6E90\u540D\u79F0\u4FDD\u6301\u4E00\u81F4\u3002\u6211\u4EEC\u6765\u505A\u4E00\u4E0B\u517C\u5BB9\u6027\u6D4B\u8BD5\u3002"]}),"\n",(0,o.jsx)(n.h4,{id:"331-\u914D\u7F6E\u6587\u4EF6\u53D8\u5316",children:"3.3.1 \u914D\u7F6E\u6587\u4EF6\u53D8\u5316"}),"\n",(0,o.jsxs)(n.p,{children:["\u8C03\u6574",(0,o.jsx)(n.code,{children:"vGPU"}),"\u5168\u5C40\u8D44\u6E90\u540D\u79F0\u7684\u914D\u7F6E\u5982\u4E0B\uFF08",(0,o.jsx)(n.code,{children:"resourceCountName"}),"\u914D\u7F6E\u4ECE",(0,o.jsx)(n.code,{children:"volcano.sh/vgpu-number"}),"\u6539\u4E3A",(0,o.jsx)(n.code,{children:"nvidia.com/gpu"}),"\uFF09\uFF1A"]}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-yaml",children:"nvidia:\n  resourceCountName: nvidia.com/gpu\n  resourceMemoryName: volcano.sh/vgpu-memory\n  resourceMemoryPercentageName: volcano.sh/vgpu-memory-percentage\n  resourceCoreName: volcano.sh/vgpu-cores\n  overwriteEnv: false\n  defaultMemory: 0\n  defaultCores: 0\n  defaultGPUNum: 1\n  deviceSplitCount: 10\n  deviceMemoryScaling: 1\n  deviceCoreScaling: 1\n  gpuMemoryFactor: 1\n  knownMigGeometries: []\n"})}),"\n",(0,o.jsxs)(n.p,{children:["\u968F\u540E\u91CD\u542F",(0,o.jsx)(n.code,{children:"volcano-vgpu-device-plugin"}),"\uFF0C\u53D1\u73B0",(0,o.jsx)(n.code,{children:"volcano-vgpu-device-plugin"}),"\u7EC4\u4EF6\u7684\u8D44\u6E90\u540D\u79F0\u5E76\u672A\u5728\u8282\u70B9\u4E0A\u53D1\u73B0\u6CA1\u6709\u751F\u6548\uFF0C\u7ECF\u8FC7\u67E5\u770B",(0,o.jsx)(n.code,{children:"volcano-vgpu-device-plugin"}),"\u548C",(0,o.jsx)(n.code,{children:"volcano"}),"\u7684",(0,o.jsx)(n.code,{children:"deviceshare"}),"\u63D2\u4EF6\u7684\u6E90\u7801\uFF0C\u53D1\u73B0\uFF1A"]}),"\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.code,{children:"volcano-vgpu-device-config"}),"\u7684",(0,o.jsx)(n.code,{children:"ConfigMap"}),"\u914D\u7F6E\u6587\u4EF6\u53EA\u662F\u7ED9",(0,o.jsx)(n.code,{children:"volcano"}),"\u7684",(0,o.jsx)(n.code,{children:"deviceshare"}),"\u63D2\u4EF6\u4F7F\u7528\u7684\u3002"]}),"\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.code,{children:"volcano-vgpu-device-plugin"}),"\u7EC4\u4EF6\u7684\u6E90\u7801\u4E2D\u5FFD\u7565\u4E86",(0,o.jsx)(n.code,{children:"ConfigMap"}),"\u7684\u8BE5\u914D\u7F6E\uFF0C\u800C\u662F\u901A\u8FC7\u547D\u4EE4\u884C\u53C2\u6570\u6307\u5B9A\u8D44\u6E90\u540D\u79F0\uFF0C\u5176\u652F\u6301\u7684\u547D\u4EE4\u884C\u53C2\u6570\u5982\u4E0B\uFF1A","\n",(0,o.jsxs)(n.table,{children:[(0,o.jsx)(n.thead,{children:(0,o.jsxs)(n.tr,{children:[(0,o.jsx)(n.th,{children:"\u547D\u4EE4\u884C\u53C2\u6570"}),(0,o.jsx)(n.th,{children:"\u8BF4\u660E"}),(0,o.jsx)(n.th,{children:"\u9ED8\u8BA4\u503C"})]})}),(0,o.jsxs)(n.tbody,{children:[(0,o.jsxs)(n.tr,{children:[(0,o.jsx)(n.td,{children:(0,o.jsx)(n.code,{children:"resource-name"})}),(0,o.jsxs)(n.td,{children:[(0,o.jsx)(n.code,{children:"vGPU"}),"\u4E2A\u6570\u7684\u8D44\u6E90\u540D\u79F0\uFF0C\u751F\u6210\u5230\u8282\u70B9\u4E0A"]}),(0,o.jsx)(n.td,{children:(0,o.jsx)(n.code,{children:"volcano.sh/vgpu-number"})})]}),(0,o.jsxs)(n.tr,{children:[(0,o.jsx)(n.td,{children:(0,o.jsx)(n.code,{children:"resource-memory-name"})}),(0,o.jsxs)(n.td,{children:[(0,o.jsx)(n.code,{children:"vGPU"}),"\u663E\u5B58\u5927\u5C0F\u7684\u8D44\u6E90\u540D\u79F0\uFF0C\u751F\u6210\u5230\u8282\u70B9\u4E0A"]}),(0,o.jsx)(n.td,{children:(0,o.jsx)(n.code,{children:"volcano.sh/vgpu-memory"})})]}),(0,o.jsxs)(n.tr,{children:[(0,o.jsx)(n.td,{children:(0,o.jsx)(n.code,{children:"resource-core-name"})}),(0,o.jsxs)(n.td,{children:[(0,o.jsx)(n.code,{children:"vGPU"}),"\u7B97\u529B\u7684\u8D44\u6E90\u540D\u79F0\uFF0C\u751F\u6210\u5230\u8282\u70B9\u4E0A"]}),(0,o.jsx)(n.td,{children:(0,o.jsx)(n.code,{children:"volcano.sh/vgpu-cores"})})]}),(0,o.jsxs)(n.tr,{children:[(0,o.jsx)(n.td,{children:(0,o.jsx)(n.code,{children:"debug"})}),(0,o.jsx)(n.td,{children:"\u662F\u5426\u5F00\u542F\u8C03\u8BD5\u6A21\u5F0F"}),(0,o.jsx)(n.td,{children:(0,o.jsx)(n.code,{children:"false"})})]})]})]}),"\n"]}),"\n",(0,o.jsxs)(n.li,{children:["\u8FD9\u4E24\u4E2A\u7EC4\u4EF6\u7684\u76F8\u5173\u914D\u7F6E\u9879\u9700\u8981\u4FDD\u6301\u4E00\u81F4\uFF0C\u5426\u5219\u65E0\u6CD5\u90E8\u7F72",(0,o.jsx)(n.code,{children:"Pod"}),"\u3002"]}),"\n"]}),"\n",(0,o.jsx)(n.p,{children:"\u5C06\u547D\u4EE4\u884C\u53C2\u6570\uFF1A"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-yaml",children:'containers:\n- image: aiharbor.msxf.local/test/projecthami/volcano-vgpu-device-plugin:v1.11.0\n  args: ["--device-split-count=10"]\n'})}),"\n",(0,o.jsx)(n.p,{children:"\u8C03\u6574\u4E3A\uFF1A"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-yaml",children:'containers:\n- image: aiharbor.msxf.local/test/projecthami/volcano-vgpu-device-plugin:v1.11.0\n  args: [\n    "--device-split-count=10",\n    "--resource-name=nvidia.com/gpu"\n  ]\n'})}),"\n",(0,o.jsx)(n.h4,{id:"332-\u90E8\u7F72\u6587\u4EF6\u793A\u4F8B",children:"3.3.2 \u90E8\u7F72\u6587\u4EF6\u793A\u4F8B"}),"\n",(0,o.jsxs)(n.p,{children:["\u4EE5\u4E0B\u4E3A\u5B8C\u6574\u7684",(0,o.jsx)(n.code,{children:"volcano-vgpu-device-plugin"}),"\u7EC4\u4EF6\u90E8\u7F72\u6587\u4EF6\uFF0C\u4EC5\u4F9B\u53C2\u8003\uFF1A"]}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-yaml",children:'# Copyright (c) 2019, NVIDIA CORPORATION.  All rights reserved.\n#\n# Licensed under the Apache License, Version 2.0 (the "License");\n# you may not use this file except in compliance with the License.\n# You may obtain a copy of the License at\n#\n#     http://www.apache.org/licenses/LICENSE-2.0\n#\n# Unless required by applicable law or agreed to in writing, software\n# distributed under the License is distributed on an "AS IS" BASIS,\n# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n# See the License for the specific language governing permissions and\n# limitations under the License.\n---\napiVersion: v1\nkind: ConfigMap\nmetadata:\n  name: volcano-vgpu-device-config\n  namespace: volcano-system\n  labels:\n    app.kubernetes.io/component: volcano-vgpu-device-plugin\ndata:\n  device-config.yaml: |-\n    nvidia:\n      resourceCountName: nvidia.com/gpu\n      resourceMemoryName: volcano.sh/vgpu-memory\n      resourceMemoryPercentageName: volcano.sh/vgpu-memory-percentage\n      resourceCoreName: volcano.sh/vgpu-cores\n      overwriteEnv: false\n      defaultMemory: 0\n      defaultCores: 0\n      defaultGPUNum: 1\n      deviceSplitCount: 10\n      deviceMemoryScaling: 1\n      deviceCoreScaling: 1\n      gpuMemoryFactor: 1\n      knownMigGeometries: []\n---\napiVersion: v1\nkind: ConfigMap\nmetadata:\n  name: volcano-vgpu-node-config\n  namespace: volcano-system\n  labels:\n    app.kubernetes.io/component: volcano-vgpu-node-plugin\ndata:\n  config.json: |\n    {\n        "nodeconfig": []\n    }\n---\napiVersion: v1\nkind: ServiceAccount\nmetadata:\n  name: volcano-device-plugin\n  namespace: volcano-system\n---\nkind: ClusterRole\napiVersion: rbac.authorization.k8s.io/v1\nmetadata:\n  name: volcano-device-plugin\nrules:\n- apiGroups: [""]\n  resources: ["nodes"]\n  verbs: ["get", "list", "watch", "update", "patch"]\n- apiGroups: [""]\n  resources: ["nodes/status"]\n  verbs: ["patch"]\n- apiGroups: [""]\n  resources: ["pods"]\n  verbs: ["get", "list", "update", "patch", "watch"]\n- apiGroups: [""]\n  resources: ["configmaps"]\n  verbs: ["get", "list", "watch", "create", "update"]\n---\nkind: ClusterRoleBinding\napiVersion: rbac.authorization.k8s.io/v1\nmetadata:\n  name: volcano-device-plugin\nsubjects:\n- kind: ServiceAccount\n  name: volcano-device-plugin\n  namespace: volcano-system\nroleRef:\n  kind: ClusterRole\n  name: volcano-device-plugin\n  apiGroup: rbac.authorization.k8s.io\n---\napiVersion: apps/v1\nkind: DaemonSet\nmetadata:\n  name: volcano-device-plugin\n  namespace: volcano-system\nspec:\n  selector:\n    matchLabels:\n      name: volcano-device-plugin\n  updateStrategy:\n    type: RollingUpdate\n  template:\n    metadata:\n      # This annotation is deprecated. Kept here for backward compatibility\n      # See https://kubernetes.io/docs/tasks/administer-cluster/guaranteed-scheduling-critical-addon-pods/\n      annotations:\n        scheduler.alpha.kubernetes.io/critical-pod: ""\n      labels:\n        name: volcano-device-plugin\n    spec:\n      nodeSelector:\n        volcano.sh/vgpu.enabled: "true"\n      tolerations:\n      # This toleration is deprecated. Kept here for backward compatibility\n      # See https://kubernetes.io/docs/tasks/administer-cluster/guaranteed-scheduling-critical-addon-pods/\n      - key: volcano.sh/vgpu\n        operator: Exists\n        effect: NoSchedule\n      - key: nvidia.com/gpu\n        operator: Exists\n        effect: NoSchedule\n      - key: nvidia.com/gpu.product\n        operator: Exists\n        effect: NoSchedule\n      - key: special.accelerate.usage\n        operator: Exists\n        effect: NoSchedule\n      - key: maip.msxf.io/node.usage\n        operator: Exists\n        effect: NoSchedule\n      - key: maip.msxf.io/ib.present\n        operator: Exists\n        effect: NoSchedule\n      # Mark this pod as a critical add-on; when enabled, the critical add-on\n      # scheduler reserves resources for critical add-on pods so that they can\n      # be rescheduled after a failure.\n      # See https://kubernetes.io/docs/tasks/administer-cluster/guaranteed-scheduling-critical-addon-pods/\n      priorityClassName: "system-node-critical"\n      serviceAccount: volcano-device-plugin\n      containers:\n      - image: aiharbor.msxf.local/test/projecthami/volcano-vgpu-device-plugin:v1.11.0\n        args: [\n          "--device-split-count=10",\n          "--resource-name=nvidia.com/gpu"\n        ]\n        lifecycle:\n          postStart:\n            exec:\n              command: ["/bin/sh", "-c", "cp -f /k8s-vgpu/lib/nvidia/* /usr/local/vgpu/"]\n        name: volcano-device-plugin\n        env:\n        - name: NODE_NAME\n          valueFrom:\n            fieldRef:\n              fieldPath: spec.nodeName\n        - name: HOOK_PATH\n          value: "/usr/local/vgpu"\n        - name: NVIDIA_VISIBLE_DEVICES\n          value: "all"\n        - name: NVIDIA_MIG_MONITOR_DEVICES\n          value: "all"\n        - name: NVIDIA_DRIVER_CAPABILITIES\n          value: "utility"\n        securityContext:\n          allowPrivilegeEscalation: true\n          privileged: true\n          capabilities:\n            drop: ["ALL"]\n            add: ["SYS_ADMIN"]\n        volumeMounts:\n        - name: deviceconfig\n          mountPath: /config\n        - name: device-plugin\n          mountPath: /var/lib/kubelet/device-plugins\n        - name: lib\n          mountPath: /usr/local/vgpu\n        - name: hosttmp\n          mountPath: /tmp\n      - image: aiharbor.msxf.local/test/projecthami/volcano-vgpu-device-plugin:v1.11.0\n        name: monitor\n        command:\n        - /bin/bash\n        - -c\n        - volcano-vgpu-monitor\n        env:\n        - name: NVIDIA_VISIBLE_DEVICES\n          value: "all"\n        - name: NVIDIA_MIG_MONITOR_DEVICES\n          value: "all"\n        - name: HOOK_PATH\n          value: "/tmp/vgpu"\n        - name: NODE_NAME\n          valueFrom:\n            fieldRef:\n              fieldPath: spec.nodeName\n        securityContext:\n          privileged: true\n          allowPrivilegeEscalation: true\n          capabilities:\n            drop: ["ALL"]\n            add: ["SYS_ADMIN"]\n        volumeMounts:\n        - name: dockers\n          mountPath: /run/docker\n        - name: containerds\n          mountPath: /run/containerd\n        - name: sysinfo\n          mountPath: /sysinfo\n        - name: hostvar\n          mountPath: /hostvar\n        - name: hosttmp\n          mountPath: /tmp\n      volumes:\n      - name: deviceconfig\n        configMap:\n          name: volcano-vgpu-node-config\n      - hostPath:\n          path: /var/lib/kubelet/device-plugins\n          type: Directory\n        name: device-plugin\n      - hostPath:\n          path: /usr/local/vgpu\n          type: DirectoryOrCreate\n        name: lib\n      - name: hosttmp\n        hostPath:\n          path: /tmp\n          type: DirectoryOrCreate\n      - name: dockers\n        hostPath:\n          path: /run/docker\n          type: DirectoryOrCreate\n      - name: containerds\n        hostPath:\n          path: /run/containerd\n          type: DirectoryOrCreate\n      - name: usrbin\n        hostPath:\n          path: /usr/bin\n          type: Directory\n      - name: sysinfo\n        hostPath:\n          path: /sys\n          type: Directory\n      - name: hostvar\n        hostPath:\n          path: /var\n          type: Directory\n'})}),"\n",(0,o.jsxs)(n.p,{children:["\u6267\u884C\u540E\uFF0C",(0,o.jsx)(n.code,{children:"volcano-vgpu-device-plugin"}),"\u7EC4\u4EF6\u4F1A\u91CD\u542F\uFF0C\u540C\u65F6\u624B\u52A8\u91CD\u542F",(0,o.jsx)(n.code,{children:"volcano scheduler"}),"\uFF0C\u968F\u540E\u67E5\u770B",(0,o.jsx)(n.code,{children:"vGPU"}),"\u8282\u70B9\u8D44\u6E90\u60C5\u51B5\u5982\u4E0B\uFF0C\u53EF\u4EE5\u770B\u5230\uFF0C",(0,o.jsx)(n.code,{children:"vGPU"}),"\u7684\u5361\u8D44\u6E90\u540D\u79F0\u548C",(0,o.jsx)(n.code,{children:"NVIDIA"}),"\u4FDD\u6301\u4E00\u81F4\uFF0C\u4F7F\u7528\u7684\u662F",(0,o.jsx)(n.code,{children:"nvidia.com/gpu"}),"\uFF1A"]}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-yaml",children:"# ...\nCapacity:\n  cpu:                     128\n  ephemeral-storage:       562291Mi\n  hugepages-1Gi:           0\n  hugepages-2Mi:           0\n  memory:                  263746296Ki\n  nvidia.com/gpu:          80\n  nvidia.com/gpu.shared:   0\n  pods:                    110\n  volcano.sh/vgpu-cores:   800\n  volcano.sh/vgpu-memory:  196512\n  volcano.sh/vgpu-number:  80\nAllocatable:\n  cpu:                     127600m\n  ephemeral-storage:       562291Mi\n  hugepages-1Gi:           0\n  hugepages-2Mi:           0\n  memory:                  256048108548\n  nvidia.com/gpu:          80\n  nvidia.com/gpu.shared:   0\n  pods:                    110\n  volcano.sh/vgpu-cores:   800\n  volcano.sh/vgpu-memory:  196512\n  volcano.sh/vgpu-number:  0\n# ...\n"})}),"\n",(0,o.jsx)(n.h4,{id:"333-\u6D4B\u8BD5\u6587\u4EF6\u793A\u4F8B",children:"3.3.3 \u6D4B\u8BD5\u6587\u4EF6\u793A\u4F8B"}),"\n",(0,o.jsxs)(n.p,{children:["\u8FD0\u884C\u4EE5\u4E0B\u793A\u4F8B\u5C06",(0,o.jsx)(n.code,{children:"Pod"}),"\u8C03\u5EA6\u5230",(0,o.jsx)(n.code,{children:"vGPU"}),"\u8282\u70B9\u4E0A\uFF1A"]}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-yaml",children:'apiVersion: v1\nkind: Pod\nmetadata:\n  name: test-vgpu-compatible\nspec:\n  # \u9700\u8981\u4F7F\u7528volcano\u8C03\u5EA6\u5668\n  schedulerName: volcano\n  # \u65B0\u589E\u8282\u70B9\u9009\u62E9\uFF0C\u8FD0\u884C\u5230vGPU\u8282\u70B9\u4E0A\n  nodeSelector:\n    name: dev-app-2-150-master-1\n  # \u5BB9\u5FCD\u6240\u6709\u6C61\u70B9\uFF0C\u4EC5\u505A\u6D4B\u8BD5\n  tolerations:\n  - key: volcano.sh/vgpu\n    operator: Exists\n    effect: NoSchedule\n  - key: nvidia.com/gpu\n    operator: Exists\n    effect: NoSchedule\n  - key: nvidia.com/gpu.product\n    operator: Exists\n    effect: NoSchedule\n  - key: special.accelerate.usage\n    operator: Exists\n    effect: NoSchedule\n  - key: maip.msxf.io/node.usage\n    operator: Exists\n    effect: NoSchedule\n  - key: maip.msxf.io/ib.present\n    operator: Exists\n    effect: NoSchedule\n  containers:\n    - name: cuda-container\n      image: aiharbor.msxf.local/test/nvidia/cuda:12.2.0-base-ubuntu22.04\n      command: ["sleep"]\n      args: ["100000"]\n      resources:\n        requests:\n          nvidia.com/gpu: 2        # \u8BF7\u6C42 2 \u5F20 GPU \u5361\n        limits:\n          nvidia.com/gpu: 2   \n'})}),"\n",(0,o.jsxs)(n.p,{children:["\u6267\u884C\u540E\uFF0C\u53EF\u4EE5\u770B\u5230",(0,o.jsx)(n.code,{children:"Pod"}),"\u5DF2\u7ECF\u88AB\u6210\u529F\u8C03\u5EA6\u548C\u8FD0\u884C\u3002\u8FDB\u5165",(0,o.jsx)(n.code,{children:"Pod"}),"\u5BB9\u5668\u67E5\u770B\u8D44\u6E90\u60C5\u51B5\uFF0C\u53EF\u4EE5\u770B\u5230\u7533\u8BF7\u7684\u7B97\u529B\u548C\u663E\u5B58\u662F\u6309\u7167\u6574\u5361\u6765\u5206\u914D\u7684\uFF0C\u8FD9\u4E5F\u662F",(0,o.jsx)(n.code,{children:"HAMi vGPU"}),"\u9ED8\u8BA4\u7684\u884C\u4E3A\uFF0C\u4EE5\u4FBF\u4E8E\u548C\u539F\u6709\u7684",(0,o.jsx)(n.code,{children:"NVIDIA device plugin"}),"\u517C\u5BB9\uFF1A"]}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-text",children:"$ k exec -it test-vgpu-compatible bash\nkubectl exec [POD] [COMMAND] is DEPRECATED and will be removed in a future version. Use kubectl exec [POD] -- [COMMAND] instead.\nroot@test-vgpu-compatible:/# nvidia-smi\n[HAMI-core Msg(15:139748339885888:libvgpu.c:839)]: Initializing.....\nTue Nov 25 09:26:16 2025       \n+-----------------------------------------------------------------------------------------+\n| NVIDIA-SMI 580.105.08             Driver Version: 580.105.08     CUDA Version: 13.0     |\n+-----------------------------------------+------------------------+----------------------+\n| GPU  Name                 Persistence-M | Bus-Id          Disp.A | Volatile Uncorr. ECC |\n| Fan  Temp   Perf          Pwr:Usage/Cap |           Memory-Usage | GPU-Util  Compute M. |\n|                                         |                        |               MIG M. |\n|=========================================+========================+======================|\n|   0  NVIDIA GeForce RTX 4090        On  |   00000000:BA:00.0 Off |                  Off |\n| 30%   34C    P8             13W /  450W |       0MiB /  24564MiB |      0%      Default |\n|                                         |                        |                  N/A |\n+-----------------------------------------+------------------------+----------------------+\n|   1  NVIDIA GeForce RTX 4090        On  |   00000000:BB:00.0 Off |                  Off |\n| 30%   32C    P8             25W /  450W |       0MiB /  24564MiB |      0%      Default |\n|                                         |                        |                  N/A |\n+-----------------------------------------+------------------------+----------------------+\n\n+-----------------------------------------------------------------------------------------+\n| Processes:                                                                              |\n|  GPU   GI   CI              PID   Type   Process name                        GPU Memory |\n|        ID   ID                                                               Usage      |\n|=========================================================================================|\n|  No running processes found                                                             |\n+-----------------------------------------------------------------------------------------+\n[HAMI-core Msg(15:139748339885888:multiprocess_memory_limit.c:455)]: Calling exit handler 15\nroot@test-vgpu-compatible:/# \n"})}),"\n",(0,o.jsx)(n.h2,{id:"4-\u76D1\u63A7\u6307\u6807",children:"4. \u76D1\u63A7\u6307\u6807"}),"\n",(0,o.jsxs)(n.p,{children:[(0,o.jsx)(n.code,{children:"Volcano vgpu"}),"\u7684\u6307\u6807\u901A\u8FC7",(0,o.jsx)(n.code,{children:"volcano scheduler"}),"\u66B4\u9732\uFF0C\u53EF\u4EE5\u901A\u8FC7\u8FDB\u5165\u96C6\u7FA4\u4E2D\u4EFB\u4E00\u652F\u6301",(0,o.jsx)(n.code,{children:"curl"}),"\u547D\u4EE4\u7684",(0,o.jsx)(n.code,{children:"Pod"}),"\uFF0C\u968F\u540E",(0,o.jsx)(n.code,{children:"curl"}),"\u4E00\u4E0B",(0,o.jsx)(n.code,{children:"volcano scheduler"}),"\u7684\u63A5\u53E3\u5730\u5740\uFF0C\u4F8B\u5982\uFF1A"]}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-yaml",children:"# 10.233.75.65\u4E3A\u4E3Bvolcano scheduler\u7684ClusterIP\ncurl 10.233.75.65:8080/metrics\n"})}),"\n",(0,o.jsxs)(n.p,{children:["\u8FD4\u56DE\u7684\u6307\u6807\u6BD4\u8F83\u91CD\uFF0C\u5176\u4E2D\u4E0E",(0,o.jsx)(n.code,{children:"vGPU"}),"\u76F8\u5173\u7684\u6307\u6807\u5982\u4E0B\uFF1A"]}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-python",children:'# HELP volcano_vgpu_device_allocated_cores The percentage of gpu compute cores allocated in this card\n# TYPE volcano_vgpu_device_allocated_cores gauge\nvolcano_vgpu_device_allocated_cores{NodeName="dev-app-2-150-master-1",devID="GPU-3c8ce108-117a-aeae-a3e8-1c0c5dafebe7"} 0\nvolcano_vgpu_device_allocated_cores{NodeName="dev-app-2-150-master-1",devID="GPU-41c5e13c-b480-c473-7a14-dd05a7c4cd43"} 0\nvolcano_vgpu_device_allocated_cores{NodeName="dev-app-2-150-master-1",devID="GPU-4e9cd184-671c-7b17-8fc2-e9bedbc3d604"} 0\nvolcano_vgpu_device_allocated_cores{NodeName="dev-app-2-150-master-1",devID="GPU-4ff93432-c6b5-7330-30e7-9c0c9a1c648b"} 0\nvolcano_vgpu_device_allocated_cores{NodeName="dev-app-2-150-master-1",devID="GPU-5beec879-79c9-6252-3aaa-9f5e146ba220"} 0\nvolcano_vgpu_device_allocated_cores{NodeName="dev-app-2-150-master-1",devID="GPU-aa336186-301a-bc80-5121-a9a2e430811a"} 0\nvolcano_vgpu_device_allocated_cores{NodeName="dev-app-2-150-master-1",devID="GPU-bc47d475-3538-d3eb-f4ba-e46e2639c54c"} 0\nvolcano_vgpu_device_allocated_cores{NodeName="dev-app-2-150-master-1",devID="GPU-bc94e532-1820-8ee8-ceaa-704166369c7c"} 0\nvolcano_vgpu_device_allocated_cores{NodeName="test-app-64-46-msxf",devID="GPU-07df9e74-a474-9fdd-248e-23e553ef2269"} 0\nvolcano_vgpu_device_allocated_cores{NodeName="test-app-64-46-msxf",devID="GPU-0af50c42-326c-bbff-7a49-a49afa433d3d"} 0\nvolcano_vgpu_device_allocated_cores{NodeName="test-app-64-46-msxf",devID="GPU-1bc8fc24-c939-545a-e272-2229d066d048"} 0\nvolcano_vgpu_device_allocated_cores{NodeName="test-app-64-46-msxf",devID="GPU-50baa64a-6476-a970-1013-121dff41ec78"} 0\nvolcano_vgpu_device_allocated_cores{NodeName="test-app-64-46-msxf",devID="GPU-7050631b-6524-21e3-41cf-6e08fc89220d"} 0\nvolcano_vgpu_device_allocated_cores{NodeName="test-app-64-46-msxf",devID="GPU-7299e30f-ccc4-a274-3e1a-77546d96a448"} 0\nvolcano_vgpu_device_allocated_cores{NodeName="test-app-64-46-msxf",devID="GPU-8cae1965-8e72-af03-1f8c-2e64646392bf"} 0\nvolcano_vgpu_device_allocated_cores{NodeName="test-app-64-46-msxf",devID="GPU-f7219cd7-e3ef-3b1b-4fa2-e84e8d5d4ce5"} 0\n# HELP volcano_vgpu_device_allocated_memory The number of vgpu memory allocated in this card\n# TYPE volcano_vgpu_device_allocated_memory gauge\nvolcano_vgpu_device_allocated_memory{NodeName="dev-app-2-150-master-1",devID="GPU-3c8ce108-117a-aeae-a3e8-1c0c5dafebe7"} 0\nvolcano_vgpu_device_allocated_memory{NodeName="dev-app-2-150-master-1",devID="GPU-41c5e13c-b480-c473-7a14-dd05a7c4cd43"} 0\nvolcano_vgpu_device_allocated_memory{NodeName="dev-app-2-150-master-1",devID="GPU-4e9cd184-671c-7b17-8fc2-e9bedbc3d604"} 0\nvolcano_vgpu_device_allocated_memory{NodeName="dev-app-2-150-master-1",devID="GPU-4ff93432-c6b5-7330-30e7-9c0c9a1c648b"} 0\nvolcano_vgpu_device_allocated_memory{NodeName="dev-app-2-150-master-1",devID="GPU-5beec879-79c9-6252-3aaa-9f5e146ba220"} 24564\nvolcano_vgpu_device_allocated_memory{NodeName="dev-app-2-150-master-1",devID="GPU-aa336186-301a-bc80-5121-a9a2e430811a"} 0\nvolcano_vgpu_device_allocated_memory{NodeName="dev-app-2-150-master-1",devID="GPU-bc47d475-3538-d3eb-f4ba-e46e2639c54c"} 0\nvolcano_vgpu_device_allocated_memory{NodeName="dev-app-2-150-master-1",devID="GPU-bc94e532-1820-8ee8-ceaa-704166369c7c"} 24564\nvolcano_vgpu_device_allocated_memory{NodeName="test-app-64-46-msxf",devID="GPU-07df9e74-a474-9fdd-248e-23e553ef2269"} 0\nvolcano_vgpu_device_allocated_memory{NodeName="test-app-64-46-msxf",devID="GPU-0af50c42-326c-bbff-7a49-a49afa433d3d"} 0\nvolcano_vgpu_device_allocated_memory{NodeName="test-app-64-46-msxf",devID="GPU-1bc8fc24-c939-545a-e272-2229d066d048"} 0\nvolcano_vgpu_device_allocated_memory{NodeName="test-app-64-46-msxf",devID="GPU-50baa64a-6476-a970-1013-121dff41ec78"} 0\nvolcano_vgpu_device_allocated_memory{NodeName="test-app-64-46-msxf",devID="GPU-7050631b-6524-21e3-41cf-6e08fc89220d"} 0\nvolcano_vgpu_device_allocated_memory{NodeName="test-app-64-46-msxf",devID="GPU-7299e30f-ccc4-a274-3e1a-77546d96a448"} 0\nvolcano_vgpu_device_allocated_memory{NodeName="test-app-64-46-msxf",devID="GPU-8cae1965-8e72-af03-1f8c-2e64646392bf"} 0\nvolcano_vgpu_device_allocated_memory{NodeName="test-app-64-46-msxf",devID="GPU-f7219cd7-e3ef-3b1b-4fa2-e84e8d5d4ce5"} 0\n# HELP volcano_vgpu_device_core_allocation_for_a_certain_pod The vgpu device core allocated for a certain pod\n# TYPE volcano_vgpu_device_core_allocation_for_a_certain_pod gauge\nvolcano_vgpu_device_core_allocation_for_a_certain_pod{NodeName="dev-app-2-150-master-1",devID="GPU-5beec879-79c9-6252-3aaa-9f5e146ba220",podName="test-vgpu-compatible"} 0\nvolcano_vgpu_device_core_allocation_for_a_certain_pod{NodeName="dev-app-2-150-master-1",devID="GPU-bc94e532-1820-8ee8-ceaa-704166369c7c",podName="test-vgpu-compatible"} 0\n# HELP volcano_vgpu_device_memory_allocation_for_a_certain_pod The vgpu device memory allocated for a certain pod\n# TYPE volcano_vgpu_device_memory_allocation_for_a_certain_pod gauge\nvolcano_vgpu_device_memory_allocation_for_a_certain_pod{NodeName="dev-app-2-150-master-1",devID="GPU-5beec879-79c9-6252-3aaa-9f5e146ba220",podName="test-vgpu-compatible"} 24564\nvolcano_vgpu_device_memory_allocation_for_a_certain_pod{NodeName="dev-app-2-150-master-1",devID="GPU-bc94e532-1820-8ee8-ceaa-704166369c7c",podName="test-vgpu-compatible"} 24564\n# HELP volcano_vgpu_device_memory_limit The number of total device memory in this card\n# TYPE volcano_vgpu_device_memory_limit gauge\nvolcano_vgpu_device_memory_limit{NodeName="dev-app-2-150-master-1",devID="GPU-3c8ce108-117a-aeae-a3e8-1c0c5dafebe7"} 24564\nvolcano_vgpu_device_memory_limit{NodeName="dev-app-2-150-master-1",devID="GPU-41c5e13c-b480-c473-7a14-dd05a7c4cd43"} 24564\nvolcano_vgpu_device_memory_limit{NodeName="dev-app-2-150-master-1",devID="GPU-4e9cd184-671c-7b17-8fc2-e9bedbc3d604"} 24564\nvolcano_vgpu_device_memory_limit{NodeName="dev-app-2-150-master-1",devID="GPU-4ff93432-c6b5-7330-30e7-9c0c9a1c648b"} 24564\nvolcano_vgpu_device_memory_limit{NodeName="dev-app-2-150-master-1",devID="GPU-5beec879-79c9-6252-3aaa-9f5e146ba220"} 24564\nvolcano_vgpu_device_memory_limit{NodeName="dev-app-2-150-master-1",devID="GPU-aa336186-301a-bc80-5121-a9a2e430811a"} 24564\nvolcano_vgpu_device_memory_limit{NodeName="dev-app-2-150-master-1",devID="GPU-bc47d475-3538-d3eb-f4ba-e46e2639c54c"} 24564\nvolcano_vgpu_device_memory_limit{NodeName="dev-app-2-150-master-1",devID="GPU-bc94e532-1820-8ee8-ceaa-704166369c7c"} 24564\nvolcano_vgpu_device_memory_limit{NodeName="test-app-64-46-msxf",devID="GPU-07df9e74-a474-9fdd-248e-23e553ef2269"} 32607\nvolcano_vgpu_device_memory_limit{NodeName="test-app-64-46-msxf",devID="GPU-0af50c42-326c-bbff-7a49-a49afa433d3d"} 32607\nvolcano_vgpu_device_memory_limit{NodeName="test-app-64-46-msxf",devID="GPU-1bc8fc24-c939-545a-e272-2229d066d048"} 32607\nvolcano_vgpu_device_memory_limit{NodeName="test-app-64-46-msxf",devID="GPU-50baa64a-6476-a970-1013-121dff41ec78"} 32607\nvolcano_vgpu_device_memory_limit{NodeName="test-app-64-46-msxf",devID="GPU-7050631b-6524-21e3-41cf-6e08fc89220d"} 32607\nvolcano_vgpu_device_memory_limit{NodeName="test-app-64-46-msxf",devID="GPU-7299e30f-ccc4-a274-3e1a-77546d96a448"} 32607\nvolcano_vgpu_device_memory_limit{NodeName="test-app-64-46-msxf",devID="GPU-8cae1965-8e72-af03-1f8c-2e64646392bf"} 32607\nvolcano_vgpu_device_memory_limit{NodeName="test-app-64-46-msxf",devID="GPU-f7219cd7-e3ef-3b1b-4fa2-e84e8d5d4ce5"} 32607\n# HELP volcano_vgpu_device_shared_number The number of vgpu tasks sharing this card\n# TYPE volcano_vgpu_device_shared_number gauge\nvolcano_vgpu_device_shared_number{NodeName="dev-app-2-150-master-1",devID="GPU-3c8ce108-117a-aeae-a3e8-1c0c5dafebe7"} 0\nvolcano_vgpu_device_shared_number{NodeName="dev-app-2-150-master-1",devID="GPU-41c5e13c-b480-c473-7a14-dd05a7c4cd43"} 0\nvolcano_vgpu_device_shared_number{NodeName="dev-app-2-150-master-1",devID="GPU-4e9cd184-671c-7b17-8fc2-e9bedbc3d604"} 0\nvolcano_vgpu_device_shared_number{NodeName="dev-app-2-150-master-1",devID="GPU-4ff93432-c6b5-7330-30e7-9c0c9a1c648b"} 0\nvolcano_vgpu_device_shared_number{NodeName="dev-app-2-150-master-1",devID="GPU-5beec879-79c9-6252-3aaa-9f5e146ba220"} 1\nvolcano_vgpu_device_shared_number{NodeName="dev-app-2-150-master-1",devID="GPU-aa336186-301a-bc80-5121-a9a2e430811a"} 0\nvolcano_vgpu_device_shared_number{NodeName="dev-app-2-150-master-1",devID="GPU-bc47d475-3538-d3eb-f4ba-e46e2639c54c"} 0\nvolcano_vgpu_device_shared_number{NodeName="dev-app-2-150-master-1",devID="GPU-bc94e532-1820-8ee8-ceaa-704166369c7c"} 1\nvolcano_vgpu_device_shared_number{NodeName="test-app-64-46-msxf",devID="GPU-07df9e74-a474-9fdd-248e-23e553ef2269"} 0\nvolcano_vgpu_device_shared_number{NodeName="test-app-64-46-msxf",devID="GPU-0af50c42-326c-bbff-7a49-a49afa433d3d"} 0\nvolcano_vgpu_device_shared_number{NodeName="test-app-64-46-msxf",devID="GPU-1bc8fc24-c939-545a-e272-2229d066d048"} 0\nvolcano_vgpu_device_shared_number{NodeName="test-app-64-46-msxf",devID="GPU-50baa64a-6476-a970-1013-121dff41ec78"} 0\nvolcano_vgpu_device_shared_number{NodeName="test-app-64-46-msxf",devID="GPU-7050631b-6524-21e3-41cf-6e08fc89220d"} 0\nvolcano_vgpu_device_shared_number{NodeName="test-app-64-46-msxf",devID="GPU-7299e30f-ccc4-a274-3e1a-77546d96a448"} 0\nvolcano_vgpu_device_shared_number{NodeName="test-app-64-46-msxf",devID="GPU-8cae1965-8e72-af03-1f8c-2e64646392bf"} 0\nvolcano_vgpu_device_shared_number{NodeName="test-app-64-46-msxf",devID="GPU-f7219cd7-e3ef-3b1b-4fa2-e84e8d5d4ce5"} 0\n'})}),"\n",(0,o.jsx)(n.h2,{id:"5-\u5E38\u89C1\u95EE\u9898",children:"5. \u5E38\u89C1\u95EE\u9898"}),"\n",(0,o.jsx)(n.h3,{id:"51-vgpu-pod\u90E8\u7F72\u65F6\u62A5\u9519unexpectedadmissionerror",children:"5.1 vGPU Pod\u90E8\u7F72\u65F6\u62A5\u9519UnexpectedAdmissionError"}),"\n",(0,o.jsxs)(n.p,{children:["\u5728\u8C03\u6574\u5B8C",(0,o.jsx)(n.code,{children:"volcano-vgpu-device-config"}),"\u8FD9\u4E2AConfigMap\u4E2D\u7684",(0,o.jsx)(n.code,{children:"resourceCountName"}),"\u914D\u7F6E\u9879\u4E3A\u81EA\u5B9A\u4E49\u7684\u8D44\u6E90\u540D\u79F0\u540E\uFF0C",(0,o.jsx)(n.code,{children:"Pod"}),"\u90E8\u7F72\u65F6\u72B6\u6001\u4E3A",(0,o.jsx)(n.code,{children:"UnexpectedAdmissionError"}),"\uFF1A"]}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-bash",children:"$ k get pod\nNAME                                   READY   STATUS                     RESTARTS   AGE\ntest-vgpu-compatible                   0/1     UnexpectedAdmissionError   0          75s\n"})}),"\n",(0,o.jsxs)(n.p,{children:["\u901A\u8FC7",(0,o.jsx)(n.code,{children:"kubectl describe pod"}),"\u67E5\u770B",(0,o.jsx)(n.code,{children:"Pod"}),"\u7684",(0,o.jsx)(n.code,{children:"Events"}),"\u5982\u4E0B\uFF1A"]}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-yaml",children:"Events:\n  Type     Reason                    Age   From     Message\n  ----     ------                    ----  ----     -------\n  Normal   Scheduled                 25s   volcano  Successfully assigned volcano-system/test-vgpu-compatible to dev-app-2-150-master-1\n  Warning  UnexpectedAdmissionError  25s   kubelet  Allocate failed due to rpc error: code = Unknown desc = device request not found, which is unexpected\n"})}),"\n",(0,o.jsxs)(n.p,{children:["\u901A\u8FC7\u7FFB\u67E5",(0,o.jsx)(n.code,{children:"volcano"}),"\u548C",(0,o.jsx)(n.code,{children:"volcano-vgpu-device-plugin"}),"\u6E90\u7801\uFF0C\u7ECF\u8FC7\u6392\u67E5\u662F\u914D\u7F6E\u6587\u4EF6\u4E0D\u4E00\u81F4\u5F15\u8D77\u7684\u3002\u5728\u4FEE\u6539\u8D44\u6E90\u540D\u79F0\u65F6\uFF0C\u6211\u4EEC\u9700\u8981\u4FDD\u8BC13\u4E2A\u5730\u65B9\u7684\u914D\u7F6E\u6B63\u786E\u6027\u548C\u4E00\u81F4\u6027\uFF0C\u62FF",(0,o.jsx)(n.code,{children:"resourceCountName"}),"\u914D\u7F6E\u9879\u4FEE\u6539\u4E3A",(0,o.jsx)(n.code,{children:"nvidia.com/gpu"}),"\u4E3E\u4F8B\uFF0C\u9700\u8981\u8C03\u6574\u4EE5\u4E0B\u5730\u65B9\uFF1A"]}),"\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.code,{children:"volcano-vgpu-device-config"}),"\u7684",(0,o.jsx)(n.code,{children:"resourceCountName: nvidia.com/gpu"})]}),"\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.code,{children:"volcano-vgpu-device-plugin"}),"\u547D\u4EE4\u884C\u53C2\u6570",(0,o.jsx)(n.code,{children:"--resource-name=nvidia.com/gpu"})]}),"\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.code,{children:"volcano-scheduler-configmap"}),"\u7684",(0,o.jsx)(n.code,{children:"deviceshare"}),"\u63D2\u4EF6\u9700\u8981\u6307\u5B9A\u6B63\u786E\u7684\u547D\u540D\u7A7A\u95F4\uFF0C\u5982\u4E0B\uFF1A","\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-yaml",children:"- name: deviceshare\n  arguments:\n    # \u662F\u5426\u542F\u7528vgpu\u7279\u6027\n    deviceshare.VGPUEnable: true \n    # volcano-vgpu-device-config\u8FD9\u4E2AConfigMap\u5BF9\u5E94\u7684\u547D\u540D\u7A7A\u95F4\n    # \u4FBF\u4E8E\u8C03\u5EA6\u5668\u81EA\u52A8\u8BFB\u53D6ConfigMap\u5185\u5BB9\n    deviceshare.KnownGeometriesCMNamespace: volcano-system \n"})}),"\n","\u53EF\u4EE5\u901A\u8FC7\u67E5\u770B\u8C03\u5EA6\u7684\u65E5\u5FD7\u6765\u6392\u67E5\u8C03\u5EA6\u5668\u4F7F\u7528\u7684\u914D\u7F6E\u6587\u4EF6\u662F\u5426\u6B63\u786E\uFF0C\u547D\u4EE4\u5982\u4E0B\uFF1A","\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-bash",children:'$ k logs volcano-scheduler-6645c59d6d-bcw68 | grep "device config"\nI1125 09:11:57.408175       1 config.go:113] "Initializing volcano device config" device-configs={"NvidiaConfig":{"ResourceCountName":"nvidia.com/gpu","ResourceMemoryName":"volcano.sh/vgpu-memory","ResourceCoreName":"volcano.sh/vgpu-cores","ResourceMemoryPercentageName":"volcano.sh/vgpu-memory-percentage","ResourcePriority":"","OverwriteEnv":false,"DefaultMemory":0,"DefaultCores":0,"DefaultGPUNum":1,"DeviceSplitCount":10,"DeviceMemoryScaling":1,"DeviceCoreScaling":1,"DisableCoreLimit":false,"MigGeometriesList":[],"GPUMemoryFactor":1}}\n'})}),"\n"]}),"\n"]})]})}function v(e={}){let{wrapper:n}={...(0,i.a)(),...e.components};return n?(0,o.jsx)(n,{...e,children:(0,o.jsx)(t,{...e})}):t(e)}},50065:function(e,n,c){c.d(n,{Z:function(){return s},a:function(){return d}});var a=c(67294);let o={},i=a.createContext(o);function d(e){let n=a.useContext(i);return a.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function s(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(o):e.components||o:d(e.components),a.createElement(i.Provider,{value:n},e.children)}}}]);