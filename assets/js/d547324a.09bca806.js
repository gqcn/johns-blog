"use strict";(self.webpackChunkgf_site=self.webpackChunkgf_site||[]).push([["8581"],{91627:function(e,n,d){d.r(n),d.d(n,{metadata:()=>c,contentTitle:()=>l,default:()=>a,assets:()=>o,toc:()=>h,frontMatter:()=>i});var c=JSON.parse('{"id":"docs/\u4E91\u539F\u751F/Kubernetes/Kubernetes CPU&NUMA\u4EB2\u548C\u6027\u8C03\u5EA6","title":"Kubernetes CPU&NUMA\u4EB2\u548C\u6027\u8C03\u5EA6","description":"\u6DF1\u5165\u89E3\u6790Kubernetes\u4E2DCPU\u548CNUMA\u4EB2\u548C\u6027\u8C03\u5EA6\u7684\u5B8C\u6574\u5B9E\u73B0\u65B9\u6848\u3002\u8BE6\u7EC6\u8BB2\u89E3Topology Manager\u3001CPU Manager\u3001Memory Manager\u548CDevice Manager\u56DB\u5927\u6838\u5FC3\u7EC4\u4EF6\u7684\u5DE5\u4F5C\u539F\u7406\u3001\u914D\u7F6E\u65B9\u6CD5\u548C\u534F\u540C\u673A\u5236\u3002\u6DB5\u76D6kubelet\u5B8C\u6574\u914D\u7F6E\u793A\u4F8B\u3001\u7B56\u7565\u9009\u9879\u8BE6\u89E3\u3001NVIDIA GPU\u8BBE\u5907\u63D2\u4EF6\u7684NUMA\u611F\u77E5\u529F\u80FD\u3001\u591A\u79CD\u62D3\u6251\u7BA1\u7406\u7B56\u7565\u5BF9\u6BD4\uFF0C\u4EE5\u53CA\u5B9E\u9645\u6D4B\u8BD5\u6848\u4F8B\u548C\u6545\u969C\u6392\u67E5\u6307\u5357\u3002\u9002\u7528\u4E8EAI\u8BAD\u7EC3\u3001\u63A8\u7406\u7B49\u5BF9CPU-GPU-\u5185\u5B58\u5C40\u90E8\u6027\u8981\u6C42\u9AD8\u7684\u5DE5\u4F5C\u8D1F\u8F7D\uFF0C\u52A9\u529B\u6027\u80FD\u4F18\u5316\u548C\u8D44\u6E90\u9AD8\u6548\u5229\u7528\u3002","source":"@site/docs/docs/2000-\u4E91\u539F\u751F/200-Kubernetes/5000-Kubernetes CPU&NUMA\u4EB2\u548C\u6027\u8C03\u5EA6.md","sourceDirName":"docs/2000-\u4E91\u539F\u751F/200-Kubernetes","slug":"/cloud-native/kubernetes-cpu-numa-affinity","permalink":"/cloud-native/kubernetes-cpu-numa-affinity","draft":false,"unlisted":false,"tags":[],"version":"current","sidebarPosition":5000,"frontMatter":{"slug":"/cloud-native/kubernetes-cpu-numa-affinity","title":"Kubernetes CPU&NUMA\u4EB2\u548C\u6027\u8C03\u5EA6","hide_title":true,"keywords":["Kubernetes","CPU\u4EB2\u548C\u6027","NUMA\u4EB2\u548C\u6027","Topology Manager","CPU Manager","Memory Manager","Device Manager","GPU\u8C03\u5EA6","AI\u8BAD\u7EC3","kubelet\u914D\u7F6E","cpuset-cpus","cpuset-mems","PCIe\u62D3\u6251","NUMA\u8282\u70B9","QoS","nvidia-device-plugin","\u9759\u6001\u7B56\u7565","\u62D3\u6251\u611F\u77E5\u8C03\u5EA6"],"description":"\u6DF1\u5165\u89E3\u6790Kubernetes\u4E2DCPU\u548CNUMA\u4EB2\u548C\u6027\u8C03\u5EA6\u7684\u5B8C\u6574\u5B9E\u73B0\u65B9\u6848\u3002\u8BE6\u7EC6\u8BB2\u89E3Topology Manager\u3001CPU Manager\u3001Memory Manager\u548CDevice Manager\u56DB\u5927\u6838\u5FC3\u7EC4\u4EF6\u7684\u5DE5\u4F5C\u539F\u7406\u3001\u914D\u7F6E\u65B9\u6CD5\u548C\u534F\u540C\u673A\u5236\u3002\u6DB5\u76D6kubelet\u5B8C\u6574\u914D\u7F6E\u793A\u4F8B\u3001\u7B56\u7565\u9009\u9879\u8BE6\u89E3\u3001NVIDIA GPU\u8BBE\u5907\u63D2\u4EF6\u7684NUMA\u611F\u77E5\u529F\u80FD\u3001\u591A\u79CD\u62D3\u6251\u7BA1\u7406\u7B56\u7565\u5BF9\u6BD4\uFF0C\u4EE5\u53CA\u5B9E\u9645\u6D4B\u8BD5\u6848\u4F8B\u548C\u6545\u969C\u6392\u67E5\u6307\u5357\u3002\u9002\u7528\u4E8EAI\u8BAD\u7EC3\u3001\u63A8\u7406\u7B49\u5BF9CPU-GPU-\u5185\u5B58\u5C40\u90E8\u6027\u8981\u6C42\u9AD8\u7684\u5DE5\u4F5C\u8D1F\u8F7D\uFF0C\u52A9\u529B\u6027\u80FD\u4F18\u5316\u548C\u8D44\u6E90\u9AD8\u6548\u5229\u7528\u3002"},"sidebar":"mainSidebar","previous":{"title":"Kubernetes NetworkPolicy","permalink":"/cloud-native/kubernetes-network-policy"},"next":{"title":"Argo Workflow","permalink":"/cloud-native/argo-workflow"}}'),r=d("85893"),s=d("50065");let i={slug:"/cloud-native/kubernetes-cpu-numa-affinity",title:"Kubernetes CPU&NUMA\u4EB2\u548C\u6027\u8C03\u5EA6",hide_title:!0,keywords:["Kubernetes","CPU\u4EB2\u548C\u6027","NUMA\u4EB2\u548C\u6027","Topology Manager","CPU Manager","Memory Manager","Device Manager","GPU\u8C03\u5EA6","AI\u8BAD\u7EC3","kubelet\u914D\u7F6E","cpuset-cpus","cpuset-mems","PCIe\u62D3\u6251","NUMA\u8282\u70B9","QoS","nvidia-device-plugin","\u9759\u6001\u7B56\u7565","\u62D3\u6251\u611F\u77E5\u8C03\u5EA6"],description:"\u6DF1\u5165\u89E3\u6790Kubernetes\u4E2DCPU\u548CNUMA\u4EB2\u548C\u6027\u8C03\u5EA6\u7684\u5B8C\u6574\u5B9E\u73B0\u65B9\u6848\u3002\u8BE6\u7EC6\u8BB2\u89E3Topology Manager\u3001CPU Manager\u3001Memory Manager\u548CDevice Manager\u56DB\u5927\u6838\u5FC3\u7EC4\u4EF6\u7684\u5DE5\u4F5C\u539F\u7406\u3001\u914D\u7F6E\u65B9\u6CD5\u548C\u534F\u540C\u673A\u5236\u3002\u6DB5\u76D6kubelet\u5B8C\u6574\u914D\u7F6E\u793A\u4F8B\u3001\u7B56\u7565\u9009\u9879\u8BE6\u89E3\u3001NVIDIA GPU\u8BBE\u5907\u63D2\u4EF6\u7684NUMA\u611F\u77E5\u529F\u80FD\u3001\u591A\u79CD\u62D3\u6251\u7BA1\u7406\u7B56\u7565\u5BF9\u6BD4\uFF0C\u4EE5\u53CA\u5B9E\u9645\u6D4B\u8BD5\u6848\u4F8B\u548C\u6545\u969C\u6392\u67E5\u6307\u5357\u3002\u9002\u7528\u4E8EAI\u8BAD\u7EC3\u3001\u63A8\u7406\u7B49\u5BF9CPU-GPU-\u5185\u5B58\u5C40\u90E8\u6027\u8981\u6C42\u9AD8\u7684\u5DE5\u4F5C\u8D1F\u8F7D\uFF0C\u52A9\u529B\u6027\u80FD\u4F18\u5316\u548C\u8D44\u6E90\u9AD8\u6548\u5229\u7528\u3002"},l=void 0,o={},h=[{value:"\u80CC\u666F\u4E0E\u4EF7\u503C",id:"\u80CC\u666F\u4E0E\u4EF7\u503C",level:2},{value:"Kubernetes NUMA \u4EB2\u548C\u6027\u5173\u952E\u7EC4\u4EF6",id:"kubernetes-numa-\u4EB2\u548C\u6027\u5173\u952E\u7EC4\u4EF6",level:2},{value:"\u7EC4\u4EF6\u529F\u80FD\u6982\u8FF0",id:"\u7EC4\u4EF6\u529F\u80FD\u6982\u8FF0",level:3},{value:"\u5DE5\u4F5C\u6D41\u7A0B",id:"\u5DE5\u4F5C\u6D41\u7A0B",level:3},{value:"\u5173\u952E\u7EC4\u4EF6\u914D\u7F6E\u8BE6\u89E3",id:"\u5173\u952E\u7EC4\u4EF6\u914D\u7F6E\u8BE6\u89E3",level:2},{value:"CPU Manager",id:"cpu-manager",level:3},{value:"\u5B9E\u73B0\u539F\u7406",id:"\u5B9E\u73B0\u539F\u7406",level:4},{value:"\u524D\u7F6E\u914D\u7F6E\u8981\u6C42",id:"\u524D\u7F6E\u914D\u7F6E\u8981\u6C42",level:4},{value:"\u914D\u7F6E\u793A\u4F8B",id:"\u914D\u7F6E\u793A\u4F8B",level:4},{value:"\u914D\u7F6E\u53C2\u6570",id:"\u914D\u7F6E\u53C2\u6570",level:4},{value:"cpuManagerPolicyOptions\uFF08\u7B56\u7565\u9009\u9879\uFF09",id:"cpumanagerpolicyoptions\u7B56\u7565\u9009\u9879",level:4},{value:"Topology Manager",id:"topology-manager",level:3},{value:"\u5B9E\u73B0\u539F\u7406",id:"\u5B9E\u73B0\u539F\u7406-1",level:4},{value:"\u914D\u7F6E\u793A\u4F8B",id:"\u914D\u7F6E\u793A\u4F8B-1",level:4},{value:"\u914D\u7F6E\u53C2\u6570",id:"\u914D\u7F6E\u53C2\u6570-1",level:4},{value:"topologyManagerPolicy \u8BE6\u89E3",id:"topologymanagerpolicy-\u8BE6\u89E3",level:4},{value:"topologyManagerScope \u8BE6\u89E3",id:"topologymanagerscope-\u8BE6\u89E3",level:4},{value:"topologyManagerPolicyOptions\uFF08\u7B56\u7565\u9009\u9879\uFF09",id:"topologymanagerpolicyoptions\u7B56\u7565\u9009\u9879",level:4},{value:"Memory Manager",id:"memory-manager",level:3},{value:"\u5B9E\u73B0\u539F\u7406",id:"\u5B9E\u73B0\u539F\u7406-2",level:4},{value:"\u914D\u7F6E\u793A\u4F8B",id:"\u914D\u7F6E\u793A\u4F8B-2",level:4},{value:"\u914D\u7F6E\u53C2\u6570",id:"\u914D\u7F6E\u53C2\u6570-2",level:4},{value:"Reserved Memory \u914D\u7F6E",id:"reserved-memory-\u914D\u7F6E",level:4},{value:"Device Manager",id:"device-manager",level:3},{value:"\u5DE5\u4F5C\u673A\u5236",id:"\u5DE5\u4F5C\u673A\u5236",level:4},{value:"NUMA\u611F\u77E5\u529F\u80FD\u8BF4\u660E",id:"numa\u611F\u77E5\u529F\u80FD\u8BF4\u660E",level:4},{value:"\u914D\u7F6E\u65B9\u5F0F",id:"\u914D\u7F6E\u65B9\u5F0F",level:4},{value:"ConfigMap\u914D\u7F6E\u793A\u4F8B",id:"configmap\u914D\u7F6E\u793A\u4F8B",level:5},{value:"\u5173\u952E\u914D\u7F6E\u53C2\u6570",id:"\u5173\u952E\u914D\u7F6E\u53C2\u6570",level:4},{value:"\u5173\u952E\u7EC4\u4EF6\u914D\u7F6E\u66F4\u65B0",id:"\u5173\u952E\u7EC4\u4EF6\u914D\u7F6E\u66F4\u65B0",level:2},{value:"\u6D4B\u8BD5\u793A\u4F8B",id:"\u6D4B\u8BD5\u793A\u4F8B",level:2},{value:"\u9A8C\u8BC1NUMA\u4EB2\u548C\u6027",id:"\u9A8C\u8BC1numa\u4EB2\u548C\u6027",level:3},{value:"\u591AGPU NUMA\u4EB2\u548C\u6027\u6D4B\u8BD5",id:"\u591Agpu-numa\u4EB2\u548C\u6027\u6D4B\u8BD5",level:3},{value:"\u6545\u969C\u6392\u67E5",id:"\u6545\u969C\u6392\u67E5",level:2},{value:"SMTAlignmentError",id:"smtalignmenterror",level:3},{value:"TopologyAffinityError",id:"topologyaffinityerror",level:3},{value:"\u5207\u6362CPU Manager Policy",id:"\u5207\u6362cpu-manager-policy",level:3},{value:"\u67E5\u770BKubelet\u65E5\u5FD7",id:"\u67E5\u770Bkubelet\u65E5\u5FD7",level:3},{value:"\u6700\u4F73\u5B9E\u8DF5",id:"\u6700\u4F73\u5B9E\u8DF5",level:2},{value:"\u53C2\u8003\u8D44\u6599",id:"\u53C2\u8003\u8D44\u6599",level:2}];function t(e){let n={a:"a",admonition:"admonition",code:"code",h2:"h2",h3:"h3",h4:"h4",h5:"h5",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,s.a)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.h2,{id:"\u80CC\u666F\u4E0E\u4EF7\u503C",children:"\u80CC\u666F\u4E0E\u4EF7\u503C"}),"\n",(0,r.jsxs)(n.p,{children:["\u5728",(0,r.jsx)(n.code,{children:"AI"}),"\u6A21\u578B\u5F00\u53D1\u3001\u8BAD\u7EC3\u548C\u63A8\u7406\u4E1A\u52A1\u573A\u666F\u4E0B\uFF0C",(0,r.jsx)(n.code,{children:"CPU"}),"\u4EB2\u548C\u6027\u4E0E",(0,r.jsx)(n.code,{children:"NUMA"}),"\u4EB2\u548C\u6027\u8C03\u5EA6\u81F3\u5173\u91CD\u8981\u3002\u73B0\u4EE3\u670D\u52A1\u5668\u901A\u5E38\u91C7\u7528\u591A",(0,r.jsx)(n.code,{children:"Socket"}),"\u3001\u591A",(0,r.jsx)(n.code,{children:"NUMA"}),"\u8282\u70B9\u7684\u67B6\u6784\uFF0C",(0,r.jsx)(n.code,{children:"GPU"}),"\u7B49\u52A0\u901F\u8BBE\u5907\u901A\u8FC7",(0,r.jsx)(n.code,{children:"PCIe"}),"\u8FDE\u63A5\u5230\u7279\u5B9A\u7684",(0,r.jsx)(n.code,{children:"NUMA"}),"\u8282\u70B9\u3002\u5982\u679C",(0,r.jsx)(n.code,{children:"CPU"}),"\u3001",(0,r.jsx)(n.code,{children:"\u5185\u5B58"}),"\u548C",(0,r.jsx)(n.code,{children:"GPU"}),"\u5206\u914D\u5728\u4E0D\u540C\u7684",(0,r.jsx)(n.code,{children:"NUMA"}),"\u8282\u70B9\u4E0A\uFF0C\u6570\u636E\u8BBF\u95EE\u5C06\u4EA7\u751F\u8DE8",(0,r.jsx)(n.code,{children:"NUMA"}),"\u7684\u5185\u5B58\u5EF6\u8FDF\uFF0C\u663E\u8457\u964D\u4F4E\u8BAD\u7EC3\u548C\u63A8\u7406\u6027\u80FD\u3002\u901A\u8FC7\u5408\u7406\u914D\u7F6E",(0,r.jsx)(n.code,{children:"CPU"}),"\u4EB2\u548C\u6027\u548C",(0,r.jsx)(n.code,{children:"NUMA"}),"\u4EB2\u548C\u6027\uFF0C\u53EF\u4EE5\u786E\u4FDD\u8BA1\u7B97\u8D44\u6E90\uFF08",(0,r.jsx)(n.code,{children:"CPU"}),"\uFF09\u3001\u5185\u5B58\u548C\u52A0\u901F\u8BBE\u5907\uFF08",(0,r.jsx)(n.code,{children:"GPU"}),"\uFF09\u5728\u540C\u4E00",(0,r.jsx)(n.code,{children:"NUMA"}),"\u8282\u70B9\u5185\u534F\u540C\u5DE5\u4F5C\uFF0C\u6700\u5927\u5316\u6570\u636E\u5C40\u90E8\u6027\uFF0C\u51CF\u5C11\u8DE8\u8282\u70B9\u901A\u4FE1\u5F00\u9500\uFF0C\u4ECE\u800C\u63D0\u5347",(0,r.jsx)(n.code,{children:"AI"}),"\u5DE5\u4F5C\u8D1F\u8F7D\u7684\u6574\u4F53\u6027\u80FD\u3002"]}),"\n",(0,r.jsxs)(n.p,{children:["\u4EE5\u5178\u578B\u7684",(0,r.jsx)(n.code,{children:"8"}),"\u5361",(0,r.jsx)(n.code,{children:"GPU"}),"\u670D\u52A1\u5668\u4E3A\u4F8B\uFF0C\u5176\u62D3\u6251\u7ED3\u6784\u5982\u4E0B\uFF1A"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-text",children:"        GPU0    GPU1    GPU2    GPU3    GPU4    GPU5    GPU6    GPU7    CPU Affinity    NUMA Affinity\nGPU0     X      PIX     NODE    NODE    SYS     SYS     SYS     SYS     0-31,64-95      0\nGPU1    PIX      X      NODE    NODE    SYS     SYS     SYS     SYS     0-31,64-95      0\nGPU2    NODE    NODE     X      PIX     SYS     SYS     SYS     SYS     0-31,64-95      0\nGPU3    NODE    NODE    PIX      X      SYS     SYS     SYS     SYS     0-31,64-95      0\nGPU4    SYS     SYS     SYS     SYS      X      PIX     NODE    NODE    32-63,96-127    1\nGPU5    SYS     SYS     SYS     SYS     PIX      X      NODE    NODE    32-63,96-127    1\nGPU6    SYS     SYS     SYS     SYS     NODE    NODE     X      PIX     32-63,96-127    1\nGPU7    SYS     SYS     SYS     SYS     NODE    NODE    PIX      X      32-63,96-127    1\n\nLegend:\n\n  X    = Self\n  SYS  = Connection traversing PCIe as well as the SMP interconnect between NUMA nodes (e.g., QPI/UPI)\n  NODE = Connection traversing PCIe as well as the interconnect between PCIe Host Bridges within a NUMA node\n  PHB  = Connection traversing PCIe as well as a PCIe Host Bridge (typically the CPU)\n  PXB  = Connection traversing multiple PCIe bridges (without traversing the PCIe Host Bridge)\n  PIX  = Connection traversing at most a single PCIe bridge\n  NV#  = Connection traversing a bonded set of # NVLinks\n"})}),"\n",(0,r.jsx)(n.p,{children:"\u53EF\u4EE5\u770B\u5230\uFF1A"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"GPU 0-3"}),"\u8FDE\u63A5\u5230",(0,r.jsx)(n.code,{children:"NUMA 0"}),"\uFF0C\u5BF9\u5E94",(0,r.jsx)(n.code,{children:"CPU 0-31, 64-95"})]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"GPU 4-7"}),"\u8FDE\u63A5\u5230",(0,r.jsx)(n.code,{children:"NUMA 1"}),"\uFF0C\u5BF9\u5E94",(0,r.jsx)(n.code,{children:"CPU 32-63, 96-127"})]}),"\n"]}),"\n",(0,r.jsxs)(n.p,{children:["\u901A\u8FC7",(0,r.jsx)(n.code,{children:"Kubernetes"}),"\u7684",(0,r.jsx)(n.code,{children:"NUMA"}),"\u4EB2\u548C\u6027\u8C03\u5EA6\uFF0C\u53EF\u4EE5\u786E\u4FDD\u4F7F\u7528",(0,r.jsx)(n.code,{children:"GPU 0-3"}),"\u7684",(0,r.jsx)(n.code,{children:"Pod"}),"\u88AB\u5206\u914D\u5230",(0,r.jsx)(n.code,{children:"NUMA 0"}),"\u5BF9\u5E94\u7684",(0,r.jsx)(n.code,{children:"CPU"}),"\u6838\u5FC3\u4E0A\u3002"]}),"\n",(0,r.jsx)(n.h2,{id:"kubernetes-numa-\u4EB2\u548C\u6027\u5173\u952E\u7EC4\u4EF6",children:"Kubernetes NUMA \u4EB2\u548C\u6027\u5173\u952E\u7EC4\u4EF6"}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.code,{children:"Kubernetes"}),"\u901A\u8FC7",(0,r.jsx)(n.code,{children:"kubelet"}),"\u4E2D\u7684\u591A\u4E2A",(0,r.jsx)(n.code,{children:"Manager"}),"\u7EC4\u4EF6\u534F\u540C\u5DE5\u4F5C\u6765\u5B9E\u73B0",(0,r.jsx)(n.code,{children:"NUMA"}),"\u4EB2\u548C\u6027\u8C03\u5EA6\uFF1A"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-text",children:"  \u250C\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n  \u2502                        Topology Manager                     \u2502\n  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n            \u2191                    \u2191                    \u2191\n            \u2502                    \u2502                    \u2502\n   \u250C\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510   \u250C\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510   \u250C\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n   \u2502   CPU Manager   \u2502   \u2502 Memory Manager \u2502   \u2502 Device Manager \u2502\n   \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518   \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518   \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n"})}),"\n",(0,r.jsx)(n.h3,{id:"\u7EC4\u4EF6\u529F\u80FD\u6982\u8FF0",children:"\u7EC4\u4EF6\u529F\u80FD\u6982\u8FF0"}),"\n",(0,r.jsxs)(n.table,{children:[(0,r.jsx)(n.thead,{children:(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.th,{children:"\u7EC4\u4EF6"}),(0,r.jsx)(n.th,{children:"\u529F\u80FD"}),(0,r.jsx)(n.th,{children:"\u8BF4\u660E"})]})}),(0,r.jsxs)(n.tbody,{children:[(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"CPU Manager"})}),(0,r.jsxs)(n.td,{children:[(0,r.jsx)(n.code,{children:"CPU"}),"\u4EB2\u548C\u6027\u7BA1\u7406"]}),(0,r.jsxs)(n.td,{children:["\u4E3A",(0,r.jsx)(n.code,{children:"Guaranteed QoS Pod"}),"\u5206\u914D\u72EC\u5360",(0,r.jsx)(n.code,{children:"CPU"}),"\u6838\u5FC3\uFF0C\u63D0\u4F9B",(0,r.jsx)(n.code,{children:"CPU"}),"\u7EA7\u522B\u7684\u62D3\u6251\u63D0\u793A"]})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"Memory Manager"})}),(0,r.jsxs)(n.td,{children:["\u5185\u5B58",(0,r.jsx)(n.code,{children:"NUMA"}),"\u4EB2\u548C\u6027"]}),(0,r.jsxs)(n.td,{children:["\u4E3A",(0,r.jsx)(n.code,{children:"Pod"}),"\u5206\u914D\u7279\u5B9A",(0,r.jsx)(n.code,{children:"NUMA"}),"\u8282\u70B9\u7684\u5185\u5B58\uFF0C\u786E\u4FDD\u5185\u5B58\u8BBF\u95EE\u672C\u5730\u5316"]})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"Device Manager"})}),(0,r.jsx)(n.td,{children:"\u8BBE\u5907\u4EB2\u548C\u6027"}),(0,r.jsxs)(n.td,{children:["\u7BA1\u7406",(0,r.jsx)(n.code,{children:"GPU"}),"\u7B49\u8BBE\u5907\u7684\u5206\u914D\uFF0C\u63D0\u4F9B\u8BBE\u5907\u6240\u5728",(0,r.jsx)(n.code,{children:"NUMA"}),"\u8282\u70B9\u7684\u62D3\u6251\u63D0\u793A"]})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"Topology Manager"})}),(0,r.jsx)(n.td,{children:"\u62D3\u6251\u534F\u8C03\u4E2D\u5FC3"}),(0,r.jsxs)(n.td,{children:["\u6536\u96C6\u5404",(0,r.jsx)(n.code,{children:"Manager"}),"\u7684\u62D3\u6251\u63D0\u793A\uFF0C\u6839\u636E\u7B56\u7565\u51B3\u5B9A\u8D44\u6E90\u5206\u914D\u548C",(0,r.jsx)(n.code,{children:"Pod"}),"\u51C6\u5165"]})]})]})]}),"\n",(0,r.jsx)(n.h3,{id:"\u5DE5\u4F5C\u6D41\u7A0B",children:"\u5DE5\u4F5C\u6D41\u7A0B"}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"Pod"}),"\u88AB\u8C03\u5EA6\u5230\u8282\u70B9\u540E\uFF0C",(0,r.jsx)(n.code,{children:"kubelet"}),"\u7684",(0,r.jsx)(n.code,{children:"Topology Manager"}),"\u5F00\u59CB\u534F\u8C03\u8D44\u6E90\u5206\u914D"]}),"\n",(0,r.jsxs)(n.li,{children:["\u5404",(0,r.jsx)(n.code,{children:"Manager"}),"\u4F5C\u4E3A",(0,r.jsx)(n.code,{children:"Hint Provider"}),"\uFF0C\u5411",(0,r.jsx)(n.code,{children:"Topology Manager"}),"\u63D0\u4F9B\u62D3\u6251\u4EB2\u548C\u6027\u63D0\u793A\uFF08",(0,r.jsx)(n.code,{children:"Hints"}),"\uFF09"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"Topology Manager"}),"\u6839\u636E\u914D\u7F6E\u7684\u7B56\u7565\u5408\u5E76\u8FD9\u4E9B",(0,r.jsx)(n.code,{children:"Hints"}),"\uFF0C\u8BA1\u7B97\u6700\u4F18\u7684",(0,r.jsx)(n.code,{children:"NUMA"}),"\u8282\u70B9\u5206\u914D"]}),"\n",(0,r.jsxs)(n.li,{children:["\u6839\u636E\u7B56\u7565\u51B3\u5B9A",(0,r.jsx)(n.code,{children:"Pod"}),"\u7684\u51C6\u5165\u6216\u62D2\u7EDD"]}),"\n",(0,r.jsxs)(n.li,{children:["\u51C6\u5165\u540E\uFF0C\u5404",(0,r.jsx)(n.code,{children:"Manager"}),"\u6839\u636E\u62D3\u6251\u63D0\u793A\u5206\u914D\u5BF9\u5E94",(0,r.jsx)(n.code,{children:"NUMA"}),"\u8282\u70B9\u4E0A\u7684\u8D44\u6E90"]}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"\u5173\u952E\u7EC4\u4EF6\u914D\u7F6E\u8BE6\u89E3",children:"\u5173\u952E\u7EC4\u4EF6\u914D\u7F6E\u8BE6\u89E3"}),"\n",(0,r.jsxs)(n.p,{children:["\u4EE5\u4E0B\u662F\u542F\u7528",(0,r.jsx)(n.code,{children:"CPU"}),"\u4EB2\u548C\u6027\u548C",(0,r.jsx)(n.code,{children:"NUMA"}),"\u4EB2\u548C\u6027\u8C03\u5EA6\u7684\u5B8C\u6574",(0,r.jsx)(n.code,{children:"kubelet"}),"\u914D\u7F6E\u793A\u4F8B\uFF0C\u8BE5\u914D\u7F6E\u901A\u5E38\u4F4D\u4E8E\u5BBF\u4E3B\u673A\u4E0A\u7684",(0,r.jsx)(n.code,{children:"/var/lib/kubelet/config.yaml"}),"\u3002\u968F\u540E\u6211\u4EEC\u4F1A\u8BE6\u7EC6\u4ECB\u7ECD\u6BCF\u4E2A\u7EC4\u4EF6\u7684\u914D\u7F6E\u9879\uFF1A"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-yaml",children:'apiVersion: kubelet.config.k8s.io/v1beta1\nkind: KubeletConfiguration\n\n# ============= CPU Manager \u914D\u7F6E =============\ncpuManagerPolicy: static                    # \u542F\u7528\u9759\u6001CPU\u7BA1\u7406\u7B56\u7565\ncpuManagerReconcilePeriod: 10s              # \u8C03\u548C\u5468\u671F\ncpuManagerPolicyOptions:\n  full-pcpus-only: "true"                   # \u4EC5\u5206\u914D\u5B8C\u6574\u7269\u7406\u6838\u5FC3\n  distribute-cpus-across-numa: "true"       # \u8DE8NUMA\u5747\u5300\u5206\u914D\uFF08\u53EF\u9009\uFF09\n\n# ============= Topology Manager \u914D\u7F6E =============\ntopologyManagerPolicy: restricted           # \u4E25\u683C\u8981\u6C42NUMA\u5BF9\u9F50\ntopologyManagerScope: pod                   # Pod\u7EA7\u522B\u5BF9\u9F50\ntopologyManagerPolicyOptions:\n  prefer-closest-numa-nodes: "true"         # \u4F18\u5148\u9009\u62E9\u8DDD\u79BB\u6700\u8FD1\u7684NUMA\u8282\u70B9\n\n# ============= Memory Manager \u914D\u7F6E =============\nmemoryManagerPolicy: Static                 # \u542F\u7528\u9759\u6001\u5185\u5B58\u7BA1\u7406\u7B56\u7565\nreservedMemory:\n  - numaNode: 0\n    limits:\n      memory: 2Gi                           # NUMA 0 \u9884\u7559\u5185\u5B58\n  - numaNode: 1\n    limits:\n      memory: 2Gi                           # NUMA 1 \u9884\u7559\u5185\u5B58\n\n# ============= \u8D44\u6E90\u9884\u7559\u914D\u7F6E =============\nkubeReserved:\n  cpu: "2"\n  memory: 2Gi\nsystemReserved:\n  cpu: "2"\n  memory: 2Gi\nreservedSystemCPUs: "0-3"                   # \u9884\u7559CPU 0-3\u7ED9\u7CFB\u7EDF\n\n# ============= \u9A71\u9010\u914D\u7F6E =============\nevictionHard:\n  memory.available: "100Mi"\n  nodefs.available: "10%"\n  imagefs.available: "15%"\n\n# ============= Feature Gates\uFF08\u53EF\u9009\uFF09=============\nfeatureGates:\n  CPUManagerPolicyOptions: true\n  CPUManagerPolicyBetaOptions: true\n  TopologyManagerPolicyOptions: true\n'})}),"\n",(0,r.jsx)(n.h3,{id:"cpu-manager",children:"CPU Manager"}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.code,{children:"CPU Manager"}),"\u8D1F\u8D23\u4E3A",(0,r.jsx)(n.code,{children:"Guaranteed QoS"}),"\u7684",(0,r.jsx)(n.code,{children:"Pod"}),"\u5206\u914D\u72EC\u5360",(0,r.jsx)(n.code,{children:"CPU"}),"\u6838\u5FC3\uFF0C\u907F\u514D",(0,r.jsx)(n.code,{children:"CPU"}),"\u8D44\u6E90\u7ADE\u4E89\u5E26\u6765\u7684\u6027\u80FD\u6296\u52A8\u3002"]}),"\n",(0,r.jsx)(n.h4,{id:"\u5B9E\u73B0\u539F\u7406",children:"\u5B9E\u73B0\u539F\u7406"}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"\u5171\u4EAB\u6C60\u7BA1\u7406"}),"\uFF1A",(0,r.jsx)(n.code,{children:"CPU Manager"}),"\u7EF4\u62A4\u4E00\u4E2A\u5171\u4EAB",(0,r.jsx)(n.code,{children:"CPU"}),"\u6C60\uFF0C\u521D\u59CB\u5305\u542B\u8282\u70B9\u6240\u6709",(0,r.jsx)(n.code,{children:"CPU"}),"\uFF08\u9664\u9884\u7559",(0,r.jsx)(n.code,{children:"CPU"}),"\u5916\uFF09"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"\u72EC\u5360\u5206\u914D"}),"\uFF1A\u5BF9\u4E8E",(0,r.jsx)(n.code,{children:"Guaranteed QoS"}),"\u4E14",(0,r.jsx)(n.code,{children:"CPU"}),"\u8BF7\u6C42\u4E3A\u6574\u6570\u7684\u5BB9\u5668\uFF0C\u4ECE\u5171\u4EAB\u6C60\u4E2D\u5206\u914D\u72EC\u5360",(0,r.jsx)(n.code,{children:"CPU"})]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"\u4EB2\u548C\u6027\u8BBE\u7F6E"}),"\uFF1A\u901A\u8FC7",(0,r.jsx)(n.code,{children:"Linux cgroups"}),"\u7684",(0,r.jsx)(n.code,{children:"cpuset"}),"\u5C06\u5BB9\u5668\u7ED1\u5B9A\u5230\u7279\u5B9A",(0,r.jsx)(n.code,{children:"CPU"}),"\u6838\u5FC3"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"\u72B6\u6001\u6301\u4E45\u5316"}),"\uFF1A\u5206\u914D\u72B6\u6001\u5B58\u50A8\u5728",(0,r.jsx)(n.code,{children:"/var/lib/kubelet/cpu_manager_state"}),"\u6587\u4EF6\u4E2D"]}),"\n"]}),"\n",(0,r.jsx)(n.h4,{id:"\u524D\u7F6E\u914D\u7F6E\u8981\u6C42",children:"\u524D\u7F6E\u914D\u7F6E\u8981\u6C42"}),"\n",(0,r.jsxs)(n.table,{children:[(0,r.jsx)(n.thead,{children:(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.th,{children:"\u524D\u7F6E\u8981\u6C42"}),(0,r.jsx)(n.th,{children:"\u8BF4\u660E"})]})}),(0,r.jsxs)(n.tbody,{children:[(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"\u9759\u6001\u7B56\u7565\u524D\u63D0"}),(0,r.jsxs)(n.td,{children:["\u4F7F\u7528",(0,r.jsx)(n.code,{children:"static"}),"\u7B56\u7565\u65F6\uFF0C\u5FC5\u987B\u914D\u7F6E",(0,r.jsx)(n.code,{children:"CPU"}),"\u9884\u7559\uFF08",(0,r.jsx)(n.code,{children:"kubeReserved"}),"\u3001",(0,r.jsx)(n.code,{children:"systemReserved"}),"\u6216",(0,r.jsx)(n.code,{children:"reservedSystemCPUs"}),"\u4E2D\u81F3\u5C11\u4E00\u4E2A\u5927\u4E8E",(0,r.jsx)(n.code,{children:"0"}),"\uFF09"]})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsxs)(n.td,{children:[(0,r.jsx)(n.code,{children:"QoS"}),"\u8981\u6C42"]}),(0,r.jsxs)(n.td,{children:["\u53EA\u6709",(0,r.jsx)(n.code,{children:"Guaranteed QoS"}),"\u7684",(0,r.jsx)(n.code,{children:"Pod"}),"\u624D\u80FD\u83B7\u5F97\u72EC\u5360",(0,r.jsx)(n.code,{children:"CPU"})]})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsxs)(n.td,{children:[(0,r.jsx)(n.code,{children:"CPU"}),"\u8BF7\u6C42\u8981\u6C42"]}),(0,r.jsxs)(n.td,{children:[(0,r.jsx)(n.code,{children:"CPU"}),"\u7684",(0,r.jsx)(n.code,{children:"requests"}),"\u548C",(0,r.jsx)(n.code,{children:"limits"}),"\u5FC5\u987B\u76F8\u7B49\uFF0C\u4E14\u4E3A",(0,r.jsx)(n.strong,{children:"\u6574\u6570"}),"\u503C"]})]})]})]}),"\n",(0,r.jsx)(n.h4,{id:"\u914D\u7F6E\u793A\u4F8B",children:"\u914D\u7F6E\u793A\u4F8B"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-yaml",children:'# ============= CPU Manager \u914D\u7F6E =============\ncpuManagerPolicy: static                    # \u542F\u7528\u9759\u6001CPU\u7BA1\u7406\u7B56\u7565\ncpuManagerReconcilePeriod: 10s              # \u8C03\u548C\u5468\u671F\ncpuManagerPolicyOptions:\n  full-pcpus-only: "true"                   # \u4EC5\u5206\u914D\u5B8C\u6574\u7269\u7406\u6838\u5FC3\n  distribute-cpus-across-numa: "true"       # \u8DE8NUMA\u5747\u5300\u5206\u914D\uFF08\u53EF\u9009\uFF09\n\n# ============= \u8D44\u6E90\u9884\u7559\u914D\u7F6E =============\nkubeReserved:\n  cpu: "2"\n  memory: 2Gi\nsystemReserved:\n  cpu: "2"\n  memory: 2Gi\nreservedSystemCPUs: "0-3"                   # \u9884\u7559CPU 0-3\u7ED9\u7CFB\u7EDF\n'})}),"\n",(0,r.jsx)(n.h4,{id:"\u914D\u7F6E\u53C2\u6570",children:"\u914D\u7F6E\u53C2\u6570"}),"\n",(0,r.jsxs)(n.table,{children:[(0,r.jsx)(n.thead,{children:(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.th,{children:"\u53C2\u6570\u540D\u79F0"}),(0,r.jsx)(n.th,{children:"\u53EF\u9009\u503C"}),(0,r.jsx)(n.th,{children:"\u9ED8\u8BA4\u503C"}),(0,r.jsx)(n.th,{style:{textAlign:"center"},children:"\u662F\u5426\u5FC5\u987B"}),(0,r.jsx)(n.th,{children:"\u8BF4\u660E"})]})}),(0,r.jsxs)(n.tbody,{children:[(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"cpuManagerPolicy"})}),(0,r.jsxs)(n.td,{children:[(0,r.jsx)(n.code,{children:"none"}),", ",(0,r.jsx)(n.code,{children:"static"})]}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"none"})}),(0,r.jsx)(n.td,{style:{textAlign:"center"},children:"\u5426"}),(0,r.jsxs)(n.td,{children:[(0,r.jsx)(n.code,{children:"CPU"}),"\u7BA1\u7406\u7B56\u7565\u3002",(0,r.jsx)(n.code,{children:"none"}),"\u4E0D\u63D0\u4F9B\u4EB2\u548C\u6027\uFF1B",(0,r.jsx)(n.code,{children:"static"}),"\u4E3A",(0,r.jsx)(n.code,{children:"Guaranteed Pod"}),"\u5206\u914D\u72EC\u5360",(0,r.jsx)(n.code,{children:"CPU"})]})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"cpuManagerReconcilePeriod"})}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"Duration"})}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"10s"})}),(0,r.jsx)(n.td,{style:{textAlign:"center"},children:"\u5426"}),(0,r.jsxs)(n.td,{children:[(0,r.jsx)(n.code,{children:"CPU Manager"}),"\u8C03\u548C\u5468\u671F\uFF0C\u5B9A\u671F\u68C0\u67E5\u5E76\u4FEE\u6B63",(0,r.jsx)(n.code,{children:"CPU"}),"\u5206\u914D"]})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"cpuManagerPolicyOptions"})}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"Map"})}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"nil"})}),(0,r.jsx)(n.td,{style:{textAlign:"center"},children:"\u5426"}),(0,r.jsxs)(n.td,{children:["\u7B56\u7565\u9009\u9879\uFF0C\u7528\u4E8E\u7CBE\u7EC6\u8C03\u6574",(0,r.jsx)(n.code,{children:"static"}),"\u7B56\u7565\u884C\u4E3A"]})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"reservedSystemCPUs"})}),(0,r.jsxs)(n.td,{children:[(0,r.jsx)(n.code,{children:"CPU"}),"\u5217\u8868"]}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:'""'})}),(0,r.jsxs)(n.td,{style:{textAlign:"center"},children:[(0,r.jsx)(n.code,{children:"static"}),"\u7B56\u7565\u65F6\u5FC5\u987B"]}),(0,r.jsxs)(n.td,{children:["\u4E3A\u7CFB\u7EDF\u8FDB\u7A0B\u9884\u7559\u7684",(0,r.jsx)(n.code,{children:"CPU"}),"\u5217\u8868\uFF0C\u5982",(0,r.jsx)(n.code,{children:"0-3,8-11"})]})]})]})]}),"\n",(0,r.jsx)(n.h4,{id:"cpumanagerpolicyoptions\u7B56\u7565\u9009\u9879",children:"cpuManagerPolicyOptions\uFF08\u7B56\u7565\u9009\u9879\uFF09"}),"\n",(0,r.jsxs)(n.table,{children:[(0,r.jsx)(n.thead,{children:(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.th,{children:"\u9009\u9879\u540D\u79F0"}),(0,r.jsx)(n.th,{children:"\u7248\u672C\u8981\u6C42"}),(0,r.jsx)(n.th,{children:"\u8BF4\u660E"})]})}),(0,r.jsxs)(n.tbody,{children:[(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"full-pcpus-only"})}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"v1.22+ (GA: v1.33+)"})}),(0,r.jsxs)(n.td,{children:[(0,r.jsx)(n.strong,{children:"\u4EC5\u5206\u914D\u5B8C\u6574\u7269\u7406\u6838\u5FC3"}),"\uFF1A\u542F\u7528\u540E\uFF0C",(0,r.jsx)(n.code,{children:"CPU Manager"}),"\u53EA\u4F1A\u4E3A\u5BB9\u5668\u5206\u914D\u5B8C\u6574\u7684\u7269\u7406\u6838\u5FC3\uFF0C\u800C\u4E0D\u4F1A\u5206\u914D\u5355\u4E2A\u786C\u4EF6\u7EBF\u7A0B\uFF08\u8D85\u7EBF\u7A0B\uFF09\u3002\u8FD9\u53EF\u4EE5\u6709\u6548\u907F\u514D",(0,r.jsx)(n.code,{children:"SMT"}),"\uFF08",(0,r.jsx)(n.code,{children:"Simultaneous Multithreading"}),'\uFF0C\u8D85\u7EBF\u7A0B\uFF09\u5E26\u6765\u7684"\u5435\u95F9\u90BB\u5C45"\u95EE\u9898\uFF0C\u5373\u591A\u4E2A\u8FDB\u7A0B\u5171\u4EAB\u540C\u4E00\u7269\u7406\u6838\u5FC3\u7684\u6267\u884C\u5355\u5143\u5BFC\u81F4\u7684\u6027\u80FD\u5E72\u6270\u3002\u5BF9\u4E8E',(0,r.jsx)(n.code,{children:"CPU"}),"\u5BC6\u96C6\u578B\u548C\u5EF6\u8FDF\u654F\u611F\u7684",(0,r.jsx)(n.code,{children:"AI"}),"\u8BAD\u7EC3\u4EFB\u52A1\uFF0C\u5EFA\u8BAE\u542F\u7528\u6B64\u9009\u9879\u4EE5\u83B7\u5F97\u66F4\u7A33\u5B9A\u7684\u6027\u80FD\u8868\u73B0\u3002\u4F8B\u5982\uFF0C\u5728\u5F00\u542F\u8D85\u7EBF\u7A0B\u7684",(0,r.jsx)(n.code,{children:"64"}),"\u6838\u670D\u52A1\u5668\u4E0A\uFF08",(0,r.jsx)(n.code,{children:"128"}),"\u4E2A\u903B\u8F91\u6838\u5FC3\uFF09\uFF0C\u542F\u7528\u6B64\u9009\u9879\u540E\u5BB9\u5668\u6700\u591A\u53EA\u80FD\u83B7\u5F97",(0,r.jsx)(n.code,{children:"64"}),"\u4E2A\u5B8C\u6574\u7269\u7406\u6838\u5FC3"]})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"distribute-cpus-across-numa"})}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"v1.23+"})}),(0,r.jsxs)(n.td,{children:[(0,r.jsx)(n.strong,{children:"\u8DE8NUMA\u5747\u5300\u5206\u914DCPU"}),"\uFF1A\u5F53\u5BB9\u5668\u8BF7\u6C42\u591A\u4E2A",(0,r.jsx)(n.code,{children:"CPU"}),"\u6838\u5FC3\u65F6\uFF0C",(0,r.jsx)(n.code,{children:"CPU Manager"}),"\u4F1A\u5C3D\u53EF\u80FD\u5C06\u8FD9\u4E9B\u6838\u5FC3\u5747\u5300\u5206\u914D\u5230\u591A\u4E2A",(0,r.jsx)(n.code,{children:"NUMA"}),"\u8282\u70B9\u4E0A\uFF0C\u800C\u4E0D\u662F\u96C6\u4E2D\u5728\u5355\u4E2A",(0,r.jsx)(n.code,{children:"NUMA"}),"\u8282\u70B9\u3002\u8FD9\u79CD\u7B56\u7565\u9002\u5408\u80FD\u591F\u611F\u77E5",(0,r.jsx)(n.code,{children:"NUMA"}),"\u62D3\u6251\u5E76\u8FDB\u884C\u5E76\u884C\u8BA1\u7B97\u7684\u5E94\u7528\u7A0B\u5E8F\uFF0C\u53EF\u4EE5\u5145\u5206\u5229\u7528\u591A",(0,r.jsx)(n.code,{children:"NUMA"}),"\u8282\u70B9\u7684\u5185\u5B58\u5E26\u5BBD\u3002\u4F46\u9700\u8981\u6CE8\u610F\uFF0C\u6B64\u9009\u9879\u53EF\u80FD\u4F1A\u589E\u52A0\u8DE8",(0,r.jsx)(n.code,{children:"NUMA"}),"\u5185\u5B58\u8BBF\u95EE\u7684\u5F00\u9500\uFF0C\u4E0D\u9002\u5408\u9700\u8981\u4E25\u683C",(0,r.jsx)(n.code,{children:"NUMA"}),"\u5C40\u90E8\u6027\u7684\u573A\u666F\u3002\u901A\u5E38\u4E0E",(0,r.jsx)(n.code,{children:"Topology Manager"}),"\u7684",(0,r.jsx)(n.code,{children:"best-effort"}),"\u7B56\u7565\u914D\u5408\u4F7F\u7528"]})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"align-by-socket"})}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"v1.25+"})}),(0,r.jsxs)(n.td,{children:[(0,r.jsx)(n.strong,{children:"\u6309Socket\u5BF9\u9F50"}),"\uFF1A\u5728\u591A",(0,r.jsx)(n.code,{children:"Socket"}),"\u670D\u52A1\u5668\u4E0A\uFF0C\u4F18\u5148\u5728\u7269\u7406",(0,r.jsx)(n.code,{children:"Socket"}),"\u8FB9\u754C\u5BF9\u9F50",(0,r.jsx)(n.code,{children:"CPU"}),"\u5206\u914D\uFF0C\u800C\u975E\u903B\u8F91",(0,r.jsx)(n.code,{children:"NUMA"}),"\u8FB9\u754C\u3002\u5728\u67D0\u4E9B\u670D\u52A1\u5668\u67B6\u6784\u4E2D\uFF0C\u4E00\u4E2A",(0,r.jsx)(n.code,{children:"Socket"}),"\u53EF\u80FD\u5305\u542B\u591A\u4E2A",(0,r.jsx)(n.code,{children:"NUMA"}),"\u8282\u70B9\uFF0C\u6B64\u9009\u9879\u4F1A\u5C1D\u8BD5\u5C06\u5BB9\u5668\u7684\u6240\u6709",(0,r.jsx)(n.code,{children:"CPU"}),"\u5206\u914D\u5728\u540C\u4E00\u4E2A\u7269\u7406",(0,r.jsx)(n.code,{children:"Socket"}),"\u4E0A\uFF0C\u4EE5\u51CF\u5C11\u8DE8",(0,r.jsx)(n.code,{children:"Socket"}),"\u901A\u4FE1\u5EF6\u8FDF\u3002\u8FD9\u5BF9\u4E8E\u9700\u8981\u9891\u7E41",(0,r.jsx)(n.code,{children:"CPU"}),"\u95F4\u901A\u4FE1\u7684\u5E94\u7528\uFF08\u5982\u5171\u4EAB",(0,r.jsx)(n.code,{children:"L3 Cache"}),"\uFF09\u6709\u6027\u80FD\u4F18\u52BF\u3002",(0,r.jsx)(n.strong,{children:"\u6CE8\u610F"}),"\uFF1A\u6B64\u9009\u9879\u4E3A",(0,r.jsx)(n.code,{children:"Alpha"}),"\u7279\u6027\uFF0C\u9ED8\u8BA4\u9690\u85CF\uFF0C\u9700\u8981\u542F\u7528",(0,r.jsx)(n.code,{children:"CPUManagerPolicyAlphaOptions"})," Feature Gate"]})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"distribute-cpus-across-cores"})}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"v1.31+"})}),(0,r.jsxs)(n.td,{children:[(0,r.jsx)(n.strong,{children:"\u8DE8\u7269\u7406\u6838\u5FC3\u5206\u914D\u865A\u62DF\u6838\u5FC3"}),"\uFF1A\u5C06\u865A\u62DF\u6838\u5FC3\uFF08\u6709\u65F6\u79F0\u4E3A\u786C\u4EF6\u7EBF\u7A0B\uFF09\u5206\u914D\u5230\u4E0D\u540C\u7684\u7269\u7406\u6838\u5FC3\u4E0A\uFF0C\u800C\u4E0D\u662F\u96C6\u4E2D\u5728\u5C11\u6570\u7269\u7406\u6838\u5FC3\u7684\u591A\u4E2A\u786C\u4EF6\u7EBF\u7A0B\u4E0A\u3002\u8FD9\u6837\u53EF\u4EE5\u51CF\u5C11\u540C\u4E00\u7269\u7406\u6838\u5FC3\u5185\u591A\u4E2A\u7EBF\u7A0B\u4E4B\u95F4\u7684\u8D44\u6E90\u7ADE\u4E89\uFF08\u5982\u6267\u884C\u5355\u5143\u3001\u7F13\u5B58\u51B2\u7A81\uFF09\uFF0C\u63D0\u5347\u6574\u4F53\u541E\u5410\u91CF\u3002\u4F8B\u5982\uFF0C\u8BF7\u6C42",(0,r.jsx)(n.code,{children:"4"}),"\u4E2A",(0,r.jsx)(n.code,{children:"CPU"}),"\u65F6\uFF0C\u4F1A\u5206\u914D",(0,r.jsx)(n.code,{children:"4"}),"\u4E2A\u4E0D\u540C\u7269\u7406\u6838\u5FC3\u7684\u5355\u4E2A\u7EBF\u7A0B\uFF0C\u800C\u4E0D\u662F",(0,r.jsx)(n.code,{children:"2"}),"\u4E2A\u7269\u7406\u6838\u5FC3\u7684",(0,r.jsx)(n.code,{children:"4"}),"\u4E2A\u7EBF\u7A0B\u3002",(0,r.jsx)(n.strong,{children:"\u6CE8\u610F"}),"\uFF1A\u6B64\u9009\u9879\u4E3A",(0,r.jsx)(n.code,{children:"Alpha"}),"\u7279\u6027\uFF0C\u9ED8\u8BA4\u9690\u85CF\uFF0C\u9700\u8981\u542F\u7528",(0,r.jsx)(n.code,{children:"CPUManagerPolicyAlphaOptions"})," Feature Gate"]})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"strict-cpu-reservation"})}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"v1.32+ (GA: v1.35+)"})}),(0,r.jsxs)(n.td,{children:[(0,r.jsx)(n.strong,{children:"\u4E25\u683CCPU\u9884\u7559"}),"\uFF1A\u542F\u7528\u540E\uFF0C\u4F1A\u4E25\u683C\u9694\u79BB\u901A\u8FC7",(0,r.jsx)(n.code,{children:"reservedSystemCPUs"}),"\u9884\u7559\u7684",(0,r.jsx)(n.code,{children:"CPU"}),"\u6838\u5FC3\uFF0C\u786E\u4FDD\u4EFB\u4F55",(0,r.jsx)(n.code,{children:"Pod"}),"\uFF08\u5305\u62EC",(0,r.jsx)(n.code,{children:"BestEffort"}),"\u3001",(0,r.jsx)(n.code,{children:"Burstable"}),"\u548C",(0,r.jsx)(n.code,{children:"Guaranteed QoS"}),"\uFF09\u90FD\u65E0\u6CD5\u4F7F\u7528\u8FD9\u4E9B\u9884\u7559\u7684",(0,r.jsx)(n.code,{children:"CPU"}),"\u3002\u672A\u542F\u7528\u65F6\uFF0C\u9884\u7559\u7684",(0,r.jsx)(n.code,{children:"CPU"}),"\u4EC5\u5BF9",(0,r.jsx)(n.code,{children:"Guaranteed QoS"}),"\u7684\u72EC\u5360\u5206\u914D\u6709\u6548\uFF0C",(0,r.jsx)(n.code,{children:"BestEffort"}),"\u548C",(0,r.jsx)(n.code,{children:"Burstable Pod"}),"\u4ECD\u53EF\u80FD\u8C03\u5EA6\u5230\u8FD9\u4E9B\u6838\u5FC3\u4E0A\u3002\u5BF9\u4E8E\u9700\u8981\u4E3A\u7CFB\u7EDF\u5173\u952E\u8FDB\u7A0B\uFF08\u5982",(0,r.jsx)(n.code,{children:"kubelet"}),"\u3001\u5BB9\u5668\u8FD0\u884C\u65F6\u3001\u7CFB\u7EDF\u5B88\u62A4\u8FDB\u7A0B\uFF09\u4FDD\u8BC1\u7A33\u5B9A",(0,r.jsx)(n.code,{children:"CPU"}),"\u8D44\u6E90\u7684\u751F\u4EA7\u73AF\u5883\uFF0C\u5F3A\u70C8\u5EFA\u8BAE\u542F\u7528\u6B64\u9009\u9879\uFF0C\u907F\u514D\u8282\u70B9\u8FC7\u8F7D\u5BFC\u81F4\u7684\u7A33\u5B9A\u6027\u95EE\u9898"]})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"prefer-align-cpus-by-uncorecache"})}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"v1.32+"})}),(0,r.jsxs)(n.td,{children:[(0,r.jsx)(n.strong,{children:"\u4F18\u5148\u6309Uncore Cache\u5BF9\u9F50"}),"\uFF1A",(0,r.jsx)(n.code,{children:"Uncore Cache"}),"\u901A\u5E38\u6307",(0,r.jsx)(n.code,{children:"Last Level Cache\uFF08LLC\uFF0C\u6700\u540E\u7EA7\u7F13\u5B58\uFF09"}),"\uFF0C\u5B83\u5728\u591A\u4E2A",(0,r.jsx)(n.code,{children:"CPU"}),"\u6838\u5FC3\u4E4B\u95F4\u5171\u4EAB\u3002\u542F\u7528\u6B64\u9009\u9879\u540E\uFF0C",(0,r.jsx)(n.code,{children:"CPU Manager"}),"\u4F1A\u5C3D\u6700\u5927\u52AA\u529B\u5C06\u5BB9\u5668\u7684\u6240\u6709",(0,r.jsx)(n.code,{children:"CPU"}),"\u6838\u5FC3\u5206\u914D\u5230\u5171\u4EAB\u540C\u4E00",(0,r.jsx)(n.code,{children:"LLC"}),"\u7684\u6838\u5FC3\u7EC4\u4E2D\u3002\u8FD9\u53EF\u4EE5\u663E\u8457\u63D0\u9AD8\u7F13\u5B58\u547D\u4E2D\u7387\uFF0C\u51CF\u5C11\u5185\u5B58\u8BBF\u95EE\u5EF6\u8FDF\uFF0C\u5BF9\u4E8E\u6570\u636E\u5C40\u90E8\u6027\u8981\u6C42\u9AD8\u7684\u5E94\u7528\uFF08\u5982",(0,r.jsx)(n.code,{children:"AI"}),"\u63A8\u7406\u670D\u52A1\u3001\u6570\u636E\u5E93\uFF09\u6709\u660E\u663E\u6027\u80FD\u63D0\u5347\u3002\u5728\u73B0\u4EE3\u670D\u52A1\u5668\u67B6\u6784\u4E2D\uFF0C\u901A\u5E38\u4E00\u4E2A",(0,r.jsx)(n.code,{children:"NUMA"}),"\u8282\u70B9\u5185\u7684\u6838\u5FC3\u5171\u4EAB\u4E00\u4E2A",(0,r.jsx)(n.code,{children:"LLC"}),"\uFF0C\u56E0\u6B64\u6B64\u9009\u9879\u4E0E",(0,r.jsx)(n.code,{children:"NUMA"}),"\u4EB2\u548C\u6027\u7B56\u7565\u914D\u5408\u6548\u679C\u66F4\u4F73"]})]})]})]}),"\n",(0,r.jsx)(n.h3,{id:"topology-manager",children:"Topology Manager"}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.code,{children:"Topology Manager"}),"\u662F",(0,r.jsx)(n.code,{children:"NUMA"}),"\u4EB2\u548C\u6027\u7684\u6838\u5FC3\u534F\u8C03\u5668\uFF0C\u8D1F\u8D23\u6536\u96C6\u5404",(0,r.jsx)(n.code,{children:"Manager"}),"\u7684\u62D3\u6251\u63D0\u793A\u5E76\u505A\u51FA\u51C6\u5165\u51B3\u7B56\u3002"]}),"\n",(0,r.jsx)(n.h4,{id:"\u5B9E\u73B0\u539F\u7406-1",children:"\u5B9E\u73B0\u539F\u7406"}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Hint\u6536\u96C6"}),"\uFF1A\u4ECE",(0,r.jsx)(n.code,{children:"CPU Manager"}),"\u3001",(0,r.jsx)(n.code,{children:"Memory Manager"}),"\u3001",(0,r.jsx)(n.code,{children:"Device Manager"}),"\u6536\u96C6\u62D3\u6251\u4EB2\u548C\u6027",(0,r.jsx)(n.code,{children:"Hints"})]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Hint\u5408\u5E76"}),"\uFF1A\u6839\u636E\u914D\u7F6E\u7684\u7B56\u7565\u5408\u5E76\u6240\u6709",(0,r.jsx)(n.code,{children:"Hints"}),"\uFF0C\u627E\u51FA\u6EE1\u8DB3\u6240\u6709\u8D44\u6E90\u9700\u6C42\u7684\u6700\u4F18",(0,r.jsx)(n.code,{children:"NUMA"}),"\u8282\u70B9\u7EC4\u5408"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"\u51C6\u5165\u51B3\u7B56"}),"\uFF1A\u6839\u636E\u7B56\u7565\u51B3\u5B9A\u662F\u5426\u5141\u8BB8",(0,r.jsx)(n.code,{children:"Pod"}),"\u5728\u8BE5\u8282\u70B9\u8FD0\u884C"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"\u8D44\u6E90\u534F\u8C03"}),"\uFF1A\u901A\u77E5\u5404",(0,r.jsx)(n.code,{children:"Manager"}),"\u6309\u7167\u5408\u5E76\u540E\u7684",(0,r.jsx)(n.code,{children:"NUMA"}),"\u8282\u70B9\u5206\u914D\u8D44\u6E90"]}),"\n"]}),"\n",(0,r.jsx)(n.h4,{id:"\u914D\u7F6E\u793A\u4F8B-1",children:"\u914D\u7F6E\u793A\u4F8B"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-yaml",children:'topologyManagerPolicy: restricted           # \u4E25\u683C\u8981\u6C42NUMA\u5BF9\u9F50\ntopologyManagerScope: pod                   # Pod\u7EA7\u522B\u5BF9\u9F50\ntopologyManagerPolicyOptions:\n  prefer-closest-numa-nodes: "true"         # \u4F18\u5148\u9009\u62E9\u8DDD\u79BB\u6700\u8FD1\u7684NUMA\u8282\u70B9\n'})}),"\n",(0,r.jsx)(n.h4,{id:"\u914D\u7F6E\u53C2\u6570-1",children:"\u914D\u7F6E\u53C2\u6570"}),"\n",(0,r.jsxs)(n.table,{children:[(0,r.jsx)(n.thead,{children:(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.th,{children:"\u53C2\u6570\u540D\u79F0"}),(0,r.jsx)(n.th,{children:"\u53EF\u9009\u503C"}),(0,r.jsx)(n.th,{children:"\u9ED8\u8BA4\u503C"}),(0,r.jsx)(n.th,{style:{textAlign:"center"},children:"\u662F\u5426\u5FC5\u987B"}),(0,r.jsx)(n.th,{children:"\u8BF4\u660E"})]})}),(0,r.jsxs)(n.tbody,{children:[(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"topologyManagerPolicy"})}),(0,r.jsxs)(n.td,{children:[(0,r.jsx)(n.code,{children:"none"}),", ",(0,r.jsx)(n.code,{children:"best-effort"}),", ",(0,r.jsx)(n.code,{children:"restricted"}),", ",(0,r.jsx)(n.code,{children:"single-numa-node"})]}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"none"})}),(0,r.jsx)(n.td,{style:{textAlign:"center"},children:(0,r.jsxs)(n.strong,{children:["\u662F\uFF08\u542F\u7528",(0,r.jsx)(n.code,{children:"NUMA"}),"\u4EB2\u548C\u6027\u65F6\uFF09"]})}),(0,r.jsxs)(n.td,{children:["\u62D3\u6251\u7BA1\u7406\u7B56\u7565\uFF0C\u51B3\u5B9A",(0,r.jsx)(n.code,{children:"NUMA"}),"\u5BF9\u9F50\u7684\u4E25\u683C\u7A0B\u5EA6"]})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"topologyManagerScope"})}),(0,r.jsxs)(n.td,{children:[(0,r.jsx)(n.code,{children:"container"}),", ",(0,r.jsx)(n.code,{children:"pod"})]}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"container"})}),(0,r.jsx)(n.td,{style:{textAlign:"center"},children:"\u5426"}),(0,r.jsx)(n.td,{children:"\u62D3\u6251\u7BA1\u7406\u7684\u4F5C\u7528\u8303\u56F4"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"topologyManagerPolicyOptions"})}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"Map"})}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"nil"})}),(0,r.jsx)(n.td,{style:{textAlign:"center"},children:"\u5426"}),(0,r.jsx)(n.td,{children:"\u7B56\u7565\u9009\u9879\uFF0C\u7528\u4E8E\u7CBE\u7EC6\u8C03\u6574\u7B56\u7565\u884C\u4E3A"})]})]})]}),"\n",(0,r.jsx)(n.h4,{id:"topologymanagerpolicy-\u8BE6\u89E3",children:"topologyManagerPolicy \u8BE6\u89E3"}),"\n",(0,r.jsxs)(n.table,{children:[(0,r.jsx)(n.thead,{children:(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.th,{children:"Policy"}),(0,r.jsx)(n.th,{children:"\u8BF4\u660E"}),(0,r.jsx)(n.th,{children:"\u9002\u7528\u573A\u666F"})]})}),(0,r.jsxs)(n.tbody,{children:[(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"none"})}),(0,r.jsx)(n.td,{children:"\u4E0D\u6267\u884C\u4EFB\u4F55\u62D3\u6251\u5BF9\u9F50\uFF0C\u4E0D\u5F71\u54CD\u8D44\u6E90\u5206\u914D"}),(0,r.jsxs)(n.td,{children:["\u9ED8\u8BA4\u884C\u4E3A\uFF0C\u4E0D\u9700\u8981",(0,r.jsx)(n.code,{children:"NUMA"}),"\u4EB2\u548C\u6027"]})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"best-effort"})}),(0,r.jsxs)(n.td,{children:["\u4F18\u5148\u9009\u62E9",(0,r.jsx)(n.code,{children:"NUMA"}),"\u5BF9\u9F50\uFF0C\u4F46\u4E0D\u5F3A\u5236\u3002\u5373\u4F7F\u6CA1\u6709\u6700\u4F18",(0,r.jsx)(n.code,{children:"NUMA"}),"\u5BF9\u9F50\uFF0C",(0,r.jsx)(n.code,{children:"Pod"}),"\u4E5F\u4F1A\u88AB\u51C6\u5165"]}),(0,r.jsxs)(n.td,{children:["\u5E0C\u671B",(0,r.jsx)(n.code,{children:"NUMA"}),"\u5BF9\u9F50\u4F46\u5141\u8BB8\u964D\u7EA7"]})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"restricted"})}),(0,r.jsxs)(n.td,{children:["\u4EC5\u5141\u8BB8",(0,r.jsx)(n.code,{children:"NUMA"}),"\u5BF9\u9F50\u7684",(0,r.jsx)(n.code,{children:"Pod"}),"\u51C6\u5165\u3002\u5982\u679C\u65E0\u6CD5\u6EE1\u8DB3\u6700\u4F18\u5BF9\u9F50\uFF0C",(0,r.jsx)(n.code,{children:"Pod"}),"\u88AB\u62D2\u7EDD"]}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.strong,{children:"\u63A8\u8350\u7528\u4E8EAI\u8BAD\u7EC3/\u63A8\u7406\u573A\u666F"})})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"single-numa-node"})}),(0,r.jsxs)(n.td,{children:["\u4EC5\u5141\u8BB8\u6240\u6709\u8D44\u6E90\u90FD\u5728",(0,r.jsxs)(n.strong,{children:["\u540C\u4E00\u4E2A",(0,r.jsx)(n.code,{children:"NUMA"}),"\u8282\u70B9"]}),"\u7684",(0,r.jsx)(n.code,{children:"Pod"}),"\u51C6\u5165"]}),(0,r.jsx)(n.td,{children:"\u5EF6\u8FDF\u6781\u5EA6\u654F\u611F\u7684\u5DE5\u4F5C\u8D1F\u8F7D"})]})]})]}),"\n",(0,r.jsx)(n.h4,{id:"topologymanagerscope-\u8BE6\u89E3",children:"topologyManagerScope \u8BE6\u89E3"}),"\n",(0,r.jsxs)(n.table,{children:[(0,r.jsx)(n.thead,{children:(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.th,{children:"Scope"}),(0,r.jsx)(n.th,{children:"\u8BF4\u660E"}),(0,r.jsx)(n.th,{children:"\u7279\u70B9"})]})}),(0,r.jsxs)(n.tbody,{children:[(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"container"})}),(0,r.jsx)(n.td,{children:"\u5728\u6BCF\u4E2A\u5BB9\u5668\u7EA7\u522B\u8FDB\u884C\u8D44\u6E90\u5BF9\u9F50"}),(0,r.jsxs)(n.td,{children:["\u540C\u4E00",(0,r.jsx)(n.code,{children:"Pod"}),"\u7684\u4E0D\u540C\u5BB9\u5668\u53EF\u80FD\u5206\u914D\u5230\u4E0D\u540C",(0,r.jsx)(n.code,{children:"NUMA"}),"\u8282\u70B9"]})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"pod"})}),(0,r.jsxs)(n.td,{children:["\u5728",(0,r.jsx)(n.code,{children:"Pod"}),"\u7EA7\u522B\u8FDB\u884C\u8D44\u6E90\u5BF9\u9F50"]}),(0,r.jsxs)(n.td,{children:[(0,r.jsx)(n.strong,{children:"\u63A8\u8350"}),"\uFF1A\u6240\u6709\u5BB9\u5668\u5206\u914D\u5230\u76F8\u540C\u7684",(0,r.jsx)(n.code,{children:"NUMA"}),"\u8282\u70B9\u96C6\u5408\uFF0C\u9002\u5408\u9700\u8981\u8FDB\u7A0B\u95F4\u901A\u4FE1\u7684\u5E94\u7528"]})]})]})]}),"\n",(0,r.jsx)(n.h4,{id:"topologymanagerpolicyoptions\u7B56\u7565\u9009\u9879",children:"topologyManagerPolicyOptions\uFF08\u7B56\u7565\u9009\u9879\uFF09"}),"\n",(0,r.jsxs)(n.table,{children:[(0,r.jsx)(n.thead,{children:(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.th,{children:"\u9009\u9879\u540D\u79F0"}),(0,r.jsx)(n.th,{children:"\u8BF4\u660E"})]})}),(0,r.jsxs)(n.tbody,{children:[(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"prefer-closest-numa-nodes"})}),(0,r.jsxs)(n.td,{children:["\u4F18\u5148\u9009\u62E9\u8DDD\u79BB\u6700\u8FD1\u7684",(0,r.jsx)(n.code,{children:"NUMA"}),"\u8282\u70B9\u96C6\u5408\uFF0C\u51CF\u5C11\u8DE8",(0,r.jsx)(n.code,{children:"NUMA"}),"\u901A\u4FE1\u5EF6\u8FDF"]})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"max-allowable-numa-nodes"})}),(0,r.jsxs)(n.td,{children:["\u5141\u8BB8\u8D85\u8FC7",(0,r.jsx)(n.code,{children:"8"}),"\u4E2A",(0,r.jsx)(n.code,{children:"NUMA"}),"\u8282\u70B9\u7684\u7CFB\u7EDF\u542F\u7528",(0,r.jsx)(n.code,{children:"Topology Manager"}),"\uFF08\u9ED8\u8BA4\u9650\u5236",(0,r.jsx)(n.code,{children:"8"}),"\u4E2A\uFF09"]})]})]})]}),"\n",(0,r.jsx)(n.h3,{id:"memory-manager",children:"Memory Manager"}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.code,{children:"Memory Manager"}),"\u8D1F\u8D23\u4E3A",(0,r.jsx)(n.code,{children:"Pod"}),"\u5206\u914D\u7279\u5B9A",(0,r.jsx)(n.code,{children:"NUMA"}),"\u8282\u70B9\u7684\u5185\u5B58\uFF0C\u786E\u4FDD\u5185\u5B58\u8BBF\u95EE\u672C\u5730\u5316\u3002"]}),"\n",(0,r.jsx)(n.h4,{id:"\u5B9E\u73B0\u539F\u7406-2",children:"\u5B9E\u73B0\u539F\u7406"}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"\u5185\u5B58\u8BA1\u6570"}),"\uFF1A\u8DDF\u8E2A\u6BCF\u4E2A",(0,r.jsx)(n.code,{children:"NUMA"}),"\u8282\u70B9\u7684\u53EF\u7528\u5185\u5B58\u548C\u5DF2\u5206\u914D\u5185\u5B58"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"NUMA\u611F\u77E5\u5206\u914D"}),"\uFF1A\u6839\u636E",(0,r.jsx)(n.code,{children:"Topology Manager"}),"\u7684\u51B3\u7B56\uFF0C\u4ECE\u6307\u5B9A",(0,r.jsx)(n.code,{children:"NUMA"}),"\u8282\u70B9\u5206\u914D\u5185\u5B58"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Hint\u63D0\u4F9B"}),"\uFF1A\u5411",(0,r.jsx)(n.code,{children:"Topology Manager"}),"\u63D0\u4F9B\u5185\u5B58\u7684",(0,r.jsx)(n.code,{children:"NUMA"}),"\u4EB2\u548C\u6027\u63D0\u793A"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"\u72B6\u6001\u6301\u4E45\u5316"}),"\uFF1A\u5206\u914D\u72B6\u6001\u5B58\u50A8\u5728",(0,r.jsx)(n.code,{children:"/var/lib/kubelet/memory_manager_state"}),"\u6587\u4EF6\u4E2D"]}),"\n"]}),"\n",(0,r.jsx)(n.h4,{id:"\u914D\u7F6E\u793A\u4F8B-2",children:"\u914D\u7F6E\u793A\u4F8B"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-yaml",children:"memoryManagerPolicy: Static                 # \u542F\u7528\u9759\u6001\u5185\u5B58\u7BA1\u7406\u7B56\u7565\nreservedMemory:\n  - numaNode: 0\n    limits:\n      memory: 2Gi                           # NUMA 0 \u9884\u7559\u5185\u5B58\n  - numaNode: 1\n    limits:\n      memory: 2Gi                           # NUMA 1 \u9884\u7559\u5185\u5B58\n"})}),"\n",(0,r.jsx)(n.h4,{id:"\u914D\u7F6E\u53C2\u6570-2",children:"\u914D\u7F6E\u53C2\u6570"}),"\n",(0,r.jsxs)(n.table,{children:[(0,r.jsx)(n.thead,{children:(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.th,{children:"\u53C2\u6570\u540D\u79F0"}),(0,r.jsx)(n.th,{children:"\u53EF\u9009\u503C"}),(0,r.jsx)(n.th,{children:"\u9ED8\u8BA4\u503C"}),(0,r.jsx)(n.th,{style:{textAlign:"center"},children:"\u662F\u5426\u5FC5\u987B"}),(0,r.jsx)(n.th,{children:"\u8BF4\u660E"})]})}),(0,r.jsxs)(n.tbody,{children:[(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"memoryManagerPolicy"})}),(0,r.jsxs)(n.td,{children:[(0,r.jsx)(n.code,{children:"None"}),", ",(0,r.jsx)(n.code,{children:"Static"})]}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"None"})}),(0,r.jsx)(n.td,{style:{textAlign:"center"},children:"\u5426"}),(0,r.jsxs)(n.td,{children:["\u5185\u5B58\u7BA1\u7406\u7B56\u7565\u3002",(0,r.jsx)(n.code,{children:"Static"}),"\u4E3A",(0,r.jsx)(n.code,{children:"Guaranteed Pod"}),"\u63D0\u4F9B\u5185\u5B58",(0,r.jsx)(n.code,{children:"NUMA"}),"\u4EB2\u548C\u6027"]})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"reservedMemory"})}),(0,r.jsxs)(n.td,{children:[(0,r.jsx)(n.code,{children:"MemoryReservation"}),"\u5217\u8868"]}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"nil"})}),(0,r.jsxs)(n.td,{style:{textAlign:"center"},children:[(0,r.jsx)(n.code,{children:"Static"}),"\u7B56\u7565\u65F6\u5FC5\u987B"]}),(0,r.jsxs)(n.td,{children:["\u6BCF\u4E2A",(0,r.jsx)(n.code,{children:"NUMA"}),"\u8282\u70B9\u9884\u7559\u7684\u5185\u5B58\u91CF"]})]})]})]}),"\n",(0,r.jsx)(n.h4,{id:"reserved-memory-\u914D\u7F6E",children:"Reserved Memory \u914D\u7F6E"}),"\n",(0,r.jsxs)(n.p,{children:["\u4F7F\u7528",(0,r.jsx)(n.code,{children:"Static"}),"\u7B56\u7565\u65F6\uFF0C\u5FC5\u987B\u914D\u7F6E\u6BCF\u4E2A",(0,r.jsx)(n.code,{children:"NUMA"}),"\u8282\u70B9\u9884\u7559\u7684\u5185\u5B58\uFF0C\u4E14\u9700\u6EE1\u8DB3\uFF1A"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-text",children:"sum(reserved-memory) = kube-reserved + system-reserved + eviction-hard\n"})}),"\n",(0,r.jsx)(n.p,{children:"\u5176\u4E2D\uFF1A"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"kube-reserved"}),"\uFF1A\u4E3A",(0,r.jsx)(n.code,{children:"Kubernetes"}),"\u7CFB\u7EDF\u7EC4\u4EF6\uFF08\u5982",(0,r.jsx)(n.code,{children:"kubelet"}),"\u3001\u5BB9\u5668\u8FD0\u884C\u65F6\uFF09\u9884\u7559\u7684\u8D44\u6E90"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"system-reserved"}),"\uFF1A\u4E3A\u64CD\u4F5C\u7CFB\u7EDF\u5B88\u62A4\u8FDB\u7A0B\uFF08\u5982",(0,r.jsx)(n.code,{children:"sshd"}),"\u3001",(0,r.jsx)(n.code,{children:"systemd"}),"\uFF09\u9884\u7559\u7684\u8D44\u6E90"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"eviction-hard"}),"\uFF1A",(0,r.jsx)(n.strong,{children:"\u786C\u9A71\u9010\u9608\u503C"}),"\uFF0C\u5F53\u8282\u70B9\u8D44\u6E90\u4F7F\u7528\u8FBE\u5230\u8BE5\u9608\u503C\u65F6\uFF0C",(0,r.jsx)(n.code,{children:"kubelet"}),"\u4F1A\u7ACB\u5373\u9A71\u9010",(0,r.jsx)(n.code,{children:"Pod"}),"\u4EE5\u56DE\u6536\u8D44\u6E90\uFF0C\u907F\u514D\u8282\u70B9\u8D44\u6E90\u8017\u5C3D\u3002\u5E38\u89C1\u7684\u9A71\u9010\u4FE1\u53F7\u5305\u62EC\uFF1A","\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"memory.available"}),"\uFF1A\u53EF\u7528\u5185\u5B58\u4F4E\u4E8E\u9608\u503C"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"nodefs.available"}),"\uFF1A\u8282\u70B9\u6587\u4EF6\u7CFB\u7EDF\u53EF\u7528\u7A7A\u95F4\u4F4E\u4E8E\u9608\u503C"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"imagefs.available"}),"\uFF1A\u955C\u50CF\u6587\u4EF6\u7CFB\u7EDF\u53EF\u7528\u7A7A\u95F4\u4F4E\u4E8E\u9608\u503C"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"pid.available"}),"\uFF1A\u53EF\u7528",(0,r.jsx)(n.code,{children:"PID"}),"\u6570\u91CF\u4F4E\u4E8E\u9608\u503C"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"evictionHard\u914D\u7F6E\u793A\u4F8B"}),"\uFF1A"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-yaml",children:'# kubelet\u914D\u7F6E\nevictionHard:\n  memory.available: "100Mi"      # \u53EF\u7528\u5185\u5B58\u4F4E\u4E8E100Mi\u65F6\u7ACB\u5373\u9A71\u9010Pod\n  nodefs.available: "10%"        # \u8282\u70B9\u6587\u4EF6\u7CFB\u7EDF\u53EF\u7528\u7A7A\u95F4\u4F4E\u4E8E10%\u65F6\u9A71\u9010\n  imagefs.available: "15%"       # \u955C\u50CF\u6587\u4EF6\u7CFB\u7EDF\u53EF\u7528\u7A7A\u95F4\u4F4E\u4E8E15%\u65F6\u9A71\u9010\n  nodefs.inodesFree: "5%"        # \u8282\u70B9\u6587\u4EF6\u7CFB\u7EDF\u53EF\u7528inode\u4F4E\u4E8E5%\u65F6\u9A71\u9010\n'})}),"\n",(0,r.jsxs)(n.p,{children:["\u5F53",(0,r.jsx)(n.code,{children:"kubelet"}),"\u914D\u7F6E\u4E0D\u6EE1\u8DB3",(0,r.jsx)(n.code,{children:"sum(reserved-memory) = kube-reserved + system-reserved + eviction-hard"}),"\u89C4\u5219\u65F6\uFF0C\u4F1A\u62A5\u7C7B\u4F3C\u5982\u4E0B\u7684\u9519\u8BEF\uFF1A"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:'Failed to initialize memory manager" err="the total amount "xxx" of type "memory" is not equal to the value "xxx" determined by Node Allocatable feature"\n'})}),"\n",(0,r.jsx)(n.h3,{id:"device-manager",children:"Device Manager"}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.code,{children:"Device Manager"}),"\u672C\u8EAB\u7531\u8BBE\u5907\u63D2\u4EF6\uFF08",(0,r.jsx)(n.code,{children:"Device Plugin"}),"\uFF09\u5B9E\u73B0\uFF0C\u5982",(0,r.jsx)(n.code,{children:"NVIDIA GPU"}),"\u7684",(0,r.jsx)(n.code,{children:"nvidia-device-plugin"}),"\u3002\u5B83\u5411",(0,r.jsx)(n.code,{children:"Topology Manager"}),"\u63D0\u4F9B",(0,r.jsx)(n.code,{children:"GPU"}),"\u8BBE\u5907\u6240\u5728",(0,r.jsx)(n.code,{children:"NUMA"}),"\u8282\u70B9\u7684\u4FE1\u606F\u3002"]}),"\n",(0,r.jsx)(n.h4,{id:"\u5DE5\u4F5C\u673A\u5236",children:"\u5DE5\u4F5C\u673A\u5236"}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"NUMA\u62D3\u6251\u68C0\u6D4B"}),"\uFF1A",(0,r.jsx)(n.code,{children:"Device Plugin"}),"\u542F\u52A8\u65F6\u901A\u8FC7\u8BFB\u53D6",(0,r.jsx)(n.code,{children:"/sys/bus/pci/devices/<busid>/numa_node"}),"\u6587\u4EF6\u81EA\u52A8\u68C0\u6D4B\u6BCF\u4E2A",(0,r.jsx)(n.code,{children:"GPU"}),"\u7684",(0,r.jsx)(n.code,{children:"NUMA"}),"\u8282\u70B9\u4FE1\u606F"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"\u8BBE\u5907\u6CE8\u518C"}),"\uFF1A\u5411",(0,r.jsx)(n.code,{children:"kubelet"}),"\u6CE8\u518C\u8BBE\u5907\u8D44\u6E90\uFF08\u5982",(0,r.jsx)(n.code,{children:"nvidia.com/gpu"}),"\uFF09\uFF0C\u5E76\u5728\u8BBE\u5907\u7684",(0,r.jsx)(n.code,{children:"TopologyInfo"}),"\u5B57\u6BB5\u4E2D\u643A\u5E26",(0,r.jsx)(n.code,{children:"NUMA"}),"\u8282\u70B9\u4FE1\u606F"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Hints\u63D0\u4F9B"}),"\uFF1A\u5F53",(0,r.jsx)(n.code,{children:"Pod"}),"\u8BF7\u6C42",(0,r.jsx)(n.code,{children:"GPU"}),"\u65F6\uFF0C\u901A\u8FC7",(0,r.jsx)(n.code,{children:"GetPreferredAllocation"}),"\u63A5\u53E3\u8FD4\u56DE",(0,r.jsx)(n.code,{children:"NUMA"}),"\u611F\u77E5\u7684\u8BBE\u5907\u5206\u914D\u5EFA\u8BAE"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"\u62D3\u6251\u534F\u8C03"}),"\uFF1A",(0,r.jsx)(n.code,{children:"Topology Manager"}),"\u7ED3\u5408",(0,r.jsx)(n.code,{children:"CPU"}),"\u3001",(0,r.jsx)(n.code,{children:"Memory"}),"\u548C",(0,r.jsx)(n.code,{children:"GPU"}),"\u7684",(0,r.jsx)(n.code,{children:"Hints"}),"\uFF0C\u9009\u62E9\u6700\u4F18\u7684",(0,r.jsx)(n.code,{children:"NUMA"}),"\u8282\u70B9\u7EC4\u5408"]}),"\n"]}),"\n",(0,r.jsx)(n.h4,{id:"numa\u611F\u77E5\u529F\u80FD\u8BF4\u660E",children:"NUMA\u611F\u77E5\u529F\u80FD\u8BF4\u660E"}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"\u91CD\u8981\u7279\u6027"}),"\uFF1A",(0,r.jsx)(n.code,{children:"NVIDIA Device Plugin"}),"\u4ECE",(0,r.jsx)(n.code,{children:"v0.2.0"}),"\u7248\u672C\u5F00\u59CB",(0,r.jsxs)(n.strong,{children:["\u539F\u751F\u652F\u6301",(0,r.jsx)(n.code,{children:"NUMA"}),"\u611F\u77E5\u529F\u80FD"]}),"\uFF0C\u65E0\u9700\u989D\u5916\u914D\u7F6E\u5373\u53EF\u81EA\u52A8\u542F\u7528\u3002\u8BE5\u529F\u80FD\u57FA\u4E8E\u4EE5\u4E0B\u673A\u5236\uFF1A"]}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"\u81EA\u52A8\u68C0\u6D4B"}),"\uFF1A\u901A\u8FC7",(0,r.jsx)(n.code,{children:"NVML"}),"\u5E93\u548C",(0,r.jsx)(n.code,{children:"sysfs"}),"\u81EA\u52A8\u83B7\u53D6",(0,r.jsx)(n.code,{children:"GPU"}),"\u7684",(0,r.jsx)(n.code,{children:"NUMA"}),"\u8282\u70B9\u4FE1\u606F"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"\u900F\u660E\u4F20\u9012"}),"\uFF1A\u901A\u8FC7",(0,r.jsx)(n.code,{children:"Kubernetes Device Plugin API"}),"\u7684",(0,r.jsx)(n.code,{children:"TopologyInfo"}),"\u7ED3\u6784\u4F53\u5C06",(0,r.jsx)(n.code,{children:"NUMA"}),"\u4FE1\u606F\u4F20\u9012\u7ED9",(0,r.jsx)(n.code,{children:"kubelet"})]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"\u667A\u80FD\u5206\u914D"}),"\uFF1A\u5B9E\u73B0\u4E86",(0,r.jsx)(n.code,{children:"GetPreferredAllocation"}),"\u63A5\u53E3\uFF0C\u6839\u636E\u8BBE\u5907\u7C7B\u578B\u91C7\u7528\u4E0D\u540C\u7684\u5206\u914D\u7B56\u7565\uFF1A","\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"\u5BF9\u9F50\u5206\u914D"}),"\uFF1A\u5BF9\u4E8E\u5B8C\u6574",(0,r.jsx)(n.code,{children:"GPU"}),"\uFF0C\u4F18\u5148\u9009\u62E9\u540C\u4E00",(0,r.jsx)(n.code,{children:"NUMA"}),"\u8282\u70B9\u7684\u8BBE\u5907"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"\u5206\u5E03\u5F0F\u5206\u914D"}),"\uFF1A\u5BF9\u4E8E",(0,r.jsx)(n.code,{children:"MIG"}),"\u3001",(0,r.jsx)(n.code,{children:"Time-slicing"}),"\u7B49\u5171\u4EAB\u6A21\u5F0F\uFF0C\u5747\u5300\u5206\u5E03\u8BBE\u5907"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(n.h4,{id:"\u914D\u7F6E\u65B9\u5F0F",children:"\u914D\u7F6E\u65B9\u5F0F"}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.code,{children:"NVIDIA Device Plugin"}),"\u652F\u6301\u591A\u79CD\u914D\u7F6E\u65B9\u5F0F\uFF0C\u53EF\u4EE5\u901A\u8FC7",(0,r.jsx)(n.code,{children:"ConfigMap"}),"\u3001\u547D\u4EE4\u884C\u53C2\u6570\u6216",(0,r.jsx)(n.code,{children:"Helm Chart"}),"\u8FDB\u884C\u914D\u7F6E\u3002"]}),"\n",(0,r.jsx)(n.h5,{id:"configmap\u914D\u7F6E\u793A\u4F8B",children:"ConfigMap\u914D\u7F6E\u793A\u4F8B"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-yaml",children:'apiVersion: v1\nkind: ConfigMap\nmetadata:\n  name: nvidia-device-plugin-config\n  namespace: nvidia-device-plugin\ndata:\n  config.yaml: |\n    version: v1\n    flags:\n      migStrategy: "none"              # MIG\u7B56\u7565: none, single, mixed\n      failOnInitError: true             # \u521D\u59CB\u5316\u5931\u8D25\u65F6\u662F\u5426\u7EC8\u6B62\n      nvidiaDriverRoot: "/"             # NVIDIA\u9A71\u52A8\u6839\u76EE\u5F55\n      plugin:\n        passDeviceSpecs: false          # \u662F\u5426\u4F20\u9012\u8BBE\u5907\u89C4\u8303\uFF08\u4E0ECPU Manager\u517C\u5BB9\u65F6\u8BBE\u4E3Atrue\uFF09\n        deviceListStrategy: "envvar"    # \u8BBE\u5907\u5217\u8868\u7B56\u7565: envvar, volume-mounts\n        deviceIDStrategy: "uuid"        # \u8BBE\u5907ID\u7B56\u7565: uuid, index\n'})}),"\n",(0,r.jsx)(n.h4,{id:"\u5173\u952E\u914D\u7F6E\u53C2\u6570",children:"\u5173\u952E\u914D\u7F6E\u53C2\u6570"}),"\n",(0,r.jsxs)(n.table,{children:[(0,r.jsx)(n.thead,{children:(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.th,{children:"\u53C2\u6570\u540D\u79F0"}),(0,r.jsx)(n.th,{children:"\u53EF\u9009\u503C"}),(0,r.jsx)(n.th,{children:"\u9ED8\u8BA4\u503C"}),(0,r.jsx)(n.th,{children:"\u8BF4\u660E"})]})}),(0,r.jsxs)(n.tbody,{children:[(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"migStrategy"})}),(0,r.jsxs)(n.td,{children:[(0,r.jsx)(n.code,{children:"none"}),", ",(0,r.jsx)(n.code,{children:"single"}),", ",(0,r.jsx)(n.code,{children:"mixed"})]}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"none"})}),(0,r.jsxs)(n.td,{children:[(0,r.jsx)(n.code,{children:"MIG"}),"\u6A21\u5F0F\u7B56\u7565\u3002",(0,r.jsx)(n.code,{children:"none"}),"\u8868\u793A\u4E0D\u4F7F\u7528",(0,r.jsx)(n.code,{children:"MIG"}),"\uFF1B",(0,r.jsx)(n.code,{children:"single"}),"\u8868\u793A\u6BCF\u4E2A",(0,r.jsx)(n.code,{children:"MIG"}),"\u8BBE\u5907\u4F5C\u4E3A\u72EC\u7ACB\u8D44\u6E90\uFF1B",(0,r.jsx)(n.code,{children:"mixed"}),"\u8868\u793A\u540C\u65F6\u66B4\u9732\u5B8C\u6574",(0,r.jsx)(n.code,{children:"GPU"}),"\u548C",(0,r.jsx)(n.code,{children:"MIG"}),"\u8BBE\u5907"]})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"failOnInitError"})}),(0,r.jsxs)(n.td,{children:[(0,r.jsx)(n.code,{children:"true"}),", ",(0,r.jsx)(n.code,{children:"false"})]}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"true"})}),(0,r.jsxs)(n.td,{children:["\u521D\u59CB\u5316\u5931\u8D25\u65F6\u662F\u5426\u7EC8\u6B62\u63D2\u4EF6\u3002\u5EFA\u8BAE\u751F\u4EA7\u73AF\u5883\u8BBE\u4E3A",(0,r.jsx)(n.code,{children:"true"})]})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"passDeviceSpecs"})}),(0,r.jsxs)(n.td,{children:[(0,r.jsx)(n.code,{children:"true"}),", ",(0,r.jsx)(n.code,{children:"false"})]}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"false"})}),(0,r.jsxs)(n.td,{children:["\u662F\u5426\u4F20\u9012\u8BBE\u5907\u89C4\u8303\u7ED9\u5BB9\u5668\u3002\u5F53\u542F\u7528",(0,r.jsx)(n.code,{children:"CPU Manager"}),"\u7684",(0,r.jsx)(n.code,{children:"static"}),"\u7B56\u7565\u65F6\uFF0C\u9700\u8981\u8BBE\u4E3A",(0,r.jsx)(n.code,{children:"false"}),"\u4EE5\u907F\u514D\u6743\u9650\u95EE\u9898"]})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"deviceListStrategy"})}),(0,r.jsxs)(n.td,{children:[(0,r.jsx)(n.code,{children:"envvar"}),", ",(0,r.jsx)(n.code,{children:"volume-mounts"})]}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"envvar"})}),(0,r.jsxs)(n.td,{children:["\u8BBE\u5907\u5217\u8868\u4F20\u9012\u65B9\u5F0F\u3002",(0,r.jsx)(n.code,{children:"envvar"}),"\u901A\u8FC7\u73AF\u5883\u53D8\u91CF",(0,r.jsx)(n.code,{children:"NVIDIA_VISIBLE_DEVICES"}),"\u4F20\u9012\uFF1B",(0,r.jsx)(n.code,{children:"volume-mounts"}),"\u901A\u8FC7\u6302\u8F7D",(0,r.jsx)(n.code,{children:"/dev"}),"\u8BBE\u5907\u8282\u70B9"]})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"deviceIDStrategy"})}),(0,r.jsxs)(n.td,{children:[(0,r.jsx)(n.code,{children:"uuid"}),", ",(0,r.jsx)(n.code,{children:"index"})]}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"uuid"})}),(0,r.jsxs)(n.td,{children:["\u8BBE\u5907\u6807\u8BC6\u7B56\u7565\u3002",(0,r.jsx)(n.code,{children:"uuid"}),"\u4F7F\u7528",(0,r.jsx)(n.code,{children:"GPU UUID"}),"\uFF1B",(0,r.jsx)(n.code,{children:"index"}),"\u4F7F\u7528\u8BBE\u5907\u7D22\u5F15"]})]})]})]}),"\n",(0,r.jsx)(n.h2,{id:"\u5173\u952E\u7EC4\u4EF6\u914D\u7F6E\u66F4\u65B0",children:"\u5173\u952E\u7EC4\u4EF6\u914D\u7F6E\u66F4\u65B0"}),"\n",(0,r.jsxs)(n.p,{children:["\u5728\u6267\u884C\u6D4B\u8BD5\u4E4B\u524D\uFF0C\u6211\u4EEC\u5BF9",(0,r.jsx)(n.code,{children:"kubelet"}),"\u7684\u914D\u7F6E\u8FDB\u884C\u4FEE\u6539\u4EE5\u542F\u7528",(0,r.jsx)(n.code,{children:"NUMA"}),"\u4EB2\u548C\u6027\u7279\u6027\uFF1A"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-yaml",children:'apiVersion: kubelet.config.k8s.io/v1beta1\nkind: KubeletConfiguration\n\n# ============= CPU Manager \u914D\u7F6E =============\ncpuManagerPolicy: static                    # \u542F\u7528\u9759\u6001CPU\u7BA1\u7406\u7B56\u7565\ncpuManagerReconcilePeriod: 10s              # \u8C03\u548C\u5468\u671F\ncpuManagerPolicyOptions:\n  full-pcpus-only: "true"                   # \u4EC5\u5206\u914D\u5B8C\u6574\u7269\u7406\u6838\u5FC3\n\n# ============= Topology Manager \u914D\u7F6E =============\ntopologyManagerPolicy: restricted           # \u4E25\u683C\u8981\u6C42NUMA\u5BF9\u9F50\ntopologyManagerScope: pod                   # Pod\u7EA7\u522B\u5BF9\u9F50\ntopologyManagerPolicyOptions:\n  prefer-closest-numa-nodes: "true"         # \u4F18\u5148\u9009\u62E9\u8DDD\u79BB\u6700\u8FD1\u7684NUMA\u8282\u70B9\n\n# ============= Memory Manager \u914D\u7F6E =============\nmemoryManagerPolicy: Static                 # \u542F\u7528\u9759\u6001\u5185\u5B58\u7BA1\u7406\u7B56\u7565\nreservedMemory:\n  - numaNode: 0\n    limits:\n      memory: 2Gi                           # NUMA 0 \u9884\u7559\u5185\u5B58\n  - numaNode: 1\n    limits:\n      memory: 2Gi                           # NUMA 1 \u9884\u7559\u5185\u5B58\n\n# ============= \u8D44\u6E90\u9884\u7559\u914D\u7F6E =============\n# \u6CE8\u610F\u9700\u8981\u4FDD\u8BC1\u516C\u5F0F\uFF1A\n# sum(reserved-memory) = kube-reserved + system-reserved + eviction-hard\nkubeReserved:\n  cpu: "2"\n  memory: 1Gi\nsystemReserved:\n  cpu: "2"\n  memory: 1Gi\nevictionHard:\n  memory.available: "2Gi"        # \u53EF\u7528\u5185\u5B58\u4F4E\u4E8E2Gi\u65F6\u7ACB\u5373\u9A71\u9010Pod\n  nodefs.available: "10%"        # \u8282\u70B9\u6587\u4EF6\u7CFB\u7EDF\u53EF\u7528\u7A7A\u95F4\u4F4E\u4E8E10%\u65F6\u9A71\u9010\n  imagefs.available: "15%"       # \u955C\u50CF\u6587\u4EF6\u7CFB\u7EDF\u53EF\u7528\u7A7A\u95F4\u4F4E\u4E8E15%\u65F6\u9A71\u9010\n  nodefs.inodesFree: "5%"        # \u8282\u70B9\u6587\u4EF6\u7CFB\u7EDF\u53EF\u7528inode\u4F4E\u4E8E5%\u65F6\u9A71\u9010\n\n# ============= Feature Gates\uFF08\u53EF\u9009\uFF09=============\nfeatureGates:\n  CPUManagerPolicyOptions: true\n  # \u4F4E\u7248\u672CK8S\u9700\u8981\u6B64\u9879\u542F\u7528\u7B56\u7565\u9009\u9879\uFF0C\u5982\u7B14\u8005\u5F53\u524D\u76841.27.3\u7248\u672C\n  CPUManagerPolicyBetaOptions: true\n  TopologyManagerPolicyOptions: true\n  # \u4F4E\u7248\u672CK8S\u9700\u8981\u6B64\u9879\u542F\u7528\u7B56\u7565\u9009\u9879\uFF0C\u5982\u7B14\u8005\u5F53\u524D\u76841.27.3\u7248\u672C\n  TopologyManagerPolicyAlphaOptions: true \n\n# ... \u5176\u4ED6\u914D\u7F6E\u9879\u4FDD\u6301\u4E0D\u53D8 ...\n'})}),"\n",(0,r.jsxs)(n.p,{children:["\u6309\u7167\u4EE5\u4E0B\u6B65\u9AA4\u66F4\u65B0",(0,r.jsx)(n.code,{children:"kubelet"}),"\u914D\u7F6E\u5E76\u91CD\u542F\uFF1A"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"# 1. Drain\u8282\u70B9\uFF08\u5EFA\u8BAE\uFF09\nkubectl drain <node-name> --ignore-daemonsets --delete-emptydir-data\n\n# 2. \u505C\u6B62kubelet\nsystemctl stop kubelet\n\n# 3. \u5220\u9664\u72B6\u6001\u6587\u4EF6\nrm /var/lib/kubelet/cpu_manager_state\nrm /var/lib/kubelet/memory_manager_state\n\n# 4. \u4FEE\u6539kubelet\u914D\u7F6E\nvim /var/lib/kubelet/config.yaml\n\n# 5. \u542F\u52A8kubelet\nsystemctl start kubelet\n\n# 6. Uncordon\u8282\u70B9\uFF08\u82E5\u524D\u9762\u6267\u884C\u4E86drain\uFF09\nkubectl uncordon <node-name>\n"})}),"\n",(0,r.jsx)(n.p,{children:"\u9700\u8981\u6CE8\u610F\u5207\u6362\u7B56\u7565\u9700\u8981\u6E05\u7406\u72B6\u6001\u6587\u4EF6\uFF0C\u5426\u5219\u4F1A\u62A5\u7C7B\u4F3C\u5982\u4E0B\u7684\u9519\u8BEF\uFF1A"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-text",children:'start cpu manager error: could not restore state from checkpoint: configured policy "static" differs from state checkpoint policy "none", please drain this node and delete the CPU manager checkpoint file "/var/lib/kubelet/cpu_manager_state" before restarting Kubelet"\n'})}),"\n",(0,r.jsx)(n.h2,{id:"\u6D4B\u8BD5\u793A\u4F8B",children:"\u6D4B\u8BD5\u793A\u4F8B"}),"\n",(0,r.jsx)(n.admonition,{title:"\u6CE8\u610F",type:"danger",children:(0,r.jsx)(n.p,{children:"\u672C\u6587\u6863\u4E2D\u7684\u793A\u4F8B\u4EE3\u7801\u8FD8\u672A\u8FDB\u884C\u8FC7\u4E25\u683C\u6D4B\u8BD5\uFF0C\u4EC5\u4F9B\u53C2\u8003\u3002\u540E\u7EED\u7ECF\u8FC7\u5B8C\u6574\u6D4B\u8BD5\u540E\u518D\u66F4\u65B0\u8FD9\u91CC\u7684\u4EE3\u7801\u548C\u4ECB\u7ECD\u5185\u5BB9\u3002"})}),"\n",(0,r.jsx)(n.h3,{id:"\u9A8C\u8BC1numa\u4EB2\u548C\u6027",children:"\u9A8C\u8BC1NUMA\u4EB2\u548C\u6027"}),"\n",(0,r.jsxs)(n.p,{children:["\u4EE5\u4E0B\u793A\u4F8B\u4F7F\u7528",(0,r.jsx)(n.code,{children:"NVIDIA CUDA"}),"\u955C\u50CF\uFF0C\u901A\u8FC7",(0,r.jsx)(n.code,{children:"nvidia-smi topo -m"}),"\u547D\u4EE4\u9A8C\u8BC1",(0,r.jsx)(n.code,{children:"GPU"}),"\u7684",(0,r.jsx)(n.code,{children:"NUMA"}),"\u4EB2\u548C\u6027\u914D\u7F6E\uFF1A"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-yaml",children:'apiVersion: v1\nkind: Pod\nmetadata:\n  name: numa-affinity-test\nspec:\n  restartPolicy: Never\n  containers:\n  - name: cuda-container\n    image: nvidia/cuda:12.2.0-base-ubuntu20.04\n    command:\n    - /bin/bash\n    - -c\n    - |\n      echo "========== GPU Topology Information =========="\n      nvidia-smi topo -m\n      echo ""\n      echo "========== CPU Affinity Information =========="\n      echo "Current CPU affinity: $(taskset -p $$)"\n      cat /proc/self/status | grep -E "Cpus_allowed|Mems_allowed"\n      echo ""\n      echo "========== NUMA Information =========="\n      numactl --hardware 2>/dev/null || echo "numactl not available"\n      echo ""\n      echo "========== Process CPU Binding =========="\n      cat /proc/self/cpuset\n      echo ""\n      echo "========== Sleeping for observation =========="\n      sleep 3600\n    resources:\n      # Guaranteed QoS: requests == limits\n      # CPU\u5FC5\u987B\u662F\u6574\u6570\u624D\u80FD\u83B7\u5F97\u72EC\u5360CPU\n      requests:\n        cpu: "4"\n        memory: "8Gi"\n        nvidia.com/gpu: "1"\n      limits:\n        cpu: "4"\n        memory: "8Gi"\n        nvidia.com/gpu: "1"\n'})}),"\n",(0,r.jsx)(n.h3,{id:"\u591Agpu-numa\u4EB2\u548C\u6027\u6D4B\u8BD5",children:"\u591AGPU NUMA\u4EB2\u548C\u6027\u6D4B\u8BD5"}),"\n",(0,r.jsxs)(n.p,{children:["\u4EE5\u4E0B\u793A\u4F8B\u8BF7\u6C42\u540C\u4E00",(0,r.jsx)(n.code,{children:"NUMA"}),"\u8282\u70B9\u7684\u591A\u4E2A",(0,r.jsx)(n.code,{children:"GPU"}),"\uFF1A"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-yaml",children:'apiVersion: v1\nkind: Pod\nmetadata:\n  name: multi-gpu-numa-test\n  namespace: default\nspec:\n  restartPolicy: Never\n  containers:\n  - name: cuda-multi-gpu\n    image: nvidia/cuda:12.2.0-base-ubuntu20.04\n    command:\n    - /bin/bash\n    - -c\n    - |\n      echo "========== GPU Topology =========="\n      nvidia-smi topo -m\n      echo ""\n      echo "========== Allocated GPUs =========="\n      echo "NVIDIA_VISIBLE_DEVICES: $NVIDIA_VISIBLE_DEVICES"\n      echo ""\n      echo "========== GPU Details =========="\n      nvidia-smi --query-gpu=index,name,pci.bus_id,memory.total --format=csv\n      echo ""\n      echo "========== CPU Binding =========="\n      cat /proc/self/status | grep -E "Cpus_allowed_list|Mems_allowed_list"\n      echo ""\n      sleep 3600\n    resources:\n      requests:\n        cpu: "8"\n        memory: "16Gi"\n        nvidia.com/gpu: "2"       # \u8BF7\u6C422\u4E2AGPU\n      limits:\n        cpu: "8"\n        memory: "16Gi"\n        nvidia.com/gpu: "2"\n'})}),"\n",(0,r.jsx)(n.h2,{id:"\u6545\u969C\u6392\u67E5",children:"\u6545\u969C\u6392\u67E5"}),"\n",(0,r.jsx)(n.h3,{id:"smtalignmenterror",children:"SMTAlignmentError"}),"\n",(0,r.jsxs)(n.p,{children:["\u5F53",(0,r.jsx)(n.code,{children:"Pod"}),"\u8BF7\u6C42\u7684",(0,r.jsx)(n.code,{children:"CPU"}),"\u6838\u5FC3\u65E0\u6CD5\u6EE1\u8DB3",(0,r.jsx)(n.code,{children:"full-pcpus-only"}),"\u9009\u9879\u65F6\uFF0C\u4F1A\u51FA\u73B0\u6B64\u9519\u8BEF\uFF1A"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"NAME                READY   STATUS              RESTARTS   AGE\nnuma-affinity-test  0/1     SMTAlignmentError   0          10s\n"})}),"\n",(0,r.jsxs)(n.p,{children:["\u67E5\u770B",(0,r.jsx)(n.code,{children:"Pod"}),"\u4FE1\u606F\u65F6\u4F1A\u6709\u7C7B\u4F3C\u5982\u4E0B\u7684\u9519\u8BEF\u65E5\u5FD7\uFF1A"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-text",children:"Events:\n  Type     Reason               Age     From        Message\n  ----     ------               ----    ----        -------\n  Warning  SMTAlignmentError    57s     kubelet     requested 1 cpus not multiple cpus per core=2\n"})}),"\n",(0,r.jsxs)(n.p,{children:["\u9700\u8981\u4FDD\u8BC1\u7533\u8BF7\u7684",(0,r.jsx)(n.code,{children:"CPU"}),"\u6838\u5FC3\u6570\u4E3A",(0,r.jsx)(n.code,{children:"2"}),"\u7684\u6574\u6570\u500D\u3002"]}),"\n",(0,r.jsx)(n.h3,{id:"topologyaffinityerror",children:"TopologyAffinityError"}),"\n",(0,r.jsxs)(n.p,{children:["\u5F53",(0,r.jsx)(n.code,{children:"Pod"}),"\u65E0\u6CD5\u6EE1\u8DB3",(0,r.jsx)(n.code,{children:"Topology Manager"}),"\u7684\u7B56\u7565\u8981\u6C42\u65F6\uFF0C\u4F1A\u51FA\u73B0\u6B64\u9519\u8BEF\uFF1A"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"NAME                READY   STATUS                  RESTARTS   AGE\nnuma-affinity-test  0/1     TopologyAffinityError   0          10s\n"})}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"\u6392\u67E5\u6B65\u9AA4"}),"\uFF1A"]}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsxs)(n.li,{children:["\u68C0\u67E5\u8282\u70B9\u53EF\u7528\u8D44\u6E90\u662F\u5426\u6EE1\u8DB3",(0,r.jsx)(n.code,{children:"NUMA"}),"\u5BF9\u9F50\u8981\u6C42"]}),"\n",(0,r.jsxs)(n.li,{children:["\u964D\u4F4E\u7B56\u7565\u4E25\u683C\u7A0B\u5EA6\uFF08\u5982\u4ECE",(0,r.jsx)(n.code,{children:"single-numa-node"}),"\u6539\u4E3A",(0,r.jsx)(n.code,{children:"restricted"}),"\uFF09"]}),"\n",(0,r.jsxs)(n.li,{children:["\u51CF\u5C11",(0,r.jsx)(n.code,{children:"Pod"}),"\u7684\u8D44\u6E90\u8BF7\u6C42"]}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"\u5207\u6362cpu-manager-policy",children:"\u5207\u6362CPU Manager Policy"}),"\n",(0,r.jsx)(n.p,{children:"\u5207\u6362\u7B56\u7565\u9700\u8981\u6E05\u7406\u72B6\u6001\u6587\u4EF6\uFF1A"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"# 1. Drain\u8282\u70B9\uFF08\u5EFA\u8BAE\uFF09\nkubectl drain <node-name> --ignore-daemonsets --delete-emptydir-data\n\n# 2. \u505C\u6B62kubelet\nsystemctl stop kubelet\n\n# 3. \u5220\u9664\u72B6\u6001\u6587\u4EF6\nrm /var/lib/kubelet/cpu_manager_state\nrm /var/lib/kubelet/memory_manager_state\n\n# 4. \u4FEE\u6539kubelet\u914D\u7F6E\nvim /var/lib/kubelet/config.yaml\n\n# 5. \u542F\u52A8kubelet\nsystemctl start kubelet\n\n# 6. Uncordon\u8282\u70B9\nkubectl uncordon <node-name>\n"})}),"\n",(0,r.jsx)(n.h3,{id:"\u67E5\u770Bkubelet\u65E5\u5FD7",children:"\u67E5\u770BKubelet\u65E5\u5FD7"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:'journalctl -u kubelet -f | grep -E "cpu_manager|topology_manager|memory_manager"\n'})}),"\n",(0,r.jsx)(n.h2,{id:"\u6700\u4F73\u5B9E\u8DF5",children:"\u6700\u4F73\u5B9E\u8DF5"}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"AI\u8BAD\u7EC3\u573A\u666F\u63A8\u8350\u914D\u7F6E"}),"\uFF1A"]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.code,{children:"topologyManagerPolicy: restricted"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.code,{children:"topologyManagerScope: pod"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.code,{children:"cpuManagerPolicy: static"})}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"\u8D44\u6E90\u8BF7\u6C42\u89C4\u8303"}),"\uFF1A"]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["\u786E\u4FDD",(0,r.jsx)(n.code,{children:"Pod"}),"\u662F",(0,r.jsx)(n.code,{children:"Guaranteed QoS\uFF08requests == limits\uFF09"})]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"CPU"}),"\u8BF7\u6C42\u4F7F\u7528\u6574\u6570\u503C\u4EE5\u83B7\u5F97\u72EC\u5360",(0,r.jsx)(n.code,{children:"CPU"})]}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"\u591AGPU\u573A\u666F"}),"\uFF1A"]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["\u4F7F\u7528",(0,r.jsx)(n.code,{children:"single-numa-node"}),"\u7B56\u7565\u786E\u4FDD\u591A",(0,r.jsx)(n.code,{children:"GPU"}),"\u5728\u540C\u4E00",(0,r.jsx)(n.code,{children:"NUMA"}),"\u8282\u70B9"]}),"\n",(0,r.jsxs)(n.li,{children:["\u6216\u4F7F\u7528",(0,r.jsx)(n.code,{children:"prefer-closest-numa-nodes"}),"\u9009\u9879\u51CF\u5C11\u8DE8",(0,r.jsx)(n.code,{children:"NUMA"}),"\u5EF6\u8FDF"]}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"\u6027\u80FD\u76D1\u63A7"}),"\uFF1A"]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["\u76D1\u63A7\u8DE8",(0,r.jsx)(n.code,{children:"NUMA"}),"\u5185\u5B58\u8BBF\u95EE\uFF08\u901A\u8FC7",(0,r.jsx)(n.code,{children:"numastat"}),"\u547D\u4EE4\uFF09"]}),"\n",(0,r.jsxs)(n.li,{children:["\u76D1\u63A7",(0,r.jsx)(n.code,{children:"CPU"}),"\u4E0A\u4E0B\u6587\u5207\u6362\u548C\u7F13\u5B58\u547D\u4E2D\u7387"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"\u53C2\u8003\u8D44\u6599",children:"\u53C2\u8003\u8D44\u6599"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"https://kubernetes.io/docs/reference/command-line-tools-reference/kubelet/",children:"https://kubernetes.io/docs/reference/command-line-tools-reference/kubelet/"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"https://kubernetes.io/docs/tasks/administer-cluster/memory-manager/#reserved-memory-flag",children:"https://kubernetes.io/docs/tasks/administer-cluster/memory-manager/#reserved-memory-flag"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"https://kubernetes.io/docs/tasks/administer-cluster/cpu-management-policies/",children:"Kubernetes CPU Management Policies"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"https://kubernetes.io/docs/tasks/administer-cluster/topology-manager/",children:"Kubernetes Topology Manager"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"https://kubernetes.io/docs/tasks/administer-cluster/memory-manager/",children:"Kubernetes Memory Manager"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"https://github.com/NVIDIA/k8s-device-plugin",children:"NVIDIA Device Plugin for Kubernetes"})}),"\n"]})]})}function a(e={}){let{wrapper:n}={...(0,s.a)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(t,{...e})}):t(e)}},50065:function(e,n,d){d.d(n,{Z:function(){return l},a:function(){return i}});var c=d(67294);let r={},s=c.createContext(r);function i(e){let n=c.useContext(s);return c.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function l(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:i(e.components),c.createElement(s.Provider,{value:n},e.children)}}}]);