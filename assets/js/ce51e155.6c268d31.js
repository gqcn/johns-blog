"use strict";(self.webpackChunkgf_site=self.webpackChunkgf_site||[]).push([["8190"],{57769:function(e,n,c){c.r(n),c.d(n,{metadata:()=>o,contentTitle:()=>d,default:()=>u,assets:()=>t,toc:()=>l,frontMatter:()=>i});var o=JSON.parse('{"id":"docs/\u65E5\u5E38\u7B14\u8BB0/\u5BB9\u5668\u5316\u4E0B\u7684GOMAXPROCS\u95EE\u9898","title":"\u5BB9\u5668\u5316\u4E0B\u7684GOMAXPROCS\u95EE\u9898","description":"\u63A2\u8BA8\u5728\u5BB9\u5668\u5316\u73AF\u5883\u4E0B Go \u7A0B\u5E8F GOMAXPROCS \u8BBE\u7F6E\u7684\u95EE\u9898\u53CA\u5176\u5BF9\u6027\u80FD\u7684\u5F71\u54CD","source":"@site/docs/docs/8-\u65E5\u5E38\u7B14\u8BB0/6-\u5BB9\u5668\u5316\u4E0B\u7684GOMAXPROCS\u95EE\u9898.md","sourceDirName":"docs/8-\u65E5\u5E38\u7B14\u8BB0","slug":"/notes/container-gomaxprocs-issue","permalink":"/notes/container-gomaxprocs-issue","draft":false,"unlisted":false,"tags":[],"version":"current","sidebarPosition":6,"frontMatter":{"slug":"/notes/container-gomaxprocs-issue","title":"\u5BB9\u5668\u5316\u4E0B\u7684GOMAXPROCS\u95EE\u9898","hide_title":true,"keywords":["Go","GOMAXPROCS","\u5BB9\u5668\u5316","\u6027\u80FD\u8C03\u4F18","\u8D44\u6E90\u9650\u5236","\u5E76\u53D1\u7F16\u7A0B"],"description":"\u63A2\u8BA8\u5728\u5BB9\u5668\u5316\u73AF\u5883\u4E0B Go \u7A0B\u5E8F GOMAXPROCS \u8BBE\u7F6E\u7684\u95EE\u9898\u53CA\u5176\u5BF9\u6027\u80FD\u7684\u5F71\u54CD"},"sidebar":"mainSidebar","previous":{"title":"\u5728K8S\u6307\u5B9A\u547D\u540D\u63A7\u5236\u8FD0\u884C\u6307\u5B9A\u955C\u50CF","permalink":"/notes/kubernetes-namespace-deployment"},"next":{"title":"\u89E3\u51B3linux\u4E0Bvim\u4E71\u7801\u7684\u60C5\u51B5","permalink":"/notes/linux-vim-encoding-fix"}}'),r=c("85893"),s=c("50065");let i={slug:"/notes/container-gomaxprocs-issue",title:"\u5BB9\u5668\u5316\u4E0B\u7684GOMAXPROCS\u95EE\u9898",hide_title:!0,keywords:["Go","GOMAXPROCS","\u5BB9\u5668\u5316","\u6027\u80FD\u8C03\u4F18","\u8D44\u6E90\u9650\u5236","\u5E76\u53D1\u7F16\u7A0B"],description:"\u63A2\u8BA8\u5728\u5BB9\u5668\u5316\u73AF\u5883\u4E0B Go \u7A0B\u5E8F GOMAXPROCS \u8BBE\u7F6E\u7684\u95EE\u9898\u53CA\u5176\u5BF9\u6027\u80FD\u7684\u5F71\u54CD"},d=void 0,t={},l=[{value:"\u57FA\u672C\u4ECB\u7ECD",id:"\u57FA\u672C\u4ECB\u7ECD",level:2},{value:"\u89E3\u51B3\u65B9\u6848",id:"\u89E3\u51B3\u65B9\u6848",level:2},{value:"<code>automaxprocs</code> \u89E3\u51B3\u4E86\u4EC0\u4E48\u95EE\u9898",id:"automaxprocs-\u89E3\u51B3\u4E86\u4EC0\u4E48\u95EE\u9898",level:2}];function a(e){let n={a:"a",code:"code",h2:"h2",img:"img",p:"p",pre:"pre",...(0,s.a)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.h2,{id:"\u57FA\u672C\u4ECB\u7ECD",children:"\u57FA\u672C\u4ECB\u7ECD"}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.code,{children:"GOMAXPROCS"})," \u662F Go \u63D0\u4F9B\u7684\u975E\u5E38\u91CD\u8981\u7684\u4E00\u4E2A\u73AF\u5883\u53D8\u91CF\u3002\u901A\u8FC7\u8BBE\u5B9A ",(0,r.jsx)(n.code,{children:"GOMAXPROCS"}),"\uFF0C\u7528\u6237\u53EF\u4EE5\u8C03\u6574\u8C03\u5EA6\u5668\u4E2D ",(0,r.jsx)(n.code,{children:"Processor"}),"\uFF08\u7B80\u79F0",(0,r.jsx)(n.code,{children:"P"}),"\uFF09\u7684\u6570\u91CF\u3002"]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.code,{children:"GOMAXPROCS"})," \u5728 ",(0,r.jsx)(n.code,{children:"Go 1.5"})," \u7248\u672C\u540E\u7684\u9ED8\u8BA4\u503C\u662F\u673A\u5668\u7684 ",(0,r.jsx)(n.code,{children:"CPU"})," \u6838\u6570 \uFF08",(0,r.jsx)(n.code,{children:"runtime.NumCPU"}),"\uFF09\u3002\u800C\u4EE5 ",(0,r.jsx)(n.code,{children:"Docker"})," \u4E3A\u4EE3\u8868\u7684\u5BB9\u5668\u865A\u62DF\u5316\u6280\u672F\uFF0C\u4F1A\u901A\u8FC7 ",(0,r.jsx)(n.code,{children:"cgroup"})," \u7B49\u6280\u672F\u5BF9 ",(0,r.jsx)(n.code,{children:"CPU"})," \u8D44\u6E90\u8FDB\u884C\u9694\u79BB\u3002\u8FD9\u7C7B\u6280\u672F\u5BF9 ",(0,r.jsx)(n.code,{children:"CPU"})," \u7684\u9694\u79BB\u9650\u5236\uFF0C\u5BFC\u81F4 ",(0,r.jsx)(n.code,{children:"runtime.NumCPU()"})," \u65E0\u6CD5\u6B63\u786E\u83B7\u53D6\u5230\u5BB9\u5668\u88AB\u5206\u914D\u7684 ",(0,r.jsx)(n.code,{children:"CPU"})," \u8D44\u6E90\u6570\u3002",(0,r.jsx)(n.code,{children:"runtime.NumCPU()"}),"\u83B7\u53D6\u7684\u662F\u5BBF\u4E3B\u673A\u7684\u6838\u5FC3\u6570\u3002"]}),"\n",(0,r.jsxs)(n.p,{children:["\u8BBE\u7F6E ",(0,r.jsx)(n.code,{children:"GOMAXPROCS"})," \u9AD8\u4E8E\u771F\u6B63\u53EF\u4F7F\u7528\u7684\u6838\u5FC3\u6570\u540E\u4F1A\u5BFC\u81F4",(0,r.jsx)(n.code,{children:"Go"}),"\u8C03\u5EA6\u5668\u4E0D\u505C\u5730\u8FDB\u884C",(0,r.jsx)(n.code,{children:"OS"}),"\u7EBF\u7A0B\u5207\u6362\uFF0C\u4ECE\u800C\u7ED9\u8C03\u5EA6\u5668\u589E\u52A0\u5F88\u591A\u4E0D\u5FC5\u8981\u7684\u5DE5\u4F5C\u3002"]}),"\n",(0,r.jsx)(n.h2,{id:"\u89E3\u51B3\u65B9\u6848",children:"\u89E3\u51B3\u65B9\u6848"}),"\n",(0,r.jsxs)(n.p,{children:["\u76EE\u524D ",(0,r.jsx)(n.code,{children:"Go"})," \u5B98\u65B9\u5E76\u65E0\u597D\u7684\u65B9\u5F0F\u6765\u89C4\u907F\u5728\u5BB9\u5668\u91CC\u83B7\u53D6\u4E0D\u5230\u771F\u6B63\u53EF\u4F7F\u7528\u7684\u6838\u5FC3\u6570\u8FD9\u4E00\u95EE\u9898\uFF0C\u800C ",(0,r.jsx)(n.code,{children:"Uber"})," \u63D0\u51FA\u4E86\u4E00\u79CD ",(0,r.jsx)(n.code,{children:"Workaround"})," \u65B9\u6CD5\uFF0C\u5229\u7528 ",(0,r.jsx)(n.a,{href:"https://github.com/uber-go/automaxprocs",children:"https://github.com/uber-go/automaxprocs"})," \u8FD9\u4E00\u4E2A\u5305\uFF0C\u53EF\u4EE5\u5728\u8FD0\u884C\u65F6\u6839\u636E ",(0,r.jsx)(n.code,{children:"cgroup"})," \u4E3A\u5BB9\u5668\u5206\u914D\u7684",(0,r.jsx)(n.code,{children:"CPU"}),"\u8D44\u6E90\u9650\u5236\u6570\u6765\u4FEE\u6539 ",(0,r.jsx)(n.code,{children:"GOMAXPROCS"}),"\u3002"]}),"\n",(0,r.jsx)(n.p,{children:"\u4F7F\u7528\u65B9\u5F0F\uFF1A"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-go",children:'import _ "go.uber.org/automaxprocs"\n\nfunc main() {\n  // Your application logic here.\n}\n'})}),"\n",(0,r.jsxs)(n.h2,{id:"automaxprocs-\u89E3\u51B3\u4E86\u4EC0\u4E48\u95EE\u9898",children:[(0,r.jsx)(n.code,{children:"automaxprocs"})," \u89E3\u51B3\u4E86\u4EC0\u4E48\u95EE\u9898"]}),"\n",(0,r.jsxs)(n.p,{children:["\u7EBF\u4E0A\u5BB9\u5668\u91CC\u7684\u670D\u52A1\u901A\u5E38\u90FD\u5BF9",(0,r.jsx)(n.code,{children:"CPU"}),"\u8D44\u6E90\u505A\u4E86\u9650\u5236\uFF0C\u4F8B\u5982\u9ED8\u8BA4\u7684 ",(0,r.jsx)(n.code,{children:"4C"}),"\u3002\u4F46\u662F\u5728\u5BB9\u5668\u91CC\u901A\u8FC7 ",(0,r.jsx)(n.code,{children:"lscpu"})," \u547D\u4EE4\u4ECD\u7136\u80FD\u770B\u5230\u5BBF\u4E3B\u673A\u7684\u6240\u6709 ",(0,r.jsx)(n.code,{children:"CPU"})," \u6838\u5FC3\uFF1A"]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.img,{src:c(57503).Z+"",width:"942",height:"429"})}),"\n",(0,r.jsxs)(n.p,{children:["\u8FD9\u5C31\u5BFC\u81F4",(0,r.jsx)(n.code,{children:"Golang"}),"\u670D\u52A1\u9ED8\u8BA4\u4F1A\u62FF\u5BBF\u4E3B\u673A\u7684",(0,r.jsx)(n.code,{children:"CPU"}),"\u6838\u5FC3\u6570\u6765\u8C03\u7528 ",(0,r.jsx)(n.code,{children:"runtime.GOMAXPROCS()"}),"\uFF0C\u5BFC\u81F4\u8FDB\u7A0B \u6570\u91CF\u8FDC\u8FDC\u5927\u4E8E\u53EF\u7528\u7684",(0,r.jsx)(n.code,{children:"CPU"}),"\u6838\u5FC3\uFF0C\u4E0D\u4EC5\u5BFC\u81F4",(0,r.jsx)(n.code,{children:"Golang"})," ",(0,r.jsx)(n.code,{children:"Runtime"}),"\u7684\u8C03\u5EA6\u6210\u672C\u63D0\u9AD8\uFF0C\u8FD8\u5F15\u8D77\u9891\u7E41\u4E0A\u4E0B\u6587\u5207\u6362\uFF0C\u5F71\u54CD\u9AD8\u8D1F\u8F7D\u60C5\u51B5\u4E0B\u7684\u670D\u52A1\u6027\u80FD\u3002"]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.code,{children:"automaxprocs"}),"\u81EA\u52A8\u8BC6\u522B",(0,r.jsx)(n.code,{children:"cgroup"}),"\u4E3A\u5BB9\u5668\u5206\u914D\u7684",(0,r.jsx)(n.code,{children:"CPU"}),"\u9650\u5236\uFF0C\u6765\u7EA0\u6B63",(0,r.jsx)(n.code,{children:"GOMAXPROCS"}),"\u3002"]})]})}function u(e={}){let{wrapper:n}={...(0,s.a)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(a,{...e})}):a(e)}},57503:function(e,n,c){c.d(n,{Z:function(){return o}});let o=c.p+"assets/images/95c4e8faeaf64218803c57f31dae1f3f-6c133ee352ea169e9edbeecc178b77b8.png"},50065:function(e,n,c){c.d(n,{Z:function(){return d},a:function(){return i}});var o=c(67294);let r={},s=o.createContext(r);function i(e){let n=o.useContext(s);return o.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function d(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:i(e.components),o.createElement(s.Provider,{value:n},e.children)}}}]);