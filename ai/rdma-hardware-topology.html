<!doctype html><html lang=en dir=ltr class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-docs/AI技术/基础架构/RDMA/RDMA硬件管理及网络拓扑信息查看" data-has-hydrated=false><meta charset=UTF-8><meta name=generator content="Docusaurus v3.6.3"><title data-rh=true>RDMA硬件管理及网络拓扑信息查看 | John's Blog</title><meta data-rh=true name=viewport content="width=device-width,initial-scale=1.0"><meta data-rh=true name=twitter:card content=summary_large_image><meta data-rh=true property=og:url content=https://johng.cn/ai/rdma-hardware-topology><meta data-rh=true property=og:locale content=en><meta data-rh=true name=docusaurus_locale content=en><meta data-rh=true name=docsearch:language content=en><meta data-rh=true name=author content="John Guo"><meta data-rh=true property=og:image content=https://johng.cn/img/favicon.png><meta data-rh=true name=docusaurus_version content=current><meta data-rh=true name=docusaurus_tag content=docs-default-current><meta data-rh=true name=docsearch:version content=current><meta data-rh=true name=docsearch:docusaurus_tag content=docs-default-current><meta data-rh=true property=og:title content="RDMA硬件管理及网络拓扑信息查看 | John's Blog"><meta data-rh=true name=description content=全面介绍RDMA硬件管理和网络拓扑信息查看方法，详细讲解ibv_devinfo、ibnetdiscover、lldpctl等关键管理工具的使用。涵盖InfiniBand和RoCE两种RDMA实现方案的PCI设备识别、NFD标签、RDMA设备信息获取以及网络拓扑发现，为RDMA网络运维和故障诊断提供实用指南><meta data-rh=true property=og:description content=全面介绍RDMA硬件管理和网络拓扑信息查看方法，详细讲解ibv_devinfo、ibnetdiscover、lldpctl等关键管理工具的使用。涵盖InfiniBand和RoCE两种RDMA实现方案的PCI设备识别、NFD标签、RDMA设备信息获取以及网络拓扑发现，为RDMA网络运维和故障诊断提供实用指南><meta data-rh=true name=keywords content=RDMA,硬件管理,网络拓扑,InfiniBand,RoCE,ibv_devinfo,ibnetdiscover,lldpctl,NFD标签,PCI设备,拓扑发现,网卡信息,子网管理,LLDP协议,Mellanox,ConnectX,设备诊断,网络运维,HCA设备,RDMA网络管理><link data-rh=true rel=icon href=/img/favicon.ico><link data-rh=true rel=canonical href=https://johng.cn/ai/rdma-hardware-topology><link data-rh=true rel=alternate href=https://johng.cn/ai/rdma-hardware-topology hreflang=en><link data-rh=true rel=alternate href=https://johng.cn/ai/rdma-hardware-topology hreflang=x-default><link data-rh=true rel=preconnect href=https://XGS1CPQERK-dsn.algolia.net crossorigin><link rel=alternate type=application/rss+xml href=/blog/rss.xml title="John's Blog RSS Feed"><link rel=alternate type=application/atom+xml href=/blog/atom.xml title="John's Blog Atom Feed"><link rel=search type=application/opensearchdescription+xml title="John's Blog" href=/opensearch.xml><script src=https://hm.baidu.com/hm.js?6b4ae23dc83ee5efe875b7172af6c7c1 async></script><link rel=stylesheet href=/assets/css/styles.2f56d3c4.css><script src=/assets/js/runtime~main.c68b3aea.js defer></script><script src=/assets/js/main.d4848e10.js defer></script><body class=navigation-with-keyboard><script>!function(){var t,e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();t=null!==e?e:"light",document.documentElement.setAttribute("data-theme",t)}(),function(){try{for(var[t,e]of new URLSearchParams(window.location.search).entries())if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id=__docusaurus><div role=region aria-label="Skip to main content"><a class=skipToContent_fXgn href=#__docusaurus_skipToContent_fallback>Skip to main content</a></div><nav aria-label=Main class="navbar navbar--fixed-top"><div class=navbar__inner><div class=navbar__items><button aria-label="Toggle navigation bar" aria-expanded=false class="navbar__toggle clean-btn" type=button><svg width=30 height=30 viewBox="0 0 30 30" aria-hidden=true><path stroke=currentColor stroke-linecap=round stroke-miterlimit=10 stroke-width=2 d="M4 7h22M4 15h22M4 23h22"/></svg></button><a class=navbar__brand href=/><b class="navbar__title text--truncate">John's Blog</b></a><a aria-current=page class="navbar__item navbar__link navbar__link--active" href=/ai>AI技术</a><a class="navbar__item navbar__link" href=/cloud-native>云原生</a><a class="navbar__item navbar__link" href=/notes>日常笔记</a><a class="navbar__item navbar__link" href=/programming>开发语言</a><a class="navbar__item navbar__link" href=/architecture>技术架构</a><a class="navbar__item navbar__link" href=/observability>可观测性</a><a class="navbar__item navbar__link" href=/life>生活笔记</a></div><div class="navbar__items navbar__items--right"><a class="navbar__item navbar__link" href=/aboutme>关于我</a><a class="navbar__item navbar__link" href=/blog>博客</a><a href=https://goframe.org/ target=_blank rel="noopener noreferrer" class="navbar__item navbar__link header-goframe-link"></a><a href=https://github.com/gqcn target=_blank rel="noopener noreferrer" class="navbar__item navbar__link header-github-link"></a><div class=navbarSearchContainer_Bca1><button type=button class="DocSearch DocSearch-Button" aria-label="Search (Command+K)"><span class=DocSearch-Button-Container><svg width=20 height=20 class=DocSearch-Search-Icon viewBox="0 0 20 20" aria-hidden=true><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke=currentColor fill=none fill-rule=evenodd stroke-linecap=round stroke-linejoin=round /></svg><span class=DocSearch-Button-Placeholder>Search</span></span><span class=DocSearch-Button-Keys></span></button></div></div></div><div role=presentation class=navbar-sidebar__backdrop></div></nav><div id=__docusaurus_skipToContent_fallback class="main-wrapper mainWrapper_z2l0"><div class=docsWrapper_hBAB><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type=button></button><div class=docRoot_UBD9><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class=sidebarViewport_aRkj><div class=sidebar_njMd><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class=menu__list-item-collapsible><a class="menu__link menu__link--sublist menu__link--active" href=/ai>AI技术</a><button aria-label="Collapse sidebar category 'AI技术'" aria-expanded=true type=button class="clean-btn menu__caret"></button></div><ul style=display:block;overflow:visible;height:auto class=menu__list><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="menu__link menu__link--sublist" tabindex=0 href=/ai/agents>智能体</a><button aria-label="Expand sidebar category '智能体'" aria-expanded=false type=button class="clean-btn menu__caret"></button></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="menu__link menu__link--sublist" tabindex=0 href=/ai/app>应用开发</a><button aria-label="Expand sidebar category '应用开发'" aria-expanded=false type=button class="clean-btn menu__caret"></button></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="menu__link menu__link--sublist" tabindex=0 href=/ai/inference>推理服务</a><button aria-label="Expand sidebar category '推理服务'" aria-expanded=false type=button class="clean-btn menu__caret"></button></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="menu__link menu__link--sublist" tabindex=0 href=/ai/training-fine-tuning>训练微调</a><button aria-label="Expand sidebar category '训练微调'" aria-expanded=false type=button class="clean-btn menu__caret"></button></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="menu__link menu__link--sublist" tabindex=0 href=/ai/model-development>模型开发</a><button aria-label="Expand sidebar category '模型开发'" aria-expanded=false type=button class="clean-btn menu__caret"></button></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class=menu__list-item-collapsible><a class="menu__link menu__link--sublist menu__link--active" tabindex=0 href=/ai/infra>基础架构</a><button aria-label="Collapse sidebar category '基础架构'" aria-expanded=true type=button class="clean-btn menu__caret"></button></div><ul style=display:block;overflow:visible;height:auto class=menu__list><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="menu__link menu__link--sublist" tabindex=0 href=/ai/vgpu>vGPU</a><button aria-label="Expand sidebar category 'vGPU'" aria-expanded=false type=button class="clean-btn menu__caret"></button></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item"><div class=menu__list-item-collapsible><a class="menu__link menu__link--sublist menu__link--active" tabindex=0 href=/ai/rdma>RDMA</a><button aria-label="Collapse sidebar category 'RDMA'" aria-expanded=true type=button class="clean-btn menu__caret"></button></div><ul style=display:block;overflow:visible;height:auto class=menu__list><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class=menu__link tabindex=0 href=/ai/rdma-brief>RDMA技术架构深度解析</a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class=menu__link tabindex=0 href=/ai/rdma-infiniband-vs-roce>RDMA: InfiniBand vs RoCE</a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link menu__link--active" aria-current=page tabindex=0 href=/ai/rdma-hardware-topology>RDMA硬件管理及网络拓扑信息查看</a></ul><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="menu__link menu__link--sublist" tabindex=0 href=/ai/nvidia>NVIDIA</a><button aria-label="Expand sidebar category 'NVIDIA'" aria-expanded=false type=button class="clean-btn menu__caret"></button></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="menu__link menu__link--sublist" tabindex=0 href=/ai/scheduling>算力调度</a><button aria-label="Expand sidebar category '算力调度'" aria-expanded=false type=button class="clean-btn menu__caret"></button></div><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class=menu__link tabindex=0 href=/ai/what-is-llmops-mlops>LLMOps介绍</a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class=menu__link tabindex=0 href=/ai/common-acceleration-cards>常见智算加速卡汇总</a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class=menu__link tabindex=0 href=/ai/ai-training-inference-scenarios>AI基础架构中常见业务场景痛点</a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class=menu__link tabindex=0 href=/ai/cpu-gpu>CPU&GPU架构差异及AI场景中的应用</a></ul><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="menu__link menu__link--sublist" tabindex=0 href=/ai/basic>入门知识</a><button aria-label="Expand sidebar category '入门知识'" aria-expanded=false type=button class="clean-btn menu__caret"></button></div></ul><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="menu__link menu__link--sublist" href=/cloud-native>云原生</a><button aria-label="Expand sidebar category '云原生'" aria-expanded=false type=button class="clean-btn menu__caret"></button></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="menu__link menu__link--sublist" href=/notes>日常笔记</a><button aria-label="Expand sidebar category '日常笔记'" aria-expanded=false type=button class="clean-btn menu__caret"></button></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="menu__link menu__link--sublist" href=/programming>开发语言</a><button aria-label="Expand sidebar category '开发语言'" aria-expanded=false type=button class="clean-btn menu__caret"></button></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="menu__link menu__link--sublist" href=/architecture>技术架构</a><button aria-label="Expand sidebar category '技术架构'" aria-expanded=false type=button class="clean-btn menu__caret"></button></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="menu__link menu__link--sublist" href=/management>技术管理</a><button aria-label="Expand sidebar category '技术管理'" aria-expanded=false type=button class="clean-btn menu__caret"></button></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="menu__link menu__link--sublist" href=/observability>可观测性</a><button aria-label="Expand sidebar category '可观测性'" aria-expanded=false type=button class="clean-btn menu__caret"></button></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="menu__link menu__link--sublist" href=/database-and-middleware>数据库与中间件</a><button aria-label="Expand sidebar category '数据库与中间件'" aria-expanded=false type=button class="clean-btn menu__caret"></button></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="menu__link menu__link--sublist" href=/operating-systems-and-networks>操作系统和网络</a><button aria-label="Expand sidebar category '操作系统和网络'" aria-expanded=false type=button class="clean-btn menu__caret"></button></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="menu__link menu__link--sublist" href=/life>生活笔记</a><button aria-label="Expand sidebar category '生活笔记'" aria-expanded=false type=button class="clean-btn menu__caret"></button></div></ul></nav></div></div></aside><main class=docMainContainer_TBSr><div class="container padding-top--md padding-bottom--lg"><div class=row><div class="col docItemCol_VOVn"><div class=docItemContainer_Djhp><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label=Breadcrumbs><ul class=breadcrumbs itemscope itemtype=https://schema.org/BreadcrumbList><li class=breadcrumbs__item><a aria-label="Home page" class=breadcrumbs__link href=/><svg viewBox="0 0 24 24" class=breadcrumbHomeIcon_YNFT><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill=currentColor /></svg></a><li itemscope itemprop=itemListElement itemtype=https://schema.org/ListItem class=breadcrumbs__item><a class=breadcrumbs__link itemprop=item href=/ai><span itemprop=name>AI技术</span></a><meta itemprop=position content=1><li itemscope itemprop=itemListElement itemtype=https://schema.org/ListItem class=breadcrumbs__item><a class=breadcrumbs__link itemprop=item href=/ai/infra><span itemprop=name>基础架构</span></a><meta itemprop=position content=2><li itemscope itemprop=itemListElement itemtype=https://schema.org/ListItem class=breadcrumbs__item><a class=breadcrumbs__link itemprop=item href=/ai/rdma><span itemprop=name>RDMA</span></a><meta itemprop=position content=3><li itemscope itemprop=itemListElement itemtype=https://schema.org/ListItem class="breadcrumbs__item breadcrumbs__item--active"><span class=breadcrumbs__link itemprop=name>RDMA硬件管理及网络拓扑信息查看</span><meta itemprop=position content=4></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type=button class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><h2 class="anchor anchorWithStickyNavbar_LWe7" id=常用工具>常用工具<a href=#常用工具 class=hash-link aria-label="Direct link to 常用工具" title="Direct link to 常用工具">​</a></h2>
<table><thead><tr><th>工具<th>适用场景<th>主要功能<th>备注<tbody><tr><td><code>ibv_devinfo</code><td><code>InfiniBand</code>、<code>RoCE</code><td>查看本节点<code>RDMA</code>设备详细信息，包括设备类型、固件版本、端口状态、链路层等<td>属于<code>libibverbs-utils</code>软件包，适用于所有<code>RDMA</code>设备<tr><td><code>ibnetdiscover</code><td><code>InfiniBand</code><td>查询<code>InfiniBand</code>子网完整拓扑信息，显示所有节点和交换机的连接关系<td>直接向<code>IB</code>子网的<code>SM</code>（子网管理器）查询，可在任意<code>IB</code>节点执行获取全网拓扑<tr><td><code>lldpctl</code><td><code>RoCE (Ethernet)</code><td>查看基于以太网的<code>RoCE</code>网络拓扑信息，显示本节点与直连交换机的连接关系<td>基于<code>LLDP</code>协议，只能查看单跳邻居信息，需安装<code>lldpd</code>服务</table>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id=infiniband>InfiniBand<a href=#infiniband class=hash-link aria-label="Direct link to InfiniBand" title="Direct link to InfiniBand">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id=pci设备信息>PCI设备信息<a href=#pci设备信息 class=hash-link aria-label="Direct link to PCI设备信息" title="Direct link to PCI设备信息">​</a></h3>
<p>查看网卡设备：<code>lspci | grep -iE "InfiniBand|Mellanox"</code></p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#f8f8f2;--prism-background-color:#272822><div class=codeBlockContent_biex><pre tabindex=0 class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style=color:#f8f8f2;background-color:#272822><code class=codeBlockLines_e6Vv><span class=token-line style=color:#f8f8f2><span class="token number" style=color:#ae81ff>29</span><span class="token plain">:00.0 Infiniband controller: Mellanox Technologies MT2910 Family </span><span class="token punctuation" style=color:#f8f8f2>[</span><span class="token plain">ConnectX-7</span><span class="token punctuation" style=color:#f8f8f2>]</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">3b:00.0 Infiniband controller: Mellanox Technologies MT2910 Family </span><span class="token punctuation" style=color:#f8f8f2>[</span><span class="token plain">ConnectX-7</span><span class="token punctuation" style=color:#f8f8f2>]</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">4b:00.0 Infiniband controller: Mellanox Technologies MT2910 Family </span><span class="token punctuation" style=color:#f8f8f2>[</span><span class="token plain">ConnectX-7</span><span class="token punctuation" style=color:#f8f8f2>]</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">5d:00.0 Infiniband controller: Mellanox Technologies MT2910 Family </span><span class="token punctuation" style=color:#f8f8f2>[</span><span class="token plain">ConnectX-7</span><span class="token punctuation" style=color:#f8f8f2>]</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain"></span><span class="token number" style=color:#ae81ff>98</span><span class="token plain">:00.0 Ethernet controller: Mellanox Technologies MT27710 Family </span><span class="token punctuation" style=color:#f8f8f2>[</span><span class="token plain">ConnectX-4 Lx</span><span class="token punctuation" style=color:#f8f8f2>]</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain"></span><span class="token number" style=color:#ae81ff>98</span><span class="token plain">:00.1 Ethernet controller: Mellanox Technologies MT27710 Family </span><span class="token punctuation" style=color:#f8f8f2>[</span><span class="token plain">ConnectX-4 Lx</span><span class="token punctuation" style=color:#f8f8f2>]</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">ab:00.0 Infiniband controller: Mellanox Technologies MT2910 Family </span><span class="token punctuation" style=color:#f8f8f2>[</span><span class="token plain">ConnectX-7</span><span class="token punctuation" style=color:#f8f8f2>]</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">bb:00.0 Infiniband controller: Mellanox Technologies MT2910 Family </span><span class="token punctuation" style=color:#f8f8f2>[</span><span class="token plain">ConnectX-7</span><span class="token punctuation" style=color:#f8f8f2>]</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">cb:00.0 Infiniband controller: Mellanox Technologies MT2910 Family </span><span class="token punctuation" style=color:#f8f8f2>[</span><span class="token plain">ConnectX-7</span><span class="token punctuation" style=color:#f8f8f2>]</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">db:00.0 Infiniband controller: Mellanox Technologies MT2910 Family </span><span class="token punctuation" style=color:#f8f8f2>[</span><span class="token plain">ConnectX-7</span><span class="token punctuation" style=color:#f8f8f2>]</span><br></span></code></pre><div class=buttonGroup__atx><button type=button aria-label="Copy code to clipboard" title=Copy class=clean-btn><span class=copyButtonIcons_eSgA aria-hidden=true><svg viewBox="0 0 24 24" class=copyButtonIcon_y97N><path fill=currentColor d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"/></svg><svg viewBox="0 0 24 24" class=copyButtonSuccessIcon_LjdS><path fill=currentColor d=M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z /></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id=pci-nfd标签>PCI NFD标签<a href=#pci-nfd标签 class=hash-link aria-label="Direct link to PCI NFD标签" title="Direct link to PCI NFD标签">​</a></h3>
<p>如果<code>K8S</code>集群有安装<code>NFD</code>组件，<code>NFD</code>将自动检测<code>PCI</code>设备并为节点打上如下标签。</p>
<div class="language-yaml codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#f8f8f2;--prism-background-color:#272822><div class=codeBlockContent_biex><pre tabindex=0 class="prism-code language-yaml codeBlock_bY9V thin-scrollbar" style=color:#f8f8f2;background-color:#272822><code class=codeBlockLines_e6Vv><span class=token-line style=color:#f8f8f2><span class="token key atrule">feature.node.kubernetes.io/rdma.available</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"> </span><span class="token string" style=color:#a6e22e>"true"</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain"></span><span class="token key atrule">feature.node.kubernetes.io/rdma.capable</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"> </span><span class="token string" style=color:#a6e22e>"true"</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain"></span><span class="token key atrule">feature.node.kubernetes.io/pci-10de.present</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"> </span><span class="token string" style=color:#a6e22e>"true"</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain"></span><span class="token key atrule">feature.node.kubernetes.io/pci-10de.sriov.capable</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"> </span><span class="token string" style=color:#a6e22e>"true"</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain"></span><span class="token key atrule">feature.node.kubernetes.io/pci-15b3.present</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"> </span><span class="token string" style=color:#a6e22e>"true"</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain"></span><span class="token key atrule">feature.node.kubernetes.io/pci-15b3.sriov.capable</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"> </span><span class="token string" style=color:#a6e22e>"true"</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain"></span><span class="token key atrule">feature.node.kubernetes.io/pci-1a03.present</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"> </span><span class="token string" style=color:#a6e22e>"true"</span><br></span></code></pre><div class=buttonGroup__atx><button type=button aria-label="Copy code to clipboard" title=Copy class=clean-btn><span class=copyButtonIcons_eSgA aria-hidden=true><svg viewBox="0 0 24 24" class=copyButtonIcon_y97N><path fill=currentColor d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"/></svg><svg viewBox="0 0 24 24" class=copyButtonSuccessIcon_LjdS><path fill=currentColor d=M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z /></svg></span></button></div></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id=nfd标签含义说明>NFD标签含义说明<a href=#nfd标签含义说明 class=hash-link aria-label="Direct link to NFD标签含义说明" title="Direct link to NFD标签含义说明">​</a></h4>
<table><thead><tr><th>标签<th>含义<th>说明<tbody><tr><td><code>feature.node.kubernetes.io/rdma.available</code><td><code>RDMA</code>功能可用<td>节点上存在已启用<code>RDMA</code>功能的网卡设备<tr><td><code>feature.node.kubernetes.io/rdma.capable</code><td><code>RDMA</code>功能支持<td>节点硬件支持<code>RDMA</code>能力（即使当前未启用）<tr><td><code>feature.node.kubernetes.io/pci-10de.present</code><td><code>NVIDIA</code>设备存在<td>节点上存在<code>NVIDIA</code>公司的PCI设备（<code>Vendor ID: 0x10de</code>），通常是<code>GPU</code><tr><td><code>feature.node.kubernetes.io/pci-10de.sriov.capable</code><td><code>NVIDIA SR-IOV</code>支持<td><code>NVIDIA</code>设备支持<code>SR-IOV</code>虚拟化功能<tr><td><code>feature.node.kubernetes.io/pci-15b3.present</code><td><code>Mellanox</code>设备存在<td>节点上存在<code>Mellanox</code>（现<code>NVIDIA</code>网络）公司的<code>PCI</code>设备（<code>Vendor ID: 0x15b3</code>），通常是<code>InfiniBand</code>/<code>RoCE</code>网卡<tr><td><code>feature.node.kubernetes.io/pci-15b3.sriov.capable</code><td><code>Mellanox SR-IOV</code>支持<td><code>Mellanox</code>网卡设备支持<code>SR-IOV</code>虚拟化功能<tr><td><code>feature.node.kubernetes.io/pci-1a03.present</code><td><code>ASPEED</code>设备存在<td>节点上存在<code>ASPEED</code>公司的PCI设备（<code>Vendor ID: 0x1a03</code>），通常是<code>BMC</code>管理芯片</table>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id=rdma设备信息>RDMA设备信息<a href=#rdma设备信息 class=hash-link aria-label="Direct link to RDMA设备信息" title="Direct link to RDMA设备信息">​</a></h3>
<p>通过<code>ibv_devinfo</code>工具查看本节点上所有支持<code>IB</code>协议的所有<code>RDMA</code>网卡，如物理<code>IB</code>网卡、物理<code>RoCE</code>网卡：</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#f8f8f2;--prism-background-color:#272822><div class=codeBlockContent_biex><pre tabindex=0 class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style=color:#f8f8f2;background-color:#272822><code class=codeBlockLines_e6Vv><span class=token-line style=color:#f8f8f2><span class="token plain">hca_id: mlx5_0                          </span><span class="token comment" style=color:#8292a2;font-style:italic># HCA设备ID，系统中的RDMA设备标识符</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">  transport:                      InfiniBand </span><span class="token punctuation" style=color:#f8f8f2>(</span><span class="token number" style=color:#ae81ff>0</span><span class="token punctuation" style=color:#f8f8f2>)</span><span class="token plain">          </span><span class="token comment" style=color:#8292a2;font-style:italic># 传输协议类型，0表示InfiniBand</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">  fw_ver:                         </span><span class="token number" style=color:#ae81ff>28.39</span><span class="token plain">.4082              </span><span class="token comment" style=color:#8292a2;font-style:italic># 固件版本号</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">  node_guid:                      b8e9:2403:0045:99fe     </span><span class="token comment" style=color:#8292a2;font-style:italic># 节点全局唯一标识符（GUID）</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">  sys_image_guid:                 b8e9:2403:0045:99fe     </span><span class="token comment" style=color:#8292a2;font-style:italic># 系统镜像GUID，通常与node_guid相同</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">  vendor_id:                      0x02c9                  </span><span class="token comment" style=color:#8292a2;font-style:italic># 厂商ID，0x02c9代表Mellanox/NVIDIA</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">  vendor_part_id:                 </span><span class="token number" style=color:#ae81ff>4129</span><span class="token plain">                    </span><span class="token comment" style=color:#8292a2;font-style:italic># 产品型号ID，4129对应ConnectX-7</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">  hw_ver:                         0x0                     </span><span class="token comment" style=color:#8292a2;font-style:italic># 硬件版本号</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">  board_id:                       MT_0000000838           </span><span class="token comment" style=color:#8292a2;font-style:italic># 板卡ID</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">  phys_port_cnt:                  </span><span class="token number" style=color:#ae81ff>1</span><span class="token plain">                       </span><span class="token comment" style=color:#8292a2;font-style:italic># 物理端口数量</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">    port:   </span><span class="token number" style=color:#ae81ff>1</span><span class="token plain">                                       </span><span class="token comment" style=color:#8292a2;font-style:italic># 端口编号</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">      state:                  PORT_ACTIVE </span><span class="token punctuation" style=color:#f8f8f2>(</span><span class="token number" style=color:#ae81ff>4</span><span class="token punctuation" style=color:#f8f8f2>)</span><span class="token plain">         </span><span class="token comment" style=color:#8292a2;font-style:italic># 端口状态：活跃(4)，已连接可用</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">      max_mtu:                </span><span class="token number" style=color:#ae81ff>4096</span><span class="token plain"> </span><span class="token punctuation" style=color:#f8f8f2>(</span><span class="token number" style=color:#ae81ff>5</span><span class="token punctuation" style=color:#f8f8f2>)</span><span class="token plain">                </span><span class="token comment" style=color:#8292a2;font-style:italic># 最大传输单元，4096字节</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">      active_mtu:             </span><span class="token number" style=color:#ae81ff>4096</span><span class="token plain"> </span><span class="token punctuation" style=color:#f8f8f2>(</span><span class="token number" style=color:#ae81ff>5</span><span class="token punctuation" style=color:#f8f8f2>)</span><span class="token plain">                </span><span class="token comment" style=color:#8292a2;font-style:italic># 当前激活的MTU大小</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">      sm_lid:                 </span><span class="token number" style=color:#ae81ff>75</span><span class="token plain">                      </span><span class="token comment" style=color:#8292a2;font-style:italic># 子网管理器的本地标识符(LID)</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">      port_lid:               </span><span class="token number" style=color:#ae81ff>5</span><span class="token plain">                       </span><span class="token comment" style=color:#8292a2;font-style:italic># 本端口的LID，用于子网内路由</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">      port_lmc:               0x00                    </span><span class="token comment" style=color:#8292a2;font-style:italic># LID掩码计数，用于多路径支持</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">      link_layer:             InfiniBand              </span><span class="token comment" style=color:#8292a2;font-style:italic># 链路层协议类型</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">hca_id: mlx5_1</span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">  transport:                      InfiniBand </span><span class="token punctuation" style=color:#f8f8f2>(</span><span class="token number" style=color:#ae81ff>0</span><span class="token punctuation" style=color:#f8f8f2>)</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">  fw_ver:                         </span><span class="token number" style=color:#ae81ff>28.39</span><span class="token plain">.4082</span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">  node_guid:                      b8e9:2403:0047:13c2</span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">  sys_image_guid:                 b8e9:2403:0047:13c2</span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">  vendor_id:                      0x02c9</span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">  vendor_part_id:                 </span><span class="token number" style=color:#ae81ff>4129</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">  hw_ver:                         0x0</span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">  board_id:                       MT_0000000838</span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">  phys_port_cnt:                  </span><span class="token number" style=color:#ae81ff>1</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">    port:   </span><span class="token number" style=color:#ae81ff>1</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">      state:                  PORT_DOWN </span><span class="token punctuation" style=color:#f8f8f2>(</span><span class="token number" style=color:#ae81ff>1</span><span class="token punctuation" style=color:#f8f8f2>)</span><span class="token plain">           </span><span class="token comment" style=color:#8292a2;font-style:italic># 端口状态：关闭(1)，未连接或禁用</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">      max_mtu:                </span><span class="token number" style=color:#ae81ff>4096</span><span class="token plain"> </span><span class="token punctuation" style=color:#f8f8f2>(</span><span class="token number" style=color:#ae81ff>5</span><span class="token punctuation" style=color:#f8f8f2>)</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">      active_mtu:             </span><span class="token number" style=color:#ae81ff>4096</span><span class="token plain"> </span><span class="token punctuation" style=color:#f8f8f2>(</span><span class="token number" style=color:#ae81ff>5</span><span class="token punctuation" style=color:#f8f8f2>)</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">      sm_lid:                 </span><span class="token number" style=color:#ae81ff>0</span><span class="token plain">                       </span><span class="token comment" style=color:#8292a2;font-style:italic># SM LID为0表示未连接到子网管理器</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">      port_lid:               </span><span class="token number" style=color:#ae81ff>65535</span><span class="token plain">                   </span><span class="token comment" style=color:#8292a2;font-style:italic># LID为65535表示端口未分配有效LID</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">      port_lmc:               0x00</span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">      link_layer:             InfiniBand</span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">hca_id: mlx5_2</span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">  transport:                      InfiniBand </span><span class="token punctuation" style=color:#f8f8f2>(</span><span class="token number" style=color:#ae81ff>0</span><span class="token punctuation" style=color:#f8f8f2>)</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">  fw_ver:                         </span><span class="token number" style=color:#ae81ff>28.39</span><span class="token plain">.4082</span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">  node_guid:                      b8e9:2403:0045:9bd6</span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">  sys_image_guid:                 b8e9:2403:0045:9bd6</span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">  vendor_id:                      0x02c9</span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">  vendor_part_id:                 </span><span class="token number" style=color:#ae81ff>4129</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">  hw_ver:                         0x0</span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">  board_id:                       MT_0000000838</span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">  phys_port_cnt:                  </span><span class="token number" style=color:#ae81ff>1</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">    port:   </span><span class="token number" style=color:#ae81ff>1</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">      state:                  PORT_ACTIVE </span><span class="token punctuation" style=color:#f8f8f2>(</span><span class="token number" style=color:#ae81ff>4</span><span class="token punctuation" style=color:#f8f8f2>)</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">      max_mtu:                </span><span class="token number" style=color:#ae81ff>4096</span><span class="token plain"> </span><span class="token punctuation" style=color:#f8f8f2>(</span><span class="token number" style=color:#ae81ff>5</span><span class="token punctuation" style=color:#f8f8f2>)</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">      active_mtu:             </span><span class="token number" style=color:#ae81ff>4096</span><span class="token plain"> </span><span class="token punctuation" style=color:#f8f8f2>(</span><span class="token number" style=color:#ae81ff>5</span><span class="token punctuation" style=color:#f8f8f2>)</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">      sm_lid:                 </span><span class="token number" style=color:#ae81ff>75</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">      port_lid:               </span><span class="token number" style=color:#ae81ff>4</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">      port_lmc:               0x00</span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">      link_layer:             InfiniBand</span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">hca_id: mlx5_3</span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">  transport:                      InfiniBand </span><span class="token punctuation" style=color:#f8f8f2>(</span><span class="token number" style=color:#ae81ff>0</span><span class="token punctuation" style=color:#f8f8f2>)</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">  fw_ver:                         </span><span class="token number" style=color:#ae81ff>28.39</span><span class="token plain">.4082</span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">  node_guid:                      b8e9:2403:0047:1002</span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">  sys_image_guid:                 b8e9:2403:0047:1002</span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">  vendor_id:                      0x02c9</span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">  vendor_part_id:                 </span><span class="token number" style=color:#ae81ff>4129</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">  hw_ver:                         0x0</span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">  board_id:                       MT_0000000838</span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">  phys_port_cnt:                  </span><span class="token number" style=color:#ae81ff>1</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">    port:   </span><span class="token number" style=color:#ae81ff>1</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">      state:                  PORT_DOWN </span><span class="token punctuation" style=color:#f8f8f2>(</span><span class="token number" style=color:#ae81ff>1</span><span class="token punctuation" style=color:#f8f8f2>)</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">      max_mtu:                </span><span class="token number" style=color:#ae81ff>4096</span><span class="token plain"> </span><span class="token punctuation" style=color:#f8f8f2>(</span><span class="token number" style=color:#ae81ff>5</span><span class="token punctuation" style=color:#f8f8f2>)</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">      active_mtu:             </span><span class="token number" style=color:#ae81ff>4096</span><span class="token plain"> </span><span class="token punctuation" style=color:#f8f8f2>(</span><span class="token number" style=color:#ae81ff>5</span><span class="token punctuation" style=color:#f8f8f2>)</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">      sm_lid:                 </span><span class="token number" style=color:#ae81ff>0</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">      port_lid:               </span><span class="token number" style=color:#ae81ff>65535</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">      port_lmc:               0x00</span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">      link_layer:             InfiniBand</span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">hca_id: mlx5_6</span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">  transport:                      InfiniBand </span><span class="token punctuation" style=color:#f8f8f2>(</span><span class="token number" style=color:#ae81ff>0</span><span class="token punctuation" style=color:#f8f8f2>)</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">  fw_ver:                         </span><span class="token number" style=color:#ae81ff>28.39</span><span class="token plain">.4082</span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">  node_guid:                      b8e9:2403:0045:9b16</span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">  sys_image_guid:                 b8e9:2403:0045:9b16</span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">  vendor_id:                      0x02c9</span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">  vendor_part_id:                 </span><span class="token number" style=color:#ae81ff>4129</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">  hw_ver:                         0x0</span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">  board_id:                       MT_0000000838</span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">  phys_port_cnt:                  </span><span class="token number" style=color:#ae81ff>1</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">    port:   </span><span class="token number" style=color:#ae81ff>1</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">      state:                  PORT_ACTIVE </span><span class="token punctuation" style=color:#f8f8f2>(</span><span class="token number" style=color:#ae81ff>4</span><span class="token punctuation" style=color:#f8f8f2>)</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">      max_mtu:                </span><span class="token number" style=color:#ae81ff>4096</span><span class="token plain"> </span><span class="token punctuation" style=color:#f8f8f2>(</span><span class="token number" style=color:#ae81ff>5</span><span class="token punctuation" style=color:#f8f8f2>)</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">      active_mtu:             </span><span class="token number" style=color:#ae81ff>4096</span><span class="token plain"> </span><span class="token punctuation" style=color:#f8f8f2>(</span><span class="token number" style=color:#ae81ff>5</span><span class="token punctuation" style=color:#f8f8f2>)</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">      sm_lid:                 </span><span class="token number" style=color:#ae81ff>75</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">      port_lid:               </span><span class="token number" style=color:#ae81ff>10</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">      port_lmc:               0x00</span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">      link_layer:             InfiniBand</span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">hca_id: mlx5_7</span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">  transport:                      InfiniBand </span><span class="token punctuation" style=color:#f8f8f2>(</span><span class="token number" style=color:#ae81ff>0</span><span class="token punctuation" style=color:#f8f8f2>)</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">  fw_ver:                         </span><span class="token number" style=color:#ae81ff>28.39</span><span class="token plain">.4082</span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">  node_guid:                      b8e9:2403:0047:179a</span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">  sys_image_guid:                 b8e9:2403:0047:179a</span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">  vendor_id:                      0x02c9</span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">  vendor_part_id:                 </span><span class="token number" style=color:#ae81ff>4129</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">  hw_ver:                         0x0</span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">  board_id:                       MT_0000000838</span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">  phys_port_cnt:                  </span><span class="token number" style=color:#ae81ff>1</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">    port:   </span><span class="token number" style=color:#ae81ff>1</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">      state:                  PORT_DOWN </span><span class="token punctuation" style=color:#f8f8f2>(</span><span class="token number" style=color:#ae81ff>1</span><span class="token punctuation" style=color:#f8f8f2>)</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">      max_mtu:                </span><span class="token number" style=color:#ae81ff>4096</span><span class="token plain"> </span><span class="token punctuation" style=color:#f8f8f2>(</span><span class="token number" style=color:#ae81ff>5</span><span class="token punctuation" style=color:#f8f8f2>)</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">      active_mtu:             </span><span class="token number" style=color:#ae81ff>4096</span><span class="token plain"> </span><span class="token punctuation" style=color:#f8f8f2>(</span><span class="token number" style=color:#ae81ff>5</span><span class="token punctuation" style=color:#f8f8f2>)</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">      sm_lid:                 </span><span class="token number" style=color:#ae81ff>0</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">      port_lid:               </span><span class="token number" style=color:#ae81ff>65535</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">      port_lmc:               0x00</span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">      link_layer:             InfiniBand</span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">hca_id: mlx5_8</span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">  transport:                      InfiniBand </span><span class="token punctuation" style=color:#f8f8f2>(</span><span class="token number" style=color:#ae81ff>0</span><span class="token punctuation" style=color:#f8f8f2>)</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">  fw_ver:                         </span><span class="token number" style=color:#ae81ff>28.39</span><span class="token plain">.4082</span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">  node_guid:                      b8e9:2403:0047:1762</span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">  sys_image_guid:                 b8e9:2403:0047:1762</span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">  vendor_id:                      0x02c9</span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">  vendor_part_id:                 </span><span class="token number" style=color:#ae81ff>4129</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">  hw_ver:                         0x0</span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">  board_id:                       MT_0000000838</span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">  phys_port_cnt:                  </span><span class="token number" style=color:#ae81ff>1</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">    port:   </span><span class="token number" style=color:#ae81ff>1</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">      state:                  PORT_ACTIVE </span><span class="token punctuation" style=color:#f8f8f2>(</span><span class="token number" style=color:#ae81ff>4</span><span class="token punctuation" style=color:#f8f8f2>)</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">      max_mtu:                </span><span class="token number" style=color:#ae81ff>4096</span><span class="token plain"> </span><span class="token punctuation" style=color:#f8f8f2>(</span><span class="token number" style=color:#ae81ff>5</span><span class="token punctuation" style=color:#f8f8f2>)</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">      active_mtu:             </span><span class="token number" style=color:#ae81ff>4096</span><span class="token plain"> </span><span class="token punctuation" style=color:#f8f8f2>(</span><span class="token number" style=color:#ae81ff>5</span><span class="token punctuation" style=color:#f8f8f2>)</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">      sm_lid:                 </span><span class="token number" style=color:#ae81ff>75</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">      port_lid:               </span><span class="token number" style=color:#ae81ff>9</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">      port_lmc:               0x00</span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">      link_layer:             InfiniBand</span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">hca_id: mlx5_9</span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">  transport:                      InfiniBand </span><span class="token punctuation" style=color:#f8f8f2>(</span><span class="token number" style=color:#ae81ff>0</span><span class="token punctuation" style=color:#f8f8f2>)</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">  fw_ver:                         </span><span class="token number" style=color:#ae81ff>28.39</span><span class="token plain">.4082</span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">  node_guid:                      b8e9:2403:0047:1ad2</span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">  sys_image_guid:                 b8e9:2403:0047:1ad2</span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">  vendor_id:                      0x02c9</span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">  vendor_part_id:                 </span><span class="token number" style=color:#ae81ff>4129</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">  hw_ver:                         0x0</span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">  board_id:                       MT_0000000838</span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">  phys_port_cnt:                  </span><span class="token number" style=color:#ae81ff>1</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">    port:   </span><span class="token number" style=color:#ae81ff>1</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">      state:                  PORT_DOWN </span><span class="token punctuation" style=color:#f8f8f2>(</span><span class="token number" style=color:#ae81ff>1</span><span class="token punctuation" style=color:#f8f8f2>)</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">      max_mtu:                </span><span class="token number" style=color:#ae81ff>4096</span><span class="token plain"> </span><span class="token punctuation" style=color:#f8f8f2>(</span><span class="token number" style=color:#ae81ff>5</span><span class="token punctuation" style=color:#f8f8f2>)</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">      active_mtu:             </span><span class="token number" style=color:#ae81ff>4096</span><span class="token plain"> </span><span class="token punctuation" style=color:#f8f8f2>(</span><span class="token number" style=color:#ae81ff>5</span><span class="token punctuation" style=color:#f8f8f2>)</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">      sm_lid:                 </span><span class="token number" style=color:#ae81ff>0</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">      port_lid:               </span><span class="token number" style=color:#ae81ff>65535</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">      port_lmc:               0x00</span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">      link_layer:             InfiniBand</span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">hca_id: mlx5_bond_0                     </span><span class="token comment" style=color:#8292a2;font-style:italic># 绑定设备，通常是多个物理网卡的bonding聚合</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">  transport:                      InfiniBand </span><span class="token punctuation" style=color:#f8f8f2>(</span><span class="token number" style=color:#ae81ff>0</span><span class="token punctuation" style=color:#f8f8f2>)</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">  fw_ver:                         </span><span class="token number" style=color:#ae81ff>14.32</span><span class="token plain">.1010              </span><span class="token comment" style=color:#8292a2;font-style:italic># 较旧的固件版本（ConnectX-4）</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">  node_guid:                      94a6:d800:008a:4861</span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">  sys_image_guid:                 94a6:d800:008a:4861</span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">  vendor_id:                      0x02c9</span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">  vendor_part_id:                 </span><span class="token number" style=color:#ae81ff>4117</span><span class="token plain">                    </span><span class="token comment" style=color:#8292a2;font-style:italic># 4117对应ConnectX-4 Lx</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">  hw_ver:                         0x0</span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">  board_id:                       H3C0010110034           </span><span class="token comment" style=color:#8292a2;font-style:italic># H3C品牌的OEM网卡</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">  phys_port_cnt:                  </span><span class="token number" style=color:#ae81ff>1</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">    port:   </span><span class="token number" style=color:#ae81ff>1</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">      state:                  PORT_ACTIVE </span><span class="token punctuation" style=color:#f8f8f2>(</span><span class="token number" style=color:#ae81ff>4</span><span class="token punctuation" style=color:#f8f8f2>)</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">      max_mtu:                </span><span class="token number" style=color:#ae81ff>4096</span><span class="token plain"> </span><span class="token punctuation" style=color:#f8f8f2>(</span><span class="token number" style=color:#ae81ff>5</span><span class="token punctuation" style=color:#f8f8f2>)</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">      active_mtu:             </span><span class="token number" style=color:#ae81ff>1024</span><span class="token plain"> </span><span class="token punctuation" style=color:#f8f8f2>(</span><span class="token number" style=color:#ae81ff>3</span><span class="token punctuation" style=color:#f8f8f2>)</span><span class="token plain">                </span><span class="token comment" style=color:#8292a2;font-style:italic># 实际MTU为1500字节（以太网标准）</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">      sm_lid:                 </span><span class="token number" style=color:#ae81ff>0</span><span class="token plain">                       </span><span class="token comment" style=color:#8292a2;font-style:italic># 以太网模式下无SM</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">      port_lid:               </span><span class="token number" style=color:#ae81ff>0</span><span class="token plain">                       </span><span class="token comment" style=color:#8292a2;font-style:italic># 以太网模式下无LID概念</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">      port_lmc:               0x00</span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">      link_layer:             Ethernet                </span><span class="token comment" style=color:#8292a2;font-style:italic># 链路层为以太网，即RoCE模式</span><br></span></code></pre><div class=buttonGroup__atx><button type=button aria-label="Copy code to clipboard" title=Copy class=clean-btn><span class=copyButtonIcons_eSgA aria-hidden=true><svg viewBox="0 0 24 24" class=copyButtonIcon_y97N><path fill=currentColor d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"/></svg><svg viewBox="0 0 24 24" class=copyButtonSuccessIcon_LjdS><path fill=currentColor d=M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z /></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id=infiniband拓扑信息>InfiniBand拓扑信息<a href=#infiniband拓扑信息 class=hash-link aria-label="Direct link to InfiniBand拓扑信息" title="Direct link to InfiniBand拓扑信息">​</a></h3>
<p>通过<code>ibnetdiscover</code>工具查看<code>IB</code>拓扑信息，该工具直接向<code>IB</code>子网的<code>SM</code>发起查询，一次性读取<code>SM</code>里维护的<strong>全集群<code>IB</code>拓扑表</strong>，所以在任意一台<code>IB</code>节点执行，拿到的都是完整的全网拓扑信息。</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#f8f8f2;--prism-background-color:#272822><div class=codeBlockContent_biex><pre tabindex=0 class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style=color:#f8f8f2;background-color:#272822><code class=codeBlockLines_e6Vv><span class=token-line style=color:#f8f8f2><span class="token comment" style=color:#8292a2;font-style:italic>#</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain"></span><span class="token comment" style=color:#8292a2;font-style:italic># Topology file: generated on Fri Dec 26 13:52:02 2025    # 拓扑信息生成时间</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain"></span><span class="token comment" style=color:#8292a2;font-style:italic>#</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain"></span><span class="token comment" style=color:#8292a2;font-style:italic># Initiated from node b8e9240300471762 port b8e9240300471762  # 发起查询的节点GUID</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain"></span><span class="token comment" style=color:#8292a2;font-style:italic># ====== 交换机信息 ======</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain"></span><span class="token assign-left variable" style=color:#f8f8f2>vendid</span><span class="token operator" style=color:#66d9ef>=</span><span class="token plain">0x2c9                            </span><span class="token comment" style=color:#8292a2;font-style:italic># 厂商ID，0x2c9代表Mellanox/NVIDIA</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain"></span><span class="token assign-left variable" style=color:#f8f8f2>devid</span><span class="token operator" style=color:#66d9ef>=</span><span class="token plain">0xd2f2                            </span><span class="token comment" style=color:#8292a2;font-style:italic># 设备ID，0xd2f2代表MQM9700交换机芯片</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain"></span><span class="token assign-left variable" style=color:#f8f8f2>sysimgguid</span><span class="token operator" style=color:#66d9ef>=</span><span class="token plain">0xb0cf0e0300d66c80          </span><span class="token comment" style=color:#8292a2;font-style:italic># 系统镜像GUID</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain"></span><span class="token assign-left variable" style=color:#f8f8f2>switchguid</span><span class="token operator" style=color:#66d9ef>=</span><span class="token plain">0xb0cf0e0300d66c80</span><span class="token punctuation" style=color:#f8f8f2>(</span><span class="token plain">b0cf0e0300d66c80</span><span class="token punctuation" style=color:#f8f8f2>)</span><span class="token plain">  </span><span class="token comment" style=color:#8292a2;font-style:italic># 交换机GUID</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">Switch  </span><span class="token number" style=color:#ae81ff>65</span><span class="token plain"> </span><span class="token string" style=color:#a6e22e>"S-b0cf0e0300d66c80"</span><span class="token plain">         </span><span class="token comment" style=color:#8292a2;font-style:italic># Switch表示交换机节点，65为端口总数</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">                                        </span><span class="token comment" style=color:#8292a2;font-style:italic># "MF0;DCXNYD-IB03-D1F2-D207-F08-U45:MQM9700/U1" 交换机描述信息</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">                                        </span><span class="token comment" style=color:#8292a2;font-style:italic># enhanced port 0 表示这是增强型端口0</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">                                        </span><span class="token comment" style=color:#8292a2;font-style:italic># lid 2 交换机的本地标识符</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">                                        </span><span class="token comment" style=color:#8292a2;font-style:italic># lmc 0 LMC计数为0</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain"></span><span class="token punctuation" style=color:#f8f8f2>[</span><span class="token number" style=color:#ae81ff>1</span><span class="token punctuation" style=color:#f8f8f2>]</span><span class="token plain">     </span><span class="token string" style=color:#a6e22e>"H-b8e924030045aaae"</span><span class="token punctuation" style=color:#f8f8f2>[</span><span class="token number" style=color:#ae81ff>1</span><span class="token punctuation" style=color:#f8f8f2>]</span><span class="token punctuation" style=color:#f8f8f2>(</span><span class="token plain">b8e924030045aaae</span><span class="token punctuation" style=color:#f8f8f2>)</span><span class="token plain">       </span><span class="token comment" style=color:#8292a2;font-style:italic># 交换机端口1连接的主机</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">                                        </span><span class="token comment" style=color:#8292a2;font-style:italic># "msxf-hpc-37-1-ai mlx5_0" 主机名和网卡设备</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">                                        </span><span class="token comment" style=color:#8292a2;font-style:italic># lid 71 该主机端口的LID</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">                                        </span><span class="token comment" style=color:#8292a2;font-style:italic># 4xNDR 链路速率为NDR（400Gbps）×4通道</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain"></span><span class="token punctuation" style=color:#f8f8f2>[</span><span class="token number" style=color:#ae81ff>2</span><span class="token punctuation" style=color:#f8f8f2>]</span><span class="token plain">     </span><span class="token string" style=color:#a6e22e>"H-b8e924030045981e"</span><span class="token punctuation" style=color:#f8f8f2>[</span><span class="token number" style=color:#ae81ff>1</span><span class="token punctuation" style=color:#f8f8f2>]</span><span class="token punctuation" style=color:#f8f8f2>(</span><span class="token plain">b8e924030045981e</span><span class="token punctuation" style=color:#f8f8f2>)</span><span class="token plain">       </span><span class="token comment" style=color:#8292a2;font-style:italic># 交换机端口2连接到另一个主机</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">                                        </span><span class="token comment" style=color:#8292a2;font-style:italic># "msxf-hpc-37-1-ai mlx5_2" lid 73 4xNDR</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain"></span><span class="token punctuation" style=color:#f8f8f2>[</span><span class="token number" style=color:#ae81ff>3</span><span class="token punctuation" style=color:#f8f8f2>]</span><span class="token plain">     </span><span class="token string" style=color:#a6e22e>"H-b8e924030045ab1e"</span><span class="token punctuation" style=color:#f8f8f2>[</span><span class="token number" style=color:#ae81ff>1</span><span class="token punctuation" style=color:#f8f8f2>]</span><span class="token punctuation" style=color:#f8f8f2>(</span><span class="token plain">b8e924030045ab1e</span><span class="token punctuation" style=color:#f8f8f2>)</span><span class="token plain">       </span><span class="token comment" style=color:#8292a2;font-style:italic># 交换机端口3</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">                                        </span><span class="token comment" style=color:#8292a2;font-style:italic># "msxf-hpc-37-1-ai mlx5_8" lid 7 4xNDR</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain"></span><span class="token punctuation" style=color:#f8f8f2>[</span><span class="token number" style=color:#ae81ff>4</span><span class="token punctuation" style=color:#f8f8f2>]</span><span class="token plain">     </span><span class="token string" style=color:#a6e22e>"H-b8e924030045963e"</span><span class="token punctuation" style=color:#f8f8f2>[</span><span class="token number" style=color:#ae81ff>1</span><span class="token punctuation" style=color:#f8f8f2>]</span><span class="token punctuation" style=color:#f8f8f2>(</span><span class="token plain">b8e924030045963e</span><span class="token punctuation" style=color:#f8f8f2>)</span><span class="token plain">       </span><span class="token comment" style=color:#8292a2;font-style:italic># 交换机端口4</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">                                        </span><span class="token comment" style=color:#8292a2;font-style:italic># "msxf-hpc-37-1-ai mlx5_6" lid 8 4xNDR</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain"></span><span class="token punctuation" style=color:#f8f8f2>[</span><span class="token number" style=color:#ae81ff>5</span><span class="token punctuation" style=color:#f8f8f2>]</span><span class="token plain">     </span><span class="token string" style=color:#a6e22e>"H-b8e92403004599fe"</span><span class="token punctuation" style=color:#f8f8f2>[</span><span class="token number" style=color:#ae81ff>1</span><span class="token punctuation" style=color:#f8f8f2>]</span><span class="token punctuation" style=color:#f8f8f2>(</span><span class="token plain">b8e92403004599fe</span><span class="token punctuation" style=color:#f8f8f2>)</span><span class="token plain">       </span><span class="token comment" style=color:#8292a2;font-style:italic># 交换机端口5</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">                                        </span><span class="token comment" style=color:#8292a2;font-style:italic># "msxf-hpc-37-2-ai mlx5_0" lid 5 4xNDR</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain"></span><span class="token punctuation" style=color:#f8f8f2>[</span><span class="token number" style=color:#ae81ff>6</span><span class="token punctuation" style=color:#f8f8f2>]</span><span class="token plain">     </span><span class="token string" style=color:#a6e22e>"H-b8e9240300459bd6"</span><span class="token punctuation" style=color:#f8f8f2>[</span><span class="token number" style=color:#ae81ff>1</span><span class="token punctuation" style=color:#f8f8f2>]</span><span class="token punctuation" style=color:#f8f8f2>(</span><span class="token plain">b8e9240300459bd6</span><span class="token punctuation" style=color:#f8f8f2>)</span><span class="token plain">       </span><span class="token comment" style=color:#8292a2;font-style:italic># 交换机端口6</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">                                        </span><span class="token comment" style=color:#8292a2;font-style:italic># "msxf-hpc-37-2-ai mlx5_2" lid 4 4xNDR</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain"></span><span class="token punctuation" style=color:#f8f8f2>[</span><span class="token number" style=color:#ae81ff>7</span><span class="token punctuation" style=color:#f8f8f2>]</span><span class="token plain">     </span><span class="token string" style=color:#a6e22e>"H-b8e9240300459b16"</span><span class="token punctuation" style=color:#f8f8f2>[</span><span class="token number" style=color:#ae81ff>1</span><span class="token punctuation" style=color:#f8f8f2>]</span><span class="token punctuation" style=color:#f8f8f2>(</span><span class="token plain">b8e9240300459b16</span><span class="token punctuation" style=color:#f8f8f2>)</span><span class="token plain">       </span><span class="token comment" style=color:#8292a2;font-style:italic># 交换机端口7</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">                                        </span><span class="token comment" style=color:#8292a2;font-style:italic># "msxf-hpc-37-2-ai mlx5_6" lid 10 4xNDR</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain"></span><span class="token punctuation" style=color:#f8f8f2>[</span><span class="token number" style=color:#ae81ff>8</span><span class="token punctuation" style=color:#f8f8f2>]</span><span class="token plain">     </span><span class="token string" style=color:#a6e22e>"H-b8e9240300471762"</span><span class="token punctuation" style=color:#f8f8f2>[</span><span class="token number" style=color:#ae81ff>1</span><span class="token punctuation" style=color:#f8f8f2>]</span><span class="token punctuation" style=color:#f8f8f2>(</span><span class="token plain">b8e9240300471762</span><span class="token punctuation" style=color:#f8f8f2>)</span><span class="token plain">       </span><span class="token comment" style=color:#8292a2;font-style:italic># 交换机端口8</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">                                        </span><span class="token comment" style=color:#8292a2;font-style:italic># "msxf-hpc-37-2-ai mlx5_8" lid 9 4xNDR</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain"></span><span class="token punctuation" style=color:#f8f8f2>[</span><span class="token number" style=color:#ae81ff>9</span><span class="token punctuation" style=color:#f8f8f2>]</span><span class="token plain">     </span><span class="token string" style=color:#a6e22e>"H-b8e924030040652a"</span><span class="token punctuation" style=color:#f8f8f2>[</span><span class="token number" style=color:#ae81ff>1</span><span class="token punctuation" style=color:#f8f8f2>]</span><span class="token punctuation" style=color:#f8f8f2>(</span><span class="token plain">b8e924030040652a</span><span class="token punctuation" style=color:#f8f8f2>)</span><span class="token plain">       </span><span class="token comment" style=color:#8292a2;font-style:italic># 交换机端口9</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">                                        </span><span class="token comment" style=color:#8292a2;font-style:italic># "msxf-hpc-37-3-ai mlx5_0" lid 75 4xNDR</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain"></span><span class="token punctuation" style=color:#f8f8f2>[</span><span class="token number" style=color:#ae81ff>10</span><span class="token punctuation" style=color:#f8f8f2>]</span><span class="token plain">    </span><span class="token string" style=color:#a6e22e>"H-b8e924030047100a"</span><span class="token punctuation" style=color:#f8f8f2>[</span><span class="token number" style=color:#ae81ff>1</span><span class="token punctuation" style=color:#f8f8f2>]</span><span class="token punctuation" style=color:#f8f8f2>(</span><span class="token plain">b8e924030047100a</span><span class="token punctuation" style=color:#f8f8f2>)</span><span class="token plain">       </span><span class="token comment" style=color:#8292a2;font-style:italic># 交换机端口10</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">                                        </span><span class="token comment" style=color:#8292a2;font-style:italic># "msxf-hpc-37-3-ai mlx5_2" lid 77 4xNDR</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain"></span><span class="token punctuation" style=color:#f8f8f2>[</span><span class="token number" style=color:#ae81ff>11</span><span class="token punctuation" style=color:#f8f8f2>]</span><span class="token plain">    </span><span class="token string" style=color:#a6e22e>"H-b8e9240300471542"</span><span class="token punctuation" style=color:#f8f8f2>[</span><span class="token number" style=color:#ae81ff>1</span><span class="token punctuation" style=color:#f8f8f2>]</span><span class="token punctuation" style=color:#f8f8f2>(</span><span class="token plain">b8e9240300471542</span><span class="token punctuation" style=color:#f8f8f2>)</span><span class="token plain">       </span><span class="token comment" style=color:#8292a2;font-style:italic># 交换机端口11</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">                                        </span><span class="token comment" style=color:#8292a2;font-style:italic># "msxf-hpc-37-3-ai mlx5_6" lid 14 4xNDR</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain"></span><span class="token punctuation" style=color:#f8f8f2>[</span><span class="token number" style=color:#ae81ff>12</span><span class="token punctuation" style=color:#f8f8f2>]</span><span class="token plain">    </span><span class="token string" style=color:#a6e22e>"H-b8e9240300471a1a"</span><span class="token punctuation" style=color:#f8f8f2>[</span><span class="token number" style=color:#ae81ff>1</span><span class="token punctuation" style=color:#f8f8f2>]</span><span class="token punctuation" style=color:#f8f8f2>(</span><span class="token plain">b8e9240300471a1a</span><span class="token punctuation" style=color:#f8f8f2>)</span><span class="token plain">       </span><span class="token comment" style=color:#8292a2;font-style:italic># 交换机端口12</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">                                        </span><span class="token comment" style=color:#8292a2;font-style:italic># "msxf-hpc-37-3-ai mlx5_8" lid 13 4xNDR</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain"></span><span class="token punctuation" style=color:#f8f8f2>[</span><span class="token number" style=color:#ae81ff>13</span><span class="token punctuation" style=color:#f8f8f2>]</span><span class="token plain">    </span><span class="token string" style=color:#a6e22e>"H-b8e9240300459c0e"</span><span class="token punctuation" style=color:#f8f8f2>[</span><span class="token number" style=color:#ae81ff>1</span><span class="token punctuation" style=color:#f8f8f2>]</span><span class="token punctuation" style=color:#f8f8f2>(</span><span class="token plain">b8e9240300459c0e</span><span class="token punctuation" style=color:#f8f8f2>)</span><span class="token plain">       </span><span class="token comment" style=color:#8292a2;font-style:italic># 交换机端口13</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">                                        </span><span class="token comment" style=color:#8292a2;font-style:italic># "msxf-hpc-37-4-ai mlx5_0" lid 79 4xNDR</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain"></span><span class="token punctuation" style=color:#f8f8f2>[</span><span class="token number" style=color:#ae81ff>14</span><span class="token punctuation" style=color:#f8f8f2>]</span><span class="token plain">    </span><span class="token string" style=color:#a6e22e>"H-b8e9240300459a06"</span><span class="token punctuation" style=color:#f8f8f2>[</span><span class="token number" style=color:#ae81ff>1</span><span class="token punctuation" style=color:#f8f8f2>]</span><span class="token punctuation" style=color:#f8f8f2>(</span><span class="token plain">b8e9240300459a06</span><span class="token punctuation" style=color:#f8f8f2>)</span><span class="token plain">       </span><span class="token comment" style=color:#8292a2;font-style:italic># 交换机端口14</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">                                        </span><span class="token comment" style=color:#8292a2;font-style:italic># "msxf-hpc-37-4-ai mlx5_2" lid 81 4xNDR</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain"></span><span class="token punctuation" style=color:#f8f8f2>[</span><span class="token number" style=color:#ae81ff>15</span><span class="token punctuation" style=color:#f8f8f2>]</span><span class="token plain">    </span><span class="token string" style=color:#a6e22e>"H-b8e92403004068d2"</span><span class="token punctuation" style=color:#f8f8f2>[</span><span class="token number" style=color:#ae81ff>1</span><span class="token punctuation" style=color:#f8f8f2>]</span><span class="token punctuation" style=color:#f8f8f2>(</span><span class="token plain">b8e92403004068d2</span><span class="token punctuation" style=color:#f8f8f2>)</span><span class="token plain">       </span><span class="token comment" style=color:#8292a2;font-style:italic># 交换机端口15</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">                                        </span><span class="token comment" style=color:#8292a2;font-style:italic># "msxf-hpc-37-4-ai mlx5_6" lid 12 4xNDR</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain"></span><span class="token punctuation" style=color:#f8f8f2>[</span><span class="token number" style=color:#ae81ff>16</span><span class="token punctuation" style=color:#f8f8f2>]</span><span class="token plain">    </span><span class="token string" style=color:#a6e22e>"H-b8e924030045b536"</span><span class="token punctuation" style=color:#f8f8f2>[</span><span class="token number" style=color:#ae81ff>1</span><span class="token punctuation" style=color:#f8f8f2>]</span><span class="token punctuation" style=color:#f8f8f2>(</span><span class="token plain">b8e924030045b536</span><span class="token punctuation" style=color:#f8f8f2>)</span><span class="token plain">       </span><span class="token comment" style=color:#8292a2;font-style:italic># 交换机端口16</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">                                        </span><span class="token comment" style=color:#8292a2;font-style:italic># "msxf-hpc-37-4-ai mlx5_8" lid 11 4xNDR</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain"></span><span class="token punctuation" style=color:#f8f8f2>[</span><span class="token number" style=color:#ae81ff>65</span><span class="token punctuation" style=color:#f8f8f2>]</span><span class="token plain">    </span><span class="token string" style=color:#a6e22e>"H-b0cf0e0300d66c88"</span><span class="token punctuation" style=color:#f8f8f2>[</span><span class="token number" style=color:#ae81ff>1</span><span class="token punctuation" style=color:#f8f8f2>]</span><span class="token punctuation" style=color:#f8f8f2>(</span><span class="token plain">b0cf0e0300d66c88</span><span class="token punctuation" style=color:#f8f8f2>)</span><span class="token plain">       </span><span class="token comment" style=color:#8292a2;font-style:italic># 交换机端口65，连接聚合节点</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">                                        </span><span class="token comment" style=color:#8292a2;font-style:italic># "Mellanox Technologies Aggregation Node" lid 6 4xNDR</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain"></span><span class="token comment" style=color:#8292a2;font-style:italic># ====== 主机通道适配器（HCA）信息 ======</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain"></span><span class="token assign-left variable" style=color:#f8f8f2>vendid</span><span class="token operator" style=color:#66d9ef>=</span><span class="token plain">0x2c9</span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain"></span><span class="token assign-left variable" style=color:#f8f8f2>devid</span><span class="token operator" style=color:#66d9ef>=</span><span class="token plain">0x1021                            </span><span class="token comment" style=color:#8292a2;font-style:italic># 设备ID，0x1021代表ConnectX-7网卡</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain"></span><span class="token assign-left variable" style=color:#f8f8f2>sysimgguid</span><span class="token operator" style=color:#66d9ef>=</span><span class="token plain">0xb8e924030045b536          </span><span class="token comment" style=color:#8292a2;font-style:italic># 系统镜像GUID</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain"></span><span class="token assign-left variable" style=color:#f8f8f2>caguid</span><span class="token operator" style=color:#66d9ef>=</span><span class="token plain">0xb8e924030045b536              </span><span class="token comment" style=color:#8292a2;font-style:italic># 通道适配器GUID</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">Ca      </span><span class="token number" style=color:#ae81ff>1</span><span class="token plain"> </span><span class="token string" style=color:#a6e22e>"H-b8e924030045b536"</span><span class="token plain">          </span><span class="token comment" style=color:#8292a2;font-style:italic># Ca表示主机通道适配器，1表示有1个端口</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">                                        </span><span class="token comment" style=color:#8292a2;font-style:italic># "msxf-hpc-37-4-ai mlx5_8" 主机名和设备名</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain"></span><span class="token punctuation" style=color:#f8f8f2>[</span><span class="token number" style=color:#ae81ff>1</span><span class="token punctuation" style=color:#f8f8f2>]</span><span class="token punctuation" style=color:#f8f8f2>(</span><span class="token plain">b8e924030045b536</span><span class="token punctuation" style=color:#f8f8f2>)</span><span class="token plain">   </span><span class="token string" style=color:#a6e22e>"S-b0cf0e0300d66c80"</span><span class="token punctuation" style=color:#f8f8f2>[</span><span class="token number" style=color:#ae81ff>16</span><span class="token punctuation" style=color:#f8f8f2>]</span><span class="token plain">        </span><span class="token comment" style=color:#8292a2;font-style:italic># 该HCA的端口1连接到交换机的端口16</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">                                        </span><span class="token comment" style=color:#8292a2;font-style:italic># lid 11 lmc 0 该端口的LID和LMC</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">                                        </span><span class="token comment" style=color:#8292a2;font-style:italic># "MF0;DCXNYD-IB03-D1F2-D207-F08-U45:MQM9700/U1" 交换机信息</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">                                        </span><span class="token comment" style=color:#8292a2;font-style:italic># lid 2 交换机的LID</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">                                        </span><span class="token comment" style=color:#8292a2;font-style:italic># 4xNDR 链路速率</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain"></span><span class="token assign-left variable" style=color:#f8f8f2>vendid</span><span class="token operator" style=color:#66d9ef>=</span><span class="token plain">0x2c9</span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain"></span><span class="token assign-left variable" style=color:#f8f8f2>devid</span><span class="token operator" style=color:#66d9ef>=</span><span class="token plain">0xcf09                            </span><span class="token comment" style=color:#8292a2;font-style:italic># 设备ID，0xcf09代表聚合节点设备</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain"></span><span class="token assign-left variable" style=color:#f8f8f2>sysimgguid</span><span class="token operator" style=color:#66d9ef>=</span><span class="token plain">0xb0cf0e0300d66c80</span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain"></span><span class="token assign-left variable" style=color:#f8f8f2>caguid</span><span class="token operator" style=color:#66d9ef>=</span><span class="token plain">0xb0cf0e0300d66c88</span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">Ca      </span><span class="token number" style=color:#ae81ff>1</span><span class="token plain"> </span><span class="token string" style=color:#a6e22e>"H-b0cf0e0300d66c88"</span><span class="token plain">          </span><span class="token comment" style=color:#8292a2;font-style:italic># 聚合节点的HCA</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">                                        </span><span class="token comment" style=color:#8292a2;font-style:italic># "Mellanox Technologies Aggregation Node"</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain"></span><span class="token punctuation" style=color:#f8f8f2>[</span><span class="token number" style=color:#ae81ff>1</span><span class="token punctuation" style=color:#f8f8f2>]</span><span class="token punctuation" style=color:#f8f8f2>(</span><span class="token plain">b0cf0e0300d66c88</span><span class="token punctuation" style=color:#f8f8f2>)</span><span class="token plain">   </span><span class="token string" style=color:#a6e22e>"S-b0cf0e0300d66c80"</span><span class="token punctuation" style=color:#f8f8f2>[</span><span class="token number" style=color:#ae81ff>65</span><span class="token punctuation" style=color:#f8f8f2>]</span><span class="token plain">        </span><span class="token comment" style=color:#8292a2;font-style:italic># 连接到交换机的端口65</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">                                        </span><span class="token comment" style=color:#8292a2;font-style:italic># lid 6 lmc 0 "MF0;DCXNYD-IB03-D1F2-D207-F08-U45:MQM9700/U1" lid 2 4xNDR</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain"></span><span class="token assign-left variable" style=color:#f8f8f2>vendid</span><span class="token operator" style=color:#66d9ef>=</span><span class="token plain">0x2c9</span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain"></span><span class="token assign-left variable" style=color:#f8f8f2>devid</span><span class="token operator" style=color:#66d9ef>=</span><span class="token plain">0x1021</span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain"></span><span class="token assign-left variable" style=color:#f8f8f2>sysimgguid</span><span class="token operator" style=color:#66d9ef>=</span><span class="token plain">0xb8e92403004068d2</span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain"></span><span class="token assign-left variable" style=color:#f8f8f2>caguid</span><span class="token operator" style=color:#66d9ef>=</span><span class="token plain">0xb8e92403004068d2</span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">Ca      </span><span class="token number" style=color:#ae81ff>1</span><span class="token plain"> </span><span class="token string" style=color:#a6e22e>"H-b8e92403004068d2"</span><span class="token plain">          </span><span class="token comment" style=color:#8292a2;font-style:italic># "msxf-hpc-37-4-ai mlx5_6"</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain"></span><span class="token punctuation" style=color:#f8f8f2>[</span><span class="token number" style=color:#ae81ff>1</span><span class="token punctuation" style=color:#f8f8f2>]</span><span class="token punctuation" style=color:#f8f8f2>(</span><span class="token plain">b8e92403004068d2</span><span class="token punctuation" style=color:#f8f8f2>)</span><span class="token plain">   </span><span class="token string" style=color:#a6e22e>"S-b0cf0e0300d66c80"</span><span class="token punctuation" style=color:#f8f8f2>[</span><span class="token number" style=color:#ae81ff>15</span><span class="token punctuation" style=color:#f8f8f2>]</span><span class="token plain">        </span><span class="token comment" style=color:#8292a2;font-style:italic># 连接到交换机端口15</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">                                        </span><span class="token comment" style=color:#8292a2;font-style:italic># lid 12 lmc 0 "MF0;DCXNYD-IB03-D1F2-D207-F08-U45:MQM9700/U1" lid 2 4xNDR</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain"></span><span class="token assign-left variable" style=color:#f8f8f2>vendid</span><span class="token operator" style=color:#66d9ef>=</span><span class="token plain">0x2c9</span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain"></span><span class="token assign-left variable" style=color:#f8f8f2>devid</span><span class="token operator" style=color:#66d9ef>=</span><span class="token plain">0x1021</span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain"></span><span class="token assign-left variable" style=color:#f8f8f2>sysimgguid</span><span class="token operator" style=color:#66d9ef>=</span><span class="token plain">0xb8e9240300459a06</span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain"></span><span class="token assign-left variable" style=color:#f8f8f2>caguid</span><span class="token operator" style=color:#66d9ef>=</span><span class="token plain">0xb8e9240300459a06</span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">Ca      </span><span class="token number" style=color:#ae81ff>1</span><span class="token plain"> </span><span class="token string" style=color:#a6e22e>"H-b8e9240300459a06"</span><span class="token plain">          </span><span class="token comment" style=color:#8292a2;font-style:italic># "msxf-hpc-37-4-ai mlx5_2"</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain"></span><span class="token punctuation" style=color:#f8f8f2>[</span><span class="token number" style=color:#ae81ff>1</span><span class="token punctuation" style=color:#f8f8f2>]</span><span class="token punctuation" style=color:#f8f8f2>(</span><span class="token plain">b8e9240300459a06</span><span class="token punctuation" style=color:#f8f8f2>)</span><span class="token plain">   </span><span class="token string" style=color:#a6e22e>"S-b0cf0e0300d66c80"</span><span class="token punctuation" style=color:#f8f8f2>[</span><span class="token number" style=color:#ae81ff>14</span><span class="token punctuation" style=color:#f8f8f2>]</span><span class="token plain">                </span><span class="token comment" style=color:#8292a2;font-style:italic># lid 81 lmc 0 "MF0;DCXNYD-IB03-D1F2-D207-F08-U45:MQM9700/U1" lid 2 4xNDR</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain"></span><span class="token assign-left variable" style=color:#f8f8f2>vendid</span><span class="token operator" style=color:#66d9ef>=</span><span class="token plain">0x2c9</span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain"></span><span class="token assign-left variable" style=color:#f8f8f2>devid</span><span class="token operator" style=color:#66d9ef>=</span><span class="token plain">0x1021</span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain"></span><span class="token assign-left variable" style=color:#f8f8f2>sysimgguid</span><span class="token operator" style=color:#66d9ef>=</span><span class="token plain">0xb8e9240300459c0e</span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain"></span><span class="token assign-left variable" style=color:#f8f8f2>caguid</span><span class="token operator" style=color:#66d9ef>=</span><span class="token plain">0xb8e9240300459c0e</span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">Ca      </span><span class="token number" style=color:#ae81ff>1</span><span class="token plain"> </span><span class="token string" style=color:#a6e22e>"H-b8e9240300459c0e"</span><span class="token plain">          </span><span class="token comment" style=color:#8292a2;font-style:italic># "msxf-hpc-37-4-ai mlx5_0"</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain"></span><span class="token punctuation" style=color:#f8f8f2>[</span><span class="token number" style=color:#ae81ff>1</span><span class="token punctuation" style=color:#f8f8f2>]</span><span class="token punctuation" style=color:#f8f8f2>(</span><span class="token plain">b8e9240300459c0e</span><span class="token punctuation" style=color:#f8f8f2>)</span><span class="token plain">   </span><span class="token string" style=color:#a6e22e>"S-b0cf0e0300d66c80"</span><span class="token punctuation" style=color:#f8f8f2>[</span><span class="token number" style=color:#ae81ff>13</span><span class="token punctuation" style=color:#f8f8f2>]</span><span class="token plain">                </span><span class="token comment" style=color:#8292a2;font-style:italic># lid 79 lmc 0 "MF0;DCXNYD-IB03-D1F2-D207-F08-U45:MQM9700/U1" lid 2 4xNDR</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain"></span><span class="token assign-left variable" style=color:#f8f8f2>vendid</span><span class="token operator" style=color:#66d9ef>=</span><span class="token plain">0x2c9</span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain"></span><span class="token assign-left variable" style=color:#f8f8f2>devid</span><span class="token operator" style=color:#66d9ef>=</span><span class="token plain">0x1021</span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain"></span><span class="token assign-left variable" style=color:#f8f8f2>sysimgguid</span><span class="token operator" style=color:#66d9ef>=</span><span class="token plain">0xb8e9240300471a1a</span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain"></span><span class="token assign-left variable" style=color:#f8f8f2>caguid</span><span class="token operator" style=color:#66d9ef>=</span><span class="token plain">0xb8e9240300471a1a</span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">Ca      </span><span class="token number" style=color:#ae81ff>1</span><span class="token plain"> </span><span class="token string" style=color:#a6e22e>"H-b8e9240300471a1a"</span><span class="token plain">          </span><span class="token comment" style=color:#8292a2;font-style:italic># "msxf-hpc-37-3-ai mlx5_8"</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain"></span><span class="token punctuation" style=color:#f8f8f2>[</span><span class="token number" style=color:#ae81ff>1</span><span class="token punctuation" style=color:#f8f8f2>]</span><span class="token punctuation" style=color:#f8f8f2>(</span><span class="token plain">b8e9240300471a1a</span><span class="token punctuation" style=color:#f8f8f2>)</span><span class="token plain">   </span><span class="token string" style=color:#a6e22e>"S-b0cf0e0300d66c80"</span><span class="token punctuation" style=color:#f8f8f2>[</span><span class="token number" style=color:#ae81ff>12</span><span class="token punctuation" style=color:#f8f8f2>]</span><span class="token plain">                </span><span class="token comment" style=color:#8292a2;font-style:italic># lid 13 lmc 0 "MF0;DCXNYD-IB03-D1F2-D207-F08-U45:MQM9700/U1" lid 2 4xNDR</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain"></span><span class="token assign-left variable" style=color:#f8f8f2>vendid</span><span class="token operator" style=color:#66d9ef>=</span><span class="token plain">0x2c9</span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain"></span><span class="token assign-left variable" style=color:#f8f8f2>devid</span><span class="token operator" style=color:#66d9ef>=</span><span class="token plain">0x1021</span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain"></span><span class="token assign-left variable" style=color:#f8f8f2>sysimgguid</span><span class="token operator" style=color:#66d9ef>=</span><span class="token plain">0xb8e9240300471542</span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain"></span><span class="token assign-left variable" style=color:#f8f8f2>caguid</span><span class="token operator" style=color:#66d9ef>=</span><span class="token plain">0xb8e9240300471542</span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">Ca      </span><span class="token number" style=color:#ae81ff>1</span><span class="token plain"> </span><span class="token string" style=color:#a6e22e>"H-b8e9240300471542"</span><span class="token plain">          </span><span class="token comment" style=color:#8292a2;font-style:italic># "msxf-hpc-37-3-ai mlx5_6"</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain"></span><span class="token punctuation" style=color:#f8f8f2>[</span><span class="token number" style=color:#ae81ff>1</span><span class="token punctuation" style=color:#f8f8f2>]</span><span class="token punctuation" style=color:#f8f8f2>(</span><span class="token plain">b8e9240300471542</span><span class="token punctuation" style=color:#f8f8f2>)</span><span class="token plain">   </span><span class="token string" style=color:#a6e22e>"S-b0cf0e0300d66c80"</span><span class="token punctuation" style=color:#f8f8f2>[</span><span class="token number" style=color:#ae81ff>11</span><span class="token punctuation" style=color:#f8f8f2>]</span><span class="token plain">                </span><span class="token comment" style=color:#8292a2;font-style:italic># lid 14 lmc 0 "MF0;DCXNYD-IB03-D1F2-D207-F08-U45:MQM9700/U1" lid 2 4xNDR</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain"></span><span class="token assign-left variable" style=color:#f8f8f2>vendid</span><span class="token operator" style=color:#66d9ef>=</span><span class="token plain">0x2c9</span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain"></span><span class="token assign-left variable" style=color:#f8f8f2>devid</span><span class="token operator" style=color:#66d9ef>=</span><span class="token plain">0x1021</span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain"></span><span class="token assign-left variable" style=color:#f8f8f2>sysimgguid</span><span class="token operator" style=color:#66d9ef>=</span><span class="token plain">0xb8e924030047100a</span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain"></span><span class="token assign-left variable" style=color:#f8f8f2>caguid</span><span class="token operator" style=color:#66d9ef>=</span><span class="token plain">0xb8e924030047100a</span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">Ca      </span><span class="token number" style=color:#ae81ff>1</span><span class="token plain"> </span><span class="token string" style=color:#a6e22e>"H-b8e924030047100a"</span><span class="token plain">          </span><span class="token comment" style=color:#8292a2;font-style:italic># "msxf-hpc-37-3-ai mlx5_2"</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain"></span><span class="token punctuation" style=color:#f8f8f2>[</span><span class="token number" style=color:#ae81ff>1</span><span class="token punctuation" style=color:#f8f8f2>]</span><span class="token punctuation" style=color:#f8f8f2>(</span><span class="token plain">b8e924030047100a</span><span class="token punctuation" style=color:#f8f8f2>)</span><span class="token plain">   </span><span class="token string" style=color:#a6e22e>"S-b0cf0e0300d66c80"</span><span class="token punctuation" style=color:#f8f8f2>[</span><span class="token number" style=color:#ae81ff>10</span><span class="token punctuation" style=color:#f8f8f2>]</span><span class="token plain">                </span><span class="token comment" style=color:#8292a2;font-style:italic># lid 77 lmc 0 "MF0;DCXNYD-IB03-D1F2-D207-F08-U45:MQM9700/U1" lid 2 4xNDR</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain"></span><span class="token assign-left variable" style=color:#f8f8f2>vendid</span><span class="token operator" style=color:#66d9ef>=</span><span class="token plain">0x2c9</span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain"></span><span class="token assign-left variable" style=color:#f8f8f2>devid</span><span class="token operator" style=color:#66d9ef>=</span><span class="token plain">0x1021</span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain"></span><span class="token assign-left variable" style=color:#f8f8f2>sysimgguid</span><span class="token operator" style=color:#66d9ef>=</span><span class="token plain">0xb8e924030040652a</span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain"></span><span class="token assign-left variable" style=color:#f8f8f2>caguid</span><span class="token operator" style=color:#66d9ef>=</span><span class="token plain">0xb8e924030040652a</span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">Ca      </span><span class="token number" style=color:#ae81ff>1</span><span class="token plain"> </span><span class="token string" style=color:#a6e22e>"H-b8e924030040652a"</span><span class="token plain">          </span><span class="token comment" style=color:#8292a2;font-style:italic># "msxf-hpc-37-3-ai mlx5_0"</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain"></span><span class="token punctuation" style=color:#f8f8f2>[</span><span class="token number" style=color:#ae81ff>1</span><span class="token punctuation" style=color:#f8f8f2>]</span><span class="token punctuation" style=color:#f8f8f2>(</span><span class="token plain">b8e924030040652a</span><span class="token punctuation" style=color:#f8f8f2>)</span><span class="token plain">   </span><span class="token string" style=color:#a6e22e>"S-b0cf0e0300d66c80"</span><span class="token punctuation" style=color:#f8f8f2>[</span><span class="token number" style=color:#ae81ff>9</span><span class="token punctuation" style=color:#f8f8f2>]</span><span class="token plain">         </span><span class="token comment" style=color:#8292a2;font-style:italic># lid 75 lmc 0 "MF0;DCXNYD-IB03-D1F2-D207-F08-U45:MQM9700/U1" lid 2 4xNDR</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain"></span><span class="token assign-left variable" style=color:#f8f8f2>vendid</span><span class="token operator" style=color:#66d9ef>=</span><span class="token plain">0x2c9</span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain"></span><span class="token assign-left variable" style=color:#f8f8f2>devid</span><span class="token operator" style=color:#66d9ef>=</span><span class="token plain">0x1021</span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain"></span><span class="token assign-left variable" style=color:#f8f8f2>sysimgguid</span><span class="token operator" style=color:#66d9ef>=</span><span class="token plain">0xb8e9240300459b16</span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain"></span><span class="token assign-left variable" style=color:#f8f8f2>caguid</span><span class="token operator" style=color:#66d9ef>=</span><span class="token plain">0xb8e9240300459b16</span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">Ca      </span><span class="token number" style=color:#ae81ff>1</span><span class="token plain"> </span><span class="token string" style=color:#a6e22e>"H-b8e9240300459b16"</span><span class="token plain">          </span><span class="token comment" style=color:#8292a2;font-style:italic># "msxf-hpc-37-2-ai mlx5_6"</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain"></span><span class="token punctuation" style=color:#f8f8f2>[</span><span class="token number" style=color:#ae81ff>1</span><span class="token punctuation" style=color:#f8f8f2>]</span><span class="token punctuation" style=color:#f8f8f2>(</span><span class="token plain">b8e9240300459b16</span><span class="token punctuation" style=color:#f8f8f2>)</span><span class="token plain">   </span><span class="token string" style=color:#a6e22e>"S-b0cf0e0300d66c80"</span><span class="token punctuation" style=color:#f8f8f2>[</span><span class="token number" style=color:#ae81ff>7</span><span class="token punctuation" style=color:#f8f8f2>]</span><span class="token plain">         </span><span class="token comment" style=color:#8292a2;font-style:italic># lid 10 lmc 0 "MF0;DCXNYD-IB03-D1F2-D207-F08-U45:MQM9700/U1" lid 2 4xNDR</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain"></span><span class="token assign-left variable" style=color:#f8f8f2>vendid</span><span class="token operator" style=color:#66d9ef>=</span><span class="token plain">0x2c9</span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain"></span><span class="token assign-left variable" style=color:#f8f8f2>devid</span><span class="token operator" style=color:#66d9ef>=</span><span class="token plain">0x1021</span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain"></span><span class="token assign-left variable" style=color:#f8f8f2>sysimgguid</span><span class="token operator" style=color:#66d9ef>=</span><span class="token plain">0xb8e9240300459bd6</span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain"></span><span class="token assign-left variable" style=color:#f8f8f2>caguid</span><span class="token operator" style=color:#66d9ef>=</span><span class="token plain">0xb8e9240300459bd6</span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">Ca      </span><span class="token number" style=color:#ae81ff>1</span><span class="token plain"> </span><span class="token string" style=color:#a6e22e>"H-b8e9240300459bd6"</span><span class="token plain">          </span><span class="token comment" style=color:#8292a2;font-style:italic># "msxf-hpc-37-2-ai mlx5_2"</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain"></span><span class="token punctuation" style=color:#f8f8f2>[</span><span class="token number" style=color:#ae81ff>1</span><span class="token punctuation" style=color:#f8f8f2>]</span><span class="token punctuation" style=color:#f8f8f2>(</span><span class="token plain">b8e9240300459bd6</span><span class="token punctuation" style=color:#f8f8f2>)</span><span class="token plain">   </span><span class="token string" style=color:#a6e22e>"S-b0cf0e0300d66c80"</span><span class="token punctuation" style=color:#f8f8f2>[</span><span class="token number" style=color:#ae81ff>6</span><span class="token punctuation" style=color:#f8f8f2>]</span><span class="token plain">         </span><span class="token comment" style=color:#8292a2;font-style:italic># lid 4 lmc 0 "MF0;DCXNYD-IB03-D1F2-D207-F08-U45:MQM9700/U1" lid 2 4xNDR</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain"></span><span class="token assign-left variable" style=color:#f8f8f2>vendid</span><span class="token operator" style=color:#66d9ef>=</span><span class="token plain">0x2c9</span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain"></span><span class="token assign-left variable" style=color:#f8f8f2>devid</span><span class="token operator" style=color:#66d9ef>=</span><span class="token plain">0x1021</span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain"></span><span class="token assign-left variable" style=color:#f8f8f2>sysimgguid</span><span class="token operator" style=color:#66d9ef>=</span><span class="token plain">0xb8e92403004599fe</span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain"></span><span class="token assign-left variable" style=color:#f8f8f2>caguid</span><span class="token operator" style=color:#66d9ef>=</span><span class="token plain">0xb8e92403004599fe</span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">Ca      </span><span class="token number" style=color:#ae81ff>1</span><span class="token plain"> </span><span class="token string" style=color:#a6e22e>"H-b8e92403004599fe"</span><span class="token plain">          </span><span class="token comment" style=color:#8292a2;font-style:italic># "msxf-hpc-37-2-ai mlx5_0"</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain"></span><span class="token punctuation" style=color:#f8f8f2>[</span><span class="token number" style=color:#ae81ff>1</span><span class="token punctuation" style=color:#f8f8f2>]</span><span class="token punctuation" style=color:#f8f8f2>(</span><span class="token plain">b8e92403004599fe</span><span class="token punctuation" style=color:#f8f8f2>)</span><span class="token plain">   </span><span class="token string" style=color:#a6e22e>"S-b0cf0e0300d66c80"</span><span class="token punctuation" style=color:#f8f8f2>[</span><span class="token number" style=color:#ae81ff>5</span><span class="token punctuation" style=color:#f8f8f2>]</span><span class="token plain">         </span><span class="token comment" style=color:#8292a2;font-style:italic># lid 5 lmc 0 "MF0;DCXNYD-IB03-D1F2-D207-F08-U45:MQM9700/U1" lid 2 4xNDR</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain"></span><span class="token assign-left variable" style=color:#f8f8f2>vendid</span><span class="token operator" style=color:#66d9ef>=</span><span class="token plain">0x2c9</span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain"></span><span class="token assign-left variable" style=color:#f8f8f2>devid</span><span class="token operator" style=color:#66d9ef>=</span><span class="token plain">0x1021</span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain"></span><span class="token assign-left variable" style=color:#f8f8f2>sysimgguid</span><span class="token operator" style=color:#66d9ef>=</span><span class="token plain">0xb8e924030045963e</span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain"></span><span class="token assign-left variable" style=color:#f8f8f2>caguid</span><span class="token operator" style=color:#66d9ef>=</span><span class="token plain">0xb8e924030045963e</span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">Ca      </span><span class="token number" style=color:#ae81ff>1</span><span class="token plain"> </span><span class="token string" style=color:#a6e22e>"H-b8e924030045963e"</span><span class="token plain">          </span><span class="token comment" style=color:#8292a2;font-style:italic># "msxf-hpc-37-1-ai mlx5_6"</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain"></span><span class="token punctuation" style=color:#f8f8f2>[</span><span class="token number" style=color:#ae81ff>1</span><span class="token punctuation" style=color:#f8f8f2>]</span><span class="token punctuation" style=color:#f8f8f2>(</span><span class="token plain">b8e924030045963e</span><span class="token punctuation" style=color:#f8f8f2>)</span><span class="token plain">   </span><span class="token string" style=color:#a6e22e>"S-b0cf0e0300d66c80"</span><span class="token punctuation" style=color:#f8f8f2>[</span><span class="token number" style=color:#ae81ff>4</span><span class="token punctuation" style=color:#f8f8f2>]</span><span class="token plain">         </span><span class="token comment" style=color:#8292a2;font-style:italic># lid 8 lmc 0 "MF0;DCXNYD-IB03-D1F2-D207-F08-U45:MQM9700/U1" lid 2 4xNDR</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain"></span><span class="token assign-left variable" style=color:#f8f8f2>vendid</span><span class="token operator" style=color:#66d9ef>=</span><span class="token plain">0x2c9</span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain"></span><span class="token assign-left variable" style=color:#f8f8f2>devid</span><span class="token operator" style=color:#66d9ef>=</span><span class="token plain">0x1021</span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain"></span><span class="token assign-left variable" style=color:#f8f8f2>sysimgguid</span><span class="token operator" style=color:#66d9ef>=</span><span class="token plain">0xb8e924030045ab1e</span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain"></span><span class="token assign-left variable" style=color:#f8f8f2>caguid</span><span class="token operator" style=color:#66d9ef>=</span><span class="token plain">0xb8e924030045ab1e</span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">Ca      </span><span class="token number" style=color:#ae81ff>1</span><span class="token plain"> </span><span class="token string" style=color:#a6e22e>"H-b8e924030045ab1e"</span><span class="token plain">          </span><span class="token comment" style=color:#8292a2;font-style:italic># "msxf-hpc-37-1-ai mlx5_8"</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain"></span><span class="token punctuation" style=color:#f8f8f2>[</span><span class="token number" style=color:#ae81ff>1</span><span class="token punctuation" style=color:#f8f8f2>]</span><span class="token punctuation" style=color:#f8f8f2>(</span><span class="token plain">b8e924030045ab1e</span><span class="token punctuation" style=color:#f8f8f2>)</span><span class="token plain">   </span><span class="token string" style=color:#a6e22e>"S-b0cf0e0300d66c80"</span><span class="token punctuation" style=color:#f8f8f2>[</span><span class="token number" style=color:#ae81ff>3</span><span class="token punctuation" style=color:#f8f8f2>]</span><span class="token plain">         </span><span class="token comment" style=color:#8292a2;font-style:italic># lid 7 lmc 0 "MF0;DCXNYD-IB03-D1F2-D207-F08-U45:MQM9700/U1" lid 2 4xNDR</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain"></span><span class="token assign-left variable" style=color:#f8f8f2>vendid</span><span class="token operator" style=color:#66d9ef>=</span><span class="token plain">0x2c9</span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain"></span><span class="token assign-left variable" style=color:#f8f8f2>devid</span><span class="token operator" style=color:#66d9ef>=</span><span class="token plain">0x1021</span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain"></span><span class="token assign-left variable" style=color:#f8f8f2>sysimgguid</span><span class="token operator" style=color:#66d9ef>=</span><span class="token plain">0xb8e924030045981e</span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain"></span><span class="token assign-left variable" style=color:#f8f8f2>caguid</span><span class="token operator" style=color:#66d9ef>=</span><span class="token plain">0xb8e924030045981e</span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">Ca      </span><span class="token number" style=color:#ae81ff>1</span><span class="token plain"> </span><span class="token string" style=color:#a6e22e>"H-b8e924030045981e"</span><span class="token plain">          </span><span class="token comment" style=color:#8292a2;font-style:italic># "msxf-hpc-37-1-ai mlx5_2"</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain"></span><span class="token punctuation" style=color:#f8f8f2>[</span><span class="token number" style=color:#ae81ff>1</span><span class="token punctuation" style=color:#f8f8f2>]</span><span class="token punctuation" style=color:#f8f8f2>(</span><span class="token plain">b8e924030045981e</span><span class="token punctuation" style=color:#f8f8f2>)</span><span class="token plain">   </span><span class="token string" style=color:#a6e22e>"S-b0cf0e0300d66c80"</span><span class="token punctuation" style=color:#f8f8f2>[</span><span class="token number" style=color:#ae81ff>2</span><span class="token punctuation" style=color:#f8f8f2>]</span><span class="token plain">         </span><span class="token comment" style=color:#8292a2;font-style:italic># lid 73 lmc 0 "MF0;DCXNYD-IB03-D1F2-D207-F08-U45:MQM9700/U1" lid 2 4xNDR</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain"></span><span class="token assign-left variable" style=color:#f8f8f2>vendid</span><span class="token operator" style=color:#66d9ef>=</span><span class="token plain">0x2c9</span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain"></span><span class="token assign-left variable" style=color:#f8f8f2>devid</span><span class="token operator" style=color:#66d9ef>=</span><span class="token plain">0x1021</span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain"></span><span class="token assign-left variable" style=color:#f8f8f2>sysimgguid</span><span class="token operator" style=color:#66d9ef>=</span><span class="token plain">0xb8e924030045aaae</span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain"></span><span class="token assign-left variable" style=color:#f8f8f2>caguid</span><span class="token operator" style=color:#66d9ef>=</span><span class="token plain">0xb8e924030045aaae</span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">Ca      </span><span class="token number" style=color:#ae81ff>1</span><span class="token plain"> </span><span class="token string" style=color:#a6e22e>"H-b8e924030045aaae"</span><span class="token plain">          </span><span class="token comment" style=color:#8292a2;font-style:italic># "msxf-hpc-37-1-ai mlx5_0"</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain"></span><span class="token punctuation" style=color:#f8f8f2>[</span><span class="token number" style=color:#ae81ff>1</span><span class="token punctuation" style=color:#f8f8f2>]</span><span class="token punctuation" style=color:#f8f8f2>(</span><span class="token plain">b8e924030045aaae</span><span class="token punctuation" style=color:#f8f8f2>)</span><span class="token plain">   </span><span class="token string" style=color:#a6e22e>"S-b0cf0e0300d66c80"</span><span class="token punctuation" style=color:#f8f8f2>[</span><span class="token number" style=color:#ae81ff>1</span><span class="token punctuation" style=color:#f8f8f2>]</span><span class="token plain">         </span><span class="token comment" style=color:#8292a2;font-style:italic># lid 71 lmc 0 "MF0;DCXNYD-IB03-D1F2-D207-F08-U45:MQM9700/U1" lid 2 4xNDR</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain"></span><span class="token assign-left variable" style=color:#f8f8f2>vendid</span><span class="token operator" style=color:#66d9ef>=</span><span class="token plain">0x2c9</span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain"></span><span class="token assign-left variable" style=color:#f8f8f2>devid</span><span class="token operator" style=color:#66d9ef>=</span><span class="token plain">0x1021</span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain"></span><span class="token assign-left variable" style=color:#f8f8f2>sysimgguid</span><span class="token operator" style=color:#66d9ef>=</span><span class="token plain">0xb8e9240300471762</span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain"></span><span class="token assign-left variable" style=color:#f8f8f2>caguid</span><span class="token operator" style=color:#66d9ef>=</span><span class="token plain">0xb8e9240300471762</span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">Ca      </span><span class="token number" style=color:#ae81ff>1</span><span class="token plain"> </span><span class="token string" style=color:#a6e22e>"H-b8e9240300471762"</span><span class="token plain">          </span><span class="token comment" style=color:#8292a2;font-style:italic># "msxf-hpc-37-2-ai mlx5_8"</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain"></span><span class="token punctuation" style=color:#f8f8f2>[</span><span class="token number" style=color:#ae81ff>1</span><span class="token punctuation" style=color:#f8f8f2>]</span><span class="token punctuation" style=color:#f8f8f2>(</span><span class="token plain">b8e9240300471762</span><span class="token punctuation" style=color:#f8f8f2>)</span><span class="token plain">   </span><span class="token string" style=color:#a6e22e>"S-b0cf0e0300d66c80"</span><span class="token punctuation" style=color:#f8f8f2>[</span><span class="token number" style=color:#ae81ff>8</span><span class="token punctuation" style=color:#f8f8f2>]</span><span class="token plain">         </span><span class="token comment" style=color:#8292a2;font-style:italic># lid 9 lmc 0 "MF0;DCXNYD-IB03-D1F2-D207-F08-U45:MQM9700/U1" lid 2 4xNDR</span><br></span></code></pre><div class=buttonGroup__atx><button type=button aria-label="Copy code to clipboard" title=Copy class=clean-btn><span class=copyButtonIcons_eSgA aria-hidden=true><svg viewBox="0 0 24 24" class=copyButtonIcon_y97N><path fill=currentColor d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"/></svg><svg viewBox="0 0 24 24" class=copyButtonSuccessIcon_LjdS><path fill=currentColor d=M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z /></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id=roce>RoCE<a href=#roce class=hash-link aria-label="Direct link to RoCE" title="Direct link to RoCE">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id=pci设备信息-1>PCI设备信息<a href=#pci设备信息-1 class=hash-link aria-label="Direct link to PCI设备信息" title="Direct link to PCI设备信息">​</a></h3>
<p>查看网卡设备：<code>lspci | grep -iE "InfiniBand|Mellanox"</code></p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#f8f8f2;--prism-background-color:#272822><div class=codeBlockContent_biex><pre tabindex=0 class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style=color:#f8f8f2;background-color:#272822><code class=codeBlockLines_e6Vv><span class=token-line style=color:#f8f8f2><span class="token plain">d8:00.0 Ethernet controller: Mellanox Technologies MT27710 Family </span><span class="token punctuation" style=color:#f8f8f2>[</span><span class="token plain">ConnectX-4 Lx</span><span class="token punctuation" style=color:#f8f8f2>]</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">d8:00.1 Ethernet controller: Mellanox Technologies MT27710 Family </span><span class="token punctuation" style=color:#f8f8f2>[</span><span class="token plain">ConnectX-4 Lx</span><span class="token punctuation" style=color:#f8f8f2>]</span><br></span></code></pre><div class=buttonGroup__atx><button type=button aria-label="Copy code to clipboard" title=Copy class=clean-btn><span class=copyButtonIcons_eSgA aria-hidden=true><svg viewBox="0 0 24 24" class=copyButtonIcon_y97N><path fill=currentColor d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"/></svg><svg viewBox="0 0 24 24" class=copyButtonSuccessIcon_LjdS><path fill=currentColor d=M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z /></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id=pci-nfd标签-1>PCI NFD标签<a href=#pci-nfd标签-1 class=hash-link aria-label="Direct link to PCI NFD标签" title="Direct link to PCI NFD标签">​</a></h3>
<p>如果<code>K8S</code>集群有安装<code>NFD</code>组件，<code>NFD</code>将自动检测<code>PCI</code>设备并为节点打上如下标签。</p>
<div class="language-yaml codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#f8f8f2;--prism-background-color:#272822><div class=codeBlockContent_biex><pre tabindex=0 class="prism-code language-yaml codeBlock_bY9V thin-scrollbar" style=color:#f8f8f2;background-color:#272822><code class=codeBlockLines_e6Vv><span class=token-line style=color:#f8f8f2><span class="token key atrule">feature.node.kubernetes.io/rdma.available</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"> </span><span class="token string" style=color:#a6e22e>"true"</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain"></span><span class="token key atrule">feature.node.kubernetes.io/rdma.capable</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"> </span><span class="token string" style=color:#a6e22e>"true"</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain"></span><span class="token key atrule">feature.node.kubernetes.io/pci-10de.present</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"> </span><span class="token string" style=color:#a6e22e>"true"</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain"></span><span class="token key atrule">feature.node.kubernetes.io/pci-15b3.present</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"> </span><span class="token string" style=color:#a6e22e>"true"</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain"></span><span class="token key atrule">feature.node.kubernetes.io/pci-15b3.sriov.capable</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"> </span><span class="token string" style=color:#a6e22e>"true"</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain"></span><span class="token key atrule">feature.node.kubernetes.io/pci-1a03.present</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"> </span><span class="token string" style=color:#a6e22e>"true"</span><br></span></code></pre><div class=buttonGroup__atx><button type=button aria-label="Copy code to clipboard" title=Copy class=clean-btn><span class=copyButtonIcons_eSgA aria-hidden=true><svg viewBox="0 0 24 24" class=copyButtonIcon_y97N><path fill=currentColor d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"/></svg><svg viewBox="0 0 24 24" class=copyButtonSuccessIcon_LjdS><path fill=currentColor d=M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z /></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id=rdma设备信息-1>RDMA设备信息<a href=#rdma设备信息-1 class=hash-link aria-label="Direct link to RDMA设备信息" title="Direct link to RDMA设备信息">​</a></h3>
<p>通过<code>ibv_devinfo</code>工具查看本节点上所有<code>IB</code>协议的所有<code>RDMA</code>网卡，如物理<code>IB</code>网卡、物理<code>RoCE</code>网卡：</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#f8f8f2;--prism-background-color:#272822><div class=codeBlockContent_biex><pre tabindex=0 class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style=color:#f8f8f2;background-color:#272822><code class=codeBlockLines_e6Vv><span class=token-line style=color:#f8f8f2><span class="token plain">hca_id: rocep216s0f0                    </span><span class="token comment" style=color:#8292a2;font-style:italic># RoCE设备ID，命名格式：roce + PCI地址 + 功能号</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">  transport:                      InfiniBand </span><span class="token punctuation" style=color:#f8f8f2>(</span><span class="token number" style=color:#ae81ff>0</span><span class="token punctuation" style=color:#f8f8f2>)</span><span class="token plain">          </span><span class="token comment" style=color:#8292a2;font-style:italic># 传输层仍显示InfiniBand，因为RoCE使用IB协议栈</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">  fw_ver:                         </span><span class="token number" style=color:#ae81ff>14.32</span><span class="token plain">.1010              </span><span class="token comment" style=color:#8292a2;font-style:italic># 固件版本号</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">  node_guid:                      b83f:d203:00a9:cc14     </span><span class="token comment" style=color:#8292a2;font-style:italic># 节点全局唯一标识符</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">  sys_image_guid:                 b83f:d203:00a9:cc14     </span><span class="token comment" style=color:#8292a2;font-style:italic># 系统镜像GUID</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">  vendor_id:                      0x02c9                  </span><span class="token comment" style=color:#8292a2;font-style:italic># 厂商ID，0x02c9代表Mellanox/NVIDIA</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">  vendor_part_id:                 </span><span class="token number" style=color:#ae81ff>4117</span><span class="token plain">                    </span><span class="token comment" style=color:#8292a2;font-style:italic># 产品型号ID，4117对应ConnectX-4 Lx</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">  hw_ver:                         0x0                     </span><span class="token comment" style=color:#8292a2;font-style:italic># 硬件版本号</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">  board_id:                       MT_2420110034           </span><span class="token comment" style=color:#8292a2;font-style:italic># 板卡ID</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">  phys_port_cnt:                  </span><span class="token number" style=color:#ae81ff>1</span><span class="token plain">                       </span><span class="token comment" style=color:#8292a2;font-style:italic># 物理端口数量</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">    port:   </span><span class="token number" style=color:#ae81ff>1</span><span class="token plain">                                       </span><span class="token comment" style=color:#8292a2;font-style:italic># 端口编号</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">      state:                  PORT_ACTIVE </span><span class="token punctuation" style=color:#f8f8f2>(</span><span class="token number" style=color:#ae81ff>4</span><span class="token punctuation" style=color:#f8f8f2>)</span><span class="token plain">         </span><span class="token comment" style=color:#8292a2;font-style:italic># 端口状态：活跃(4)，已连接可用</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">      max_mtu:                </span><span class="token number" style=color:#ae81ff>4096</span><span class="token plain"> </span><span class="token punctuation" style=color:#f8f8f2>(</span><span class="token number" style=color:#ae81ff>5</span><span class="token punctuation" style=color:#f8f8f2>)</span><span class="token plain">                </span><span class="token comment" style=color:#8292a2;font-style:italic># 最大MTU支持4096字节</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">      active_mtu:             </span><span class="token number" style=color:#ae81ff>1024</span><span class="token plain"> </span><span class="token punctuation" style=color:#f8f8f2>(</span><span class="token number" style=color:#ae81ff>3</span><span class="token punctuation" style=color:#f8f8f2>)</span><span class="token plain">                </span><span class="token comment" style=color:#8292a2;font-style:italic># 当前MTU为1500字节（标准以太网）</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">      sm_lid:                 </span><span class="token number" style=color:#ae81ff>0</span><span class="token plain">                       </span><span class="token comment" style=color:#8292a2;font-style:italic># RoCE网络无子网管理器，LID为0</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">      port_lid:               </span><span class="token number" style=color:#ae81ff>0</span><span class="token plain">                       </span><span class="token comment" style=color:#8292a2;font-style:italic># RoCE网络不使用LID寻址，使用MAC/IP</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">      port_lmc:               0x00                    </span><span class="token comment" style=color:#8292a2;font-style:italic># 无LMC配置</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">      link_layer:             Ethernet                </span><span class="token comment" style=color:#8292a2;font-style:italic># 链路层为以太网，标识这是RoCE设备</span><br></span></code></pre><div class=buttonGroup__atx><button type=button aria-label="Copy code to clipboard" title=Copy class=clean-btn><span class=copyButtonIcons_eSgA aria-hidden=true><svg viewBox="0 0 24 24" class=copyButtonIcon_y97N><path fill=currentColor d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"/></svg><svg viewBox="0 0 24 24" class=copyButtonSuccessIcon_LjdS><path fill=currentColor d=M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z /></svg></span></button></div></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id=为什么-roce-网卡信息上会显示-transport-infiniband-0>为什么 RoCE 网卡信息上会显示 transport: InfiniBand (0)？<a href=#为什么-roce-网卡信息上会显示-transport-infiniband-0 class=hash-link aria-label="Direct link to 为什么 RoCE 网卡信息上会显示 transport: InfiniBand (0)？" title="Direct link to 为什么 RoCE 网卡信息上会显示 transport: InfiniBand (0)？">​</a></h4>
<p><code>RoCE</code>属于<code>IB</code>协议体系，只是底层传输介质换成了以太网，上层的协议逻辑、交互规则、接口调用，和物理<code>IB</code>网卡完全一模一样。</p>
<p><code>RoCE</code>本质是「在以太网上跑<code>InfiniBand</code>的<code>RDMA</code>协议栈」<code>IB</code>是一套完整的<code>RDMA</code>协议标准，<code>RoCE</code>是这套标准的以太网承载实现，<code>IB</code>和<code>RoCE</code>共用同一个<code>RDMA</code>协议上层，只是底层的传输介质不同。</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id=为什么通过lspci看到有2张roce的网卡但是通过ibv_devinfo却只看到一个设备信息>为什么通过lspci看到有2张RoCE的网卡，但是通过ibv_devinfo却只看到一个设备信息？<a href=#为什么通过lspci看到有2张roce的网卡但是通过ibv_devinfo却只看到一个设备信息 class=hash-link aria-label="Direct link to 为什么通过lspci看到有2张RoCE的网卡，但是通过ibv_devinfo却只看到一个设备信息？" title="Direct link to 为什么通过lspci看到有2张RoCE的网卡，但是通过ibv_devinfo却只看到一个设备信息？">​</a></h4>
<p>因为这里的硬件是一块<code>Mellanox ConnectX-4 Lx</code>双口物理网卡，<code>lspci</code>识别的是「物理<code>PCI</code>端口」，而<code>ibv_devinfo</code>识别的是「<code>RDMA</code>驱动层面的<code>HCA</code>设备」——迈络思的双口<code>RoCE</code>/<code>IB</code>网卡，在 <code>RDMA</code> 驱动层只会被识别为「一个 <code>HCA</code> 主设备」，两个物理网口是这个主设备下的「两个子端口」。</p>
<p>当前<code>ibv_devinfo</code>里只显示<code>phys_port_cnt: 1</code>，说明你的双口网卡，只启用了<code>1</code>个网口的<code>RDMA</code>功能，另一个网口要么物理未插线/链路<code>Down</code>，要么<code>RDMA</code>功能未启用，并不是网卡消失了。</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id=ethernet拓扑信息>Ethernet拓扑信息<a href=#ethernet拓扑信息 class=hash-link aria-label="Direct link to Ethernet拓扑信息" title="Direct link to Ethernet拓扑信息">​</a></h3>
<p><code>RoCE</code>基于以太网，而以太网可以通过<code>LLDP</code>协议感知拓扑，因此需要先安装<code>LLDP</code>拓扑感知工具：</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#f8f8f2;--prism-background-color:#272822><div class=codeBlockContent_biex><pre tabindex=0 class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style=color:#f8f8f2;background-color:#272822><code class=codeBlockLines_e6Vv><span class=token-line style=color:#f8f8f2><span class="token function" style=color:#e6db74>apt</span><span class="token plain"> </span><span class="token function" style=color:#e6db74>install</span><span class="token plain"> lldpd</span><br></span></code></pre><div class=buttonGroup__atx><button type=button aria-label="Copy code to clipboard" title=Copy class=clean-btn><span class=copyButtonIcons_eSgA aria-hidden=true><svg viewBox="0 0 24 24" class=copyButtonIcon_y97N><path fill=currentColor d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"/></svg><svg viewBox="0 0 24 24" class=copyButtonSuccessIcon_LjdS><path fill=currentColor d=M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z /></svg></span></button></div></div></div>
<p>通过<code>lldpctl</code>查看<code>RoCE</code>拓扑信息。</p>
<p>只能探测【当前节点】自身 ↔ 直连交换机 的单层拓扑信息（本机网卡连到哪台交换机、哪个端口、哪个<code>VLAN</code>），看不到其他节点的拓扑、看不到交换机之间的级联拓扑、看不到跨节点的网络关系。</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#f8f8f2;--prism-background-color:#272822><div class=codeBlockContent_biex><pre tabindex=0 class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style=color:#f8f8f2;background-color:#272822><code class=codeBlockLines_e6Vv><span class=token-line style=color:#f8f8f2><span class="token plain">-------------------------------------------------------------------------------</span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">LLDP neighbors:                         </span><span class="token comment" style=color:#8292a2;font-style:italic># LLDP邻居设备信息</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">-------------------------------------------------------------------------------</span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">Interface:    ens64f0np0, via: LLDP, RID: </span><span class="token number" style=color:#ae81ff>1</span><span class="token plain">, Time: </span><span class="token number" style=color:#ae81ff>0</span><span class="token plain"> day, 00:00:18  </span><span class="token comment" style=color:#8292a2;font-style:italic># 本地接口名称，通过LLDP协议发现</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">  Chassis:                              </span><span class="token comment" style=color:#8292a2;font-style:italic># 对端设备机箱信息</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">    ChassisID:    mac ec:cd:4c:e3:09:9c                </span><span class="token comment" style=color:#8292a2;font-style:italic># 对端设备MAC地址（机箱ID）</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">    SysName:      DCXNYD-DMXCS-LEAF21_D1F2-D207-A09-U45-U43  </span><span class="token comment" style=color:#8292a2;font-style:italic># 对端交换机系统名称</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">    SysDescr:     H3C Comware Platform Software, Software Version </span><span class="token number" style=color:#ae81ff>7.1</span><span class="token plain">.070, Release </span><span class="token number" style=color:#ae81ff>6715</span><span class="token plain">  </span><span class="token comment" style=color:#8292a2;font-style:italic># 系统描述，软件版本</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">                  H3C S6850-56HF                        </span><span class="token comment" style=color:#8292a2;font-style:italic># 交换机型号</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">                  Copyright </span><span class="token punctuation" style=color:#f8f8f2>(</span><span class="token plain">c</span><span class="token punctuation" style=color:#f8f8f2>)</span><span class="token plain"> </span><span class="token number" style=color:#ae81ff>2004</span><span class="token plain">-2024 New H3C Technologies Co., Ltd. All rights reserved.</span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">    MgmtIP:       </span><span class="token number" style=color:#ae81ff>10.112</span><span class="token plain">.30.254                         </span><span class="token comment" style=color:#8292a2;font-style:italic># 交换机管理IP地址</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">    MgmtIface:    </span><span class="token number" style=color:#ae81ff>2153</span><span class="token plain">                                  </span><span class="token comment" style=color:#8292a2;font-style:italic># 管理接口ID</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">    Capability:   Bridge, on                            </span><span class="token comment" style=color:#8292a2;font-style:italic># 具备桥接能力，已启用</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">    Capability:   Router, on                            </span><span class="token comment" style=color:#8292a2;font-style:italic># 具备路由能力，已启用</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">  Port:                                 </span><span class="token comment" style=color:#8292a2;font-style:italic># 对端端口信息</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">    PortID:       ifname Twenty-FiveGigE2/0/1          </span><span class="token comment" style=color:#8292a2;font-style:italic># 对端端口标识，25GbE第2模块第0槽位第1端口</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">    PortDescr:    Twenty-FiveGigE2/0/1 Interface       </span><span class="token comment" style=color:#8292a2;font-style:italic># 端口描述</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">    TTL:          </span><span class="token number" style=color:#ae81ff>121</span><span class="token plain">                                   </span><span class="token comment" style=color:#8292a2;font-style:italic># 存活时间（秒），LLDP信息有效期</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">    MFS:          </span><span class="token number" style=color:#ae81ff>9416</span><span class="token plain">                                  </span><span class="token comment" style=color:#8292a2;font-style:italic># 最大帧大小（字节），支持Jumbo Frame</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">    PMD autoneg:  supported: yes, enabled: </span><span class="token function" style=color:#e6db74>yes</span><span class="token plain">         </span><span class="token comment" style=color:#8292a2;font-style:italic># 物理介质相关（PMD）自动协商，已支持并启用</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">      MAU oper type: 25GbaseSR - 25GBASE-R PCS/PMA over multimode fiber  </span><span class="token comment" style=color:#8292a2;font-style:italic># 介质连接单元类型，25G短距多模光纤</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">    MDI Power:    supported: no, enabled: no, pair control: no  </span><span class="token comment" style=color:#8292a2;font-style:italic># 介质相关接口供电（PoE），不支持</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">      Device type:  PD                                  </span><span class="token comment" style=color:#8292a2;font-style:italic># 设备类型：受电设备（Powered Device）</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">      Power pairs:  signal                              </span><span class="token comment" style=color:#8292a2;font-style:italic># 供电线对：信号线对</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">      Class:        class </span><span class="token number" style=color:#ae81ff>0</span><span class="token plain">                             </span><span class="token comment" style=color:#8292a2;font-style:italic># 功率等级：0级（不使用PoE）</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">  VLAN:         </span><span class="token number" style=color:#ae81ff>900</span><span class="token plain">, pvid: </span><span class="token function" style=color:#e6db74>yes</span><span class="token plain">                          </span><span class="token comment" style=color:#8292a2;font-style:italic># VLAN ID为900，且为端口VLAN ID（原生VLAN）</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">-------------------------------------------------------------------------------</span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">Interface:    ens64f1np1, via: LLDP, RID: </span><span class="token number" style=color:#ae81ff>1</span><span class="token plain">, Time: </span><span class="token number" style=color:#ae81ff>0</span><span class="token plain"> day, 00:00:18  </span><span class="token comment" style=color:#8292a2;font-style:italic># 第二个网络接口</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">  Chassis:     </span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">    ChassisID:    mac ec:cd:4c:e3:09:9c                </span><span class="token comment" style=color:#8292a2;font-style:italic># 同一台交换机（相同MAC地址）</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">    SysName:      DCXNYD-DMXCS-LEAF21_D1F2-D207-A09-U45-U43</span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">    SysDescr:     H3C Comware Platform Software, Software Version </span><span class="token number" style=color:#ae81ff>7.1</span><span class="token plain">.070, Release </span><span class="token number" style=color:#ae81ff>6715</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">                  H3C S6850-56HF</span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">                  Copyright </span><span class="token punctuation" style=color:#f8f8f2>(</span><span class="token plain">c</span><span class="token punctuation" style=color:#f8f8f2>)</span><span class="token plain"> </span><span class="token number" style=color:#ae81ff>2004</span><span class="token plain">-2024 New H3C Technologies Co., Ltd. All rights reserved.</span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">    MgmtIP:       </span><span class="token number" style=color:#ae81ff>10.112</span><span class="token plain">.30.254</span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">    MgmtIface:    </span><span class="token number" style=color:#ae81ff>2153</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">    Capability:   Bridge, on</span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">    Capability:   Router, on</span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">  Port:        </span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">    PortID:       ifname Twenty-FiveGigE1/0/1          </span><span class="token comment" style=color:#8292a2;font-style:italic># 连接到交换机的另一个端口（第1模块第0槽位第1端口）</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">    PortDescr:    Twenty-FiveGigE1/0/1 Interface</span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">    TTL:          </span><span class="token number" style=color:#ae81ff>121</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">    MFS:          </span><span class="token number" style=color:#ae81ff>9416</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">    PMD autoneg:  supported: yes, enabled: </span><span class="token function" style=color:#e6db74>yes</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">      MAU oper type: 25GbaseSR - 25GBASE-R PCS/PMA over multimode fiber</span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">    MDI Power:    supported: no, enabled: no, pair control: no</span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">      Device type:  PD</span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">      Power pairs:  signal</span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">      Class:        class </span><span class="token number" style=color:#ae81ff>0</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">  VLAN:         </span><span class="token number" style=color:#ae81ff>900</span><span class="token plain">, pvid: </span><span class="token function" style=color:#e6db74>yes</span><span class="token plain">                          </span><span class="token comment" style=color:#8292a2;font-style:italic># 同样在VLAN 900中</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">-------------------------------------------------------------------------------</span><br></span></code></pre><div class=buttonGroup__atx><button type=button aria-label="Copy code to clipboard" title=Copy class=clean-btn><span class=copyButtonIcons_eSgA aria-hidden=true><svg viewBox="0 0 24 24" class=copyButtonIcon_y97N><path fill=currentColor d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"/></svg><svg viewBox="0 0 24 24" class=copyButtonSuccessIcon_LjdS><path fill=currentColor d=M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z /></svg></span></button></div></div></div></div></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href=/ai/rdma-infiniband-vs-roce><div class=pagination-nav__sublabel>Previous</div><div class=pagination-nav__label>RDMA: InfiniBand vs RoCE</div></a><a class="pagination-nav__link pagination-nav__link--next" href=/ai/nvidia><div class=pagination-nav__sublabel>Next</div><div class=pagination-nav__label>NVIDIA</div></a></nav><div class=docusaurus-mt-lg></div></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href=#常用工具 class="table-of-contents__link toc-highlight">常用工具</a><li><a href=#infiniband class="table-of-contents__link toc-highlight">InfiniBand</a><ul><li><a href=#pci设备信息 class="table-of-contents__link toc-highlight">PCI设备信息</a><li><a href=#pci-nfd标签 class="table-of-contents__link toc-highlight">PCI NFD标签</a><li><a href=#rdma设备信息 class="table-of-contents__link toc-highlight">RDMA设备信息</a><li><a href=#infiniband拓扑信息 class="table-of-contents__link toc-highlight">InfiniBand拓扑信息</a></ul><li><a href=#roce class="table-of-contents__link toc-highlight">RoCE</a><ul><li><a href=#pci设备信息-1 class="table-of-contents__link toc-highlight">PCI设备信息</a><li><a href=#pci-nfd标签-1 class="table-of-contents__link toc-highlight">PCI NFD标签</a><li><a href=#rdma设备信息-1 class="table-of-contents__link toc-highlight">RDMA设备信息</a><li><a href=#ethernet拓扑信息 class="table-of-contents__link toc-highlight">Ethernet拓扑信息</a></ul></ul></div></div></div></div></main></div></div></div><footer class=footer><div class="container container-fluid"><div class="footer__bottom text--center"><div class=footer__copyright>Copyright 2026 johng.cn</div></div></div></footer></div>