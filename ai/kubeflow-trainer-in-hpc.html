<!doctype html><html lang=en dir=ltr class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-docs/AI技术/训练微调/Kubeflow Trainer/Kubeflow Trainer In HPC" data-has-hydrated=false><meta charset=UTF-8><meta name=generator content="Docusaurus v3.6.3"><title data-rh=true>Kubeflow Trainer In HPC | John's Blog</title><meta data-rh=true name=viewport content="width=device-width,initial-scale=1.0"><meta data-rh=true name=twitter:card content=summary_large_image><meta data-rh=true property=og:url content=https://johng.cn/ai/kubeflow-trainer-in-hpc><meta data-rh=true property=og:locale content=en><meta data-rh=true name=docusaurus_locale content=en><meta data-rh=true name=docsearch:language content=en><meta data-rh=true name=author content="John Guo"><meta data-rh=true property=og:image content=https://johng.cn/img/favicon.png><meta data-rh=true name=docusaurus_version content=current><meta data-rh=true name=docusaurus_tag content=docs-default-current><meta data-rh=true name=docsearch:version content=current><meta data-rh=true name=docsearch:docusaurus_tag content=docs-default-current><meta data-rh=true property=og:title content="Kubeflow Trainer In HPC | John's Blog"><meta data-rh=true name=description content="深入介绍Kubeflow Trainer在HPC场景中的应用，包括项目背景、核心架构、支持的框架（PyTorch/DeepSpeed/MPI）、训练任务创建流程、与Volcano调度器的集成方案，以及与Volcano Job的对比分析"><meta data-rh=true property=og:description content="深入介绍Kubeflow Trainer在HPC场景中的应用，包括项目背景、核心架构、支持的框架（PyTorch/DeepSpeed/MPI）、训练任务创建流程、与Volcano调度器的集成方案，以及与Volcano Job的对比分析"><meta data-rh=true name=keywords content="Kubeflow Trainer,Kubeflow,HPC,分布式训练,PyTorch,DeepSpeed,MPI,Gang Scheduling,Volcano,Kubernetes,TrainJob,TrainingRuntime,LLM微调,大模型训练,JobSet,Kueue,机器学习,深度学习,GPU调度,弹性训练"><link data-rh=true rel=icon href=/img/favicon.ico><link data-rh=true rel=canonical href=https://johng.cn/ai/kubeflow-trainer-in-hpc><link data-rh=true rel=alternate href=https://johng.cn/ai/kubeflow-trainer-in-hpc hreflang=en><link data-rh=true rel=alternate href=https://johng.cn/ai/kubeflow-trainer-in-hpc hreflang=x-default><link data-rh=true rel=preconnect href=https://XGS1CPQERK-dsn.algolia.net crossorigin><link rel=alternate type=application/rss+xml href=/blog/rss.xml title="John's Blog RSS Feed"><link rel=alternate type=application/atom+xml href=/blog/atom.xml title="John's Blog Atom Feed"><link rel=search type=application/opensearchdescription+xml title="John's Blog" href=/opensearch.xml><script src=https://hm.baidu.com/hm.js?6b4ae23dc83ee5efe875b7172af6c7c1 async></script><link rel=stylesheet href=/assets/css/styles.2f56d3c4.css><script src=/assets/js/runtime~main.023da4e1.js defer></script><script src=/assets/js/main.2361e6c6.js defer></script><body class=navigation-with-keyboard><script>!function(){var t,e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();t=null!==e?e:"light",document.documentElement.setAttribute("data-theme",t)}(),function(){try{for(var[t,e]of new URLSearchParams(window.location.search).entries())if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id=__docusaurus><div role=region aria-label="Skip to main content"><a class=skipToContent_fXgn href=#__docusaurus_skipToContent_fallback>Skip to main content</a></div><nav aria-label=Main class="navbar navbar--fixed-top"><div class=navbar__inner><div class=navbar__items><button aria-label="Toggle navigation bar" aria-expanded=false class="navbar__toggle clean-btn" type=button><svg width=30 height=30 viewBox="0 0 30 30" aria-hidden=true><path stroke=currentColor stroke-linecap=round stroke-miterlimit=10 stroke-width=2 d="M4 7h22M4 15h22M4 23h22"/></svg></button><a class=navbar__brand href=/><b class="navbar__title text--truncate">John's Blog</b></a><a aria-current=page class="navbar__item navbar__link navbar__link--active" href=/ai>AI技术</a><a class="navbar__item navbar__link" href=/cloud-native>云原生</a><a class="navbar__item navbar__link" href=/notes>日常笔记</a><a class="navbar__item navbar__link" href=/programming>开发语言</a><a class="navbar__item navbar__link" href=/architecture>技术架构</a><a class="navbar__item navbar__link" href=/observability>可观测性</a><a class="navbar__item navbar__link" href=/life>生活笔记</a></div><div class="navbar__items navbar__items--right"><a class="navbar__item navbar__link" href=/aboutme>关于我</a><a class="navbar__item navbar__link" href=/blog>博客</a><a href=https://goframe.org/ target=_blank rel="noopener noreferrer" class="navbar__item navbar__link header-goframe-link"></a><a href=https://github.com/gqcn target=_blank rel="noopener noreferrer" class="navbar__item navbar__link header-github-link"></a><div class=navbarSearchContainer_Bca1><button type=button class="DocSearch DocSearch-Button" aria-label="Search (Command+K)"><span class=DocSearch-Button-Container><svg width=20 height=20 class=DocSearch-Search-Icon viewBox="0 0 20 20" aria-hidden=true><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke=currentColor fill=none fill-rule=evenodd stroke-linecap=round stroke-linejoin=round /></svg><span class=DocSearch-Button-Placeholder>Search</span></span><span class=DocSearch-Button-Keys></span></button></div></div></div><div role=presentation class=navbar-sidebar__backdrop></div></nav><div id=__docusaurus_skipToContent_fallback class="main-wrapper mainWrapper_z2l0"><div class=docsWrapper_hBAB><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type=button></button><div class=docRoot_UBD9><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class=sidebarViewport_aRkj><div class=sidebar_njMd><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class=menu__list-item-collapsible><a class="menu__link menu__link--sublist menu__link--active" href=/ai>AI技术</a><button aria-label="Collapse sidebar category 'AI技术'" aria-expanded=true type=button class="clean-btn menu__caret"></button></div><ul style=display:block;overflow:visible;height:auto class=menu__list><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="menu__link menu__link--sublist" tabindex=0 href=/ai/agents>智能体</a><button aria-label="Expand sidebar category '智能体'" aria-expanded=false type=button class="clean-btn menu__caret"></button></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="menu__link menu__link--sublist" tabindex=0 href=/ai/app>应用开发</a><button aria-label="Expand sidebar category '应用开发'" aria-expanded=false type=button class="clean-btn menu__caret"></button></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="menu__link menu__link--sublist" tabindex=0 href=/ai/inference>推理服务</a><button aria-label="Expand sidebar category '推理服务'" aria-expanded=false type=button class="clean-btn menu__caret"></button></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class=menu__list-item-collapsible><a class="menu__link menu__link--sublist menu__link--active" tabindex=0 href=/ai/training-fine-tuning>训练微调</a><button aria-label="Collapse sidebar category '训练微调'" aria-expanded=true type=button class="clean-btn menu__caret"></button></div><ul style=display:block;overflow:visible;height:auto class=menu__list><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="menu__link menu__link--sublist" tabindex=0 href=/ai/training-platform>开发训练平台</a><button aria-label="Expand sidebar category '开发训练平台'" aria-expanded=false type=button class="clean-btn menu__caret"></button></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item"><div class=menu__list-item-collapsible><a class="menu__link menu__link--sublist menu__link--active" tabindex=0 href=/ai/kubeflow-trainer>Kubeflow Trainer</a><button aria-label="Collapse sidebar category 'Kubeflow Trainer'" aria-expanded=true type=button class="clean-btn menu__caret"></button></div><ul style=display:block;overflow:visible;height:auto class=menu__list><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link menu__link--active" aria-current=page tabindex=0 href=/ai/kubeflow-trainer-in-hpc>Kubeflow Trainer In HPC</a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class=menu__link tabindex=0 href=/ai/kubeflow-trainer-pytorch-parallel-computing>Kubeflow Trainer PyTorch并行计算</a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class=menu__link tabindex=0 href=/ai/kubeflow-trainer-crd-reference>Kubeflow Trainer CRD配置格式详解</a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class=menu__link tabindex=0 href=/ai/kubeflow-trainer-environment-variables>Kubeflow Trainer 环境变量自动注入</a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class=menu__link tabindex=0 href=/ai/kubeflow-trainer-deploy-usage>Kubeflow Trainer 安装、部署及使用</a></ul><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class=menu__link tabindex=0 href=/ai/machine-learning-fundamentals>AI模型与机器学习</a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class=menu__link tabindex=0 href=/ai/training>AI模型训练技术详解</a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class=menu__link tabindex=0 href=/ai/fine-tuning>AI模型微调技术详解</a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class=menu__link tabindex=0 href=/ai/training-parallel-strategies>AI模型训练并行策略介绍</a></ul><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="menu__link menu__link--sublist" tabindex=0 href=/ai/model-development>模型开发</a><button aria-label="Expand sidebar category '模型开发'" aria-expanded=false type=button class="clean-btn menu__caret"></button></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="menu__link menu__link--sublist" tabindex=0 href=/ai/infra>基础架构</a><button aria-label="Expand sidebar category '基础架构'" aria-expanded=false type=button class="clean-btn menu__caret"></button></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="menu__link menu__link--sublist" tabindex=0 href=/ai/basic>入门知识</a><button aria-label="Expand sidebar category '入门知识'" aria-expanded=false type=button class="clean-btn menu__caret"></button></div></ul><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="menu__link menu__link--sublist" href=/cloud-native>云原生</a><button aria-label="Expand sidebar category '云原生'" aria-expanded=false type=button class="clean-btn menu__caret"></button></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="menu__link menu__link--sublist" href=/notes>日常笔记</a><button aria-label="Expand sidebar category '日常笔记'" aria-expanded=false type=button class="clean-btn menu__caret"></button></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="menu__link menu__link--sublist" href=/programming>开发语言</a><button aria-label="Expand sidebar category '开发语言'" aria-expanded=false type=button class="clean-btn menu__caret"></button></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="menu__link menu__link--sublist" href=/architecture>技术架构</a><button aria-label="Expand sidebar category '技术架构'" aria-expanded=false type=button class="clean-btn menu__caret"></button></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="menu__link menu__link--sublist" href=/management>技术管理</a><button aria-label="Expand sidebar category '技术管理'" aria-expanded=false type=button class="clean-btn menu__caret"></button></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="menu__link menu__link--sublist" href=/observability>可观测性</a><button aria-label="Expand sidebar category '可观测性'" aria-expanded=false type=button class="clean-btn menu__caret"></button></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="menu__link menu__link--sublist" href=/database-and-middleware>数据库与中间件</a><button aria-label="Expand sidebar category '数据库与中间件'" aria-expanded=false type=button class="clean-btn menu__caret"></button></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="menu__link menu__link--sublist" href=/operating-systems-and-networks>操作系统和网络</a><button aria-label="Expand sidebar category '操作系统和网络'" aria-expanded=false type=button class="clean-btn menu__caret"></button></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="menu__link menu__link--sublist" href=/life>生活笔记</a><button aria-label="Expand sidebar category '生活笔记'" aria-expanded=false type=button class="clean-btn menu__caret"></button></div></ul></nav></div></div></aside><main class=docMainContainer_TBSr><div class="container padding-top--md padding-bottom--lg"><div class=row><div class="col docItemCol_VOVn"><div class=docItemContainer_Djhp><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label=Breadcrumbs><ul class=breadcrumbs itemscope itemtype=https://schema.org/BreadcrumbList><li class=breadcrumbs__item><a aria-label="Home page" class=breadcrumbs__link href=/><svg viewBox="0 0 24 24" class=breadcrumbHomeIcon_YNFT><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill=currentColor /></svg></a><li itemscope itemprop=itemListElement itemtype=https://schema.org/ListItem class=breadcrumbs__item><a class=breadcrumbs__link itemprop=item href=/ai><span itemprop=name>AI技术</span></a><meta itemprop=position content=1><li itemscope itemprop=itemListElement itemtype=https://schema.org/ListItem class=breadcrumbs__item><a class=breadcrumbs__link itemprop=item href=/ai/training-fine-tuning><span itemprop=name>训练微调</span></a><meta itemprop=position content=2><li itemscope itemprop=itemListElement itemtype=https://schema.org/ListItem class=breadcrumbs__item><a class=breadcrumbs__link itemprop=item href=/ai/kubeflow-trainer><span itemprop=name>Kubeflow Trainer</span></a><meta itemprop=position content=3><li itemscope itemprop=itemListElement itemtype=https://schema.org/ListItem class="breadcrumbs__item breadcrumbs__item--active"><span class=breadcrumbs__link itemprop=name>Kubeflow Trainer In HPC</span><meta itemprop=position content=4></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type=button class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><h2 class="anchor anchorWithStickyNavbar_LWe7" id=kubeflow项目简介>Kubeflow项目简介<a href=#kubeflow项目简介 class=hash-link aria-label="Direct link to Kubeflow项目简介" title="Direct link to Kubeflow项目简介">​</a></h2>
<p><img decoding=async loading=lazy alt=Kubeflow src=/assets/images/image-6c0b22b47237f3ba820da1bbf1b6a5a4.png width=3768 height=1683 class=img_ev3q></p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id=项目背景>项目背景<a href=#项目背景 class=hash-link aria-label="Direct link to 项目背景" title="Direct link to 项目背景">​</a></h3>
<p><a href=https://www.kubeflow.org/ target=_blank rel="noopener noreferrer">Kubeflow</a> 是一个开源的机器学习平台，旨在使机器学习工作流在<code>Kubernetes</code>上的部署变得简单、可移植和可扩展。该项目于2017年由<code>Google</code>发起，现已成为<code>CNCF</code>（云原生计算基金会）的孵化项目。</p>
<p><code>Kubeflow</code>的核心目标是：</p>
<ul>
<li><strong>简化ML工作流</strong>：提供端到端的机器学习工作流管理能力</li>
<li><strong>云原生架构</strong>：充分利用<code>Kubernetes</code>的容器编排能力</li>
<li><strong>框架无关</strong>：支持<code>TensorFlow</code>、<code>PyTorch</code>、<code>MXNet</code>等主流<code>ML</code>框架</li>
<li><strong>可扩展性</strong>：支持从单机到大规模分布式训练的无缝扩展</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id=核心组件>核心组件<a href=#核心组件 class=hash-link aria-label="Direct link to 核心组件" title="Direct link to 核心组件">​</a></h3>
<p><code>Kubeflow</code>生态系统包含多个核心组件：</p>
<table><thead><tr><th>组件<th>功能描述<tbody><tr><td><strong>Kubeflow Trainer</strong><td>分布式训练任务管理，支持<code>PyTorch</code>、<code>MPI</code>等框架<tr><td><strong>Kubeflow Pipelines</strong><td><code>ML</code>工作流编排和自动化<tr><td><strong>Katib</strong><td>超参数调优和神经架构搜索<tr><td><strong>KServe</strong><td>模型推理服务部署<tr><td><strong>Notebooks</strong><td>基于<code>Jupyter</code>的交互式开发环境<tr><td><strong>Model Registry</strong><td>模型版本管理和元数据存储</table>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id=使用者>使用者<a href=#使用者 class=hash-link aria-label="Direct link to 使用者" title="Direct link to 使用者">​</a></h3>
<p><code>Kubeflow</code>已被众多知名企业使用，包括：</p>
<ul>
<li><strong>云服务商</strong>：阿里云、<code>AWS</code>、华为云</li>
<li><strong>科技公司</strong>：腾讯、字节跳动、<code>Cisco</code>、<code>NVIDIA</code></li>
<li><strong>金融机构</strong>：<code>Bloomberg</code>、<code>Ant Group</code></li>
<li><strong>其他企业</strong>：<code>Red Hat</code>、<code>Polyaxon</code>、<code>TuSimple</code>等</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id=kubeflow-trainer详细介绍>Kubeflow Trainer详细介绍<a href=#kubeflow-trainer详细介绍 class=hash-link aria-label="Direct link to Kubeflow Trainer详细介绍" title="Direct link to Kubeflow Trainer详细介绍">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id=项目演进>项目演进<a href=#项目演进 class=hash-link aria-label="Direct link to 项目演进" title="Direct link to 项目演进">​</a></h3>
<p><code>Kubeflow Trainer</code>（原名<code>Training Operator</code>）代表了<code>Kubeflow</code>训练组件的下一代演进，建立在超过七年的<code>Kubernetes ML</code>工作负载运行经验之上。</p>
<p><strong>发展历程：</strong></p>
<ul>
<li><strong>2017年</strong>：<code>Kubeflow</code>项目引入<code>TFJob</code>，用于在<code>Kubernetes</code>上编排<code>TensorFlow</code>训练</li>
<li><strong>2018-2020年</strong>：扩展支持<code>PyTorch</code>、<code>MXNet</code>、<code>MPI</code>、<code>XGBoost</code>等多个<code>ML</code>框架</li>
<li><strong>2021年</strong>：将各个独立的<code>Operator</code>整合为统一的<code>Training Operator v1</code></li>
<li><strong>2025年7月</strong>：正式发布<code>Kubeflow Trainer v2.0</code>，采用全新架构</li>
</ul>
<p><img decoding=async loading=lazy alt="Kubeflow Trainer" src=/assets/images/image-1-ca6de3282096988fa69b209ba4619779.png width=721 height=811 class=img_ev3q></p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id=trainer-v2核心特性>Trainer v2核心特性<a href=#trainer-v2核心特性 class=hash-link aria-label="Direct link to Trainer v2核心特性" title="Direct link to Trainer v2核心特性">​</a></h3>
<p><img decoding=async loading=lazy alt="Kubeflow Trainer" src=/assets/images/image-3fe84e9861e55ef8b71d036955806d2b.png width=3115 height=1421 class=img_ev3q></p>
<p><code>Kubeflow Trainer v2</code>是一个<code>Kubernetes</code>原生项目，专为大语言模型（<code>LLM</code>）微调和可扩展的分布式机器学习模型训练而设计。</p>
<p><strong>主要目标：</strong></p>
<ul>
<li>使<code>AI/ML</code>工作负载更易于大规模管理</li>
<li>提供<code>Pythonic</code>接口进行模型训练</li>
<li>提供最简单、最可扩展的<code>PyTorch</code>分布式训练方案</li>
<li>内置支持大语言模型微调</li>
<li>对<code>AI</code>从业者屏蔽<code>Kubernetes</code>复杂性</li>
<li>整合<code>Kubernetes Batch WG</code>和<code>Kubeflow</code>社区的努力</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id=核心api设计>核心API设计<a href=#核心api设计 class=hash-link aria-label="Direct link to 核心API设计" title="Direct link to 核心API设计">​</a></h3>
<p><code>Kubeflow Trainer v2</code>引入了三个核心<code>CRD</code>：</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id=trainjob>TrainJob<a href=#trainjob class=hash-link aria-label="Direct link to TrainJob" title="Direct link to TrainJob">​</a></h4>
<p><code>TrainJob</code>是面向数据科学家的简化<code>CRD</code>，允许从预部署的训练运行时启动训练和微调任务。</p>
<div class="language-yaml codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#f8f8f2;--prism-background-color:#272822><div class=codeBlockContent_biex><pre tabindex=0 class="prism-code language-yaml codeBlock_bY9V thin-scrollbar" style=color:#f8f8f2;background-color:#272822><code class=codeBlockLines_e6Vv><span class=token-line style=color:#f8f8f2><span class="token key atrule">apiVersion</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"> trainer.kubeflow.org/v1alpha1</span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain"></span><span class="token key atrule">kind</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"> TrainJob</span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain"></span><span class="token key atrule">metadata</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">  </span><span class="token key atrule">name</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"> torch</span><span class="token punctuation" style=color:#f8f8f2>-</span><span class="token plain">ddp</span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">  </span><span class="token key atrule">namespace</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"> tenant</span><span class="token punctuation" style=color:#f8f8f2>-</span><span class="token plain">alpha</span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain"></span><span class="token key atrule">spec</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">  </span><span class="token key atrule">runtimeRef</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">    </span><span class="token key atrule">name</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"> torch</span><span class="token punctuation" style=color:#f8f8f2>-</span><span class="token plain">distributed</span><span class="token punctuation" style=color:#f8f8f2>-</span><span class="token plain">multi</span><span class="token punctuation" style=color:#f8f8f2>-</span><span class="token plain">node</span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">  </span><span class="token key atrule">trainer</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">    </span><span class="token key atrule">image</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"> docker.io/custom</span><span class="token punctuation" style=color:#f8f8f2>-</span><span class="token plain">training</span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">    </span><span class="token key atrule">command</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">      </span><span class="token punctuation" style=color:#f8f8f2>-</span><span class="token plain"> torchrun train.py</span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">    </span><span class="token key atrule">numNodes</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"> </span><span class="token number" style=color:#ae81ff>5</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">    </span><span class="token key atrule">resourcesPerNode</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">      </span><span class="token key atrule">requests</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">        </span><span class="token key atrule">nvidia.com/gpu</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"> </span><span class="token number" style=color:#ae81ff>2</span><br></span></code></pre><div class=buttonGroup__atx><button type=button aria-label="Copy code to clipboard" title=Copy class=clean-btn><span class=copyButtonIcons_eSgA aria-hidden=true><svg viewBox="0 0 24 24" class=copyButtonIcon_y97N><path fill=currentColor d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"/></svg><svg viewBox="0 0 24 24" class=copyButtonSuccessIcon_LjdS><path fill=currentColor d=M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z /></svg></span></button></div></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id=trainingruntime--clustertrainingruntime>TrainingRuntime / ClusterTrainingRuntime<a href=#trainingruntime--clustertrainingruntime class=hash-link aria-label="Direct link to TrainingRuntime / ClusterTrainingRuntime" title="Direct link to TrainingRuntime / ClusterTrainingRuntime">​</a></h4>
<p><code>TrainingRuntime</code>和<code>ClusterTrainingRuntime</code>是由平台工程师管理的训练蓝图，定义了如何启动各种类型的训练或微调任务。</p>
<div class="language-yaml codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#f8f8f2;--prism-background-color:#272822><div class=codeBlockContent_biex><pre tabindex=0 class="prism-code language-yaml codeBlock_bY9V thin-scrollbar" style=color:#f8f8f2;background-color:#272822><code class=codeBlockLines_e6Vv><span class=token-line style=color:#f8f8f2><span class="token key atrule">apiVersion</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"> trainer.kubeflow.org/v1alpha1</span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain"></span><span class="token key atrule">kind</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"> ClusterTrainingRuntime</span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain"></span><span class="token key atrule">metadata</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">  </span><span class="token key atrule">name</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"> torch</span><span class="token punctuation" style=color:#f8f8f2>-</span><span class="token plain">distributed</span><span class="token punctuation" style=color:#f8f8f2>-</span><span class="token plain">multi</span><span class="token punctuation" style=color:#f8f8f2>-</span><span class="token plain">node</span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain"></span><span class="token key atrule">spec</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">  </span><span class="token key atrule">mlPolicy</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">    </span><span class="token key atrule">numNodes</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"> </span><span class="token number" style=color:#ae81ff>2</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">    </span><span class="token key atrule">torch</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">      </span><span class="token key atrule">numProcPerNode</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"> </span><span class="token number" style=color:#ae81ff>5</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">  </span><span class="token key atrule">template</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">    </span><span class="token key atrule">spec</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">      </span><span class="token key atrule">replicatedJobs</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">        </span><span class="token punctuation" style=color:#f8f8f2>-</span><span class="token plain"> </span><span class="token key atrule">name</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"> node</span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">          </span><span class="token key atrule">template</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">            </span><span class="token key atrule">spec</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">              </span><span class="token key atrule">template</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">                </span><span class="token key atrule">metadata</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">                  </span><span class="token key atrule">labels</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">                    </span><span class="token key atrule">trainer.kubeflow.org/trainjob-ancestor-step</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"> trainer</span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">                </span><span class="token key atrule">spec</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">                  </span><span class="token key atrule">containers</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">                    </span><span class="token punctuation" style=color:#f8f8f2>-</span><span class="token plain"> </span><span class="token key atrule">name</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"> node</span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">                      </span><span class="token key atrule">image</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"> docker.io/kubeflow/pytorch</span><span class="token punctuation" style=color:#f8f8f2>-</span><span class="token plain">mnist</span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">                      </span><span class="token key atrule">env</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">                        </span><span class="token punctuation" style=color:#f8f8f2>-</span><span class="token plain"> </span><span class="token key atrule">name</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"> MASTER_ADDR</span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">                          </span><span class="token key atrule">value</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"> </span><span class="token string" style=color:#a6e22e>"pytorch-node-0-0.pytorch"</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">                        </span><span class="token punctuation" style=color:#f8f8f2>-</span><span class="token plain"> </span><span class="token key atrule">name</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"> MASTER_PORT</span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">                          </span><span class="token key atrule">value</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"> </span><span class="token string" style=color:#a6e22e>"29400"</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">                      </span><span class="token key atrule">command</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">                        </span><span class="token punctuation" style=color:#f8f8f2>-</span><span class="token plain"> torchrun train.py</span><br></span></code></pre><div class=buttonGroup__atx><button type=button aria-label="Copy code to clipboard" title=Copy class=clean-btn><span class=copyButtonIcons_eSgA aria-hidden=true><svg viewBox="0 0 24 24" class=copyButtonIcon_y97N><path fill=currentColor d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"/></svg><svg viewBox="0 0 24 24" class=copyButtonSuccessIcon_LjdS><path fill=currentColor d=M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z /></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id=用户角色分离>用户角色分离<a href=#用户角色分离 class=hash-link aria-label="Direct link to 用户角色分离" title="Direct link to 用户角色分离">​</a></h3>
<p><code>Kubeflow Trainer v2</code>采用了清晰的用户角色分离设计：</p>
<table><thead><tr><th>角色<th>职责<th>技能要求<tbody><tr><td><strong>DevOps工程师</strong><td>管理<code>Kubernetes</code>工作负载<td>熟悉<code>Kubernetes</code>概念<tr><td><strong>MLOps工程师</strong><td>配置分布式训练参数（如<code>PyTorch rendezvous</code>、<code>MPI</code>配置）<td>熟悉ML框架<tr><td><strong>数据科学家/ML工程师</strong><td>创建模型架构和<code>ML</code>算法<td>熟悉<code>torch.nn API</code>，使用<code>Python</code></table>
<p>这种设计使得：</p>
<ul>
<li><strong>数据科学家</strong>（<code>AI Practitioners</code>）：只需创建简单的<code>TrainJob</code>，无需理解复杂的<code>Kubernetes API</code>。</li>
<li><strong>平台工程师</strong>（<code>Platform Admins</code>）：负责创建和维护<code>TrainingRuntime</code>，配置基础设施参数。</li>
</ul>
<p><img decoding=async loading=lazy alt="Kubeflow Trainer" src=/assets/images/image-2-af706c798783991c0e9b6819e0d8c1c0.png width=1174 height=1030 class=img_ev3q></p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id=hpc训练场景技术挑战与解决方案>HPC训练场景技术挑战与解决方案<a href=#hpc训练场景技术挑战与解决方案 class=hash-link aria-label="Direct link to HPC训练场景技术挑战与解决方案" title="Direct link to HPC训练场景技术挑战与解决方案">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id=常见技术挑战>常见技术挑战<a href=#常见技术挑战 class=hash-link aria-label="Direct link to 常见技术挑战" title="Direct link to 常见技术挑战">​</a></h3>
<p>在<code>HPC</code>（高性能计算）训练场景中，存在以下常见技术挑战：</p>
<table><thead><tr><th>挑战<th>描述<th>影响<tbody><tr><td><strong>分布式协调复杂</strong><td>多节点、多<code>GPU</code>训练需要复杂的进程协调和通信配置<td>配置错误导致训练失败<tr><td><strong>资源碎片化</strong><td><code>GPU</code>资源分散在不同节点，大规模训练任务无法调度<td>资源利用率低下<tr><td><strong>Gang调度缺失</strong><td><code>Kubernetes</code>默认调度器不支持"全或无"调度<td>部分<code>Pod</code>调度导致资源浪费<tr><td><strong>容错机制不足</strong><td>长时间训练任务缺乏检查点和恢复机制<td>节点故障导致训练从头开始<tr><td><strong>数据加载瓶颈</strong><td>每个训练<code>Pod</code>独立下载大型模型和数据集<td>网络拥塞，<code>GPU</code>空闲等待<tr><td><strong>环境配置复杂</strong><td>不同框架需要不同的环境变量和启动命令<td>配置繁琐，易出错<tr><td><strong>多租户隔离</strong><td>多团队共享集群资源时缺乏有效隔离<td>资源竞争，优先级混乱</table>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id=kubeflow-trainer解决方案>Kubeflow Trainer解决方案<a href=#kubeflow-trainer解决方案 class=hash-link aria-label="Direct link to Kubeflow Trainer解决方案" title="Direct link to Kubeflow Trainer解决方案">​</a></h3>
<p><code>Kubeflow Trainer</code>针对上述挑战提供了系统性的解决方案：</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id=简化分布式训练配置>简化分布式训练配置<a href=#简化分布式训练配置 class=hash-link aria-label="Direct link to 简化分布式训练配置" title="Direct link to 简化分�布式训练配置">​</a></h4>
<p><strong>问题</strong>：配置<code>torchrun</code>、<code>MPI</code>等分布式训练参数复杂且易出错。</p>
<p><strong>解决方案</strong>：</p>
<ul>
<li>自动注入<code>MASTER_ADDR</code>、<code>MASTER_PORT</code>等环境变量</li>
<li>自动计算<code>--nnodes</code>和<code>--nproc-per-node</code>参数</li>
<li>提供预配置的<code>ClusterTrainingRuntime</code>蓝图</li>
</ul>
<div class="language-yaml codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#f8f8f2;--prism-background-color:#272822><div class=codeBlockContent_biex><pre tabindex=0 class="prism-code language-yaml codeBlock_bY9V thin-scrollbar" style=color:#f8f8f2;background-color:#272822><code class=codeBlockLines_e6Vv><span class=token-line style=color:#f8f8f2><span class="token comment" style=color:#8292a2;font-style:italic># 用户只需指定简单参数</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain"></span><span class="token key atrule">spec</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">  </span><span class="token key atrule">trainer</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">    </span><span class="token key atrule">numNodes</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"> </span><span class="token number" style=color:#ae81ff>5</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">    </span><span class="token key atrule">resourcesPerNode</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">      </span><span class="token key atrule">requests</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">        </span><span class="token key atrule">nvidia.com/gpu</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"> </span><span class="token number" style=color:#ae81ff>2</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain"></span><span class="token comment" style=color:#8292a2;font-style:italic># Trainer自动转换为：torchrun --nnodes=5 --nproc-per-node=2 train.py</span><br></span></code></pre><div class=buttonGroup__atx><button type=button aria-label="Copy code to clipboard" title=Copy class=clean-btn><span class=copyButtonIcons_eSgA aria-hidden=true><svg viewBox="0 0 24 24" class=copyButtonIcon_y97N><path fill=currentColor d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"/></svg><svg viewBox="0 0 24 24" class=copyButtonSuccessIcon_LjdS><path fill=currentColor d=M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z /></svg></span></button></div></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id=gang调度支持>Gang调度支持<a href=#gang调度支持 class=hash-link aria-label="Direct link to Gang调度支持" title="Direct link to Gang调度支持">​</a></h4>
<p><strong>问题</strong>：分布式训练需要所有<code>Pod</code>同时启动，否则会造成资源浪费。</p>
<p><strong>解决方案</strong>：</p>
<ul>
<li>内置<code>PodGroupPolicy API</code>支持<code>Gang</code>调度</li>
<li>支持<code>Coscheduling</code>、<code>Volcano</code>、<code>KAI Scheduler</code>等多种调度器</li>
<li>自动创建<code>PodGroup</code>资源确保原子性调度</li>
</ul>
<div class="language-yaml codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#f8f8f2;--prism-background-color:#272822><div class=codeBlockContent_biex><pre tabindex=0 class="prism-code language-yaml codeBlock_bY9V thin-scrollbar" style=color:#f8f8f2;background-color:#272822><code class=codeBlockLines_e6Vv><span class=token-line style=color:#f8f8f2><span class="token key atrule">spec</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">  </span><span class="token key atrule">podGroupPolicy</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">    </span><span class="token key atrule">coscheduling</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">      </span><span class="token key atrule">scheduleTimeoutSeconds</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"> </span><span class="token number" style=color:#ae81ff>120</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">    </span><span class="token comment" style=color:#8292a2;font-style:italic># 或使用Volcano</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">    </span><span class="token comment" style=color:#8292a2;font-style:italic># volcano: {}</span><br></span></code></pre><div class=buttonGroup__atx><button type=button aria-label="Copy code to clipboard" title=Copy class=clean-btn><span class=copyButtonIcons_eSgA aria-hidden=true><svg viewBox="0 0 24 24" class=copyButtonIcon_y97N><path fill=currentColor d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"/></svg><svg viewBox="0 0 24 24" class=copyButtonSuccessIcon_LjdS><path fill=currentColor d=M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z /></svg></span></button></div></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id=数据集和模型初始化器>数据集和模型初始化器<a href=#数据集和模型初始化器 class=hash-link aria-label="Direct link to 数据集和模型初始化器" title="Direct link to 数据集和模型初始化器">​</a></h4>
<p><strong>问题</strong>：每个训练<code>Pod</code>独立下载数据会造成网络瓶颈和<code>GPU</code>空闲。</p>
<p><strong>解决方案</strong>：</p>
<ul>
<li>提供专用的<code>Dataset Initializer</code>和<code>Model Initializer</code></li>
<li>数据下载一次，通过共享卷分发给所有训练节点</li>
<li>将数据加载任务卸载到<code>CPU</code>节点，节省<code>GPU</code>资源</li>
</ul>
<div class="language-yaml codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#f8f8f2;--prism-background-color:#272822><div class=codeBlockContent_biex><pre tabindex=0 class="prism-code language-yaml codeBlock_bY9V thin-scrollbar" style=color:#f8f8f2;background-color:#272822><code class=codeBlockLines_e6Vv><span class=token-line style=color:#f8f8f2><span class="token key atrule">spec</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">  </span><span class="token key atrule">initializer</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">    </span><span class="token key atrule">dataset</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">      </span><span class="token key atrule">storageUri</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"> hf</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain">//tatsu</span><span class="token punctuation" style=color:#f8f8f2>-</span><span class="token plain">lab/alpaca</span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">    </span><span class="token key atrule">model</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">      </span><span class="token key atrule">storageUri</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"> hf</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain">//meta</span><span class="token punctuation" style=color:#f8f8f2>-</span><span class="token plain">llama/Llama</span><span class="token punctuation" style=color:#f8f8f2>-</span><span class="token plain">2</span><span class="token punctuation" style=color:#f8f8f2>-</span><span class="token plain">7b</span><br></span></code></pre><div class=buttonGroup__atx><button type=button aria-label="Copy code to clipboard" title=Copy class=clean-btn><span class=copyButtonIcons_eSgA aria-hidden=true><svg viewBox="0 0 24 24" class=copyButtonIcon_y97N><path fill=currentColor d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"/></svg><svg viewBox="0 0 24 24" class=copyButtonSuccessIcon_LjdS><path fill=currentColor d=M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z /></svg></span></button></div></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id=容错与恢复>容错与恢复<a href=#容错与恢复 class=hash-link aria-label="Direct link to 容错与恢复" title="Direct link to 容错与恢复">​</a></h4>
<p><strong>问题</strong>：长时间训练任务在节点故障时需要从头开始。</p>
<p><strong>解决方案</strong>：</p>
<ul>
<li>支持<code>Kubernetes PodFailurePolicy</code></li>
<li>定义不同类型故障的处理规则</li>
<li>支持<code>PyTorch Elastic</code>弹性训练</li>
</ul>
<div class="language-yaml codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#f8f8f2;--prism-background-color:#272822><div class=codeBlockContent_biex><pre tabindex=0 class="prism-code language-yaml codeBlock_bY9V thin-scrollbar" style=color:#f8f8f2;background-color:#272822><code class=codeBlockLines_e6Vv><span class=token-line style=color:#f8f8f2><span class="token key atrule">spec</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">  </span><span class="token key atrule">mlPolicy</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">    </span><span class="token key atrule">torch</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">      </span><span class="token key atrule">elasticPolicy</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">        </span><span class="token key atrule">maxRestarts</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"> </span><span class="token number" style=color:#ae81ff>3</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">        </span><span class="token key atrule">minNodes</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"> </span><span class="token number" style=color:#ae81ff>5</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">        </span><span class="token key atrule">maxNodes</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"> </span><span class="token number" style=color:#ae81ff>10</span><br></span></code></pre><div class=buttonGroup__atx><button type=button aria-label="Copy code to clipboard" title=Copy class=clean-btn><span class=copyButtonIcons_eSgA aria-hidden=true><svg viewBox="0 0 24 24" class=copyButtonIcon_y97N><path fill=currentColor d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"/></svg><svg viewBox="0 0 24 24" class=copyButtonSuccessIcon_LjdS><path fill=currentColor d=M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z /></svg></span></button></div></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id=llm微调内置支持>LLM微调内置支持<a href=#llm微调内置支持 class=hash-link aria-label="Direct link to LLM微调内置支持" title="Direct link to LLM微调内置支持">​</a></h4>
<p><strong>问题</strong>：大语言模型微调需要复杂的配置和专业知识。</p>
<p><strong>解决方案</strong>：</p>
<ul>
<li>提供<code>BuiltinTrainer</code>内置训练器（如<code>TorchTune</code>）</li>
<li>预配置的<code>LLM</code>微调<code>Runtime</code>（<code>Llama</code>、<code>Gemma</code>等）</li>
<li>支持<code>LoRA</code>、<code>QLoRA</code>等参数高效微调方法</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id=支持的框架>支持的框架<a href=#支持的框架 class=hash-link aria-label="Direct link to 支持的框架" title="Direct link to 支持的框架">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id=pytorch>PyTorch<a href=#pytorch class=hash-link aria-label="Direct link to PyTorch" title="Direct link to PyTorch">​</a></h3>
<p><code>Kubeflow Trainer</code>对<code>PyTorch</code>提供最全面的支持，包括：</p>
<table><thead><tr><th>训练模式<th>描述<th>适用场景<tbody><tr><td><strong>单机单卡</strong><td>基础训练模式<td>小规模模型开发调试<tr><td><strong>单机多卡</strong><td>单节点多<code>GPU</code>并行<td>中等规模模型训练<tr><td><strong>多机多卡</strong><td>分布式数据并行（<code>DDP</code>）<td>大规模模型训练<tr><td><strong>弹性训练</strong><td><code>PyTorch Elastic</code><td>动态扩缩容场景</table>
<p><strong>PyTorch分布式训练示例：</strong></p>
<div class="language-yaml codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#f8f8f2;--prism-background-color:#272822><div class=codeBlockContent_biex><pre tabindex=0 class="prism-code language-yaml codeBlock_bY9V thin-scrollbar" style=color:#f8f8f2;background-color:#272822><code class=codeBlockLines_e6Vv><span class=token-line style=color:#f8f8f2><span class="token key atrule">apiVersion</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"> trainer.kubeflow.org/v1alpha1</span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain"></span><span class="token key atrule">kind</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"> ClusterTrainingRuntime</span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain"></span><span class="token key atrule">metadata</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">  </span><span class="token key atrule">name</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"> torch</span><span class="token punctuation" style=color:#f8f8f2>-</span><span class="token plain">distributed</span><span class="token punctuation" style=color:#f8f8f2>-</span><span class="token plain">multi</span><span class="token punctuation" style=color:#f8f8f2>-</span><span class="token plain">node</span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain"></span><span class="token key atrule">spec</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">  </span><span class="token key atrule">mlPolicy</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">    </span><span class="token key atrule">numNodes</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"> </span><span class="token number" style=color:#ae81ff>2</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">    </span><span class="token key atrule">torch</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">      </span><span class="token key atrule">numProcPerNode</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"> </span><span class="token string" style=color:#a6e22e>"auto"</span><span class="token plain">  </span><span class="token comment" style=color:#8292a2;font-style:italic># 支持auto、cpu、gpu或具体数值</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">  </span><span class="token key atrule">template</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">    </span><span class="token key atrule">spec</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">      </span><span class="token key atrule">replicatedJobs</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">        </span><span class="token punctuation" style=color:#f8f8f2>-</span><span class="token plain"> </span><span class="token key atrule">name</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"> node</span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">          </span><span class="token key atrule">template</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">            </span><span class="token key atrule">spec</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">              </span><span class="token key atrule">template</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">                </span><span class="token key atrule">metadata</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">                  </span><span class="token key atrule">labels</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">                    </span><span class="token key atrule">trainer.kubeflow.org/trainjob-ancestor-step</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"> trainer</span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">                </span><span class="token key atrule">spec</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">                  </span><span class="token key atrule">containers</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">                    </span><span class="token punctuation" style=color:#f8f8f2>-</span><span class="token plain"> </span><span class="token key atrule">name</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"> node</span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">                      </span><span class="token key atrule">image</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"> docker.io/kubeflow/pytorch</span><span class="token punctuation" style=color:#f8f8f2>-</span><span class="token plain">mnist</span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">                      </span><span class="token key atrule">resources</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">                        </span><span class="token key atrule">limits</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">                          </span><span class="token key atrule">nvidia.com/gpu</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"> </span><span class="token number" style=color:#ae81ff>4</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">                      </span><span class="token key atrule">command</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">                        </span><span class="token punctuation" style=color:#f8f8f2>-</span><span class="token plain"> torchrun train.py</span><br></span></code></pre><div class=buttonGroup__atx><button type=button aria-label="Copy code to clipboard" title=Copy class=clean-btn><span class=copyButtonIcons_eSgA aria-hidden=true><svg viewBox="0 0 24 24" class=copyButtonIcon_y97N><path fill=currentColor d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"/></svg><svg viewBox="0 0 24 24" class=copyButtonSuccessIcon_LjdS><path fill=currentColor d=M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z /></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id=deepspeed>DeepSpeed<a href=#deepspeed class=hash-link aria-label="Direct link to DeepSpeed" title="Direct link to DeepSpeed">​</a></h3>
<p><code>DeepSpeed</code>是微软开发的深度学习优化库，<code>Kubeflow Trainer</code>通过<code>MPI Runtime</code>提供支持：</p>
<p><strong>核心特性：</strong></p>
<ul>
<li><code>ZeRO</code>优化器（<code>ZeRO-1/2/3</code>）</li>
<li>混合精度训练</li>
<li>梯度累积</li>
<li>模型并行</li>
</ul>
<p><strong>DeepSpeed训练示例：</strong></p>
<div class="language-yaml codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#f8f8f2;--prism-background-color:#272822><div class=codeBlockContent_biex><pre tabindex=0 class="prism-code language-yaml codeBlock_bY9V thin-scrollbar" style=color:#f8f8f2;background-color:#272822><code class=codeBlockLines_e6Vv><span class=token-line style=color:#f8f8f2><span class="token key atrule">apiVersion</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"> trainer.kubeflow.org/v1alpha1</span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain"></span><span class="token key atrule">kind</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"> ClusterTrainingRuntime</span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain"></span><span class="token key atrule">metadata</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">  </span><span class="token key atrule">name</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"> deepspeed</span><span class="token punctuation" style=color:#f8f8f2>-</span><span class="token plain">training</span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain"></span><span class="token key atrule">spec</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">  </span><span class="token key atrule">mlPolicy</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">    </span><span class="token key atrule">numNodes</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"> </span><span class="token number" style=color:#ae81ff>2</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">    </span><span class="token key atrule">mpi</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">      </span><span class="token key atrule">mpiImplementation</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"> OpenMPI</span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">      </span><span class="token key atrule">numProcPerNode</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"> </span><span class="token number" style=color:#ae81ff>4</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">  </span><span class="token key atrule">template</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">    </span><span class="token key atrule">spec</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">      </span><span class="token key atrule">replicatedJobs</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">        </span><span class="token punctuation" style=color:#f8f8f2>-</span><span class="token plain"> </span><span class="token key atrule">name</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"> launcher</span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">          </span><span class="token key atrule">template</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">            </span><span class="token key atrule">spec</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">              </span><span class="token key atrule">template</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">                </span><span class="token key atrule">metadata</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">                  </span><span class="token key atrule">labels</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">                    </span><span class="token key atrule">trainer.kubeflow.org/trainjob-ancestor-step</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"> trainer</span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">                </span><span class="token key atrule">spec</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">                  </span><span class="token key atrule">containers</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">                    </span><span class="token punctuation" style=color:#f8f8f2>-</span><span class="token plain"> </span><span class="token key atrule">name</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"> launcher</span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">                      </span><span class="token key atrule">image</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"> docker.io/deepspeed</span><span class="token punctuation" style=color:#f8f8f2>-</span><span class="token plain">launcher</span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">                      </span><span class="token key atrule">command</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">                        </span><span class="token punctuation" style=color:#f8f8f2>-</span><span class="token plain"> deepspeed</span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">                        </span><span class="token punctuation" style=color:#f8f8f2>-</span><span class="token plain"> </span><span class="token punctuation" style=color:#f8f8f2>-</span><span class="token punctuation" style=color:#f8f8f2>-</span><span class="token plain">num_nodes=2</span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">                        </span><span class="token punctuation" style=color:#f8f8f2>-</span><span class="token plain"> </span><span class="token punctuation" style=color:#f8f8f2>-</span><span class="token punctuation" style=color:#f8f8f2>-</span><span class="token plain">num_gpus=4</span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">                        </span><span class="token punctuation" style=color:#f8f8f2>-</span><span class="token plain"> train.py</span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">        </span><span class="token punctuation" style=color:#f8f8f2>-</span><span class="token plain"> </span><span class="token key atrule">name</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"> node</span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">          </span><span class="token key atrule">template</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">            </span><span class="token key atrule">spec</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">              </span><span class="token key atrule">template</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">                </span><span class="token key atrule">metadata</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">                  </span><span class="token key atrule">labels</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">                    </span><span class="token key atrule">trainer.kubeflow.org/trainjob-ancestor-step</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"> trainer</span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">                </span><span class="token key atrule">spec</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">                  </span><span class="token key atrule">containers</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">                    </span><span class="token punctuation" style=color:#f8f8f2>-</span><span class="token plain"> </span><span class="token key atrule">name</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"> node</span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">                      </span><span class="token key atrule">image</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"> docker.io/deepspeed</span><span class="token punctuation" style=color:#f8f8f2>-</span><span class="token plain">trainer</span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">                      </span><span class="token key atrule">resources</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">                        </span><span class="token key atrule">limits</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">                          </span><span class="token key atrule">nvidia.com/gpu</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"> </span><span class="token number" style=color:#ae81ff>4</span><br></span></code></pre><div class=buttonGroup__atx><button type=button aria-label="Copy code to clipboard" title=Copy class=clean-btn><span class=copyButtonIcons_eSgA aria-hidden=true><svg viewBox="0 0 24 24" class=copyButtonIcon_y97N><path fill=currentColor d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"/></svg><svg viewBox="0 0 24 24" class=copyButtonSuccessIcon_LjdS><path fill=currentColor d=M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z /></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id=mpi>MPI<a href=#mpi class=hash-link aria-label="Direct link to MPI" title="Direct link to MPI">​</a></h3>
<p><code>MPI</code>（<code>Message Passing Interface</code>）是<code>HPC</code>领域的标准通信协议，<code>Kubeflow Trainer</code>提供完整的<code>MPI v2</code>支持：</p>
<p><strong>支持的MPI实现：</strong></p>
<ul>
<li><code>OpenMPI</code></li>
<li><code>Intel MPI</code></li>
<li><code>MPICH</code></li>
</ul>
<p><strong>MPI Runtime特性：</strong></p>
<ul>
<li>自动生成<code>SSH</code>密钥用于节点间安全通信</li>
<li>自动创建<code>hostfile</code>配置</li>
<li>支持<code>slot</code>配置</li>
</ul>
<div class="language-yaml codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#f8f8f2;--prism-background-color:#272822><div class=codeBlockContent_biex><pre tabindex=0 class="prism-code language-yaml codeBlock_bY9V thin-scrollbar" style=color:#f8f8f2;background-color:#272822><code class=codeBlockLines_e6Vv><span class=token-line style=color:#f8f8f2><span class="token key atrule">apiVersion</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"> trainer.kubeflow.org/v1alpha1</span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain"></span><span class="token key atrule">kind</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"> ClusterTrainingRuntime</span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain"></span><span class="token key atrule">metadata</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">  </span><span class="token key atrule">name</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"> mpi</span><span class="token punctuation" style=color:#f8f8f2>-</span><span class="token plain">training</span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain"></span><span class="token key atrule">spec</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">  </span><span class="token key atrule">mlPolicy</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">    </span><span class="token key atrule">numNodes</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"> </span><span class="token number" style=color:#ae81ff>4</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">    </span><span class="token key atrule">mpi</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">      </span><span class="token key atrule">mpiImplementation</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"> OpenMPI</span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">      </span><span class="token key atrule">numProcPerNode</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"> </span><span class="token number" style=color:#ae81ff>8</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">      </span><span class="token key atrule">sshAuthMountPath</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"> /root/.ssh</span><br></span></code></pre><div class=buttonGroup__atx><button type=button aria-label="Copy code to clipboard" title=Copy class=clean-btn><span class=copyButtonIcons_eSgA aria-hidden=true><svg viewBox="0 0 24 24" class=copyButtonIcon_y97N><path fill=currentColor d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"/></svg><svg viewBox="0 0 24 24" class=copyButtonSuccessIcon_LjdS><path fill=currentColor d=M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z /></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id=其他框架支持>其他框架支持<a href=#其他框架支持 class=hash-link aria-label="Direct link to 其他框架支持" title="Direct link to 其他框架支持">​</a></h3>
<table><thead><tr><th>框架<th>状态<th>说明<tbody><tr><td><strong>JAX</strong><td>路线图中<td>分布式<code>JAX</code>训练，已有<code>KEP</code>提案（<a href=https://github.com/kubeflow/trainer/issues/2442 target=_blank rel="noopener noreferrer">#2442</a>）<tr><td><strong>MLX</strong><td>路线图中<td><code>Apple Silicon</code>优化的<code>ML</code>框架（<a href=https://github.com/kubeflow/trainer/issues/2047 target=_blank rel="noopener noreferrer">#2047</a>）<tr><td><strong>TensorFlow</strong><td>待实现<td><code>PyTorch</code>实现完成后添加<tr><td><strong>XGBoost</strong><td>待实现<td><code>PyTorch</code>实现完成后添加<tr><td><strong>PaddlePaddle</strong><td>待实现<td><code>PyTorch</code>实现完成后添加</table>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id=llm微调框架>LLM微调框架<a href=#llm微调框架 class=hash-link aria-label="Direct link to LLM微调框架" title="Direct link to LLM微调框架">​</a></h3>
<p><code>Kubeflow Trainer v2</code>内置支持多种<code>LLM</code>微调框架：</p>
<table><thead><tr><th>框架<th>描述<th>状态<tbody><tr><td><strong>TorchTune</strong><td><code>PyTorch</code>官方<code>LLM</code>微调库<td>已支持<tr><td><strong>HuggingFace TRL</strong><td><code>Transformer</code>强化学习库<td>计划中<tr><td><strong>Unsloth</strong><td>高效<code>LLM</code>微调库<td>计划中<tr><td><strong>LLaMA-Factory</strong><td>一站式<code>LLM</code>微调框架<td>计划中</table>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id=训练任务创建流程>训练任务创建流程<a href=#训练任务创建流程 class=hash-link aria-label="Direct link to 训练任务创建流程" title="Direct link to 训练任务创建流程">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id=整体架构>整体架构<a href=#整体架构 class=hash-link aria-label="Direct link to 整体架构" title="Direct link to 整体架构">​</a></h3>
<!-- -->
<h3 class="anchor anchorWithStickyNavbar_LWe7" id=详细创建流程>详细创建流程<a href=#详细创建流程 class=hash-link aria-label="Direct link to 详细创建流程" title="Direct link to 详细创建流程">​</a></h3>
<!-- -->
<h3 class="anchor anchorWithStickyNavbar_LWe7" id=pipeline-framework详解>Pipeline Framework详解<a href=#pipeline-framework详解 class=hash-link aria-label="Direct link to Pipeline Framework详解" title="Direct link to Pipeline Framework详解">​</a></h3>
<p><code>Kubeflow Trainer v2</code>引入了<code>Pipeline Framework</code>作为内部扩展机制，包含四个阶段：</p>
<table><thead><tr><th>阶段<th>功能<th>扩展点<tbody><tr><td><strong>Startup Phase</strong><td>控制器启动时初始化<td><code>WatchExtension</code><tr><td><strong>PreExecution Phase</strong><td><code>Webhook</code>验证<td><code>CustomValidation</code><tr><td><strong>Build Phase</strong><td>构建和部署资源<td><code>EnforcePodGroupPolicy</code>, <code>EnforceMLPolicy</code>, <code>ComponentBuilder</code><tr><td><strong>PostExecution Phase</strong><td>状态更新<td><code>TerminalCondition</code></table>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id=volcano调度器集成>Volcano调度器集成<a href=#volcano调度器集成 class=hash-link aria-label="Direct link to Volcano调度器集成" title="Direct link to Volcano调度器集成">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id=为什么需要volcano>为什么需要Volcano<a href=#为什么需要volcano class=hash-link aria-label="Direct link to 为什么需要Volcano" title="Direct link to 为什么需要Volcano">​</a></h3>
<p><code>Kubeflow Trainer v2</code>默认使用<code>Coscheduling</code>插件提供<code>Gang</code>调度支持，但<code>Coscheduling</code>存在一些局限性：</p>
<table><thead><tr><th>特性<th>Coscheduling<th>Volcano<tbody><tr><td><code>Gang</code>调度<td>✅<td>✅<tr><td>优先级调度<td>❌<td>✅<tr><td>队列管理<td>❌<td>✅<tr><td>资源配额<td>❌<td>✅<tr><td>拓扑感知调度<td>❌<td>✅<tr><td>抢占机制<td>有限<td>✅<tr><td>生态成熟度<td>一般<td>成熟</table>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id=集成配置>集成配置<a href=#集成配置 class=hash-link aria-label="Direct link to 集成配置" title="Direct link to 集成配置">​</a></h3>
<p><code>Kubeflow Trainer</code>可以与<code>Volcano</code>调度器无缝对接，通过源码级别实现了完美的集成，以下是配置步骤。</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id=前置条件>前置条件<a href=#前置条件 class=hash-link aria-label="Direct link to 前置条件" title="Direct link to 前置条件">​</a></h4>
<p>首先需要在<code>Kubernetes</code>集群中安装<code>Volcano</code>：</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#f8f8f2;--prism-background-color:#272822><div class=codeBlockContent_biex><pre tabindex=0 class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style=color:#f8f8f2;background-color:#272822><code class=codeBlockLines_e6Vv><span class=token-line style=color:#f8f8f2><span class="token comment" style=color:#8292a2;font-style:italic># 安装Volcano</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">kubectl apply </span><span class="token parameter variable" style=color:#f8f8f2>-f</span><span class="token plain"> https://raw.githubusercontent.com/volcano-sh/volcano/master/installer/volcano-development.yaml</span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain"></span><span class="token comment" style=color:#8292a2;font-style:italic># 验证安装</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">kubectl get pods </span><span class="token parameter variable" style=color:#f8f8f2>-n</span><span class="token plain"> volcano-system</span><br></span></code></pre><div class=buttonGroup__atx><button type=button aria-label="Copy code to clipboard" title=Copy class=clean-btn><span class=copyButtonIcons_eSgA aria-hidden=true><svg viewBox="0 0 24 24" class=copyButtonIcon_y97N><path fill=currentColor d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"/></svg><svg viewBox="0 0 24 24" class=copyButtonSuccessIcon_LjdS><path fill=currentColor d=M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z /></svg></span></button></div></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id=启用volcano插件>启用Volcano插件<a href=#启用volcano插件 class=hash-link aria-label="Direct link to 启用Volcano插件" title="Direct link to 启用Volcano插件">​</a></h4>
<p>在<code>TrainingRuntime</code>或<code>ClusterTrainingRuntime</code>中配置<code>Volcano</code>：</p>
<div class="language-yaml codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#f8f8f2;--prism-background-color:#272822><div class=codeBlockContent_biex><pre tabindex=0 class="prism-code language-yaml codeBlock_bY9V thin-scrollbar" style=color:#f8f8f2;background-color:#272822><code class=codeBlockLines_e6Vv><span class=token-line style=color:#f8f8f2><span class="token key atrule">apiVersion</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"> trainer.kubeflow.org/v1alpha1</span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain"></span><span class="token key atrule">kind</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"> ClusterTrainingRuntime</span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain"></span><span class="token key atrule">metadata</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">  </span><span class="token key atrule">name</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"> torch</span><span class="token punctuation" style=color:#f8f8f2>-</span><span class="token plain">distributed</span><span class="token punctuation" style=color:#f8f8f2>-</span><span class="token plain">volcano</span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain"></span><span class="token key atrule">spec</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">  </span><span class="token key atrule">mlPolicy</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">    </span><span class="token key atrule">numNodes</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"> </span><span class="token number" style=color:#ae81ff>4</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">    </span><span class="token key atrule">torch</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">      </span><span class="token key atrule">numProcPerNode</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"> </span><span class="token number" style=color:#ae81ff>8</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">  </span><span class="token key atrule">template</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">    </span><span class="token key atrule">spec</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">      </span><span class="token key atrule">replicatedJobs</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">        </span><span class="token punctuation" style=color:#f8f8f2>-</span><span class="token plain"> </span><span class="token key atrule">name</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"> node</span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">          </span><span class="token key atrule">template</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">            </span><span class="token key atrule">spec</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">              </span><span class="token key atrule">template</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">                </span><span class="token key atrule">metadata</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">                  </span><span class="token key atrule">labels</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">                    </span><span class="token key atrule">trainer.kubeflow.org/trainjob-ancestor-step</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"> trainer</span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">                </span><span class="token key atrule">spec</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">                  </span><span class="token comment" style=color:#8292a2;font-style:italic># 指定Volcano调度器</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">                  </span><span class="token key atrule">schedulerName</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"> volcano  </span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">                  </span><span class="token key atrule">priorityClassName</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"> high</span><span class="token punctuation" style=color:#f8f8f2>-</span><span class="token plain">priority</span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">                  </span><span class="token key atrule">containers</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">                    </span><span class="token punctuation" style=color:#f8f8f2>-</span><span class="token plain"> </span><span class="token key atrule">name</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"> node</span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">                      </span><span class="token key atrule">image</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"> docker.io/kubeflow/pytorch</span><span class="token punctuation" style=color:#f8f8f2>-</span><span class="token plain">mnist</span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">                      </span><span class="token key atrule">resources</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">                        </span><span class="token key atrule">limits</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">                          </span><span class="token key atrule">nvidia.com/gpu</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"> </span><span class="token number" style=color:#ae81ff>8</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">                      </span><span class="token key atrule">command</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">                        </span><span class="token punctuation" style=color:#f8f8f2>-</span><span class="token plain"> torchrun train.py</span><br></span></code></pre><div class=buttonGroup__atx><button type=button aria-label="Copy code to clipboard" title=Copy class=clean-btn><span class=copyButtonIcons_eSgA aria-hidden=true><svg viewBox="0 0 24 24" class=copyButtonIcon_y97N><path fill=currentColor d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"/></svg><svg viewBox="0 0 24 24" class=copyButtonSuccessIcon_LjdS><path fill=currentColor d=M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z /></svg></span></button></div></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id=配置优先级队列>配置优先级队列<a href=#配置优先级队列 class=hash-link aria-label="Direct link to 配置优先级队列" title="Direct link to 配置优先级队列">​</a></h4>
<p><strong>步骤1：创建Volcano Queue</strong></p>
<div class="language-yaml codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#f8f8f2;--prism-background-color:#272822><div class=codeBlockContent_biex><pre tabindex=0 class="prism-code language-yaml codeBlock_bY9V thin-scrollbar" style=color:#f8f8f2;background-color:#272822><code class=codeBlockLines_e6Vv><span class=token-line style=color:#f8f8f2><span class="token key atrule">apiVersion</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"> scheduling.volcano.sh/v1beta1</span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain"></span><span class="token key atrule">kind</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"> Queue</span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain"></span><span class="token key atrule">metadata</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">  </span><span class="token key atrule">name</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"> high</span><span class="token punctuation" style=color:#f8f8f2>-</span><span class="token plain">priority</span><span class="token punctuation" style=color:#f8f8f2>-</span><span class="token plain">queue</span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain"></span><span class="token key atrule">spec</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">  </span><span class="token key atrule">weight</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"> </span><span class="token number" style=color:#ae81ff>10</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">  </span><span class="token key atrule">reclaimable</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"> </span><span class="token boolean important" style=color:#ae81ff>false</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">  </span><span class="token key atrule">capability</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">    </span><span class="token key atrule">cpu</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"> </span><span class="token string" style=color:#a6e22e>"100"</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">    </span><span class="token key atrule">memory</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"> </span><span class="token string" style=color:#a6e22e>"500Gi"</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">    </span><span class="token key atrule">nvidia.com/gpu</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"> </span><span class="token string" style=color:#a6e22e>"32"</span><br></span></code></pre><div class=buttonGroup__atx><button type=button aria-label="Copy code to clipboard" title=Copy class=clean-btn><span class=copyButtonIcons_eSgA aria-hidden=true><svg viewBox="0 0 24 24" class=copyButtonIcon_y97N><path fill=currentColor d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"/></svg><svg viewBox="0 0 24 24" class=copyButtonSuccessIcon_LjdS><path fill=currentColor d=M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z /></svg></span></button></div></div></div>
<p><strong>步骤2：在TrainingRuntime中引用Queue</strong></p>
<div class="language-yaml codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#f8f8f2;--prism-background-color:#272822><div class=codeBlockContent_biex><pre tabindex=0 class="prism-code language-yaml codeBlock_bY9V thin-scrollbar" style=color:#f8f8f2;background-color:#272822><code class=codeBlockLines_e6Vv><span class=token-line style=color:#f8f8f2><span class="token key atrule">apiVersion</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"> trainer.kubeflow.org/v1alpha1</span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain"></span><span class="token key atrule">kind</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"> ClusterTrainingRuntime</span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain"></span><span class="token key atrule">metadata</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">  </span><span class="token key atrule">name</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"> torch</span><span class="token punctuation" style=color:#f8f8f2>-</span><span class="token plain">high</span><span class="token punctuation" style=color:#f8f8f2>-</span><span class="token plain">priority</span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain"></span><span class="token key atrule">spec</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">  </span><span class="token key atrule">podGroupPolicy</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">    </span><span class="token key atrule">volcano</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"> </span><span class="token punctuation" style=color:#f8f8f2>{</span><span class="token punctuation" style=color:#f8f8f2>}</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">  </span><span class="token key atrule">template</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">    </span><span class="token key atrule">metadata</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">      </span><span class="token key atrule">annotations</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">        </span><span class="token key atrule">scheduling.volcano.sh/queue-name</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"> </span><span class="token string" style=color:#a6e22e>"high-priority-queue"</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">    </span><span class="token key atrule">spec</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">      </span><span class="token key atrule">replicatedJobs</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">        </span><span class="token punctuation" style=color:#f8f8f2>-</span><span class="token plain"> </span><span class="token key atrule">name</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"> node</span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">          </span><span class="token key atrule">template</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">            </span><span class="token key atrule">spec</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">              </span><span class="token key atrule">template</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">                </span><span class="token key atrule">metadata</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">                  </span><span class="token key atrule">labels</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">                    </span><span class="token key atrule">trainer.kubeflow.org/trainjob-ancestor-step</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"> trainer</span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">                </span><span class="token key atrule">spec</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">                  </span><span class="token key atrule">schedulerName</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"> volcano</span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">                  </span><span class="token key atrule">containers</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">                    </span><span class="token punctuation" style=color:#f8f8f2>-</span><span class="token plain"> </span><span class="token key atrule">name</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"> node</span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">                      </span><span class="token key atrule">image</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"> docker.io/kubeflow/pytorch</span><span class="token punctuation" style=color:#f8f8f2>-</span><span class="token plain">mnist</span><br></span></code></pre><div class=buttonGroup__atx><button type=button aria-label="Copy code to clipboard" title=Copy class=clean-btn><span class=copyButtonIcons_eSgA aria-hidden=true><svg viewBox="0 0 24 24" class=copyButtonIcon_y97N><path fill=currentColor d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"/></svg><svg viewBox="0 0 24 24" class=copyButtonSuccessIcon_LjdS><path fill=currentColor d=M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z /></svg></span></button></div></div></div>
<p><strong>步骤3：在TrainJob中覆盖Queue（可选）</strong></p>
<div class="language-yaml codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#f8f8f2;--prism-background-color:#272822><div class=codeBlockContent_biex><pre tabindex=0 class="prism-code language-yaml codeBlock_bY9V thin-scrollbar" style=color:#f8f8f2;background-color:#272822><code class=codeBlockLines_e6Vv><span class=token-line style=color:#f8f8f2><span class="token key atrule">apiVersion</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"> trainer.kubeflow.org/v1alpha1</span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain"></span><span class="token key atrule">kind</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"> TrainJob</span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain"></span><span class="token key atrule">metadata</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">  </span><span class="token key atrule">name</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"> urgent</span><span class="token punctuation" style=color:#f8f8f2>-</span><span class="token plain">training</span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain"></span><span class="token key atrule">spec</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">  </span><span class="token key atrule">runtimeRef</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">    </span><span class="token key atrule">name</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"> torch</span><span class="token punctuation" style=color:#f8f8f2>-</span><span class="token plain">high</span><span class="token punctuation" style=color:#f8f8f2>-</span><span class="token plain">priority</span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">  </span><span class="token key atrule">annotations</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">    </span><span class="token key atrule">scheduling.volcano.sh/queue-name</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"> </span><span class="token string" style=color:#a6e22e>"urgent-queue"</span><span class="token plain">  </span><span class="token comment" style=color:#8292a2;font-style:italic># 覆盖Runtime中的队列</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">  </span><span class="token key atrule">trainer</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">    </span><span class="token key atrule">numNodes</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"> </span><span class="token number" style=color:#ae81ff>8</span><br></span></code></pre><div class=buttonGroup__atx><button type=button aria-label="Copy code to clipboard" title=Copy class=clean-btn><span class=copyButtonIcons_eSgA aria-hidden=true><svg viewBox="0 0 24 24" class=copyButtonIcon_y97N><path fill=currentColor d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"/></svg><svg viewBox="0 0 24 24" class=copyButtonSuccessIcon_LjdS><path fill=currentColor d=M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z /></svg></span></button></div></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id=拓扑感知调度>拓扑感知调度<a href=#拓扑感知调度 class=hash-link aria-label="Direct link to 拓扑感知调度" title="Direct link to 拓扑感知调度">​</a></h4>
<p><code>Volcano</code>支持网络拓扑感知调度，可以将<code>Pod</code>调度到网络拓扑相近的节点，减少通信延迟：</p>
<div class="language-yaml codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#f8f8f2;--prism-background-color:#272822><div class=codeBlockContent_biex><pre tabindex=0 class="prism-code language-yaml codeBlock_bY9V thin-scrollbar" style=color:#f8f8f2;background-color:#272822><code class=codeBlockLines_e6Vv><span class=token-line style=color:#f8f8f2><span class="token key atrule">apiVersion</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"> trainer.kubeflow.org/v1alpha1</span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain"></span><span class="token key atrule">kind</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"> ClusterTrainingRuntime</span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain"></span><span class="token key atrule">metadata</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">  </span><span class="token key atrule">name</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"> torch</span><span class="token punctuation" style=color:#f8f8f2>-</span><span class="token plain">topology</span><span class="token punctuation" style=color:#f8f8f2>-</span><span class="token plain">aware</span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain"></span><span class="token key atrule">spec</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">  </span><span class="token key atrule">podGroupPolicy</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">    </span><span class="token key atrule">volcano</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">      </span><span class="token comment" style=color:#8292a2;font-style:italic># 具体的配置使用可以查看volcano网络拓扑感知调度章节</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">      </span><span class="token key atrule">networkTopology</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">        </span><span class="token key atrule">mode</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"> hard  </span><span class="token comment" style=color:#8292a2;font-style:italic># hard表示必须满足拓扑约束</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">        </span><span class="token key atrule">highestTierAllowed</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"> </span><span class="token number" style=color:#ae81ff>1</span><span class="token plain">  </span><span class="token comment" style=color:#8292a2;font-style:italic># 最高允许的拓扑层级</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">  </span><span class="token key atrule">template</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">    </span><span class="token key atrule">spec</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">      </span><span class="token key atrule">replicatedJobs</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">        </span><span class="token punctuation" style=color:#f8f8f2>-</span><span class="token plain"> </span><span class="token key atrule">name</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"> node</span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">          </span><span class="token key atrule">template</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">            </span><span class="token key atrule">spec</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">              </span><span class="token key atrule">template</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">                </span><span class="token key atrule">metadata</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">                  </span><span class="token key atrule">labels</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">                    </span><span class="token key atrule">trainer.kubeflow.org/trainjob-ancestor-step</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"> trainer</span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">                </span><span class="token key atrule">spec</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">                  </span><span class="token key atrule">schedulerName</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"> volcano</span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">                  </span><span class="token key atrule">containers</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">                    </span><span class="token punctuation" style=color:#f8f8f2>-</span><span class="token plain"> </span><span class="token key atrule">name</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"> node</span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">                      </span><span class="token key atrule">image</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"> docker.io/kubeflow/pytorch</span><span class="token punctuation" style=color:#f8f8f2>-</span><span class="token plain">mnist</span><br></span></code></pre><div class=buttonGroup__atx><button type=button aria-label="Copy code to clipboard" title=Copy class=clean-btn><span class=copyButtonIcons_eSgA aria-hidden=true><svg viewBox="0 0 24 24" class=copyButtonIcon_y97N><path fill=currentColor d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"/></svg><svg viewBox="0 0 24 24" class=copyButtonSuccessIcon_LjdS><path fill=currentColor d=M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z /></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id=volcano调度器配置建议>Volcano调度器配置建议<a href=#volcano调度器配置建议 class=hash-link aria-label="Direct link to Volcano调度器配置建议" title="Direct link to Volcano调度器配置建议">​</a></h3>
<p>为了与<code>Kubeflow Trainer</code>配合使用，建议配置<code>Volcano</code>调度器启用以下插件：</p>
<div class="language-yaml codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#f8f8f2;--prism-background-color:#272822><div class=codeBlockContent_biex><pre tabindex=0 class="prism-code language-yaml codeBlock_bY9V thin-scrollbar" style=color:#f8f8f2;background-color:#272822><code class=codeBlockLines_e6Vv><span class=token-line style=color:#f8f8f2><span class="token key atrule">apiVersion</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"> v1</span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain"></span><span class="token key atrule">kind</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"> ConfigMap</span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain"></span><span class="token key atrule">metadata</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">  </span><span class="token key atrule">name</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"> volcano</span><span class="token punctuation" style=color:#f8f8f2>-</span><span class="token plain">scheduler</span><span class="token punctuation" style=color:#f8f8f2>-</span><span class="token plain">configmap</span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">  </span><span class="token key atrule">namespace</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"> volcano</span><span class="token punctuation" style=color:#f8f8f2>-</span><span class="token plain">system</span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain"></span><span class="token key atrule">data</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">  </span><span class="token key atrule">volcano-scheduler.conf</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"> </span><span class="token punctuation" style=color:#f8f8f2>|</span><span class="token scalar string" style=color:#a6e22e></span><br></span><span class=token-line style=color:#f8f8f2><span class="token scalar string" style=color:#a6e22e>    actions: "enqueue, allocate, backfill"</span><br></span><span class=token-line style=color:#f8f8f2><span class="token scalar string" style=color:#a6e22e>    tiers:</span><br></span><span class=token-line style=color:#f8f8f2><span class="token scalar string" style=color:#a6e22e>    - plugins:</span><br></span><span class=token-line style=color:#f8f8f2><span class="token scalar string" style=color:#a6e22e>      - name: priority      # 基于PriorityClassName排序</span><br></span><span class=token-line style=color:#f8f8f2><span class="token scalar string" style=color:#a6e22e>      - name: gang          # Gang调度策略</span><br></span><span class=token-line style=color:#f8f8f2><span class="token scalar string" style=color:#a6e22e>    - plugins:</span><br></span><span class=token-line style=color:#f8f8f2><span class="token scalar string" style=color:#a6e22e>      - name: predicates    # 预选过滤</span><br></span><span class=token-line style=color:#f8f8f2><span class="token scalar string" style=color:#a6e22e>      - name: proportion    # 队列资源比例</span><br></span><span class=token-line style=color:#f8f8f2><span class="token scalar string" style=color:#a6e22e>      - name: binpack       # 紧凑调度，减少碎片</span><br></span><span class=token-line style=color:#f8f8f2><span class="token scalar string" style=color:#a6e22e>      - name: network-topology-aware  # 拓扑感知调度</span><br></span></code></pre><div class=buttonGroup__atx><button type=button aria-label="Copy code to clipboard" title=Copy class=clean-btn><span class=copyButtonIcons_eSgA aria-hidden=true><svg viewBox="0 0 24 24" class=copyButtonIcon_y97N><path fill=currentColor d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"/></svg><svg viewBox="0 0 24 24" class=copyButtonSuccessIcon_LjdS><path fill=currentColor d=M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z /></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id=volcano-job对比分析>Volcano Job对比分析<a href=#volcano-job对比分析 class=hash-link aria-label="Direct link to Volcano Job对比分析" title="Direct link to Volcano Job对比分析">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id=两种方案比较>两种方案比较<a href=#两种方案比较 class=hash-link aria-label="Direct link to 两种方案比较" title="Direct link to 两种方案比较">​</a></h3>
<p>在<code>Kubernetes</code>上运行<code>HPC</code>训练任务，有两种主要方案：</p>
<table><thead><tr><th>方案<th>描述<tbody><tr><td><strong>Volcano Job</strong><td>直接使用<code>Volcano</code>的<code>vcjob CRD</code>管理训练任务<tr><td><strong>Kubeflow Trainer + Volcano</strong><td>使用<code>Kubeflow Trainer</code>的<code>TrainJob CRD</code>，集成<code>Volcano</code>调度</table>
<p>详细对比：</p>
<table><thead><tr><th>对比维度<th>Volcano Job<th>Kubeflow Trainer<tbody><tr><td><strong>API复杂度</strong><td>需要手动配置所有参数<td>通过<code>Runtime</code>抽象简化配置<tr><td><strong>用户角色分离</strong><td>不支持<td>支持（平台工程师 vs 数据科学家）<tr><td><strong>分布式训练配置</strong><td>手动配置环境变量和启动命令<td>自动注入，支持<code>torchrun</code><tr><td><strong>框架支持</strong><td>通用，需手动适配<td>内置<code>PyTorch</code>、<code>MPI</code>、<code>DeepSpeed</code>支持<tr><td><strong>LLM微调</strong><td>不支持<td>内置<code>BuiltinTrainer</code>支持<tr><td><strong>数据/模型初始化</strong><td>不支持<td>内置<code>Initializer</code>支持<tr><td><strong>Python SDK</strong><td>不支持<td>支持，<code>Pythonic</code>接口<tr><td><strong>弹性训练</strong><td>有限支持<td>原生支持<code>PyTorch Elastic</code><tr><td><strong>Gang调度</strong><td>原生支持<td>通过<code>PodGroupPolicy</code>集成<tr><td><strong>队列管理</strong><td>原生支持<td>通过<code>annotations</code>集成<tr><td><strong>拓扑感知</strong><td>原生支持<td>通过<code>PodGroupPolicy</code>集成<tr><td><strong>生态集成</strong><td><code>Volcano</code>生态<td><code>Kubeflow</code>生态（<code>Pipelines</code>、<code>Katib</code>等）<tr><td><strong>底层实现</strong><td>直接创建<code>Pod</code><td>基于<code>JobSet API</code></table>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id=volcano-job示例>Volcano Job示例<a href=#volcano-job示例 class=hash-link aria-label="Direct link to Volcano Job示例" title="Direct link to Volcano Job示例">​</a></h3>
<div class="language-yaml codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#f8f8f2;--prism-background-color:#272822><div class=codeBlockContent_biex><pre tabindex=0 class="prism-code language-yaml codeBlock_bY9V thin-scrollbar" style=color:#f8f8f2;background-color:#272822><code class=codeBlockLines_e6Vv><span class=token-line style=color:#f8f8f2><span class="token key atrule">apiVersion</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"> batch.volcano.sh/v1alpha1</span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain"></span><span class="token key atrule">kind</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"> Job</span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain"></span><span class="token key atrule">metadata</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">  </span><span class="token key atrule">name</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"> pytorch</span><span class="token punctuation" style=color:#f8f8f2>-</span><span class="token plain">distributed</span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain"></span><span class="token key atrule">spec</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">  </span><span class="token key atrule">minAvailable</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"> </span><span class="token number" style=color:#ae81ff>4</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">  </span><span class="token key atrule">schedulerName</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"> volcano</span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">  </span><span class="token key atrule">queue</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"> default</span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">  </span><span class="token key atrule">plugins</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">    </span><span class="token key atrule">ssh</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"> </span><span class="token punctuation" style=color:#f8f8f2>[</span><span class="token punctuation" style=color:#f8f8f2>]</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">    </span><span class="token key atrule">svc</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"> </span><span class="token punctuation" style=color:#f8f8f2>[</span><span class="token punctuation" style=color:#f8f8f2>]</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">  </span><span class="token key atrule">policies</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">    </span><span class="token punctuation" style=color:#f8f8f2>-</span><span class="token plain"> </span><span class="token key atrule">event</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"> PodEvicted</span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">      </span><span class="token key atrule">action</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"> RestartJob</span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">  </span><span class="token key atrule">tasks</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">    </span><span class="token punctuation" style=color:#f8f8f2>-</span><span class="token plain"> </span><span class="token key atrule">replicas</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"> </span><span class="token number" style=color:#ae81ff>1</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">      </span><span class="token key atrule">name</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"> master</span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">      </span><span class="token key atrule">template</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">        </span><span class="token key atrule">spec</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">          </span><span class="token key atrule">containers</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">            </span><span class="token punctuation" style=color:#f8f8f2>-</span><span class="token plain"> </span><span class="token key atrule">name</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"> pytorch</span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">              </span><span class="token key atrule">image</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"> docker.io/pytorch</span><span class="token punctuation" style=color:#f8f8f2>-</span><span class="token plain">training</span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">              </span><span class="token key atrule">command</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">                </span><span class="token punctuation" style=color:#f8f8f2>-</span><span class="token plain"> /bin/bash</span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">                </span><span class="token punctuation" style=color:#f8f8f2>-</span><span class="token plain"> </span><span class="token punctuation" style=color:#f8f8f2>-</span><span class="token plain">c</span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">                </span><span class="token punctuation" style=color:#f8f8f2>-</span><span class="token plain"> </span><span class="token punctuation" style=color:#f8f8f2>|</span><span class="token scalar string" style=color:#a6e22e></span><br></span><span class=token-line style=color:#f8f8f2><span class="token scalar string" style=color:#a6e22e>                  python -m torch.distributed.launch \</span><br></span><span class=token-line style=color:#f8f8f2><span class="token scalar string" style=color:#a6e22e>                    --nproc_per_node=4 \</span><br></span><span class=token-line style=color:#f8f8f2><span class="token scalar string" style=color:#a6e22e>                    --nnodes=4 \</span><br></span><span class=token-line style=color:#f8f8f2><span class="token scalar string" style=color:#a6e22e>                    --node_rank=${VK_TASK_INDEX} \</span><br></span><span class=token-line style=color:#f8f8f2><span class="token scalar string" style=color:#a6e22e>                    --master_addr=${MASTER_ADDR} \</span><br></span><span class=token-line style=color:#f8f8f2><span class="token scalar string" style=color:#a6e22e>                    --master_port=29500 \</span><br></span><span class=token-line style=color:#f8f8f2><span class="token scalar string" style=color:#a6e22e>                    train.py</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">              </span><span class="token key atrule">resources</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">                </span><span class="token key atrule">limits</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">                  </span><span class="token key atrule">nvidia.com/gpu</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"> </span><span class="token number" style=color:#ae81ff>4</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">    </span><span class="token punctuation" style=color:#f8f8f2>-</span><span class="token plain"> </span><span class="token key atrule">replicas</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"> </span><span class="token number" style=color:#ae81ff>3</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">      </span><span class="token key atrule">name</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"> worker</span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">      </span><span class="token key atrule">template</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">        </span><span class="token key atrule">spec</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">          </span><span class="token key atrule">containers</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">            </span><span class="token punctuation" style=color:#f8f8f2>-</span><span class="token plain"> </span><span class="token key atrule">name</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"> pytorch</span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">              </span><span class="token key atrule">image</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"> docker.io/pytorch</span><span class="token punctuation" style=color:#f8f8f2>-</span><span class="token plain">training</span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">              </span><span class="token key atrule">command</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">                </span><span class="token punctuation" style=color:#f8f8f2>-</span><span class="token plain"> /bin/bash</span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">                </span><span class="token punctuation" style=color:#f8f8f2>-</span><span class="token plain"> </span><span class="token punctuation" style=color:#f8f8f2>-</span><span class="token plain">c</span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">                </span><span class="token punctuation" style=color:#f8f8f2>-</span><span class="token plain"> </span><span class="token punctuation" style=color:#f8f8f2>|</span><span class="token scalar string" style=color:#a6e22e></span><br></span><span class=token-line style=color:#f8f8f2><span class="token scalar string" style=color:#a6e22e>                  python -m torch.distributed.launch \</span><br></span><span class=token-line style=color:#f8f8f2><span class="token scalar string" style=color:#a6e22e>                    --nproc_per_node=4 \</span><br></span><span class=token-line style=color:#f8f8f2><span class="token scalar string" style=color:#a6e22e>                    --nnodes=4 \</span><br></span><span class=token-line style=color:#f8f8f2><span class="token scalar string" style=color:#a6e22e>                    --node_rank=${VK_TASK_INDEX} \</span><br></span><span class=token-line style=color:#f8f8f2><span class="token scalar string" style=color:#a6e22e>                    --master_addr=${MASTER_ADDR} \</span><br></span><span class=token-line style=color:#f8f8f2><span class="token scalar string" style=color:#a6e22e>                    --master_port=29500 \</span><br></span><span class=token-line style=color:#f8f8f2><span class="token scalar string" style=color:#a6e22e>                    train.py</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">              </span><span class="token key atrule">resources</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">                </span><span class="token key atrule">limits</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">                  </span><span class="token key atrule">nvidia.com/gpu</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"> </span><span class="token number" style=color:#ae81ff>4</span><br></span></code></pre><div class=buttonGroup__atx><button type=button aria-label="Copy code to clipboard" title=Copy class=clean-btn><span class=copyButtonIcons_eSgA aria-hidden=true><svg viewBox="0 0 24 24" class=copyButtonIcon_y97N><path fill=currentColor d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"/></svg><svg viewBox="0 0 24 24" class=copyButtonSuccessIcon_LjdS><path fill=currentColor d=M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z /></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id=kubeflow-trainer示例>Kubeflow Trainer示例<a href=#kubeflow-trainer示例 class=hash-link aria-label="Direct link to Kubeflow Trainer示例" title="Direct link to Kubeflow Trainer示例">​</a></h3>
<div class="language-yaml codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#f8f8f2;--prism-background-color:#272822><div class=codeBlockContent_biex><pre tabindex=0 class="prism-code language-yaml codeBlock_bY9V thin-scrollbar" style=color:#f8f8f2;background-color:#272822><code class=codeBlockLines_e6Vv><span class=token-line style=color:#f8f8f2><span class="token comment" style=color:#8292a2;font-style:italic># ClusterTrainingRuntime（平台工程师配置一次）</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain"></span><span class="token key atrule">apiVersion</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"> trainer.kubeflow.org/v1alpha1</span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain"></span><span class="token key atrule">kind</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"> ClusterTrainingRuntime</span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain"></span><span class="token key atrule">metadata</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">  </span><span class="token key atrule">name</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"> torch</span><span class="token punctuation" style=color:#f8f8f2>-</span><span class="token plain">distributed</span><span class="token punctuation" style=color:#f8f8f2>-</span><span class="token plain">volcano</span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain"></span><span class="token key atrule">spec</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">  </span><span class="token key atrule">mlPolicy</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">    </span><span class="token key atrule">numNodes</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"> </span><span class="token number" style=color:#ae81ff>4</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">    </span><span class="token key atrule">torch</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">      </span><span class="token key atrule">numProcPerNode</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"> </span><span class="token number" style=color:#ae81ff>4</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">  </span><span class="token key atrule">podGroupPolicy</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">    </span><span class="token key atrule">volcano</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"> </span><span class="token punctuation" style=color:#f8f8f2>{</span><span class="token punctuation" style=color:#f8f8f2>}</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">  </span><span class="token key atrule">template</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">    </span><span class="token key atrule">spec</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">      </span><span class="token key atrule">replicatedJobs</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">        </span><span class="token punctuation" style=color:#f8f8f2>-</span><span class="token plain"> </span><span class="token key atrule">name</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"> node</span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">          </span><span class="token key atrule">template</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">            </span><span class="token key atrule">spec</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">              </span><span class="token key atrule">template</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">                </span><span class="token key atrule">metadata</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">                  </span><span class="token key atrule">labels</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">                    </span><span class="token key atrule">trainer.kubeflow.org/trainjob-ancestor-step</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"> trainer</span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">                </span><span class="token key atrule">spec</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">                  </span><span class="token key atrule">schedulerName</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"> volcano</span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">                  </span><span class="token key atrule">containers</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">                    </span><span class="token punctuation" style=color:#f8f8f2>-</span><span class="token plain"> </span><span class="token key atrule">name</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"> node</span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">                      </span><span class="token key atrule">image</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"> docker.io/pytorch</span><span class="token punctuation" style=color:#f8f8f2>-</span><span class="token plain">training</span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">                      </span><span class="token key atrule">resources</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">                        </span><span class="token key atrule">limits</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">                          </span><span class="token key atrule">nvidia.com/gpu</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"> </span><span class="token number" style=color:#ae81ff>4</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">                      </span><span class="token key atrule">command</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">                        </span><span class="token punctuation" style=color:#f8f8f2>-</span><span class="token plain"> torchrun train.py</span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain"></span><span class="token punctuation" style=color:#f8f8f2>---</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain"></span><span class="token comment" style=color:#8292a2;font-style:italic># TrainJob（数据科学家使用）</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain"></span><span class="token key atrule">apiVersion</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"> trainer.kubeflow.org/v1alpha1</span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain"></span><span class="token key atrule">kind</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"> TrainJob</span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain"></span><span class="token key atrule">metadata</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">  </span><span class="token key atrule">name</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"> my</span><span class="token punctuation" style=color:#f8f8f2>-</span><span class="token plain">training</span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain"></span><span class="token key atrule">spec</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">  </span><span class="token key atrule">runtimeRef</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">    </span><span class="token key atrule">name</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"> torch</span><span class="token punctuation" style=color:#f8f8f2>-</span><span class="token plain">distributed</span><span class="token punctuation" style=color:#f8f8f2>-</span><span class="token plain">volcano</span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">  </span><span class="token key atrule">trainer</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">    </span><span class="token key atrule">image</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"> docker.io/my</span><span class="token punctuation" style=color:#f8f8f2>-</span><span class="token plain">custom</span><span class="token punctuation" style=color:#f8f8f2>-</span><span class="token plain">training</span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">    </span><span class="token key atrule">args</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">      </span><span class="token punctuation" style=color:#f8f8f2>-</span><span class="token plain"> </span><span class="token punctuation" style=color:#f8f8f2>-</span><span class="token punctuation" style=color:#f8f8f2>-</span><span class="token plain">epochs=100</span><br></span></code></pre><div class=buttonGroup__atx><button type=button aria-label="Copy code to clipboard" title=Copy class=clean-btn><span class=copyButtonIcons_eSgA aria-hidden=true><svg viewBox="0 0 24 24" class=copyButtonIcon_y97N><path fill=currentColor d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"/></svg><svg viewBox="0 0 24 24" class=copyButtonSuccessIcon_LjdS><path fill=currentColor d=M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z /></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id=工作负载类型与podgroup分析>工作负载类型与PodGroup分析<a href=#工作负载类型与podgroup分析 class=hash-link aria-label="Direct link to 工作负载类型与PodGroup分析" title="Direct link to 工作负载类型与PodGroup分析">​</a></h3>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id=kubeflow-trainer生成的工作负载类型>Kubeflow Trainer生成的工作负载类型<a href=#kubeflow-trainer生成的工作负载类型 class=hash-link aria-label="Direct link to Kubeflow Trainer生成的工作负载类型" title="Direct link to Kubeflow Trainer生成的工作负载类型">​</a></h4>
<p><code>Kubeflow Trainer</code>与<code>Volcano</code>集成时，<strong>生成的工作负载不是<code>Volcano Job</code>，而是<code>JobSet</code> + <code>PodGroup</code></strong>。</p>
<!-- -->
<p>从<code>Kubeflow Trainer</code>源码可以确认，<code>Volcano</code>插件直接引用了<code>Volcano</code>的<code>PodGroup API</code>：</p>
<div class="language-go codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#f8f8f2;--prism-background-color:#272822><div class=codeBlockContent_biex><pre tabindex=0 class="prism-code language-go codeBlock_bY9V thin-scrollbar" style=color:#f8f8f2;background-color:#272822><code class=codeBlockLines_e6Vv><span class=token-line style=color:#f8f8f2><span class="token comment" style=color:#8292a2;font-style:italic>// 源码路径: pkg/runtime/framework/plugins/volcano/volcano.go</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain"></span><span class="token keyword" style=color:#66d9ef>import</span><span class="token plain"> </span><span class="token punctuation" style=color:#f8f8f2>(</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">    volcanov1beta1 </span><span class="token string" style=color:#a6e22e>"volcano.sh/apis/pkg/apis/scheduling/v1beta1"</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">    volcanov1beta1ac </span><span class="token string" style=color:#a6e22e>"volcano.sh/apis/pkg/client/applyconfiguration/scheduling/v1beta1"</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain"></span><span class="token punctuation" style=color:#f8f8f2>)</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain"></span><span class="token keyword" style=color:#66d9ef>func</span><span class="token plain"> </span><span class="token punctuation" style=color:#f8f8f2>(</span><span class="token plain">v </span><span class="token operator" style=color:#66d9ef>*</span><span class="token plain">Volcano</span><span class="token punctuation" style=color:#f8f8f2>)</span><span class="token plain"> </span><span class="token function" style=color:#e6db74>Build</span><span class="token punctuation" style=color:#f8f8f2>(</span><span class="token operator" style=color:#66d9ef>...</span><span class="token punctuation" style=color:#f8f8f2>)</span><span class="token plain"> </span><span class="token punctuation" style=color:#f8f8f2>(</span><span class="token punctuation" style=color:#f8f8f2>[</span><span class="token punctuation" style=color:#f8f8f2>]</span><span class="token plain">apiruntime</span><span class="token punctuation" style=color:#f8f8f2>.</span><span class="token plain">ApplyConfiguration</span><span class="token punctuation" style=color:#f8f8f2>,</span><span class="token plain"> </span><span class="token builtin" style=color:#e6db74>error</span><span class="token punctuation" style=color:#f8f8f2>)</span><span class="token plain"> </span><span class="token punctuation" style=color:#f8f8f2>{</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">    </span><span class="token comment" style=color:#8292a2;font-style:italic>// 创建Volcano PodGroup</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">    pg </span><span class="token operator" style=color:#66d9ef>:=</span><span class="token plain"> volcanov1beta1ac</span><span class="token punctuation" style=color:#f8f8f2>.</span><span class="token function" style=color:#e6db74>PodGroup</span><span class="token punctuation" style=color:#f8f8f2>(</span><span class="token plain">trainJob</span><span class="token punctuation" style=color:#f8f8f2>.</span><span class="token plain">Name</span><span class="token punctuation" style=color:#f8f8f2>,</span><span class="token plain"> trainJob</span><span class="token punctuation" style=color:#f8f8f2>.</span><span class="token plain">Namespace</span><span class="token punctuation" style=color:#f8f8f2>)</span><span class="token punctuation" style=color:#f8f8f2>.</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">        </span><span class="token function" style=color:#e6db74>WithSpec</span><span class="token punctuation" style=color:#f8f8f2>(</span><span class="token plain">volcanov1beta1ac</span><span class="token punctuation" style=color:#f8f8f2>.</span><span class="token function" style=color:#e6db74>PodGroupSpec</span><span class="token punctuation" style=color:#f8f8f2>(</span><span class="token punctuation" style=color:#f8f8f2>)</span><span class="token punctuation" style=color:#f8f8f2>.</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">            </span><span class="token function" style=color:#e6db74>WithMinMember</span><span class="token punctuation" style=color:#f8f8f2>(</span><span class="token plain">totalMembers</span><span class="token punctuation" style=color:#f8f8f2>)</span><span class="token punctuation" style=color:#f8f8f2>.</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">            </span><span class="token function" style=color:#e6db74>WithMinResources</span><span class="token punctuation" style=color:#f8f8f2>(</span><span class="token plain">totalResources</span><span class="token punctuation" style=color:#f8f8f2>)</span><span class="token punctuation" style=color:#f8f8f2>)</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">    </span><span class="token comment" style=color:#8292a2;font-style:italic>// ...</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain"></span><span class="token punctuation" style=color:#f8f8f2>}</span><br></span></code></pre><div class=buttonGroup__atx><button type=button aria-label="Copy code to clipboard" title=Copy class=clean-btn><span class=copyButtonIcons_eSgA aria-hidden=true><svg viewBox="0 0 24 24" class=copyButtonIcon_y97N><path fill=currentColor d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"/></svg><svg viewBox="0 0 24 24" class=copyButtonSuccessIcon_LjdS><path fill=currentColor d=M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z /></svg></span></button></div></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id=podgroup是同一类型>PodGroup是同一类型<a href=#podgroup是同一类型 class=hash-link aria-label="Direct link to PodGroup是同一类型" title="Direct link to PodGroup是同一类型">​</a></h4>
<p><code>Kubeflow Trainer</code>创建的<code>PodGroup</code>与<code>Volcano</code>原生的<code>PodGroup</code>是完全相同的<code>CRD</code>类型。</p>
<table><thead><tr><th>属性<th>值<tbody><tr><td><strong>API Group</strong><td><code>scheduling.volcano.sh</code><tr><td><strong>API Version</strong><td><code>v1beta1</code><tr><td><strong>Kind</strong><td><code>PodGroup</code><tr><td><strong>CRD名称</strong><td><code>podgroups.scheduling.volcano.sh</code></table>
<p>这意味着<code>Kubeflow Trainer</code>创建的<code>PodGroup</code>可以被<code>Volcano Scheduler</code>完全识别和处理，支持以下调度特性：</p>
<table><thead><tr><th>特性<th>支持情况<th>说明<tbody><tr><td><strong>Gang调度</strong><td>✅<td>通过<code>minMember</code>字段<tr><td><strong>队列管理</strong><td>✅<td>通过<code>queue</code>字段<tr><td><strong>优先级调度</strong><td>✅<td>通过<code>priorityClassName</code>字段<tr><td><strong>最小资源检查</strong><td>✅<td>通过<code>minResources</code>字段<tr><td><strong>网络拓扑感知</strong><td>✅<td>通过<code>networkTopology</code>字段</table>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id=volcano-job特有功能的缺失>Volcano Job特有功能的缺失<a href=#volcano-job特有功能的缺失 class=hash-link aria-label="Direct link to Volcano Job特有功能的缺失" title="Direct link to Volcano Job特有功能的缺失">​</a></h4>
<p>由于<code>Kubeflow Trainer</code>使用<code>JobSet</code>而非<code>Volcano Job</code>作为工作负载，以下<code>Volcano Job</code>特有的功能<strong>无法使用</strong>：</p>
<table><thead><tr><th>Volcano Job特性<th>说明<th>Kubeflow Trainer替代方案<tbody><tr><td><strong>任务级Policies</strong><td>如<code>PodEvicted → RestartJob</code><td>依赖<code>JobSet</code>的<code>FailurePolicy</code><tr><td><strong>内置Plugins</strong><td><code>ssh</code>、<code>svc</code>、<code>env</code>等<td>需手动配置或使用<code>Initializer</code><tr><td><strong>Task依赖</strong><td>任务间的<code>DAG</code>依赖<td>不支持，需使用<code>Kubeflow Pipelines</code><tr><td><strong>minAvailable动态调整</strong><td>运行时调整最小可用数<td>不支持<tr><td><strong>Lifecycle管理</strong><td><code>Pending</code>/<code>Running</code>/<code>Completed</code>等状态<td>使用<code>JobSet</code>状态</table>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id=架构对比图>架构对比图<a href=#架构对比图 class=hash-link aria-label="Direct link to 架构对比图" title="Direct link to 架构对比图">​</a></h4>
<!-- -->
<h4 class="anchor anchorWithStickyNavbar_LWe7" id=选型建议>选型建议<a href=#选型建议 class=hash-link aria-label="Direct link to 选型建议" title="Direct link to 选型建议">​</a></h4>
<table><thead><tr><th>场景<th>推荐方案<th>原因<tbody><tr><td>需要<code>Volcano Job</code>完整功能（<code>Policies</code>、<code>Plugins</code>）<td><code>Volcano Job</code><td>原生支持所有特性<tr><td>需要<code>PyTorch</code>/<code>MPI</code>分布式训练简化配置<td><code>Kubeflow Trainer</code><td>自动注入环境变量，<code>Runtime</code>抽象<tr><td>需要<code>LLM</code>微调能力<td><code>Kubeflow Trainer</code><td>内置<code>BuiltinTrainer</code>支持<tr><td>需要与<code>Kubeflow</code>生态集成<td><code>Kubeflow Trainer</code><td>与<code>Pipelines</code>、<code>Katib</code>无缝集成<tr><td>需要<code>Python SDK</code>提交任务<td><code>Kubeflow Trainer</code><td>提供<code>Pythonic</code>接口<tr><td>纯<code>HPC</code>批处理场景<td><code>Volcano Job</code><td>更成熟的批处理生态</table>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id=volcano--kubeflow-trainer>Volcano + Kubeflow Trainer<a href=#volcano--kubeflow-trainer class=hash-link aria-label="Direct link to Volcano + Kubeflow Trainer" title="Direct link to Volcano + Kubeflow Trainer">​</a></h3>
<p>将<code>Volcano</code>与<code>Kubeflow Trainer</code>结合使用，可以充分发挥两者的优势，构建企业级<code>HPC</code>训练平台。</p>
<table><thead><tr><th>能力维度<th>Volcano提供<th>Kubeflow Trainer提供<tbody><tr><td><strong>调度能力</strong><td><code>Gang</code>调度、优先级抢占、队列管理、拓扑感知<td>分布式训练编排、框架适配<tr><td><strong>资源管理</strong><td>多租户隔离、资源配额、公平调度<td>训练任务生命周期管理<tr><td><strong>用户体验</strong><td>-<td><code>Runtime</code>抽象、<code>Python SDK</code>、角色分离<tr><td><strong>生态集成</strong><td>批处理调度生态<td><code>ML</code>工作流生态（<code>Pipelines</code>、<code>Katib</code>）</table>
<!-- -->
<h2 class="anchor anchorWithStickyNavbar_LWe7" id=参考资料>参考资料<a href=#参考资料 class=hash-link aria-label="Direct link to 参考资料" title="Direct link to 参考资料">​</a></h2>
<ul>
<li><a href=https://www.kubeflow.org/docs/components/trainer/ target=_blank rel="noopener noreferrer">Kubeflow Trainer官方文档</a></li>
<li><a href=https://github.com/kubeflow/trainer target=_blank rel="noopener noreferrer">Kubeflow Trainer GitHub仓库</a></li>
<li><a href=https://volcano.sh/en/docs/ target=_blank rel="noopener noreferrer">Volcano官方文档</a></li>
</ul></div></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href=/ai/kubeflow-trainer><div class=pagination-nav__sublabel>Previous</div><div class=pagination-nav__label>Kubeflow Trainer</div></a><a class="pagination-nav__link pagination-nav__link--next" href=/ai/kubeflow-trainer-pytorch-parallel-computing><div class=pagination-nav__sublabel>Next</div><div class=pagination-nav__label>Kubeflow Trainer PyTorch并行计算</div></a></nav><div class=docusaurus-mt-lg></div></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href=#kubeflow项目简介 class="table-of-contents__link toc-highlight">Kubeflow项目简介</a><ul><li><a href=#项目背景 class="table-of-contents__link toc-highlight">项目背景</a><li><a href=#核心组件 class="table-of-contents__link toc-highlight">核心组件</a><li><a href=#使用者 class="table-of-contents__link toc-highlight">使用者</a></ul><li><a href=#kubeflow-trainer详细介绍 class="table-of-contents__link toc-highlight">Kubeflow Trainer详细介绍</a><ul><li><a href=#项目演进 class="table-of-contents__link toc-highlight">项目演进</a><li><a href=#trainer-v2核心特性 class="table-of-contents__link toc-highlight">Trainer v2核心特性</a><li><a href=#核心api设计 class="table-of-contents__link toc-highlight">核心API设计</a><li><a href=#用户角色分离 class="table-of-contents__link toc-highlight">用户角色分离</a></ul><li><a href=#hpc训练场景技术挑战与解决方案 class="table-of-contents__link toc-highlight">HPC训练场景技术挑战与解决方案</a><ul><li><a href=#常见技术挑战 class="table-of-contents__link toc-highlight">常见技术挑战</a><li><a href=#kubeflow-trainer解决方案 class="table-of-contents__link toc-highlight">Kubeflow Trainer解决方案</a></ul><li><a href=#支持的框架 class="table-of-contents__link toc-highlight">支持的框架</a><ul><li><a href=#pytorch class="table-of-contents__link toc-highlight">PyTorch</a><li><a href=#deepspeed class="table-of-contents__link toc-highlight">DeepSpeed</a><li><a href=#mpi class="table-of-contents__link toc-highlight">MPI</a><li><a href=#其他框架支持 class="table-of-contents__link toc-highlight">其他框架支持</a><li><a href=#llm微调框架 class="table-of-contents__link toc-highlight">LLM微调框架</a></ul><li><a href=#训练任务创建流程 class="table-of-contents__link toc-highlight">训练任务创建流程</a><ul><li><a href=#整体架构 class="table-of-contents__link toc-highlight">整体架构</a><li><a href=#详细创建流程 class="table-of-contents__link toc-highlight">详细创建流程</a><li><a href=#pipeline-framework详解 class="table-of-contents__link toc-highlight">Pipeline Framework详解</a></ul><li><a href=#volcano调度器集成 class="table-of-contents__link toc-highlight">Volcano调度器集成</a><ul><li><a href=#为什么需要volcano class="table-of-contents__link toc-highlight">为什么需要Volcano</a><li><a href=#集成配置 class="table-of-contents__link toc-highlight">集成配置</a><li><a href=#volcano调度器配置建议 class="table-of-contents__link toc-highlight">Volcano调度器配置建议</a></ul><li><a href=#volcano-job对比分析 class="table-of-contents__link toc-highlight">Volcano Job对比分析</a><ul><li><a href=#两种方案比较 class="table-of-contents__link toc-highlight">两种方案比较</a><li><a href=#volcano-job示例 class="table-of-contents__link toc-highlight">Volcano Job示例</a><li><a href=#kubeflow-trainer示例 class="table-of-contents__link toc-highlight">Kubeflow Trainer示例</a><li><a href=#工作负载类型与podgroup分析 class="table-of-contents__link toc-highlight">工作负载类型与PodGroup分析</a><li><a href=#volcano--kubeflow-trainer class="table-of-contents__link toc-highlight">Volcano + Kubeflow Trainer</a></ul><li><a href=#参考资料 class="table-of-contents__link toc-highlight">参考资料</a></ul></div></div></div></div></main></div></div></div><footer class=footer><div class="container container-fluid"><div class="footer__bottom text--center"><div class=footer__copyright>Copyright 2026 johng.cn</div></div></div></footer></div>