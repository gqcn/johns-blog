<!doctype html><html lang=en dir=ltr class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-docs/AI技术/vGPU/HAMi With Volcano" data-has-hydrated=false><meta charset=UTF-8><meta name=generator content="Docusaurus v3.6.3"><title data-rh=true>HAMi With Volcano | John's Blog</title><meta data-rh=true name=viewport content="width=device-width,initial-scale=1.0"><meta data-rh=true name=twitter:card content=summary_large_image><meta data-rh=true property=og:url content=https://johng.cn/ai/vgpu-hami-with-volcano><meta data-rh=true property=og:locale content=en><meta data-rh=true name=docusaurus_locale content=en><meta data-rh=true name=docsearch:language content=en><meta data-rh=true name=docusaurus_version content=current><meta data-rh=true name=docusaurus_tag content=docs-default-current><meta data-rh=true name=docsearch:version content=current><meta data-rh=true name=docsearch:docusaurus_tag content=docs-default-current><meta data-rh=true property=og:title content="HAMi With Volcano | John's Blog"><meta data-rh=true name=description content="深入解析Volcano vGPU的完整执行流程和技术原理，包括deviceshare插件调度机制、Device Plugin资源分配、HAMi Core库注入方式（LD_LIBRARY_PATH vs LD_PRELOAD）、与独立HAMi部署的架构对比，以及Prometheus监控指标详解。基于源码分析，提供完整的组件交互流程图。"><meta data-rh=true property=og:description content="深入解析Volcano vGPU的完整执行流程和技术原理，包括deviceshare插件调度机制、Device Plugin资源分配、HAMi Core库注入方式（LD_LIBRARY_PATH vs LD_PRELOAD）、与独立HAMi部署的架构对比，以及Prometheus监控指标详解。基于源码分析，提供完整的组件交互流程图。"><meta data-rh=true name=keywords content="Volcano vGPU,deviceshare插件,HAMi Core,LD_LIBRARY_PATH注入,GPU调度流程,volcano-vgpu-device-plugin,Prometheus监控,binpack调度,CUDA API劫持,NVIDIA Runtime"><link data-rh=true rel=icon href=/img/favicon.ico><link data-rh=true rel=canonical href=https://johng.cn/ai/vgpu-hami-with-volcano><link data-rh=true rel=alternate href=https://johng.cn/ai/vgpu-hami-with-volcano hreflang=en><link data-rh=true rel=alternate href=https://johng.cn/ai/vgpu-hami-with-volcano hreflang=x-default><link data-rh=true rel=preconnect href=https://XGS1CPQERK-dsn.algolia.net crossorigin><link rel=alternate type=application/rss+xml href=/blog/rss.xml title="John's Blog RSS Feed"><link rel=alternate type=application/atom+xml href=/blog/atom.xml title="John's Blog Atom Feed"><link rel=search type=application/opensearchdescription+xml title="John's Blog" href=/opensearch.xml><script src=https://hm.baidu.com/hm.js?6b4ae23dc83ee5efe875b7172af6c7c1 async></script><link rel=stylesheet href=/assets/css/styles.b3f7724c.css><script src=/assets/js/runtime~main.38b121e9.js defer></script><script src=/assets/js/main.5daefaa8.js defer></script><body class=navigation-with-keyboard><script>!function(){var t,e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();t=null!==e?e:"light",document.documentElement.setAttribute("data-theme",t)}(),function(){try{for(var[t,e]of new URLSearchParams(window.location.search).entries())if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id=__docusaurus><div role=region aria-label="Skip to main content"><a class=skipToContent_fXgn href=#__docusaurus_skipToContent_fallback>Skip to main content</a></div><nav aria-label=Main class="navbar navbar--fixed-top"><div class=navbar__inner><div class=navbar__items><button aria-label="Toggle navigation bar" aria-expanded=false class="navbar__toggle clean-btn" type=button><svg width=30 height=30 viewBox="0 0 30 30" aria-hidden=true><path stroke=currentColor stroke-linecap=round stroke-miterlimit=10 stroke-width=2 d="M4 7h22M4 15h22M4 23h22"/></svg></button><a class=navbar__brand href=/><b class="navbar__title text--truncate">John's Blog</b></a><a aria-current=page class="navbar__item navbar__link navbar__link--active" sidebarid=mainSidebar href=/ai>AI技术</a><a class="navbar__item navbar__link" sidebarid=mainSidebar href=/cloud-native>云原生</a><a class="navbar__item navbar__link" sidebarid=mainSidebar href=/notes>日常笔记</a><a class="navbar__item navbar__link" sidebarid=mainSidebar href=/programming>开发语言</a><a class="navbar__item navbar__link" sidebarid=mainSidebar href=/architecture>技术架构</a><a class="navbar__item navbar__link" sidebarid=mainSidebar href=/observability>可观测性</a><a class="navbar__item navbar__link" sidebarid=mainSidebar href=/database-and-middleware>数据库与中间件</a><a class="navbar__item navbar__link" href=/aboutme>关于我</a></div><div class="navbar__items navbar__items--right"><a class="navbar__item navbar__link" href=/blog>博客</a><a href=https://goframe.org/ target=_blank rel="noopener noreferrer" class="navbar__item navbar__link header-goframe-link"></a><a href=https://github.com/gqcn target=_blank rel="noopener noreferrer" class="navbar__item navbar__link header-github-link"></a><div class=navbarSearchContainer_Bca1><button type=button class="DocSearch DocSearch-Button" aria-label="Search (Command+K)"><span class=DocSearch-Button-Container><svg width=20 height=20 class=DocSearch-Search-Icon viewBox="0 0 20 20" aria-hidden=true><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke=currentColor fill=none fill-rule=evenodd stroke-linecap=round stroke-linejoin=round /></svg><span class=DocSearch-Button-Placeholder>Search</span></span><span class=DocSearch-Button-Keys></span></button></div></div></div><div role=presentation class=navbar-sidebar__backdrop></div></nav><div id=__docusaurus_skipToContent_fallback class="main-wrapper mainWrapper_z2l0"><div class=docsWrapper_hBAB><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type=button></button><div class=docRoot_UBD9><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class=sidebarViewport_aRkj><div class=sidebar_njMd><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class=menu__list-item-collapsible><a class="menu__link menu__link--sublist menu__link--active" href=/ai>AI技术</a><button aria-label="Collapse sidebar category 'AI技术'" aria-expanded=true type=button class="clean-btn menu__caret"></button></div><ul style=display:block;overflow:visible;height:auto class=menu__list><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="menu__link menu__link--sublist" tabindex=0 href=/ai/nvidia>NVIDIA</a><button aria-label="Expand sidebar category 'NVIDIA'" aria-expanded=false type=button class="clean-btn menu__caret"></button></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="menu__link menu__link--sublist" tabindex=0 href=/ai/distributed-inference>分布式推理</a><button aria-label="Expand sidebar category '分布式推理'" aria-expanded=false type=button class="clean-btn menu__caret"></button></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="menu__link menu__link--sublist" tabindex=0 href=/ai/scheduling>算力资源调度</a><button aria-label="Expand sidebar category '算力资源调度'" aria-expanded=false type=button class="clean-btn menu__caret"></button></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="menu__link menu__link--sublist" tabindex=0 href=/ai/rdma>RDMA</a><button aria-label="Expand sidebar category 'RDMA'" aria-expanded=false type=button class="clean-btn menu__caret"></button></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class=menu__list-item-collapsible><a class="menu__link menu__link--sublist menu__link--active" tabindex=0 href=/ai/vgpu>vGPU</a><button aria-label="Collapse sidebar category 'vGPU'" aria-expanded=true type=button class="clean-btn menu__caret"></button></div><ul style=display:block;overflow:visible;height:auto class=menu__list><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class=menu__link tabindex=0 href=/ai/vgpu-survey>vGPU方案调研</a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class=menu__link tabindex=0 href=/ai/vgpu-hami>HAMi vGPU调研</a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link menu__link--active" aria-current=page tabindex=0 href=/ai/vgpu-hami-with-volcano>HAMi With Volcano</a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class=menu__link tabindex=0 href=/ai/vgpu-hami-test-with-volcano>HAMi Volcano安装测试</a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class=menu__link tabindex=0 href=/ai/vgpu-hami-cuda-driver-api>HAMi CUDA Driver API</a></ul><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class=menu__link tabindex=0 href=/ai/common-acceleration-cards>常见智算加速卡汇总</a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class=menu__link tabindex=0 href=/ai/general-ai-model-and-reasoning-ai-model-difference>通用大模型和推理大模型区别</a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class=menu__link tabindex=0 href=/ai/common-ai-model-training-inference-framework>常见AI模型训练推理框架对比</a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class=menu__link tabindex=0 href=/ai/ai-training-inference-scenarios>AI模型训练推理常见业务场景痛点</a></ul><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="menu__link menu__link--sublist" href=/cloud-native>云原生</a><button aria-label="Expand sidebar category '云原生'" aria-expanded=false type=button class="clean-btn menu__caret"></button></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="menu__link menu__link--sublist" href=/notes>日常笔记</a><button aria-label="Expand sidebar category '日常笔记'" aria-expanded=false type=button class="clean-btn menu__caret"></button></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="menu__link menu__link--sublist" href=/programming>开发语言</a><button aria-label="Expand sidebar category '开发语言'" aria-expanded=false type=button class="clean-btn menu__caret"></button></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="menu__link menu__link--sublist" href=/architecture>技术架构</a><button aria-label="Expand sidebar category '技术架构'" aria-expanded=false type=button class="clean-btn menu__caret"></button></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="menu__link menu__link--sublist" href=/management>技术管理</a><button aria-label="Expand sidebar category '技术管理'" aria-expanded=false type=button class="clean-btn menu__caret"></button></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="menu__link menu__link--sublist" href=/observability>可观测性</a><button aria-label="Expand sidebar category '可观测性'" aria-expanded=false type=button class="clean-btn menu__caret"></button></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="menu__link menu__link--sublist" href=/database-and-middleware>数据库与中间件</a><button aria-label="Expand sidebar category '数据库与中间件'" aria-expanded=false type=button class="clean-btn menu__caret"></button></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="menu__link menu__link--sublist" href=/operating-systems-and-networks>操作系统和网络</a><button aria-label="Expand sidebar category '操作系统和网络'" aria-expanded=false type=button class="clean-btn menu__caret"></button></div></ul></nav></div></div></aside><main class=docMainContainer_TBSr><div class="container padding-top--md padding-bottom--lg"><div class=row><div class="col docItemCol_VOVn"><div class=docItemContainer_Djhp><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label=Breadcrumbs><ul class=breadcrumbs itemscope itemtype=https://schema.org/BreadcrumbList><li class=breadcrumbs__item><a aria-label="Home page" class=breadcrumbs__link href=/><svg viewBox="0 0 24 24" class=breadcrumbHomeIcon_YNFT><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill=currentColor /></svg></a><li itemscope itemprop=itemListElement itemtype=https://schema.org/ListItem class=breadcrumbs__item><a class=breadcrumbs__link itemprop=item href=/ai><span itemprop=name>AI技术</span></a><meta itemprop=position content=1><li itemscope itemprop=itemListElement itemtype=https://schema.org/ListItem class=breadcrumbs__item><a class=breadcrumbs__link itemprop=item href=/ai/vgpu><span itemprop=name>vGPU</span></a><meta itemprop=position content=2><li itemscope itemprop=itemListElement itemtype=https://schema.org/ListItem class="breadcrumbs__item breadcrumbs__item--active"><span class=breadcrumbs__link itemprop=name>HAMi With Volcano</span><meta itemprop=position content=3></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type=button class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><p><code>Volcano</code>原生支持<code>HAMi vGPU</code>，但需要启用对应的<code>deviceshare</code> 插件。</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id=volcano调度器配置>Volcano调度器配置<a href=#volcano调度器配置 class=hash-link aria-label="Direct link to Volcano调度器配置" title="Direct link to Volcano调度器配置">​</a></h2>
<p>具体配置如下：</p>
<div class="language-yaml codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#f8f8f2;--prism-background-color:#272822><div class=codeBlockTitle_Ktv7>volcano-scheduler.conf</div><div class=codeBlockContent_biex><pre tabindex=0 class="prism-code language-yaml codeBlock_bY9V thin-scrollbar" style=color:#f8f8f2;background-color:#272822><code class=codeBlockLines_e6Vv><span class=token-line style=color:#f8f8f2><span class="token key atrule">actions</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"> </span><span class="token string" style=color:#a6e22e>"enqueue, allocate, backfill"</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain"></span><span class="token key atrule">tiers</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain"></span><span class="token punctuation" style=color:#f8f8f2>-</span><span class="token plain"> </span><span class="token key atrule">plugins</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">  </span><span class="token punctuation" style=color:#f8f8f2>-</span><span class="token plain"> </span><span class="token key atrule">name</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"> priority</span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">  </span><span class="token punctuation" style=color:#f8f8f2>-</span><span class="token plain"> </span><span class="token key atrule">name</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"> gang</span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">  </span><span class="token punctuation" style=color:#f8f8f2>-</span><span class="token plain"> </span><span class="token key atrule">name</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"> conformance</span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain"></span><span class="token punctuation" style=color:#f8f8f2>-</span><span class="token plain"> </span><span class="token key atrule">plugins</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">  </span><span class="token punctuation" style=color:#f8f8f2>-</span><span class="token plain"> </span><span class="token key atrule">name</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"> drf</span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">  </span><span class="token punctuation" style=color:#f8f8f2>-</span><span class="token plain"> </span><span class="token key atrule">name</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"> deviceshare</span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">    </span><span class="token key atrule">arguments</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">      </span><span class="token comment" style=color:#8292a2;font-style:italic># 是否启用vgpu特性</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">      </span><span class="token key atrule">deviceshare.VGPUEnable</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"> </span><span class="token boolean important" style=color:#ae81ff>true</span><span class="token plain"> </span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">      </span><span class="token comment" style=color:#8292a2;font-style:italic># volcano-vgpu-device-config这个ConfigMap对应的命名空间</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">      </span><span class="token comment" style=color:#8292a2;font-style:italic># 便于调度器自动读取ConfigMap内容</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">      </span><span class="token key atrule">deviceshare.KnownGeometriesCMNamespace</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"> volcano</span><span class="token punctuation" style=color:#f8f8f2>-</span><span class="token plain">system </span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">  </span><span class="token punctuation" style=color:#f8f8f2>-</span><span class="token plain"> </span><span class="token key atrule">name</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"> predicates</span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">  </span><span class="token punctuation" style=color:#f8f8f2>-</span><span class="token plain"> </span><span class="token key atrule">name</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"> proportion</span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">  </span><span class="token punctuation" style=color:#f8f8f2>-</span><span class="token plain"> </span><span class="token key atrule">name</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"> nodeorder</span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">  </span><span class="token punctuation" style=color:#f8f8f2>-</span><span class="token plain"> </span><span class="token key atrule">name</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"> binpack</span><br></span></code></pre><div class=buttonGroup__atx><button type=button aria-label="Copy code to clipboard" title=Copy class=clean-btn><span class=copyButtonIcons_eSgA aria-hidden=true><svg viewBox="0 0 24 24" class=copyButtonIcon_y97N><path fill=currentColor d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"/></svg><svg viewBox="0 0 24 24" class=copyButtonSuccessIcon_LjdS><path fill=currentColor d=M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z /></svg></span></button></div></div></div>
<p>同时需要替换<code>NVIDIA Device Plugin</code>为 <a href=https://github.com/Project-HAMi/volcano-vgpu-device-plugin target=_blank rel="noopener noreferrer">https://github.com/Project-HAMi/volcano-vgpu-device-plugin</a> ，具体参考：<a href=https://project-hami.io/zh/docs/userguide/volcano-vgpu/NVIDIA-GPU/how-to-use-volcano-vgpu target=_blank rel="noopener noreferrer">https://project-hami.io/zh/docs/userguide/volcano-vgpu/NVIDIA-GPU/how-to-use-volcano-vgpu</a></p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id=volcano-vgpu执行流程>Volcano vGPU执行流程<a href=#volcano-vgpu执行流程 class=hash-link aria-label="Direct link to Volcano vGPU执行流程" title="Direct link to Volcano vGPU执行流程">​</a></h2>
<p><code>Volcano + HAMi vGPU</code>的完整执行流程涉及多个组件的协同工作，从<code>Pod</code>创建到最终运行在节点上，经历了以下关键步骤：</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id=组件交互流程>组件交互流程<a href=#组件交互流程 class=hash-link aria-label="Direct link to 组件交互流程" title="Direct link to 组件交互流程">​</a></h3>
<!-- -->
<h3 class="anchor anchorWithStickyNavbar_LWe7" id=详细流程介绍>详细流程介绍<a href=#详细流程介绍 class=hash-link aria-label="Direct link to 详细流程介绍" title="Direct link to 详细流程介绍">​</a></h3>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id=阶段1pod创建>阶段1：Pod创建<a href=#阶段1pod创建 class=hash-link aria-label="Direct link to 阶段1：Pod创建" title="Direct link to 阶段1：Pod创建">​</a></h4>
<ol>
<li><strong>用户创建Pod</strong>
<div class="language-yaml codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#f8f8f2;--prism-background-color:#272822><div class=codeBlockContent_biex><pre tabindex=0 class="prism-code language-yaml codeBlock_bY9V thin-scrollbar" style=color:#f8f8f2;background-color:#272822><code class=codeBlockLines_e6Vv><span class=token-line style=color:#f8f8f2><span class="token key atrule">apiVersion</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"> v1</span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain"></span><span class="token key atrule">kind</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"> Pod</span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain"></span><span class="token key atrule">metadata</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">  </span><span class="token key atrule">name</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"> vgpu</span><span class="token punctuation" style=color:#f8f8f2>-</span><span class="token plain">test</span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain"></span><span class="token key atrule">spec</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">  </span><span class="token key atrule">schedulerName</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"> volcano  </span><span class="token comment" style=color:#8292a2;font-style:italic># 指定使用 Volcano 调度器</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">  </span><span class="token key atrule">containers</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">  </span><span class="token punctuation" style=color:#f8f8f2>-</span><span class="token plain"> </span><span class="token key atrule">name</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"> cuda</span><span class="token punctuation" style=color:#f8f8f2>-</span><span class="token plain">app</span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">    </span><span class="token key atrule">image</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"> nvidia/cuda</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain">11.0</span><span class="token punctuation" style=color:#f8f8f2>-</span><span class="token plain">base</span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">    </span><span class="token key atrule">resources</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">      </span><span class="token key atrule">limits</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">        </span><span class="token key atrule">volcano.sh/vgpu-number</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"> </span><span class="token number" style=color:#ae81ff>2</span><span class="token plain">        </span><span class="token comment" style=color:#8292a2;font-style:italic># 请求 2 张 GPU 卡</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">        </span><span class="token key atrule">volcano.sh/vgpu-memory</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"> </span><span class="token number" style=color:#ae81ff>3000</span><span class="token plain">     </span><span class="token comment" style=color:#8292a2;font-style:italic># （可选）每个 vGPU 使用 3G 显存</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">        </span><span class="token key atrule">volcano.sh/vgpu-cores</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"> </span><span class="token number" style=color:#ae81ff>50</span><span class="token plain">        </span><span class="token comment" style=color:#8292a2;font-style:italic># （可选）每个 vGPU 使用 50% 核心</span><br></span></code></pre><div class=buttonGroup__atx><button type=button aria-label="Copy code to clipboard" title=Copy class=clean-btn><span class=copyButtonIcons_eSgA aria-hidden=true><svg viewBox="0 0 24 24" class=copyButtonIcon_y97N><path fill=currentColor d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"/></svg><svg viewBox="0 0 24 24" class=copyButtonSuccessIcon_LjdS><path fill=currentColor d=M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z /></svg></span></button></div></div></div>
</li>
</ol>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id=阶段2调度器调度>阶段2：调度器调度<a href=#阶段2调度器调度 class=hash-link aria-label="Direct link to 阶段2：调度器调度" title="Direct link to 阶段2：调度器调度">​</a></h4>
<ol start=2>
<li>
<p><strong>Volcano Scheduler接收调度请求</strong></p>
<ul>
<li><code>Scheduler</code>从<code>API Server</code>获取待调度的<code>Pod</code></li>
<li>初始化调度会话（<code>Session</code>）</li>
</ul>
</li>
<li>
<p><strong>deviceshare插件执行预选（Predicate）</strong></p>
<div class="language-go codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#f8f8f2;--prism-background-color:#272822><div class=codeBlockContent_biex><pre tabindex=0 class="prism-code language-go codeBlock_bY9V thin-scrollbar" style=color:#f8f8f2;background-color:#272822><code class=codeBlockLines_e6Vv><span class=token-line style=color:#f8f8f2><span class="token comment" style=color:#8292a2;font-style:italic>// 遍历所有注册的设备类型</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain"></span><span class="token keyword" style=color:#66d9ef>for</span><span class="token plain"> </span><span class="token boolean" style=color:#ae81ff>_</span><span class="token punctuation" style=color:#f8f8f2>,</span><span class="token plain"> val </span><span class="token operator" style=color:#66d9ef>:=</span><span class="token plain"> </span><span class="token keyword" style=color:#66d9ef>range</span><span class="token plain"> api</span><span class="token punctuation" style=color:#f8f8f2>.</span><span class="token plain">RegisteredDevices </span><span class="token punctuation" style=color:#f8f8f2>{</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">    </span><span class="token keyword" style=color:#66d9ef>if</span><span class="token plain"> dev</span><span class="token punctuation" style=color:#f8f8f2>,</span><span class="token plain"> ok </span><span class="token operator" style=color:#66d9ef>:=</span><span class="token plain"> node</span><span class="token punctuation" style=color:#f8f8f2>.</span><span class="token plain">Others</span><span class="token punctuation" style=color:#f8f8f2>[</span><span class="token plain">val</span><span class="token punctuation" style=color:#f8f8f2>]</span><span class="token punctuation" style=color:#f8f8f2>.</span><span class="token punctuation" style=color:#f8f8f2>(</span><span class="token plain">api</span><span class="token punctuation" style=color:#f8f8f2>.</span><span class="token plain">Devices</span><span class="token punctuation" style=color:#f8f8f2>)</span><span class="token punctuation" style=color:#f8f8f2>;</span><span class="token plain"> ok </span><span class="token punctuation" style=color:#f8f8f2>{</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">        </span><span class="token comment" style=color:#8292a2;font-style:italic>// 调用FilterNode检查节点是否满足vGPU资源需求</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">        code</span><span class="token punctuation" style=color:#f8f8f2>,</span><span class="token plain"> msg</span><span class="token punctuation" style=color:#f8f8f2>,</span><span class="token plain"> err </span><span class="token operator" style=color:#66d9ef>:=</span><span class="token plain"> dev</span><span class="token punctuation" style=color:#f8f8f2>.</span><span class="token function" style=color:#e6db74>FilterNode</span><span class="token punctuation" style=color:#f8f8f2>(</span><span class="token plain">task</span><span class="token punctuation" style=color:#f8f8f2>.</span><span class="token plain">Pod</span><span class="token punctuation" style=color:#f8f8f2>,</span><span class="token plain"> dp</span><span class="token punctuation" style=color:#f8f8f2>.</span><span class="token plain">schedulePolicy</span><span class="token punctuation" style=color:#f8f8f2>)</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">        </span><span class="token keyword" style=color:#66d9ef>if</span><span class="token plain"> err </span><span class="token operator" style=color:#66d9ef>!=</span><span class="token plain"> </span><span class="token boolean" style=color:#ae81ff>nil</span><span class="token plain"> </span><span class="token punctuation" style=color:#f8f8f2>{</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">            </span><span class="token comment" style=color:#8292a2;font-style:italic>// 节点不满足条件，过滤掉</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">            </span><span class="token keyword" style=color:#66d9ef>return</span><span class="token plain"> api</span><span class="token punctuation" style=color:#f8f8f2>.</span><span class="token function" style=color:#e6db74>NewFitErrWithStatus</span><span class="token punctuation" style=color:#f8f8f2>(</span><span class="token plain">task</span><span class="token punctuation" style=color:#f8f8f2>,</span><span class="token plain"> node</span><span class="token punctuation" style=color:#f8f8f2>,</span><span class="token plain"> predicateStatus</span><span class="token operator" style=color:#66d9ef>...</span><span class="token punctuation" style=color:#f8f8f2>)</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">        </span><span class="token punctuation" style=color:#f8f8f2>}</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">    </span><span class="token punctuation" style=color:#f8f8f2>}</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain"></span><span class="token punctuation" style=color:#f8f8f2>}</span><br></span></code></pre><div class=buttonGroup__atx><button type=button aria-label="Copy code to clipboard" title=Copy class=clean-btn><span class=copyButtonIcons_eSgA aria-hidden=true><svg viewBox="0 0 24 24" class=copyButtonIcon_y97N><path fill=currentColor d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"/></svg><svg viewBox="0 0 24 24" class=copyButtonSuccessIcon_LjdS><path fill=currentColor d=M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z /></svg></span></button></div></div></div>
<p><strong>预选检查内容</strong>：</p>
<ul>
<li>节点是否有足够的<code>vGPU</code>数量</li>
<li>节点是否有足够的显存（<code>vgpu-memory</code>）</li>
<li>节点是否有足够的算力（<code>vgpu-cores</code>）</li>
<li>检查节点<code>Annotation</code>中的设备注册信息（<code>volcano.sh/node-vgpu-register</code>）</li>
</ul>
</li>
<li>
<p><strong>deviceshare插件执行打分（Score）</strong></p>
<div class="language-go codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#f8f8f2;--prism-background-color:#272822><div class=codeBlockContent_biex><pre tabindex=0 class="prism-code language-go codeBlock_bY9V thin-scrollbar" style=color:#f8f8f2;background-color:#272822><code class=codeBlockLines_e6Vv><span class=token-line style=color:#f8f8f2><span class="token comment" style=color:#8292a2;font-style:italic>// 计算节点设备得分</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain"></span><span class="token keyword" style=color:#66d9ef>for</span><span class="token plain"> </span><span class="token boolean" style=color:#ae81ff>_</span><span class="token punctuation" style=color:#f8f8f2>,</span><span class="token plain"> devices </span><span class="token operator" style=color:#66d9ef>:=</span><span class="token plain"> </span><span class="token keyword" style=color:#66d9ef>range</span><span class="token plain"> node</span><span class="token punctuation" style=color:#f8f8f2>.</span><span class="token plain">Others </span><span class="token punctuation" style=color:#f8f8f2>{</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">    </span><span class="token keyword" style=color:#66d9ef>if</span><span class="token plain"> devices</span><span class="token punctuation" style=color:#f8f8f2>.</span><span class="token punctuation" style=color:#f8f8f2>(</span><span class="token plain">api</span><span class="token punctuation" style=color:#f8f8f2>.</span><span class="token plain">Devices</span><span class="token punctuation" style=color:#f8f8f2>)</span><span class="token punctuation" style=color:#f8f8f2>.</span><span class="token function" style=color:#e6db74>HasDeviceRequest</span><span class="token punctuation" style=color:#f8f8f2>(</span><span class="token plain">pod</span><span class="token punctuation" style=color:#f8f8f2>)</span><span class="token plain"> </span><span class="token punctuation" style=color:#f8f8f2>{</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">        ns </span><span class="token operator" style=color:#66d9ef>:=</span><span class="token plain"> devices</span><span class="token punctuation" style=color:#f8f8f2>.</span><span class="token punctuation" style=color:#f8f8f2>(</span><span class="token plain">api</span><span class="token punctuation" style=color:#f8f8f2>.</span><span class="token plain">Devices</span><span class="token punctuation" style=color:#f8f8f2>)</span><span class="token punctuation" style=color:#f8f8f2>.</span><span class="token function" style=color:#e6db74>ScoreNode</span><span class="token punctuation" style=color:#f8f8f2>(</span><span class="token plain">pod</span><span class="token punctuation" style=color:#f8f8f2>,</span><span class="token plain"> schedulePolicy</span><span class="token punctuation" style=color:#f8f8f2>)</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">        s </span><span class="token operator" style=color:#66d9ef>+=</span><span class="token plain"> ns</span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">    </span><span class="token punctuation" style=color:#f8f8f2>}</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain"></span><span class="token punctuation" style=color:#f8f8f2>}</span><br></span></code></pre><div class=buttonGroup__atx><button type=button aria-label="Copy code to clipboard" title=Copy class=clean-btn><span class=copyButtonIcons_eSgA aria-hidden=true><svg viewBox="0 0 24 24" class=copyButtonIcon_y97N><path fill=currentColor d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"/></svg><svg viewBox="0 0 24 24" class=copyButtonSuccessIcon_LjdS><path fill=currentColor d=M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z /></svg></span></button></div></div></div>
<p><strong>打分策略</strong>：</p>
<ul>
<li><code>binpack</code>：优先选择资源使用率高的节点（资源紧凑）</li>
<li><code>spread</code>：优先选择资源使用率低的节点（资源分散）</li>
</ul>
</li>
<li>
<p><strong>调度决策与绑定</strong></p>
<ul>
<li>选择得分最高的节点</li>
<li>更新节点<code>Annotation</code>：<code>volcano.sh/vgpu-devices-allocated</code></li>
<li>记录分配的<code>GPU</code>设备信息（设备<code>ID</code>、显存、算力等）</li>
<li>将<code>Pod</code>绑定到目标节点</li>
<li>最终调度后的<code>Pod</code>会自动增加以下注解信息：<!-- -->
<div class="language-yaml codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#f8f8f2;--prism-background-color:#272822><div class=codeBlockContent_biex><pre tabindex=0 class="prism-code language-yaml codeBlock_bY9V thin-scrollbar" style=color:#f8f8f2;background-color:#272822><code class=codeBlockLines_e6Vv><span class=token-line style=color:#f8f8f2><span class="token key atrule">apiVersion</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"> v1</span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain"></span><span class="token key atrule">kind</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"> Pod</span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain"></span><span class="token key atrule">metadata</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">  </span><span class="token key atrule">annotations</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">    </span><span class="token key atrule">scheduling.k8s.io/group-name</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"> podgroup</span><span class="token punctuation" style=color:#f8f8f2>-</span><span class="token plain">d6d0ed67</span><span class="token punctuation" style=color:#f8f8f2>-</span><span class="token plain">9b3f</span><span class="token punctuation" style=color:#f8f8f2>-</span><span class="token plain">4f17</span><span class="token punctuation" style=color:#f8f8f2>-</span><span class="token plain">aae5</span><span class="token punctuation" style=color:#f8f8f2>-</span><span class="token plain">b24c3b2f5c87</span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">    </span><span class="token key atrule">volcano.sh/bind-phase</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"> success</span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">    </span><span class="token key atrule">volcano.sh/bind-time</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"> </span><span class="token string" style=color:#a6e22e>"1764060249"</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">    </span><span class="token key atrule">volcano.sh/devices-to-allocate</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"> </span><span class="token string" style=color:#a6e22e>""</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">    </span><span class="token key atrule">volcano.sh/vgpu-ids-new</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"> </span><span class="token string" style=color:#a6e22e>'GPU-bc94e532-1820-8ee8-ceaa-704166369c7c,NVIDIA,3000,50:GPU-5beec879-79c9-6252-3aaa-9f5e146ba220,NVIDIA,3000,50:'</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">    </span><span class="token key atrule">volcano.sh/vgpu-node</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"> dev</span><span class="token punctuation" style=color:#f8f8f2>-</span><span class="token plain">app</span><span class="token punctuation" style=color:#f8f8f2>-</span><span class="token plain">2</span><span class="token punctuation" style=color:#f8f8f2>-</span><span class="token plain">150</span><span class="token punctuation" style=color:#f8f8f2>-</span><span class="token plain">master</span><span class="token punctuation" style=color:#f8f8f2>-</span><span class="token number" style=color:#ae81ff>1</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">    </span><span class="token key atrule">volcano.sh/vgpu-time</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"> </span><span class="token string" style=color:#a6e22e>"18446744073709551615"</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain"></span><span class="token comment" style=color:#8292a2;font-style:italic># ...</span><br></span></code></pre><div class=buttonGroup__atx><button type=button aria-label="Copy code to clipboard" title=Copy class=clean-btn><span class=copyButtonIcons_eSgA aria-hidden=true><svg viewBox="0 0 24 24" class=copyButtonIcon_y97N><path fill=currentColor d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"/></svg><svg viewBox="0 0 24 24" class=copyButtonSuccessIcon_LjdS><path fill=currentColor d=M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z /></svg></span></button></div></div></div>
</li>
</ul>
</li>
</ol>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id=阶段3device-plugin分配>阶段3：Device Plugin分配<a href=#阶段3device-plugin分配 class=hash-link aria-label="Direct link to 阶段3：Device Plugin分配" title="Direct link to 阶段3：Device Plugin分配">​</a></h4>
<ol start=6>
<li>
<p><strong>Kubelet调用Device Plugin</strong></p>
<ul>
<li><code>Kubelet</code>检测到<code>Pod</code>被调度到本节点</li>
<li>读取<code>Pod</code>的资源请求（<code>volcano.sh/vgpu-*</code>）</li>
<li>调用<code>volcano-vgpu-device-plugin</code>的<code>Allocate</code>方法</li>
</ul>
</li>
<li>
<p><strong>Device Plugin执行分配</strong></p>
<div class="language-go codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#f8f8f2;--prism-background-color:#272822><div class=codeBlockContent_biex><pre tabindex=0 class="prism-code language-go codeBlock_bY9V thin-scrollbar" style=color:#f8f8f2;background-color:#272822><code class=codeBlockLines_e6Vv><span class=token-line style=color:#f8f8f2><span class="token comment" style=color:#8292a2;font-style:italic>// 初始化NVML</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">nvml</span><span class="token punctuation" style=color:#f8f8f2>.</span><span class="token function" style=color:#e6db74>Init</span><span class="token punctuation" style=color:#f8f8f2>(</span><span class="token punctuation" style=color:#f8f8f2>)</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain"></span><span class="token comment" style=color:#8292a2;font-style:italic>// 创建设备缓存</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">cache </span><span class="token operator" style=color:#66d9ef>:=</span><span class="token plain"> nvidiadevice</span><span class="token punctuation" style=color:#f8f8f2>.</span><span class="token function" style=color:#e6db74>NewDeviceCache</span><span class="token punctuation" style=color:#f8f8f2>(</span><span class="token punctuation" style=color:#f8f8f2>)</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">cache</span><span class="token punctuation" style=color:#f8f8f2>.</span><span class="token function" style=color:#e6db74>Start</span><span class="token punctuation" style=color:#f8f8f2>(</span><span class="token punctuation" style=color:#f8f8f2>)</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain"></span><span class="token comment" style=color:#8292a2;font-style:italic>// 创建设备注册器</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">register </span><span class="token operator" style=color:#66d9ef>:=</span><span class="token plain"> nvidiadevice</span><span class="token punctuation" style=color:#f8f8f2>.</span><span class="token function" style=color:#e6db74>NewDeviceRegister</span><span class="token punctuation" style=color:#f8f8f2>(</span><span class="token plain">cache</span><span class="token punctuation" style=color:#f8f8f2>)</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">register</span><span class="token punctuation" style=color:#f8f8f2>.</span><span class="token function" style=color:#e6db74>Start</span><span class="token punctuation" style=color:#f8f8f2>(</span><span class="token punctuation" style=color:#f8f8f2>)</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain"></span><span class="token comment" style=color:#8292a2;font-style:italic>// 根据MIG策略获取插件</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">plugins </span><span class="token operator" style=color:#66d9ef>=</span><span class="token plain"> migStrategy</span><span class="token punctuation" style=color:#f8f8f2>.</span><span class="token function" style=color:#e6db74>GetPlugins</span><span class="token punctuation" style=color:#f8f8f2>(</span><span class="token plain">nvidiaCfg</span><span class="token punctuation" style=color:#f8f8f2>,</span><span class="token plain"> cache</span><span class="token punctuation" style=color:#f8f8f2>)</span><br></span></code></pre><div class=buttonGroup__atx><button type=button aria-label="Copy code to clipboard" title=Copy class=clean-btn><span class=copyButtonIcons_eSgA aria-hidden=true><svg viewBox="0 0 24 24" class=copyButtonIcon_y97N><path fill=currentColor d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"/></svg><svg viewBox="0 0 24 24" class=copyButtonSuccessIcon_LjdS><path fill=currentColor d=M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z /></svg></span></button></div></div></div>
<p><strong>Allocate方法职责</strong>：</p>
<ul>
<li>读取<code>Volcano Scheduler</code>在节点<code>Annotation</code>中记录的分配信息</li>
<li>确定要使用的物理<code>GPU</code>设备</li>
<li>生成设备挂载路径（<code>/dev/nvidia*</code>）</li>
<li>生成环境变量：<!-- -->
<ul>
<li><code>NVIDIA_VISIBLE_DEVICES</code>：可见的<code>GPU UUID</code></li>
<li><code>CUDA_DEVICE_ORDER=PCI_BUS_ID</code></li>
<li><code>CUDA_VISIBLE_DEVICES</code>：对应的设备索引</li>
</ul>
</li>
<li>返回<code>ContainerAllocateResponse</code>给<code>Kubelet</code></li>
</ul>
</li>
</ol>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id=阶段4容器运行时处理>阶段4：容器运行时处理<a href=#阶段4容器运行时处理 class=hash-link aria-label="Direct link to 阶段4：容器运行时处理" title="Direct link to 阶段4：容器运行时处理">​</a></h4>
<ol start=8>
<li>
<p><strong>Kubelet调用Container Runtime</strong></p>
<ul>
<li>将<code>Device Plugin</code>返回的设备和环境变量传递给<code>Container Runtime</code></li>
<li>指定<code>RuntimeClass</code>为<code>nvidia</code>（如果配置）</li>
</ul>
</li>
<li>
<p><strong>NVIDIA Container Runtime注入</strong></p>
<ul>
<li>挂载<code>GPU</code>设备文件（<code>/dev/nvidia*</code>）</li>
<li>挂载<code>NVIDIA</code>驱动库（<code>/usr/lib/x86_64-linux-gnu/libnvidia-*.so</code>）</li>
<li>注入<code>LD_LIBRARY_PATH=/usr/local/vgpu:$LD_LIBRARY_PATH</code></li>
<li>注入其他<code>NVIDIA</code>相关环境变量</li>
</ul>
</li>
<li>
<p><strong>HAMi Core库加载</strong></p>
<ul>
<li>容器启动时，动态链接器根据<code>LD_LIBRARY_PATH</code>搜索库</li>
<li>优先加载<code>/usr/local/vgpu/libvgpu.so</code>（<code>HAMi Core</code>）</li>
<li><code>libvgpu.so</code>劫持<code>CUDA API</code>调用</li>
<li>实现显存和算力的隔离与限制</li>
</ul>
</li>
</ol>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id=阶段5应用运行>阶段5：应用运行<a href=#阶段5应用运行 class=hash-link aria-label="Direct link to 阶段5：应用运行" title="Direct link to 阶段5：应用运行">​</a></h4>
<ol start=11>
<li><strong>应用执行CUDA调用</strong>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#f8f8f2;--prism-background-color:#272822><div class=codeBlockContent_biex><pre tabindex=0 class="prism-code language-text codeBlock_bY9V thin-scrollbar" style=color:#f8f8f2;background-color:#272822><code class=codeBlockLines_e6Vv><span class=token-line style=color:#f8f8f2><span class="token plain">应用调用 cuMemAlloc()</span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">     ↓</span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">libvgpu.so 劫持</span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">     ↓</span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">检查显存配额 (volcano.sh/vgpu-memory)</span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">     ↓</span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">检查算力配额 (volcano.sh/vgpu-cores)</span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">     ↓</span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">调用真实的 CUDA Driver API</span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">     ↓</span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">返回结果给应用</span><br></span></code></pre><div class=buttonGroup__atx><button type=button aria-label="Copy code to clipboard" title=Copy class=clean-btn><span class=copyButtonIcons_eSgA aria-hidden=true><svg viewBox="0 0 24 24" class=copyButtonIcon_y97N><path fill=currentColor d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"/></svg><svg viewBox="0 0 24 24" class=copyButtonSuccessIcon_LjdS><path fill=currentColor d=M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z /></svg></span></button></div></div></div>
</li>
</ol>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id=volcano-vgpu与独立hami部署的区别>Volcano vGPU与独立HAMi部署的区别<a href=#volcano-vgpu与独��立hami部署的区别 class=hash-link aria-label="Direct link to Volcano vGPU与独立HAMi部署的区别" title="Direct link to Volcano vGPU与独立HAMi部署的区别">​</a></h2>
<table><thead><tr><th>对比项<th>独立HAMi<th>Volcano + HAMi<tbody><tr><td><strong>调度器</strong><td><code>Kubernetes Default Scheduler</code> + <code>HAMi Scheduler Extender</code><td><code>Volcano Scheduler</code><tr><td><strong>Webhook</strong><td><code>HAMi Mutating Webhook</code><td><code>Volcano Mutating Webhook</code><tr><td><strong>资源名称</strong><td><code>nvidia.com/gpu</code>、<code>nvidia.com/gpumem</code><td><code>volcano.sh/vgpu-number</code>、<code>volcano.sh/vgpu-memory</code><tr><td><strong>调度插件</strong><td><code>Scheduler Extender</code>（外部扩展）<td><code>deviceshare Plugin</code>（内置插件）<tr><td><strong>设备分配</strong><td><code>HAMi Device Plugin</code><td><code>volcano-vgpu-device-plugin</code><tr><td><strong>库注入方式</strong><td><code>Webhook</code>注入<code>LD_PRELOAD</code><td><code>NVIDIA Runtime</code>注入<code>LD_LIBRARY_PATH</code></table>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id=volcano-vgpu中的库注入机制>Volcano vGPU中的库注入机制<a href=#volcano-vgpu中的库注入机制 class=hash-link aria-label="Direct link to Volcano vGPU中的库注入机制" title="Direct link to Volcano vGPU中的库注入机制">​</a></h2>
<p>在<code>Volcano + HAMi</code>集成环境中，<code>HAMi Core</code>库的注入方式与独立部署的<code>HAMi</code>有所不同：</p>
<p><strong>独立部署的HAMi</strong>：</p>
<ul>
<li>通过<code>Mutating Webhook</code>直接向容器注入<code>LD_PRELOAD</code>环境变量</li>
<li>强制预加载<code>libvgpu.so</code>库，实现<code>CUDA API</code>劫持</li>
</ul>
<p><strong>Volcano集成的HAMi</strong>：</p>
<ul>
<li>使用<code>LD_LIBRARY_PATH</code>而非<code>LD_PRELOAD</code></li>
<li>依赖<code>NVIDIA Container Runtime</code>的<code>hook</code>机制</li>
<li>通过<code>RuntimeClass</code>触发库路径注入</li>
</ul>
<p><strong>技术原理</strong>：</p>
<ol>
<li>
<p><strong>Device Plugin初始化阶段</strong>：</p>
<div class="language-yaml codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#f8f8f2;--prism-background-color:#272822><div class=codeBlockContent_biex><pre tabindex=0 class="prism-code language-yaml codeBlock_bY9V thin-scrollbar" style=color:#f8f8f2;background-color:#272822><code class=codeBlockLines_e6Vv><span class=token-line style=color:#f8f8f2><span class="token key atrule">lifecycle</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">  </span><span class="token key atrule">postStart</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">    </span><span class="token key atrule">exec</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">      </span><span class="token key atrule">command</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"> </span><span class="token punctuation" style=color:#f8f8f2>[</span><span class="token string" style=color:#a6e22e>"/bin/sh"</span><span class="token punctuation" style=color:#f8f8f2>,</span><span class="token plain"> </span><span class="token string" style=color:#a6e22e>"-c"</span><span class="token punctuation" style=color:#f8f8f2>,</span><span class="token plain"> </span><span class="token string" style=color:#a6e22e>"cp -f /k8s-vgpu/lib/nvidia/* /usr/local/vgpu/"</span><span class="token punctuation" style=color:#f8f8f2>]</span><br></span></code></pre><div class=buttonGroup__atx><button type=button aria-label="Copy code to clipboard" title=Copy class=clean-btn><span class=copyButtonIcons_eSgA aria-hidden=true><svg viewBox="0 0 24 24" class=copyButtonIcon_y97N><path fill=currentColor d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"/></svg><svg viewBox="0 0 24 24" class=copyButtonSuccessIcon_LjdS><path fill=currentColor d=M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z /></svg></span></button></div></div></div>
<p>将<code>HAMi Core</code>库复制到宿主机的<code>/usr/local/vgpu/</code>目录</p>
</li>
<li>
<p><strong>RuntimeClass配置</strong>：</p>
<div class="language-yaml codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#f8f8f2;--prism-background-color:#272822><div class=codeBlockContent_biex><pre tabindex=0 class="prism-code language-yaml codeBlock_bY9V thin-scrollbar" style=color:#f8f8f2;background-color:#272822><code class=codeBlockLines_e6Vv><span class=token-line style=color:#f8f8f2><span class="token key atrule">apiVersion</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"> node.k8s.io/v1</span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain"></span><span class="token key atrule">kind</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"> RuntimeClass</span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain"></span><span class="token key atrule">metadata</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">  </span><span class="token key atrule">name</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"> nvidia</span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain"></span><span class="token key atrule">handler</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"> nvidia</span><br></span></code></pre><div class=buttonGroup__atx><button type=button aria-label="Copy code to clipboard" title=Copy class=clean-btn><span class=copyButtonIcons_eSgA aria-hidden=true><svg viewBox="0 0 24 24" class=copyButtonIcon_y97N><path fill=currentColor d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"/></svg><svg viewBox="0 0 24 24" class=copyButtonSuccessIcon_LjdS><path fill=currentColor d=M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z /></svg></span></button></div></div></div>
<p>指定使用<code>NVIDIA Container Runtime</code>作为容器运行时</p>
</li>
<li>
<p><strong>环境变量注入</strong>：</p>
<ul>
<li><code>NVIDIA Container Runtime</code>自动设置<code>LD_LIBRARY_PATH=/usr/local/vgpu:$LD_LIBRARY_PATH</code></li>
<li>动态链接器按路径优先级查找共享库</li>
<li><code>/usr/local/vgpu/libvgpu.so</code>中的符号优先被解析，实现<code>CUDA API</code>劫持</li>
</ul>
</li>
</ol>
<p><strong>为什么选择LD_LIBRARY_PATH</strong>：</p>
<table><thead><tr><th>对比维度<th>LD_PRELOAD<th>LD_LIBRARY_PATH<tbody><tr><td>注入方式<td><code>Webhook</code>直接注入<td><code>NVIDIA Runtime</code>自动管理<tr><td>库加载机制<td>强制预加载<td>路径优先级<tr><td>与<code>NVIDIA Runtime</code>兼容性<td>可能冲突<td>原生兼容<tr><td>环境变量管理<td>需手动维护<td><code>Runtime</code>自动处理<tr><td>适用场景<td><code>HAMi</code>独立部署<td><code>Volcano</code>集成部署</table>
<p>这种设计避免了与<code>NVIDIA Container Runtime</code>内部机制的冲突，同时保持了与<code>Volcano</code>调度器的良好集成。</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id=volcano-vgpu监控指标>Volcano vGPU监控指标<a href=#volcano-vgpu监控指标 class=hash-link aria-label="Direct link to Volcano vGPU监控指标" title="Direct link to Volcano vGPU监控指标">​</a></h2>
<p><code>Volcano Scheduler</code>在调度<code>vGPU</code>资源时会暴露<code>Prometheus</code>监控指标，用于观测<code>GPU</code>设备的分配和使用情况。这些指标定义在 <code>pkg/scheduler/api/devices/nvidia/vgpu/metrics.go</code> 中。</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id=设备级指标>设备级指标<a href=#设备级指标 class=hash-link aria-label="Direct link to 设备级指标" title="Direct link to 设备级指标">​</a></h3>
<table><thead><tr><th>指标名称<th>类型<th>标签<th>说明<th>单位<tbody><tr><td><code>volcano_vgpu_device_memory_limit</code><td><code>Gauge</code><td><code>devID</code>, <code>NodeName</code><td><code>GPU</code>卡的总显存容量<td><code>MB</code><tr><td><code>volcano_vgpu_device_allocated_memory</code><td><code>Gauge</code><td><code>devID</code>, <code>NodeName</code><td><code>GPU</code>卡已分配的显存总量<td><code>MB</code><tr><td><code>volcano_vgpu_device_allocated_cores</code><td><code>Gauge</code><td><code>devID</code>, <code>NodeName</code><td><code>GPU</code>卡已分配的算力百分比<td><code>% (0-100)</code><tr><td><code>volcano_vgpu_device_shared_number</code><td><code>Gauge</code><td><code>devID</code>, <code>NodeName</code><td>共享此 <code>GPU</code>卡的<code>Pod</code>数量<td><code>个</code></table>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id=pod-级指标>Pod 级指标<a href=#pod-级指标 class=hash-link aria-label="Direct link to Pod 级指标" title="Direct link to Pod 级指标">​</a></h3>
<table><thead><tr><th>指标名称<th>类型<th>标签<th>说明<th>单位<tbody><tr><td><code>volcano_vgpu_device_memory_allocation_for_a_certain_pod</code><td><code>Gauge</code><td><code>devID</code>, <code>NodeName</code>, <code>podName</code><td>特定<code>Pod</code>在此<code>GPU</code>卡上分配的显存<td><code>MB</code><tr><td><code>volcano_vgpu_device_core_allocation_for_a_certain_pod</code><td><code>Gauge</code><td><code>devID</code>, <code>NodeName</code>, <code>podName</code><td>特定<code>Pod</code>在此<code>GPU</code>卡上分配的算力<td><code>% (0-100)</code></table>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id=常用-promql-查询示例>常用 PromQL 查询示例<a href=#常用-promql-查询示例 class=hash-link aria-label="Direct link to 常用 PromQL 查询示例" title="Direct link to 常用 PromQL 查询示例">​</a></h3>
<ol>
<li>
<p><strong>查看节点上所有 GPU 卡的显存使用率</strong>：</p>
<div class="language-promql codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#f8f8f2;--prism-background-color:#272822><div class=codeBlockContent_biex><pre tabindex=0 class="prism-code language-promql codeBlock_bY9V thin-scrollbar" style=color:#f8f8f2;background-color:#272822><code class=codeBlockLines_e6Vv><span class=token-line style=color:#f8f8f2><span class="token plain">volcano_vgpu_device_allocated_memory / volcano_vgpu_device_memory_limit * 100</span><br></span></code></pre><div class=buttonGroup__atx><button type=button aria-label="Copy code to clipboard" title=Copy class=clean-btn><span class=copyButtonIcons_eSgA aria-hidden=true><svg viewBox="0 0 24 24" class=copyButtonIcon_y97N><path fill=currentColor d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"/></svg><svg viewBox="0 0 24 24" class=copyButtonSuccessIcon_LjdS><path fill=currentColor d=M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z /></svg></span></button></div></div></div>
</li>
<li>
<p><strong>查看 GPU 卡的平均共享数</strong>：</p>
<div class="language-promql codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#f8f8f2;--prism-background-color:#272822><div class=codeBlockContent_biex><pre tabindex=0 class="prism-code language-promql codeBlock_bY9V thin-scrollbar" style=color:#f8f8f2;background-color:#272822><code class=codeBlockLines_e6Vv><span class=token-line style=color:#f8f8f2><span class="token plain">avg(volcano_vgpu_device_shared_number) by (NodeName)</span><br></span></code></pre><div class=buttonGroup__atx><button type=button aria-label="Copy code to clipboard" title=Copy class=clean-btn><span class=copyButtonIcons_eSgA aria-hidden=true><svg viewBox="0 0 24 24" class=copyButtonIcon_y97N><path fill=currentColor d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"/></svg><svg viewBox="0 0 24 24" class=copyButtonSuccessIcon_LjdS><path fill=currentColor d=M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z /></svg></span></button></div></div></div>
</li>
<li>
<p><strong>查看特定节点上 GPU 算力分配情况</strong>：</p>
<div class="language-promql codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#f8f8f2;--prism-background-color:#272822><div class=codeBlockContent_biex><pre tabindex=0 class="prism-code language-promql codeBlock_bY9V thin-scrollbar" style=color:#f8f8f2;background-color:#272822><code class=codeBlockLines_e6Vv><span class=token-line style=color:#f8f8f2><span class="token plain">volcano_vgpu_device_allocated_cores{NodeName="node-1"}</span><br></span></code></pre><div class=buttonGroup__atx><button type=button aria-label="Copy code to clipboard" title=Copy class=clean-btn><span class=copyButtonIcons_eSgA aria-hidden=true><svg viewBox="0 0 24 24" class=copyButtonIcon_y97N><path fill=currentColor d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"/></svg><svg viewBox="0 0 24 24" class=copyButtonSuccessIcon_LjdS><path fill=currentColor d=M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z /></svg></span></button></div></div></div>
</li>
<li>
<p><strong>查看特定 Pod 的 GPU 显存分配</strong>：</p>
<div class="language-promql codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#f8f8f2;--prism-background-color:#272822><div class=codeBlockContent_biex><pre tabindex=0 class="prism-code language-promql codeBlock_bY9V thin-scrollbar" style=color:#f8f8f2;background-color:#272822><code class=codeBlockLines_e6Vv><span class=token-line style=color:#f8f8f2><span class="token plain">volcano_vgpu_device_memory_allocation_for_a_certain_pod{podName="my-training-pod"}</span><br></span></code></pre><div class=buttonGroup__atx><button type=button aria-label="Copy code to clipboard" title=Copy class=clean-btn><span class=copyButtonIcons_eSgA aria-hidden=true><svg viewBox="0 0 24 24" class=copyButtonIcon_y97N><path fill=currentColor d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"/></svg><svg viewBox="0 0 24 24" class=copyButtonSuccessIcon_LjdS><path fill=currentColor d=M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z /></svg></span></button></div></div></div>
</li>
<li>
<p><strong>统计集群中 GPU 卡的总显存利用率</strong>：</p>
<div class="language-promql codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#f8f8f2;--prism-background-color:#272822><div class=codeBlockContent_biex><pre tabindex=0 class="prism-code language-promql codeBlock_bY9V thin-scrollbar" style=color:#f8f8f2;background-color:#272822><code class=codeBlockLines_e6Vv><span class=token-line style=color:#f8f8f2><span class="token plain">sum(volcano_vgpu_device_allocated_memory) / sum(volcano_vgpu_device_memory_limit) * 100</span><br></span></code></pre><div class=buttonGroup__atx><button type=button aria-label="Copy code to clipboard" title=Copy class=clean-btn><span class=copyButtonIcons_eSgA aria-hidden=true><svg viewBox="0 0 24 24" class=copyButtonIcon_y97N><path fill=currentColor d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"/></svg><svg viewBox="0 0 24 24" class=copyButtonSuccessIcon_LjdS><path fill=currentColor d=M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z /></svg></span></button></div></div></div>
</li>
</ol>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id=指标访问方式>指标访问方式<a href=#指标访问方式 class=hash-link aria-label="Direct link to 指标访问方式" title="Direct link to 指标访问方式">​</a></h3>
<p><code>Volcano Scheduler</code>默认在 <code>:8080/metrics</code> 端点暴露<code>Prometheus</code>监控指标。可以通过以下方式访问：</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#f8f8f2;--prism-background-color:#272822><div class=codeBlockContent_biex><pre tabindex=0 class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style=color:#f8f8f2;background-color:#272822><code class=codeBlockLines_e6Vv><span class=token-line style=color:#f8f8f2><span class="token comment" style=color:#8292a2;font-style:italic># 直接访问 Scheduler Pod</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">kubectl port-forward </span><span class="token parameter variable" style=color:#f8f8f2>-n</span><span class="token plain"> volcano-system svc/volcano-scheduler </span><span class="token number" style=color:#ae81ff>8080</span><span class="token plain">:8080</span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain"></span><span class="token function" style=color:#e6db74>curl</span><span class="token plain"> http://localhost:8080/metrics </span><span class="token operator" style=color:#66d9ef>|</span><span class="token plain"> </span><span class="token function" style=color:#e6db74>grep</span><span class="token plain"> volcano_vgpu</span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain"></span><span class="token comment" style=color:#8292a2;font-style:italic># 或配置 Prometheus 自动采集</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain"></span><span class="token comment" style=color:#8292a2;font-style:italic># 在 Prometheus 配置中添加 Volcano Scheduler 的 ServiceMonitor</span><br></span></code></pre><div class=buttonGroup__atx><button type=button aria-label="Copy code to clipboard" title=Copy class=clean-btn><span class=copyButtonIcons_eSgA aria-hidden=true><svg viewBox="0 0 24 24" class=copyButtonIcon_y97N><path fill=currentColor d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"/></svg><svg viewBox="0 0 24 24" class=copyButtonSuccessIcon_LjdS><path fill=currentColor d=M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z /></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id=指标参考数据>指标参考数据<a href=#指标参考数据 class=hash-link aria-label="Direct link to 指标参考数据" title="Direct link to 指标参考数据">​</a></h3>
<div class="language-python codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#f8f8f2;--prism-background-color:#272822><div class=codeBlockContent_biex><pre tabindex=0 class="prism-code language-python codeBlock_bY9V thin-scrollbar" style=color:#f8f8f2;background-color:#272822><code class=codeBlockLines_e6Vv><span class=token-line style=color:#f8f8f2><span class="token comment" style=color:#8292a2;font-style:italic># HELP volcano_vgpu_device_allocated_cores The percentage of gpu compute cores allocated in this card</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain"></span><span class="token comment" style=color:#8292a2;font-style:italic># TYPE volcano_vgpu_device_allocated_cores gauge</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">volcano_vgpu_device_allocated_cores</span><span class="token punctuation" style=color:#f8f8f2>{</span><span class="token plain">NodeName</span><span class="token operator" style=color:#66d9ef>=</span><span class="token string" style=color:#a6e22e>"dev-app-2-150-master-1"</span><span class="token punctuation" style=color:#f8f8f2>,</span><span class="token plain">devID</span><span class="token operator" style=color:#66d9ef>=</span><span class="token string" style=color:#a6e22e>"GPU-3c8ce108-117a-aeae-a3e8-1c0c5dafebe7"</span><span class="token punctuation" style=color:#f8f8f2>}</span><span class="token plain"> </span><span class="token number" style=color:#ae81ff>0</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">volcano_vgpu_device_allocated_cores</span><span class="token punctuation" style=color:#f8f8f2>{</span><span class="token plain">NodeName</span><span class="token operator" style=color:#66d9ef>=</span><span class="token string" style=color:#a6e22e>"dev-app-2-150-master-1"</span><span class="token punctuation" style=color:#f8f8f2>,</span><span class="token plain">devID</span><span class="token operator" style=color:#66d9ef>=</span><span class="token string" style=color:#a6e22e>"GPU-41c5e13c-b480-c473-7a14-dd05a7c4cd43"</span><span class="token punctuation" style=color:#f8f8f2>}</span><span class="token plain"> </span><span class="token number" style=color:#ae81ff>0</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">volcano_vgpu_device_allocated_cores</span><span class="token punctuation" style=color:#f8f8f2>{</span><span class="token plain">NodeName</span><span class="token operator" style=color:#66d9ef>=</span><span class="token string" style=color:#a6e22e>"dev-app-2-150-master-1"</span><span class="token punctuation" style=color:#f8f8f2>,</span><span class="token plain">devID</span><span class="token operator" style=color:#66d9ef>=</span><span class="token string" style=color:#a6e22e>"GPU-4e9cd184-671c-7b17-8fc2-e9bedbc3d604"</span><span class="token punctuation" style=color:#f8f8f2>}</span><span class="token plain"> </span><span class="token number" style=color:#ae81ff>0</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">volcano_vgpu_device_allocated_cores</span><span class="token punctuation" style=color:#f8f8f2>{</span><span class="token plain">NodeName</span><span class="token operator" style=color:#66d9ef>=</span><span class="token string" style=color:#a6e22e>"dev-app-2-150-master-1"</span><span class="token punctuation" style=color:#f8f8f2>,</span><span class="token plain">devID</span><span class="token operator" style=color:#66d9ef>=</span><span class="token string" style=color:#a6e22e>"GPU-4ff93432-c6b5-7330-30e7-9c0c9a1c648b"</span><span class="token punctuation" style=color:#f8f8f2>}</span><span class="token plain"> </span><span class="token number" style=color:#ae81ff>0</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">volcano_vgpu_device_allocated_cores</span><span class="token punctuation" style=color:#f8f8f2>{</span><span class="token plain">NodeName</span><span class="token operator" style=color:#66d9ef>=</span><span class="token string" style=color:#a6e22e>"dev-app-2-150-master-1"</span><span class="token punctuation" style=color:#f8f8f2>,</span><span class="token plain">devID</span><span class="token operator" style=color:#66d9ef>=</span><span class="token string" style=color:#a6e22e>"GPU-5beec879-79c9-6252-3aaa-9f5e146ba220"</span><span class="token punctuation" style=color:#f8f8f2>}</span><span class="token plain"> </span><span class="token number" style=color:#ae81ff>0</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">volcano_vgpu_device_allocated_cores</span><span class="token punctuation" style=color:#f8f8f2>{</span><span class="token plain">NodeName</span><span class="token operator" style=color:#66d9ef>=</span><span class="token string" style=color:#a6e22e>"dev-app-2-150-master-1"</span><span class="token punctuation" style=color:#f8f8f2>,</span><span class="token plain">devID</span><span class="token operator" style=color:#66d9ef>=</span><span class="token string" style=color:#a6e22e>"GPU-aa336186-301a-bc80-5121-a9a2e430811a"</span><span class="token punctuation" style=color:#f8f8f2>}</span><span class="token plain"> </span><span class="token number" style=color:#ae81ff>0</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">volcano_vgpu_device_allocated_cores</span><span class="token punctuation" style=color:#f8f8f2>{</span><span class="token plain">NodeName</span><span class="token operator" style=color:#66d9ef>=</span><span class="token string" style=color:#a6e22e>"dev-app-2-150-master-1"</span><span class="token punctuation" style=color:#f8f8f2>,</span><span class="token plain">devID</span><span class="token operator" style=color:#66d9ef>=</span><span class="token string" style=color:#a6e22e>"GPU-bc47d475-3538-d3eb-f4ba-e46e2639c54c"</span><span class="token punctuation" style=color:#f8f8f2>}</span><span class="token plain"> </span><span class="token number" style=color:#ae81ff>0</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">volcano_vgpu_device_allocated_cores</span><span class="token punctuation" style=color:#f8f8f2>{</span><span class="token plain">NodeName</span><span class="token operator" style=color:#66d9ef>=</span><span class="token string" style=color:#a6e22e>"dev-app-2-150-master-1"</span><span class="token punctuation" style=color:#f8f8f2>,</span><span class="token plain">devID</span><span class="token operator" style=color:#66d9ef>=</span><span class="token string" style=color:#a6e22e>"GPU-bc94e532-1820-8ee8-ceaa-704166369c7c"</span><span class="token punctuation" style=color:#f8f8f2>}</span><span class="token plain"> </span><span class="token number" style=color:#ae81ff>0</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">volcano_vgpu_device_allocated_cores</span><span class="token punctuation" style=color:#f8f8f2>{</span><span class="token plain">NodeName</span><span class="token operator" style=color:#66d9ef>=</span><span class="token string" style=color:#a6e22e>"test-app-64-46-msxf"</span><span class="token punctuation" style=color:#f8f8f2>,</span><span class="token plain">devID</span><span class="token operator" style=color:#66d9ef>=</span><span class="token string" style=color:#a6e22e>"GPU-07df9e74-a474-9fdd-248e-23e553ef2269"</span><span class="token punctuation" style=color:#f8f8f2>}</span><span class="token plain"> </span><span class="token number" style=color:#ae81ff>0</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">volcano_vgpu_device_allocated_cores</span><span class="token punctuation" style=color:#f8f8f2>{</span><span class="token plain">NodeName</span><span class="token operator" style=color:#66d9ef>=</span><span class="token string" style=color:#a6e22e>"test-app-64-46-msxf"</span><span class="token punctuation" style=color:#f8f8f2>,</span><span class="token plain">devID</span><span class="token operator" style=color:#66d9ef>=</span><span class="token string" style=color:#a6e22e>"GPU-0af50c42-326c-bbff-7a49-a49afa433d3d"</span><span class="token punctuation" style=color:#f8f8f2>}</span><span class="token plain"> </span><span class="token number" style=color:#ae81ff>0</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">volcano_vgpu_device_allocated_cores</span><span class="token punctuation" style=color:#f8f8f2>{</span><span class="token plain">NodeName</span><span class="token operator" style=color:#66d9ef>=</span><span class="token string" style=color:#a6e22e>"test-app-64-46-msxf"</span><span class="token punctuation" style=color:#f8f8f2>,</span><span class="token plain">devID</span><span class="token operator" style=color:#66d9ef>=</span><span class="token string" style=color:#a6e22e>"GPU-1bc8fc24-c939-545a-e272-2229d066d048"</span><span class="token punctuation" style=color:#f8f8f2>}</span><span class="token plain"> </span><span class="token number" style=color:#ae81ff>0</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">volcano_vgpu_device_allocated_cores</span><span class="token punctuation" style=color:#f8f8f2>{</span><span class="token plain">NodeName</span><span class="token operator" style=color:#66d9ef>=</span><span class="token string" style=color:#a6e22e>"test-app-64-46-msxf"</span><span class="token punctuation" style=color:#f8f8f2>,</span><span class="token plain">devID</span><span class="token operator" style=color:#66d9ef>=</span><span class="token string" style=color:#a6e22e>"GPU-50baa64a-6476-a970-1013-121dff41ec78"</span><span class="token punctuation" style=color:#f8f8f2>}</span><span class="token plain"> </span><span class="token number" style=color:#ae81ff>0</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">volcano_vgpu_device_allocated_cores</span><span class="token punctuation" style=color:#f8f8f2>{</span><span class="token plain">NodeName</span><span class="token operator" style=color:#66d9ef>=</span><span class="token string" style=color:#a6e22e>"test-app-64-46-msxf"</span><span class="token punctuation" style=color:#f8f8f2>,</span><span class="token plain">devID</span><span class="token operator" style=color:#66d9ef>=</span><span class="token string" style=color:#a6e22e>"GPU-7050631b-6524-21e3-41cf-6e08fc89220d"</span><span class="token punctuation" style=color:#f8f8f2>}</span><span class="token plain"> </span><span class="token number" style=color:#ae81ff>0</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">volcano_vgpu_device_allocated_cores</span><span class="token punctuation" style=color:#f8f8f2>{</span><span class="token plain">NodeName</span><span class="token operator" style=color:#66d9ef>=</span><span class="token string" style=color:#a6e22e>"test-app-64-46-msxf"</span><span class="token punctuation" style=color:#f8f8f2>,</span><span class="token plain">devID</span><span class="token operator" style=color:#66d9ef>=</span><span class="token string" style=color:#a6e22e>"GPU-7299e30f-ccc4-a274-3e1a-77546d96a448"</span><span class="token punctuation" style=color:#f8f8f2>}</span><span class="token plain"> </span><span class="token number" style=color:#ae81ff>0</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">volcano_vgpu_device_allocated_cores</span><span class="token punctuation" style=color:#f8f8f2>{</span><span class="token plain">NodeName</span><span class="token operator" style=color:#66d9ef>=</span><span class="token string" style=color:#a6e22e>"test-app-64-46-msxf"</span><span class="token punctuation" style=color:#f8f8f2>,</span><span class="token plain">devID</span><span class="token operator" style=color:#66d9ef>=</span><span class="token string" style=color:#a6e22e>"GPU-8cae1965-8e72-af03-1f8c-2e64646392bf"</span><span class="token punctuation" style=color:#f8f8f2>}</span><span class="token plain"> </span><span class="token number" style=color:#ae81ff>0</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">volcano_vgpu_device_allocated_cores</span><span class="token punctuation" style=color:#f8f8f2>{</span><span class="token plain">NodeName</span><span class="token operator" style=color:#66d9ef>=</span><span class="token string" style=color:#a6e22e>"test-app-64-46-msxf"</span><span class="token punctuation" style=color:#f8f8f2>,</span><span class="token plain">devID</span><span class="token operator" style=color:#66d9ef>=</span><span class="token string" style=color:#a6e22e>"GPU-f7219cd7-e3ef-3b1b-4fa2-e84e8d5d4ce5"</span><span class="token punctuation" style=color:#f8f8f2>}</span><span class="token plain"> </span><span class="token number" style=color:#ae81ff>0</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain"></span><span class="token comment" style=color:#8292a2;font-style:italic># HELP volcano_vgpu_device_allocated_memory The number of vgpu memory allocated in this card</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain"></span><span class="token comment" style=color:#8292a2;font-style:italic># TYPE volcano_vgpu_device_allocated_memory gauge</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">volcano_vgpu_device_allocated_memory</span><span class="token punctuation" style=color:#f8f8f2>{</span><span class="token plain">NodeName</span><span class="token operator" style=color:#66d9ef>=</span><span class="token string" style=color:#a6e22e>"dev-app-2-150-master-1"</span><span class="token punctuation" style=color:#f8f8f2>,</span><span class="token plain">devID</span><span class="token operator" style=color:#66d9ef>=</span><span class="token string" style=color:#a6e22e>"GPU-3c8ce108-117a-aeae-a3e8-1c0c5dafebe7"</span><span class="token punctuation" style=color:#f8f8f2>}</span><span class="token plain"> </span><span class="token number" style=color:#ae81ff>0</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">volcano_vgpu_device_allocated_memory</span><span class="token punctuation" style=color:#f8f8f2>{</span><span class="token plain">NodeName</span><span class="token operator" style=color:#66d9ef>=</span><span class="token string" style=color:#a6e22e>"dev-app-2-150-master-1"</span><span class="token punctuation" style=color:#f8f8f2>,</span><span class="token plain">devID</span><span class="token operator" style=color:#66d9ef>=</span><span class="token string" style=color:#a6e22e>"GPU-41c5e13c-b480-c473-7a14-dd05a7c4cd43"</span><span class="token punctuation" style=color:#f8f8f2>}</span><span class="token plain"> </span><span class="token number" style=color:#ae81ff>0</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">volcano_vgpu_device_allocated_memory</span><span class="token punctuation" style=color:#f8f8f2>{</span><span class="token plain">NodeName</span><span class="token operator" style=color:#66d9ef>=</span><span class="token string" style=color:#a6e22e>"dev-app-2-150-master-1"</span><span class="token punctuation" style=color:#f8f8f2>,</span><span class="token plain">devID</span><span class="token operator" style=color:#66d9ef>=</span><span class="token string" style=color:#a6e22e>"GPU-4e9cd184-671c-7b17-8fc2-e9bedbc3d604"</span><span class="token punctuation" style=color:#f8f8f2>}</span><span class="token plain"> </span><span class="token number" style=color:#ae81ff>0</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">volcano_vgpu_device_allocated_memory</span><span class="token punctuation" style=color:#f8f8f2>{</span><span class="token plain">NodeName</span><span class="token operator" style=color:#66d9ef>=</span><span class="token string" style=color:#a6e22e>"dev-app-2-150-master-1"</span><span class="token punctuation" style=color:#f8f8f2>,</span><span class="token plain">devID</span><span class="token operator" style=color:#66d9ef>=</span><span class="token string" style=color:#a6e22e>"GPU-4ff93432-c6b5-7330-30e7-9c0c9a1c648b"</span><span class="token punctuation" style=color:#f8f8f2>}</span><span class="token plain"> </span><span class="token number" style=color:#ae81ff>0</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">volcano_vgpu_device_allocated_memory</span><span class="token punctuation" style=color:#f8f8f2>{</span><span class="token plain">NodeName</span><span class="token operator" style=color:#66d9ef>=</span><span class="token string" style=color:#a6e22e>"dev-app-2-150-master-1"</span><span class="token punctuation" style=color:#f8f8f2>,</span><span class="token plain">devID</span><span class="token operator" style=color:#66d9ef>=</span><span class="token string" style=color:#a6e22e>"GPU-5beec879-79c9-6252-3aaa-9f5e146ba220"</span><span class="token punctuation" style=color:#f8f8f2>}</span><span class="token plain"> </span><span class="token number" style=color:#ae81ff>24564</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">volcano_vgpu_device_allocated_memory</span><span class="token punctuation" style=color:#f8f8f2>{</span><span class="token plain">NodeName</span><span class="token operator" style=color:#66d9ef>=</span><span class="token string" style=color:#a6e22e>"dev-app-2-150-master-1"</span><span class="token punctuation" style=color:#f8f8f2>,</span><span class="token plain">devID</span><span class="token operator" style=color:#66d9ef>=</span><span class="token string" style=color:#a6e22e>"GPU-aa336186-301a-bc80-5121-a9a2e430811a"</span><span class="token punctuation" style=color:#f8f8f2>}</span><span class="token plain"> </span><span class="token number" style=color:#ae81ff>0</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">volcano_vgpu_device_allocated_memory</span><span class="token punctuation" style=color:#f8f8f2>{</span><span class="token plain">NodeName</span><span class="token operator" style=color:#66d9ef>=</span><span class="token string" style=color:#a6e22e>"dev-app-2-150-master-1"</span><span class="token punctuation" style=color:#f8f8f2>,</span><span class="token plain">devID</span><span class="token operator" style=color:#66d9ef>=</span><span class="token string" style=color:#a6e22e>"GPU-bc47d475-3538-d3eb-f4ba-e46e2639c54c"</span><span class="token punctuation" style=color:#f8f8f2>}</span><span class="token plain"> </span><span class="token number" style=color:#ae81ff>0</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">volcano_vgpu_device_allocated_memory</span><span class="token punctuation" style=color:#f8f8f2>{</span><span class="token plain">NodeName</span><span class="token operator" style=color:#66d9ef>=</span><span class="token string" style=color:#a6e22e>"dev-app-2-150-master-1"</span><span class="token punctuation" style=color:#f8f8f2>,</span><span class="token plain">devID</span><span class="token operator" style=color:#66d9ef>=</span><span class="token string" style=color:#a6e22e>"GPU-bc94e532-1820-8ee8-ceaa-704166369c7c"</span><span class="token punctuation" style=color:#f8f8f2>}</span><span class="token plain"> </span><span class="token number" style=color:#ae81ff>24564</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">volcano_vgpu_device_allocated_memory</span><span class="token punctuation" style=color:#f8f8f2>{</span><span class="token plain">NodeName</span><span class="token operator" style=color:#66d9ef>=</span><span class="token string" style=color:#a6e22e>"test-app-64-46-msxf"</span><span class="token punctuation" style=color:#f8f8f2>,</span><span class="token plain">devID</span><span class="token operator" style=color:#66d9ef>=</span><span class="token string" style=color:#a6e22e>"GPU-07df9e74-a474-9fdd-248e-23e553ef2269"</span><span class="token punctuation" style=color:#f8f8f2>}</span><span class="token plain"> </span><span class="token number" style=color:#ae81ff>0</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">volcano_vgpu_device_allocated_memory</span><span class="token punctuation" style=color:#f8f8f2>{</span><span class="token plain">NodeName</span><span class="token operator" style=color:#66d9ef>=</span><span class="token string" style=color:#a6e22e>"test-app-64-46-msxf"</span><span class="token punctuation" style=color:#f8f8f2>,</span><span class="token plain">devID</span><span class="token operator" style=color:#66d9ef>=</span><span class="token string" style=color:#a6e22e>"GPU-0af50c42-326c-bbff-7a49-a49afa433d3d"</span><span class="token punctuation" style=color:#f8f8f2>}</span><span class="token plain"> </span><span class="token number" style=color:#ae81ff>0</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">volcano_vgpu_device_allocated_memory</span><span class="token punctuation" style=color:#f8f8f2>{</span><span class="token plain">NodeName</span><span class="token operator" style=color:#66d9ef>=</span><span class="token string" style=color:#a6e22e>"test-app-64-46-msxf"</span><span class="token punctuation" style=color:#f8f8f2>,</span><span class="token plain">devID</span><span class="token operator" style=color:#66d9ef>=</span><span class="token string" style=color:#a6e22e>"GPU-1bc8fc24-c939-545a-e272-2229d066d048"</span><span class="token punctuation" style=color:#f8f8f2>}</span><span class="token plain"> </span><span class="token number" style=color:#ae81ff>0</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">volcano_vgpu_device_allocated_memory</span><span class="token punctuation" style=color:#f8f8f2>{</span><span class="token plain">NodeName</span><span class="token operator" style=color:#66d9ef>=</span><span class="token string" style=color:#a6e22e>"test-app-64-46-msxf"</span><span class="token punctuation" style=color:#f8f8f2>,</span><span class="token plain">devID</span><span class="token operator" style=color:#66d9ef>=</span><span class="token string" style=color:#a6e22e>"GPU-50baa64a-6476-a970-1013-121dff41ec78"</span><span class="token punctuation" style=color:#f8f8f2>}</span><span class="token plain"> </span><span class="token number" style=color:#ae81ff>0</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">volcano_vgpu_device_allocated_memory</span><span class="token punctuation" style=color:#f8f8f2>{</span><span class="token plain">NodeName</span><span class="token operator" style=color:#66d9ef>=</span><span class="token string" style=color:#a6e22e>"test-app-64-46-msxf"</span><span class="token punctuation" style=color:#f8f8f2>,</span><span class="token plain">devID</span><span class="token operator" style=color:#66d9ef>=</span><span class="token string" style=color:#a6e22e>"GPU-7050631b-6524-21e3-41cf-6e08fc89220d"</span><span class="token punctuation" style=color:#f8f8f2>}</span><span class="token plain"> </span><span class="token number" style=color:#ae81ff>0</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">volcano_vgpu_device_allocated_memory</span><span class="token punctuation" style=color:#f8f8f2>{</span><span class="token plain">NodeName</span><span class="token operator" style=color:#66d9ef>=</span><span class="token string" style=color:#a6e22e>"test-app-64-46-msxf"</span><span class="token punctuation" style=color:#f8f8f2>,</span><span class="token plain">devID</span><span class="token operator" style=color:#66d9ef>=</span><span class="token string" style=color:#a6e22e>"GPU-7299e30f-ccc4-a274-3e1a-77546d96a448"</span><span class="token punctuation" style=color:#f8f8f2>}</span><span class="token plain"> </span><span class="token number" style=color:#ae81ff>0</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">volcano_vgpu_device_allocated_memory</span><span class="token punctuation" style=color:#f8f8f2>{</span><span class="token plain">NodeName</span><span class="token operator" style=color:#66d9ef>=</span><span class="token string" style=color:#a6e22e>"test-app-64-46-msxf"</span><span class="token punctuation" style=color:#f8f8f2>,</span><span class="token plain">devID</span><span class="token operator" style=color:#66d9ef>=</span><span class="token string" style=color:#a6e22e>"GPU-8cae1965-8e72-af03-1f8c-2e64646392bf"</span><span class="token punctuation" style=color:#f8f8f2>}</span><span class="token plain"> </span><span class="token number" style=color:#ae81ff>0</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">volcano_vgpu_device_allocated_memory</span><span class="token punctuation" style=color:#f8f8f2>{</span><span class="token plain">NodeName</span><span class="token operator" style=color:#66d9ef>=</span><span class="token string" style=color:#a6e22e>"test-app-64-46-msxf"</span><span class="token punctuation" style=color:#f8f8f2>,</span><span class="token plain">devID</span><span class="token operator" style=color:#66d9ef>=</span><span class="token string" style=color:#a6e22e>"GPU-f7219cd7-e3ef-3b1b-4fa2-e84e8d5d4ce5"</span><span class="token punctuation" style=color:#f8f8f2>}</span><span class="token plain"> </span><span class="token number" style=color:#ae81ff>0</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain"></span><span class="token comment" style=color:#8292a2;font-style:italic># HELP volcano_vgpu_device_core_allocation_for_a_certain_pod The vgpu device core allocated for a certain pod</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain"></span><span class="token comment" style=color:#8292a2;font-style:italic># TYPE volcano_vgpu_device_core_allocation_for_a_certain_pod gauge</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">volcano_vgpu_device_core_allocation_for_a_certain_pod</span><span class="token punctuation" style=color:#f8f8f2>{</span><span class="token plain">NodeName</span><span class="token operator" style=color:#66d9ef>=</span><span class="token string" style=color:#a6e22e>"dev-app-2-150-master-1"</span><span class="token punctuation" style=color:#f8f8f2>,</span><span class="token plain">devID</span><span class="token operator" style=color:#66d9ef>=</span><span class="token string" style=color:#a6e22e>"GPU-5beec879-79c9-6252-3aaa-9f5e146ba220"</span><span class="token punctuation" style=color:#f8f8f2>,</span><span class="token plain">podName</span><span class="token operator" style=color:#66d9ef>=</span><span class="token string" style=color:#a6e22e>"test-vgpu-compatible"</span><span class="token punctuation" style=color:#f8f8f2>}</span><span class="token plain"> </span><span class="token number" style=color:#ae81ff>0</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">volcano_vgpu_device_core_allocation_for_a_certain_pod</span><span class="token punctuation" style=color:#f8f8f2>{</span><span class="token plain">NodeName</span><span class="token operator" style=color:#66d9ef>=</span><span class="token string" style=color:#a6e22e>"dev-app-2-150-master-1"</span><span class="token punctuation" style=color:#f8f8f2>,</span><span class="token plain">devID</span><span class="token operator" style=color:#66d9ef>=</span><span class="token string" style=color:#a6e22e>"GPU-bc94e532-1820-8ee8-ceaa-704166369c7c"</span><span class="token punctuation" style=color:#f8f8f2>,</span><span class="token plain">podName</span><span class="token operator" style=color:#66d9ef>=</span><span class="token string" style=color:#a6e22e>"test-vgpu-compatible"</span><span class="token punctuation" style=color:#f8f8f2>}</span><span class="token plain"> </span><span class="token number" style=color:#ae81ff>0</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain"></span><span class="token comment" style=color:#8292a2;font-style:italic># HELP volcano_vgpu_device_memory_allocation_for_a_certain_pod The vgpu device memory allocated for a certain pod</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain"></span><span class="token comment" style=color:#8292a2;font-style:italic># TYPE volcano_vgpu_device_memory_allocation_for_a_certain_pod gauge</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">volcano_vgpu_device_memory_allocation_for_a_certain_pod</span><span class="token punctuation" style=color:#f8f8f2>{</span><span class="token plain">NodeName</span><span class="token operator" style=color:#66d9ef>=</span><span class="token string" style=color:#a6e22e>"dev-app-2-150-master-1"</span><span class="token punctuation" style=color:#f8f8f2>,</span><span class="token plain">devID</span><span class="token operator" style=color:#66d9ef>=</span><span class="token string" style=color:#a6e22e>"GPU-5beec879-79c9-6252-3aaa-9f5e146ba220"</span><span class="token punctuation" style=color:#f8f8f2>,</span><span class="token plain">podName</span><span class="token operator" style=color:#66d9ef>=</span><span class="token string" style=color:#a6e22e>"test-vgpu-compatible"</span><span class="token punctuation" style=color:#f8f8f2>}</span><span class="token plain"> </span><span class="token number" style=color:#ae81ff>24564</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">volcano_vgpu_device_memory_allocation_for_a_certain_pod</span><span class="token punctuation" style=color:#f8f8f2>{</span><span class="token plain">NodeName</span><span class="token operator" style=color:#66d9ef>=</span><span class="token string" style=color:#a6e22e>"dev-app-2-150-master-1"</span><span class="token punctuation" style=color:#f8f8f2>,</span><span class="token plain">devID</span><span class="token operator" style=color:#66d9ef>=</span><span class="token string" style=color:#a6e22e>"GPU-bc94e532-1820-8ee8-ceaa-704166369c7c"</span><span class="token punctuation" style=color:#f8f8f2>,</span><span class="token plain">podName</span><span class="token operator" style=color:#66d9ef>=</span><span class="token string" style=color:#a6e22e>"test-vgpu-compatible"</span><span class="token punctuation" style=color:#f8f8f2>}</span><span class="token plain"> </span><span class="token number" style=color:#ae81ff>24564</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain"></span><span class="token comment" style=color:#8292a2;font-style:italic># HELP volcano_vgpu_device_memory_limit The number of total device memory in this card</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain"></span><span class="token comment" style=color:#8292a2;font-style:italic># TYPE volcano_vgpu_device_memory_limit gauge</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">volcano_vgpu_device_memory_limit</span><span class="token punctuation" style=color:#f8f8f2>{</span><span class="token plain">NodeName</span><span class="token operator" style=color:#66d9ef>=</span><span class="token string" style=color:#a6e22e>"dev-app-2-150-master-1"</span><span class="token punctuation" style=color:#f8f8f2>,</span><span class="token plain">devID</span><span class="token operator" style=color:#66d9ef>=</span><span class="token string" style=color:#a6e22e>"GPU-3c8ce108-117a-aeae-a3e8-1c0c5dafebe7"</span><span class="token punctuation" style=color:#f8f8f2>}</span><span class="token plain"> </span><span class="token number" style=color:#ae81ff>24564</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">volcano_vgpu_device_memory_limit</span><span class="token punctuation" style=color:#f8f8f2>{</span><span class="token plain">NodeName</span><span class="token operator" style=color:#66d9ef>=</span><span class="token string" style=color:#a6e22e>"dev-app-2-150-master-1"</span><span class="token punctuation" style=color:#f8f8f2>,</span><span class="token plain">devID</span><span class="token operator" style=color:#66d9ef>=</span><span class="token string" style=color:#a6e22e>"GPU-41c5e13c-b480-c473-7a14-dd05a7c4cd43"</span><span class="token punctuation" style=color:#f8f8f2>}</span><span class="token plain"> </span><span class="token number" style=color:#ae81ff>24564</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">volcano_vgpu_device_memory_limit</span><span class="token punctuation" style=color:#f8f8f2>{</span><span class="token plain">NodeName</span><span class="token operator" style=color:#66d9ef>=</span><span class="token string" style=color:#a6e22e>"dev-app-2-150-master-1"</span><span class="token punctuation" style=color:#f8f8f2>,</span><span class="token plain">devID</span><span class="token operator" style=color:#66d9ef>=</span><span class="token string" style=color:#a6e22e>"GPU-4e9cd184-671c-7b17-8fc2-e9bedbc3d604"</span><span class="token punctuation" style=color:#f8f8f2>}</span><span class="token plain"> </span><span class="token number" style=color:#ae81ff>24564</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">volcano_vgpu_device_memory_limit</span><span class="token punctuation" style=color:#f8f8f2>{</span><span class="token plain">NodeName</span><span class="token operator" style=color:#66d9ef>=</span><span class="token string" style=color:#a6e22e>"dev-app-2-150-master-1"</span><span class="token punctuation" style=color:#f8f8f2>,</span><span class="token plain">devID</span><span class="token operator" style=color:#66d9ef>=</span><span class="token string" style=color:#a6e22e>"GPU-4ff93432-c6b5-7330-30e7-9c0c9a1c648b"</span><span class="token punctuation" style=color:#f8f8f2>}</span><span class="token plain"> </span><span class="token number" style=color:#ae81ff>24564</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">volcano_vgpu_device_memory_limit</span><span class="token punctuation" style=color:#f8f8f2>{</span><span class="token plain">NodeName</span><span class="token operator" style=color:#66d9ef>=</span><span class="token string" style=color:#a6e22e>"dev-app-2-150-master-1"</span><span class="token punctuation" style=color:#f8f8f2>,</span><span class="token plain">devID</span><span class="token operator" style=color:#66d9ef>=</span><span class="token string" style=color:#a6e22e>"GPU-5beec879-79c9-6252-3aaa-9f5e146ba220"</span><span class="token punctuation" style=color:#f8f8f2>}</span><span class="token plain"> </span><span class="token number" style=color:#ae81ff>24564</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">volcano_vgpu_device_memory_limit</span><span class="token punctuation" style=color:#f8f8f2>{</span><span class="token plain">NodeName</span><span class="token operator" style=color:#66d9ef>=</span><span class="token string" style=color:#a6e22e>"dev-app-2-150-master-1"</span><span class="token punctuation" style=color:#f8f8f2>,</span><span class="token plain">devID</span><span class="token operator" style=color:#66d9ef>=</span><span class="token string" style=color:#a6e22e>"GPU-aa336186-301a-bc80-5121-a9a2e430811a"</span><span class="token punctuation" style=color:#f8f8f2>}</span><span class="token plain"> </span><span class="token number" style=color:#ae81ff>24564</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">volcano_vgpu_device_memory_limit</span><span class="token punctuation" style=color:#f8f8f2>{</span><span class="token plain">NodeName</span><span class="token operator" style=color:#66d9ef>=</span><span class="token string" style=color:#a6e22e>"dev-app-2-150-master-1"</span><span class="token punctuation" style=color:#f8f8f2>,</span><span class="token plain">devID</span><span class="token operator" style=color:#66d9ef>=</span><span class="token string" style=color:#a6e22e>"GPU-bc47d475-3538-d3eb-f4ba-e46e2639c54c"</span><span class="token punctuation" style=color:#f8f8f2>}</span><span class="token plain"> </span><span class="token number" style=color:#ae81ff>24564</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">volcano_vgpu_device_memory_limit</span><span class="token punctuation" style=color:#f8f8f2>{</span><span class="token plain">NodeName</span><span class="token operator" style=color:#66d9ef>=</span><span class="token string" style=color:#a6e22e>"dev-app-2-150-master-1"</span><span class="token punctuation" style=color:#f8f8f2>,</span><span class="token plain">devID</span><span class="token operator" style=color:#66d9ef>=</span><span class="token string" style=color:#a6e22e>"GPU-bc94e532-1820-8ee8-ceaa-704166369c7c"</span><span class="token punctuation" style=color:#f8f8f2>}</span><span class="token plain"> </span><span class="token number" style=color:#ae81ff>24564</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">volcano_vgpu_device_memory_limit</span><span class="token punctuation" style=color:#f8f8f2>{</span><span class="token plain">NodeName</span><span class="token operator" style=color:#66d9ef>=</span><span class="token string" style=color:#a6e22e>"test-app-64-46-msxf"</span><span class="token punctuation" style=color:#f8f8f2>,</span><span class="token plain">devID</span><span class="token operator" style=color:#66d9ef>=</span><span class="token string" style=color:#a6e22e>"GPU-07df9e74-a474-9fdd-248e-23e553ef2269"</span><span class="token punctuation" style=color:#f8f8f2>}</span><span class="token plain"> </span><span class="token number" style=color:#ae81ff>32607</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">volcano_vgpu_device_memory_limit</span><span class="token punctuation" style=color:#f8f8f2>{</span><span class="token plain">NodeName</span><span class="token operator" style=color:#66d9ef>=</span><span class="token string" style=color:#a6e22e>"test-app-64-46-msxf"</span><span class="token punctuation" style=color:#f8f8f2>,</span><span class="token plain">devID</span><span class="token operator" style=color:#66d9ef>=</span><span class="token string" style=color:#a6e22e>"GPU-0af50c42-326c-bbff-7a49-a49afa433d3d"</span><span class="token punctuation" style=color:#f8f8f2>}</span><span class="token plain"> </span><span class="token number" style=color:#ae81ff>32607</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">volcano_vgpu_device_memory_limit</span><span class="token punctuation" style=color:#f8f8f2>{</span><span class="token plain">NodeName</span><span class="token operator" style=color:#66d9ef>=</span><span class="token string" style=color:#a6e22e>"test-app-64-46-msxf"</span><span class="token punctuation" style=color:#f8f8f2>,</span><span class="token plain">devID</span><span class="token operator" style=color:#66d9ef>=</span><span class="token string" style=color:#a6e22e>"GPU-1bc8fc24-c939-545a-e272-2229d066d048"</span><span class="token punctuation" style=color:#f8f8f2>}</span><span class="token plain"> </span><span class="token number" style=color:#ae81ff>32607</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">volcano_vgpu_device_memory_limit</span><span class="token punctuation" style=color:#f8f8f2>{</span><span class="token plain">NodeName</span><span class="token operator" style=color:#66d9ef>=</span><span class="token string" style=color:#a6e22e>"test-app-64-46-msxf"</span><span class="token punctuation" style=color:#f8f8f2>,</span><span class="token plain">devID</span><span class="token operator" style=color:#66d9ef>=</span><span class="token string" style=color:#a6e22e>"GPU-50baa64a-6476-a970-1013-121dff41ec78"</span><span class="token punctuation" style=color:#f8f8f2>}</span><span class="token plain"> </span><span class="token number" style=color:#ae81ff>32607</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">volcano_vgpu_device_memory_limit</span><span class="token punctuation" style=color:#f8f8f2>{</span><span class="token plain">NodeName</span><span class="token operator" style=color:#66d9ef>=</span><span class="token string" style=color:#a6e22e>"test-app-64-46-msxf"</span><span class="token punctuation" style=color:#f8f8f2>,</span><span class="token plain">devID</span><span class="token operator" style=color:#66d9ef>=</span><span class="token string" style=color:#a6e22e>"GPU-7050631b-6524-21e3-41cf-6e08fc89220d"</span><span class="token punctuation" style=color:#f8f8f2>}</span><span class="token plain"> </span><span class="token number" style=color:#ae81ff>32607</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">volcano_vgpu_device_memory_limit</span><span class="token punctuation" style=color:#f8f8f2>{</span><span class="token plain">NodeName</span><span class="token operator" style=color:#66d9ef>=</span><span class="token string" style=color:#a6e22e>"test-app-64-46-msxf"</span><span class="token punctuation" style=color:#f8f8f2>,</span><span class="token plain">devID</span><span class="token operator" style=color:#66d9ef>=</span><span class="token string" style=color:#a6e22e>"GPU-7299e30f-ccc4-a274-3e1a-77546d96a448"</span><span class="token punctuation" style=color:#f8f8f2>}</span><span class="token plain"> </span><span class="token number" style=color:#ae81ff>32607</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">volcano_vgpu_device_memory_limit</span><span class="token punctuation" style=color:#f8f8f2>{</span><span class="token plain">NodeName</span><span class="token operator" style=color:#66d9ef>=</span><span class="token string" style=color:#a6e22e>"test-app-64-46-msxf"</span><span class="token punctuation" style=color:#f8f8f2>,</span><span class="token plain">devID</span><span class="token operator" style=color:#66d9ef>=</span><span class="token string" style=color:#a6e22e>"GPU-8cae1965-8e72-af03-1f8c-2e64646392bf"</span><span class="token punctuation" style=color:#f8f8f2>}</span><span class="token plain"> </span><span class="token number" style=color:#ae81ff>32607</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">volcano_vgpu_device_memory_limit</span><span class="token punctuation" style=color:#f8f8f2>{</span><span class="token plain">NodeName</span><span class="token operator" style=color:#66d9ef>=</span><span class="token string" style=color:#a6e22e>"test-app-64-46-msxf"</span><span class="token punctuation" style=color:#f8f8f2>,</span><span class="token plain">devID</span><span class="token operator" style=color:#66d9ef>=</span><span class="token string" style=color:#a6e22e>"GPU-f7219cd7-e3ef-3b1b-4fa2-e84e8d5d4ce5"</span><span class="token punctuation" style=color:#f8f8f2>}</span><span class="token plain"> </span><span class="token number" style=color:#ae81ff>32607</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain"></span><span class="token comment" style=color:#8292a2;font-style:italic># HELP volcano_vgpu_device_shared_number The number of vgpu tasks sharing this card</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain"></span><span class="token comment" style=color:#8292a2;font-style:italic># TYPE volcano_vgpu_device_shared_number gauge</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">volcano_vgpu_device_shared_number</span><span class="token punctuation" style=color:#f8f8f2>{</span><span class="token plain">NodeName</span><span class="token operator" style=color:#66d9ef>=</span><span class="token string" style=color:#a6e22e>"dev-app-2-150-master-1"</span><span class="token punctuation" style=color:#f8f8f2>,</span><span class="token plain">devID</span><span class="token operator" style=color:#66d9ef>=</span><span class="token string" style=color:#a6e22e>"GPU-3c8ce108-117a-aeae-a3e8-1c0c5dafebe7"</span><span class="token punctuation" style=color:#f8f8f2>}</span><span class="token plain"> </span><span class="token number" style=color:#ae81ff>0</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">volcano_vgpu_device_shared_number</span><span class="token punctuation" style=color:#f8f8f2>{</span><span class="token plain">NodeName</span><span class="token operator" style=color:#66d9ef>=</span><span class="token string" style=color:#a6e22e>"dev-app-2-150-master-1"</span><span class="token punctuation" style=color:#f8f8f2>,</span><span class="token plain">devID</span><span class="token operator" style=color:#66d9ef>=</span><span class="token string" style=color:#a6e22e>"GPU-41c5e13c-b480-c473-7a14-dd05a7c4cd43"</span><span class="token punctuation" style=color:#f8f8f2>}</span><span class="token plain"> </span><span class="token number" style=color:#ae81ff>0</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">volcano_vgpu_device_shared_number</span><span class="token punctuation" style=color:#f8f8f2>{</span><span class="token plain">NodeName</span><span class="token operator" style=color:#66d9ef>=</span><span class="token string" style=color:#a6e22e>"dev-app-2-150-master-1"</span><span class="token punctuation" style=color:#f8f8f2>,</span><span class="token plain">devID</span><span class="token operator" style=color:#66d9ef>=</span><span class="token string" style=color:#a6e22e>"GPU-4e9cd184-671c-7b17-8fc2-e9bedbc3d604"</span><span class="token punctuation" style=color:#f8f8f2>}</span><span class="token plain"> </span><span class="token number" style=color:#ae81ff>0</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">volcano_vgpu_device_shared_number</span><span class="token punctuation" style=color:#f8f8f2>{</span><span class="token plain">NodeName</span><span class="token operator" style=color:#66d9ef>=</span><span class="token string" style=color:#a6e22e>"dev-app-2-150-master-1"</span><span class="token punctuation" style=color:#f8f8f2>,</span><span class="token plain">devID</span><span class="token operator" style=color:#66d9ef>=</span><span class="token string" style=color:#a6e22e>"GPU-4ff93432-c6b5-7330-30e7-9c0c9a1c648b"</span><span class="token punctuation" style=color:#f8f8f2>}</span><span class="token plain"> </span><span class="token number" style=color:#ae81ff>0</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">volcano_vgpu_device_shared_number</span><span class="token punctuation" style=color:#f8f8f2>{</span><span class="token plain">NodeName</span><span class="token operator" style=color:#66d9ef>=</span><span class="token string" style=color:#a6e22e>"dev-app-2-150-master-1"</span><span class="token punctuation" style=color:#f8f8f2>,</span><span class="token plain">devID</span><span class="token operator" style=color:#66d9ef>=</span><span class="token string" style=color:#a6e22e>"GPU-5beec879-79c9-6252-3aaa-9f5e146ba220"</span><span class="token punctuation" style=color:#f8f8f2>}</span><span class="token plain"> </span><span class="token number" style=color:#ae81ff>1</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">volcano_vgpu_device_shared_number</span><span class="token punctuation" style=color:#f8f8f2>{</span><span class="token plain">NodeName</span><span class="token operator" style=color:#66d9ef>=</span><span class="token string" style=color:#a6e22e>"dev-app-2-150-master-1"</span><span class="token punctuation" style=color:#f8f8f2>,</span><span class="token plain">devID</span><span class="token operator" style=color:#66d9ef>=</span><span class="token string" style=color:#a6e22e>"GPU-aa336186-301a-bc80-5121-a9a2e430811a"</span><span class="token punctuation" style=color:#f8f8f2>}</span><span class="token plain"> </span><span class="token number" style=color:#ae81ff>0</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">volcano_vgpu_device_shared_number</span><span class="token punctuation" style=color:#f8f8f2>{</span><span class="token plain">NodeName</span><span class="token operator" style=color:#66d9ef>=</span><span class="token string" style=color:#a6e22e>"dev-app-2-150-master-1"</span><span class="token punctuation" style=color:#f8f8f2>,</span><span class="token plain">devID</span><span class="token operator" style=color:#66d9ef>=</span><span class="token string" style=color:#a6e22e>"GPU-bc47d475-3538-d3eb-f4ba-e46e2639c54c"</span><span class="token punctuation" style=color:#f8f8f2>}</span><span class="token plain"> </span><span class="token number" style=color:#ae81ff>0</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">volcano_vgpu_device_shared_number</span><span class="token punctuation" style=color:#f8f8f2>{</span><span class="token plain">NodeName</span><span class="token operator" style=color:#66d9ef>=</span><span class="token string" style=color:#a6e22e>"dev-app-2-150-master-1"</span><span class="token punctuation" style=color:#f8f8f2>,</span><span class="token plain">devID</span><span class="token operator" style=color:#66d9ef>=</span><span class="token string" style=color:#a6e22e>"GPU-bc94e532-1820-8ee8-ceaa-704166369c7c"</span><span class="token punctuation" style=color:#f8f8f2>}</span><span class="token plain"> </span><span class="token number" style=color:#ae81ff>1</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">volcano_vgpu_device_shared_number</span><span class="token punctuation" style=color:#f8f8f2>{</span><span class="token plain">NodeName</span><span class="token operator" style=color:#66d9ef>=</span><span class="token string" style=color:#a6e22e>"test-app-64-46-msxf"</span><span class="token punctuation" style=color:#f8f8f2>,</span><span class="token plain">devID</span><span class="token operator" style=color:#66d9ef>=</span><span class="token string" style=color:#a6e22e>"GPU-07df9e74-a474-9fdd-248e-23e553ef2269"</span><span class="token punctuation" style=color:#f8f8f2>}</span><span class="token plain"> </span><span class="token number" style=color:#ae81ff>0</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">volcano_vgpu_device_shared_number</span><span class="token punctuation" style=color:#f8f8f2>{</span><span class="token plain">NodeName</span><span class="token operator" style=color:#66d9ef>=</span><span class="token string" style=color:#a6e22e>"test-app-64-46-msxf"</span><span class="token punctuation" style=color:#f8f8f2>,</span><span class="token plain">devID</span><span class="token operator" style=color:#66d9ef>=</span><span class="token string" style=color:#a6e22e>"GPU-0af50c42-326c-bbff-7a49-a49afa433d3d"</span><span class="token punctuation" style=color:#f8f8f2>}</span><span class="token plain"> </span><span class="token number" style=color:#ae81ff>0</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">volcano_vgpu_device_shared_number</span><span class="token punctuation" style=color:#f8f8f2>{</span><span class="token plain">NodeName</span><span class="token operator" style=color:#66d9ef>=</span><span class="token string" style=color:#a6e22e>"test-app-64-46-msxf"</span><span class="token punctuation" style=color:#f8f8f2>,</span><span class="token plain">devID</span><span class="token operator" style=color:#66d9ef>=</span><span class="token string" style=color:#a6e22e>"GPU-1bc8fc24-c939-545a-e272-2229d066d048"</span><span class="token punctuation" style=color:#f8f8f2>}</span><span class="token plain"> </span><span class="token number" style=color:#ae81ff>0</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">volcano_vgpu_device_shared_number</span><span class="token punctuation" style=color:#f8f8f2>{</span><span class="token plain">NodeName</span><span class="token operator" style=color:#66d9ef>=</span><span class="token string" style=color:#a6e22e>"test-app-64-46-msxf"</span><span class="token punctuation" style=color:#f8f8f2>,</span><span class="token plain">devID</span><span class="token operator" style=color:#66d9ef>=</span><span class="token string" style=color:#a6e22e>"GPU-50baa64a-6476-a970-1013-121dff41ec78"</span><span class="token punctuation" style=color:#f8f8f2>}</span><span class="token plain"> </span><span class="token number" style=color:#ae81ff>0</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">volcano_vgpu_device_shared_number</span><span class="token punctuation" style=color:#f8f8f2>{</span><span class="token plain">NodeName</span><span class="token operator" style=color:#66d9ef>=</span><span class="token string" style=color:#a6e22e>"test-app-64-46-msxf"</span><span class="token punctuation" style=color:#f8f8f2>,</span><span class="token plain">devID</span><span class="token operator" style=color:#66d9ef>=</span><span class="token string" style=color:#a6e22e>"GPU-7050631b-6524-21e3-41cf-6e08fc89220d"</span><span class="token punctuation" style=color:#f8f8f2>}</span><span class="token plain"> </span><span class="token number" style=color:#ae81ff>0</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">volcano_vgpu_device_shared_number</span><span class="token punctuation" style=color:#f8f8f2>{</span><span class="token plain">NodeName</span><span class="token operator" style=color:#66d9ef>=</span><span class="token string" style=color:#a6e22e>"test-app-64-46-msxf"</span><span class="token punctuation" style=color:#f8f8f2>,</span><span class="token plain">devID</span><span class="token operator" style=color:#66d9ef>=</span><span class="token string" style=color:#a6e22e>"GPU-7299e30f-ccc4-a274-3e1a-77546d96a448"</span><span class="token punctuation" style=color:#f8f8f2>}</span><span class="token plain"> </span><span class="token number" style=color:#ae81ff>0</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">volcano_vgpu_device_shared_number</span><span class="token punctuation" style=color:#f8f8f2>{</span><span class="token plain">NodeName</span><span class="token operator" style=color:#66d9ef>=</span><span class="token string" style=color:#a6e22e>"test-app-64-46-msxf"</span><span class="token punctuation" style=color:#f8f8f2>,</span><span class="token plain">devID</span><span class="token operator" style=color:#66d9ef>=</span><span class="token string" style=color:#a6e22e>"GPU-8cae1965-8e72-af03-1f8c-2e64646392bf"</span><span class="token punctuation" style=color:#f8f8f2>}</span><span class="token plain"> </span><span class="token number" style=color:#ae81ff>0</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">volcano_vgpu_device_shared_number</span><span class="token punctuation" style=color:#f8f8f2>{</span><span class="token plain">NodeName</span><span class="token operator" style=color:#66d9ef>=</span><span class="token string" style=color:#a6e22e>"test-app-64-46-msxf"</span><span class="token punctuation" style=color:#f8f8f2>,</span><span class="token plain">devID</span><span class="token operator" style=color:#66d9ef>=</span><span class="token string" style=color:#a6e22e>"GPU-f7219cd7-e3ef-3b1b-4fa2-e84e8d5d4ce5"</span><span class="token punctuation" style=color:#f8f8f2>}</span><span class="token plain"> </span><span class="token number" style=color:#ae81ff>0</span><br></span></code></pre><div class=buttonGroup__atx><button type=button aria-label="Copy code to clipboard" title=Copy class=clean-btn><span class=copyButtonIcons_eSgA aria-hidden=true><svg viewBox="0 0 24 24" class=copyButtonIcon_y97N><path fill=currentColor d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"/></svg><svg viewBox="0 0 24 24" class=copyButtonSuccessIcon_LjdS><path fill=currentColor d=M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z /></svg></span></button></div></div></div></div></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href=/ai/vgpu-hami><div class=pagination-nav__sublabel>Previous</div><div class=pagination-nav__label>HAMi vGPU调研</div></a><a class="pagination-nav__link pagination-nav__link--next" href=/ai/vgpu-hami-test-with-volcano><div class=pagination-nav__sublabel>Next</div><div class=pagination-nav__label>HAMi Volcano安装测试</div></a></nav><div class=docusaurus-mt-lg></div></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href=#volcano调度器配置 class="table-of-contents__link toc-highlight">Volcano调度器配置</a><li><a href=#volcano-vgpu执行流程 class="table-of-contents__link toc-highlight">Volcano vGPU执行流程</a><ul><li><a href=#组件交互流程 class="table-of-contents__link toc-highlight">组件交互流程</a><li><a href=#详细流程介绍 class="table-of-contents__link toc-highlight">详细流程介绍</a><ul><li><a href=#阶段1pod创建 class="table-of-contents__link toc-highlight">阶段1：Pod创建</a><li><a href=#阶段2调度器调度 class="table-of-contents__link toc-highlight">阶段2：调度器调度</a><li><a href=#阶段3device-plugin分配 class="table-of-contents__link toc-highlight">阶段3：Device Plugin分配</a><li><a href=#阶段4容器运行时处理 class="table-of-contents__link toc-highlight">阶段4：容器运行时处理</a><li><a href=#阶段5应用运行 class="table-of-contents__link toc-highlight">阶段5：应用运行</a></ul></ul><li><a href=#volcano-vgpu与独立hami部署的区别 class="table-of-contents__link toc-highlight">Volcano vGPU与独立HAMi部署的区别</a><li><a href=#volcano-vgpu中的库注入机制 class="table-of-contents__link toc-highlight">Volcano vGPU中的库注入机制</a><li><a href=#volcano-vgpu监控指标 class="table-of-contents__link toc-highlight">Volcano vGPU监控指标</a><ul><li><a href=#设备级指标 class="table-of-contents__link toc-highlight">设备级指标</a><li><a href=#pod-级指标 class="table-of-contents__link toc-highlight">Pod 级指标</a><li><a href=#常用-promql-查询示例 class="table-of-contents__link toc-highlight">常用 PromQL 查询示例</a><li><a href=#指标访问方式 class="table-of-contents__link toc-highlight">指标访问方式</a><li><a href=#指标参考数据 class="table-of-contents__link toc-highlight">指标参考数据</a></ul></ul></div></div></div></div></main></div></div></div><footer class=footer><div class="container container-fluid"><div class="footer__bottom text--center"><div class=footer__copyright>Copyright 2025 johng.cn</div></div></div></footer></div>