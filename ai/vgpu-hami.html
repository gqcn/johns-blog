<!doctype html><html lang=en dir=ltr class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-docs/AI技术/基础架构/vGPU/HAMi vGPU介绍及原理分析" data-has-hydrated=false><meta charset=UTF-8><meta name=generator content="Docusaurus v3.6.3"><title data-rh=true>HAMi vGPU介绍及原理分析 | John's Blog</title><meta data-rh=true name=viewport content="width=device-width,initial-scale=1.0"><meta data-rh=true name=twitter:card content=summary_large_image><meta data-rh=true property=og:url content=https://johng.cn/ai/vgpu-hami><meta data-rh=true property=og:locale content=en><meta data-rh=true name=docusaurus_locale content=en><meta data-rh=true name=docsearch:language content=en><meta data-rh=true name=author content="John Guo"><meta data-rh=true property=og:image content=https://johng.cn/img/favicon.png><meta data-rh=true name=docusaurus_version content=current><meta data-rh=true name=docusaurus_tag content=docs-default-current><meta data-rh=true name=docsearch:version content=current><meta data-rh=true name=docsearch:docusaurus_tag content=docs-default-current><meta data-rh=true property=og:title content="HAMi vGPU介绍及原理分析 | John's Blog"><meta data-rh=true name=description content="HAMi是CNCF沙箱项目，提供Kubernetes环境下的GPU虚拟化解决方案。通过CUDA API劫持实现硬显存隔离和算力配额管理，支持多GPU厂商，零侵入应用，是目前最成熟的开源vGPU方案之一。"><meta data-rh=true property=og:description content="HAMi是CNCF沙箱项目，提供Kubernetes环境下的GPU虚拟化解决方案。通过CUDA API劫持实现硬显存隔离和算力配额管理，支持多GPU厂商，零侵入应用，是目前最成熟的开源vGPU方案之一。"><meta data-rh=true name=keywords content="HAMi,vGPU,GPU虚拟化,Kubernetes,CUDA API劫持,显存隔离,GPU共享,CNCF,云原生"><link data-rh=true rel=icon href=/img/favicon.ico><link data-rh=true rel=canonical href=https://johng.cn/ai/vgpu-hami><link data-rh=true rel=alternate href=https://johng.cn/ai/vgpu-hami hreflang=en><link data-rh=true rel=alternate href=https://johng.cn/ai/vgpu-hami hreflang=x-default><link data-rh=true rel=preconnect href=https://XGS1CPQERK-dsn.algolia.net crossorigin><link rel=alternate type=application/rss+xml href=/blog/rss.xml title="John's Blog RSS Feed"><link rel=alternate type=application/atom+xml href=/blog/atom.xml title="John's Blog Atom Feed"><link rel=search type=application/opensearchdescription+xml title="John's Blog" href=/opensearch.xml><script src=https://hm.baidu.com/hm.js?6b4ae23dc83ee5efe875b7172af6c7c1 async></script><link rel=stylesheet href=/assets/css/styles.2f56d3c4.css><script src=/assets/js/runtime~main.2e9c5463.js defer></script><script src=/assets/js/main.570a4733.js defer></script><body class=navigation-with-keyboard><script>!function(){var t,e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();t=null!==e?e:"light",document.documentElement.setAttribute("data-theme",t)}(),function(){try{for(var[t,e]of new URLSearchParams(window.location.search).entries())if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id=__docusaurus><div role=region aria-label="Skip to main content"><a class=skipToContent_fXgn href=#__docusaurus_skipToContent_fallback>Skip to main content</a></div><nav aria-label=Main class="navbar navbar--fixed-top"><div class=navbar__inner><div class=navbar__items><button aria-label="Toggle navigation bar" aria-expanded=false class="navbar__toggle clean-btn" type=button><svg width=30 height=30 viewBox="0 0 30 30" aria-hidden=true><path stroke=currentColor stroke-linecap=round stroke-miterlimit=10 stroke-width=2 d="M4 7h22M4 15h22M4 23h22"/></svg></button><a class=navbar__brand href=/><b class="navbar__title text--truncate">John's Blog</b></a><a aria-current=page class="navbar__item navbar__link navbar__link--active" href=/ai>AI技术</a><a class="navbar__item navbar__link" href=/cloud-native>云原生</a><a class="navbar__item navbar__link" href=/notes>日常笔记</a><a class="navbar__item navbar__link" href=/programming>开发语言</a><a class="navbar__item navbar__link" href=/architecture>技术架构</a><a class="navbar__item navbar__link" href=/observability>可观测性</a><a class="navbar__item navbar__link" href=/life>生活笔记</a></div><div class="navbar__items navbar__items--right"><a class="navbar__item navbar__link" href=/aboutme>关于我</a><a class="navbar__item navbar__link" href=/blog>博客</a><a href=https://goframe.org/ target=_blank rel="noopener noreferrer" class="navbar__item navbar__link header-goframe-link"></a><a href=https://github.com/gqcn target=_blank rel="noopener noreferrer" class="navbar__item navbar__link header-github-link"></a><div class=navbarSearchContainer_Bca1><button type=button class="DocSearch DocSearch-Button" aria-label="Search (Command+K)"><span class=DocSearch-Button-Container><svg width=20 height=20 class=DocSearch-Search-Icon viewBox="0 0 20 20" aria-hidden=true><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke=currentColor fill=none fill-rule=evenodd stroke-linecap=round stroke-linejoin=round /></svg><span class=DocSearch-Button-Placeholder>Search</span></span><span class=DocSearch-Button-Keys></span></button></div></div></div><div role=presentation class=navbar-sidebar__backdrop></div></nav><div id=__docusaurus_skipToContent_fallback class="main-wrapper mainWrapper_z2l0"><div class=docsWrapper_hBAB><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type=button></button><div class=docRoot_UBD9><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class=sidebarViewport_aRkj><div class=sidebar_njMd><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class=menu__list-item-collapsible><a class="menu__link menu__link--sublist menu__link--active" href=/ai>AI技术</a><button aria-label="Collapse sidebar category 'AI技术'" aria-expanded=true type=button class="clean-btn menu__caret"></button></div><ul style=display:block;overflow:visible;height:auto class=menu__list><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="menu__link menu__link--sublist" tabindex=0 href=/ai/agents>智能体</a><button aria-label="Expand sidebar category '智能体'" aria-expanded=false type=button class="clean-btn menu__caret"></button></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="menu__link menu__link--sublist" tabindex=0 href=/ai/app>应用开发</a><button aria-label="Expand sidebar category '应用开发'" aria-expanded=false type=button class="clean-btn menu__caret"></button></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="menu__link menu__link--sublist" tabindex=0 href=/ai/inference>推理服务</a><button aria-label="Expand sidebar category '推理服务'" aria-expanded=false type=button class="clean-btn menu__caret"></button></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="menu__link menu__link--sublist" tabindex=0 href=/ai/training>训练微调</a><button aria-label="Expand sidebar category '训练微调'" aria-expanded=false type=button class="clean-btn menu__caret"></button></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class=menu__list-item-collapsible><a class="menu__link menu__link--sublist menu__link--active" tabindex=0 href=/ai/infra>基础架构</a><button aria-label="Collapse sidebar category '基础架构'" aria-expanded=true type=button class="clean-btn menu__caret"></button></div><ul style=display:block;overflow:visible;height:auto class=menu__list><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item"><div class=menu__list-item-collapsible><a class="menu__link menu__link--sublist menu__link--active" tabindex=0 href=/ai/vgpu>vGPU</a><button aria-label="Collapse sidebar category 'vGPU'" aria-expanded=true type=button class="clean-btn menu__caret"></button></div><ul style=display:block;overflow:visible;height:auto class=menu__list><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class=menu__link tabindex=0 href=/ai/vgpu-introduction-and-comparison>vGPU介绍及主流方案对比</a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link menu__link--active" aria-current=page tabindex=0 href=/ai/vgpu-hami>HAMi vGPU介绍及原理分析</a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class=menu__link tabindex=0 href=/ai/vgpu-hami-with-volcano>HAMi With Volcano</a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class=menu__link tabindex=0 href=/ai/vgpu-hami-test-with-volcano>HAMi Volcano安装测试</a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class=menu__link tabindex=0 href=/ai/vgpu-hami-cuda-driver-api>HAMi CUDA Driver API</a></ul><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="menu__link menu__link--sublist" tabindex=0 href=/ai/rdma>RDMA</a><button aria-label="Expand sidebar category 'RDMA'" aria-expanded=false type=button class="clean-btn menu__caret"></button></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="menu__link menu__link--sublist" tabindex=0 href=/ai/nvidia>NVIDIA</a><button aria-label="Expand sidebar category 'NVIDIA'" aria-expanded=false type=button class="clean-btn menu__caret"></button></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="menu__link menu__link--sublist" tabindex=0 href=/ai/scheduling>算力调度</a><button aria-label="Expand sidebar category '算力调度'" aria-expanded=false type=button class="clean-btn menu__caret"></button></div><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class=menu__link tabindex=0 href=/ai/what-is-llmops-mlops>LLMOps介绍</a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class=menu__link tabindex=0 href=/ai/common-acceleration-cards>常见智算加速卡汇总</a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class=menu__link tabindex=0 href=/ai/ai-training-inference-scenarios>AI模型训练推理常见业务场景痛点</a></ul><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="menu__link menu__link--sublist" tabindex=0 href=/ai/basic>入门知识</a><button aria-label="Expand sidebar category '入门知识'" aria-expanded=false type=button class="clean-btn menu__caret"></button></div></ul><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="menu__link menu__link--sublist" href=/cloud-native>云原生</a><button aria-label="Expand sidebar category '云原生'" aria-expanded=false type=button class="clean-btn menu__caret"></button></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="menu__link menu__link--sublist" href=/notes>日常笔记</a><button aria-label="Expand sidebar category '日常笔记'" aria-expanded=false type=button class="clean-btn menu__caret"></button></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="menu__link menu__link--sublist" href=/programming>开发语言</a><button aria-label="Expand sidebar category '开发语言'" aria-expanded=false type=button class="clean-btn menu__caret"></button></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="menu__link menu__link--sublist" href=/architecture>技术架构</a><button aria-label="Expand sidebar category '技术架构'" aria-expanded=false type=button class="clean-btn menu__caret"></button></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="menu__link menu__link--sublist" href=/management>技术管理</a><button aria-label="Expand sidebar category '技术管理'" aria-expanded=false type=button class="clean-btn menu__caret"></button></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="menu__link menu__link--sublist" href=/observability>可观测性</a><button aria-label="Expand sidebar category '可观测性'" aria-expanded=false type=button class="clean-btn menu__caret"></button></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="menu__link menu__link--sublist" href=/database-and-middleware>数据库与中间件</a><button aria-label="Expand sidebar category '数据库与中间件'" aria-expanded=false type=button class="clean-btn menu__caret"></button></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="menu__link menu__link--sublist" href=/operating-systems-and-networks>操作系统和网络</a><button aria-label="Expand sidebar category '操作系统和网络'" aria-expanded=false type=button class="clean-btn menu__caret"></button></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="menu__link menu__link--sublist" href=/life>生活笔记</a><button aria-label="Expand sidebar category '生活笔记'" aria-expanded=false type=button class="clean-btn menu__caret"></button></div></ul></nav></div></div></aside><main class=docMainContainer_TBSr><div class="container padding-top--md padding-bottom--lg"><div class=row><div class="col docItemCol_VOVn"><div class=docItemContainer_Djhp><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label=Breadcrumbs><ul class=breadcrumbs itemscope itemtype=https://schema.org/BreadcrumbList><li class=breadcrumbs__item><a aria-label="Home page" class=breadcrumbs__link href=/><svg viewBox="0 0 24 24" class=breadcrumbHomeIcon_YNFT><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill=currentColor /></svg></a><li itemscope itemprop=itemListElement itemtype=https://schema.org/ListItem class=breadcrumbs__item><a class=breadcrumbs__link itemprop=item href=/ai><span itemprop=name>AI技术</span></a><meta itemprop=position content=1><li itemscope itemprop=itemListElement itemtype=https://schema.org/ListItem class=breadcrumbs__item><a class=breadcrumbs__link itemprop=item href=/ai/infra><span itemprop=name>基础架构</span></a><meta itemprop=position content=2><li itemscope itemprop=itemListElement itemtype=https://schema.org/ListItem class=breadcrumbs__item><a class=breadcrumbs__link itemprop=item href=/ai/vgpu><span itemprop=name>vGPU</span></a><meta itemprop=position content=3><li itemscope itemprop=itemListElement itemtype=https://schema.org/ListItem class="breadcrumbs__item breadcrumbs__item--active"><span class=breadcrumbs__link itemprop=name>HAMi vGPU介绍及原理分析</span><meta itemprop=position content=4></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type=button class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><h2 class="anchor anchorWithStickyNavbar_LWe7" id=hami项目概述>HAMi项目概述<a href=#hami项目概述 class=hash-link aria-label="Direct link to HAMi项目概述" title="Direct link to HAMi项目概述">​</a></h2>
<p><img decoding=async loading=lazy alt=HAMi整体架构 src=/assets/images/image-2-84381ed8be34a777eec27418714dd345.png width=1280 height=720 class=img_ev3q></p>
<p><strong>HAMi</strong> (<code>Heterogeneous AI Computing Virtualization Middleware</code>) 是开源的 <code>vGPU</code>与调度系统 <a href=https://project-hami.io/ target=_blank rel="noopener noreferrer">https://project-hami.io/</a> ，目标是为<code>Kubernetes</code>环境下的深度学习/推理任务提供细粒度、灵活的<code>GPU</code>资源管理能力。其思路是：在<code>Kubernetes</code>调度层与<code>GPU driver</code>层能力之间，建立一个智能的中间层，用统一的接口和策略提供给用户。这样，用户提交任务时不需要关心底层细节，只需要声明需要多少<code>GPU</code>算力/显存，<code>HAMi</code>就能动态分配、隔离并调度。</p>
<p><strong>项目信息</strong>：</p>
<ul>
<li><strong>GitHub</strong>: <a href=https://github.com/Project-HAMi/HAMi target=_blank rel="noopener noreferrer">https://github.com/Project-HAMi/HAMi</a></li>
<li><strong>开源协议</strong>: <code>Apache 2.0</code></li>
<li><strong>项目状态</strong>: <code>CNCF</code>沙箱项目，活跃，持续更新</li>
</ul>
<p><strong>核心特性</strong>：</p>
<ul>
<li>✅ 显存隔离</li>
<li>✅ 算力配额限制</li>
<li>✅ <code>Kubernetes</code>原生集成</li>
<li>✅ 多<code>GPU</code>厂商支持（<code>NVIDIA</code>、<code>AMD</code>、昇腾等）</li>
<li>✅ 完善的监控和可观测性</li>
<li>✅ 零侵入，应用无需修改</li>
</ul>
<p><strong>支持的设备</strong>： <a href=https://project-hami.io/zh/docs/userguide/device-supported/ target=_blank rel="noopener noreferrer">https://project-hami.io/zh/docs/userguide/device-supported/</a></p>
<table><thead><tr><th>生产商<th>制造商<th>类型<th>内存隔离<th>核心隔离<th>多卡支持<tbody><tr><td><code>GPU</code><td><code>NVIDIA</code><td>全部<td>✅<td>✅<td>✅<tr><td><code>GPU</code><td><code>iluvatar</code><td>全部<td>✅<td>✅<td>❌<tr><td><code>GPU</code><td><code>Mthreads</code><td><code>MTT S4000</code><td>✅<td>✅<td>❌<tr><td><code>GPU</code><td><code>Metax</code><td><code>MXC500</code><td>✅<td>✅<td>❌<tr><td><code>MLU</code><td><code>Cambricon</code><td><code>370</code>, <code>590</code><td>✅<td>✅<td>❌<tr><td><code>DCU</code><td><code>Hygon</code><td><code>Z100</code>, <code>Z100L</code><td>✅<td>✅<td>❌<tr><td><code>Ascend</code><td><code>Huawei</code><td><code>910B</code>, <code>910B3</code>, <code>310P</code><td>✅<td>✅<td>❌<tr><td><code>GCU</code><td><code>Enflame</code><td><code>S60</code><td>✅<td>✅<td>❌<tr><td><code>XPU</code><td><code>Kunlunxin</code><td><code>P800</code><td>✅<td>✅<td>❌<tr><td><code>DPU</code><td><code>Teco</code><td>检查中<td>进行中<td>进行中<td>❌</table>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id=hami的优势与局限>HAMi的优势与局限<a href=#hami的优势与局限 class=hash-link aria-label="Direct link to HAMi的优势与局限" title="Direct link to HAMi的优势与局限">​</a></h2>
<table><thead><tr><th>维度<th>优势 ✅<th>局限 ⚠️<tbody><tr><td><strong>隔离性</strong><td>• 显存隔离，防止<code>OOM</code>相互影响<br>• 进程崩溃不影响其他容器<br>• 资源配额强制执行<td>• 算力隔离较弱，仅能软限制<br>• 无法像<code>MIG</code>那样硬件级隔离<br>• 恶意进程可能超出配额<tr><td><strong>性能</strong><td>• 大规模计算场景影响较小<br>• 相比内核态方案开销更低<td>• <code>API</code>劫持带来<code>5-15%</code>性能损失<br>• 小<code>batch</code>推理场景影响较大<tr><td><strong>易用性</strong><td>• <code>Kubernetes</code>原生集成<br>• 无缝集成<code>K8S</code>调度器<br>• 支持标准资源请求语法<br>• 完善的监控和可观测性<td>• <code>API</code>劫持可能影响调试工具<br>• 需要理解<code>vGPU</code>机制（如显存、算力分配）<tr><td><strong>兼容性</strong><td>• 多<code>GPU</code>厂商支持（<code>NVIDIA</code>、<code>AMD</code>、昇腾等）<br>• 易于扩展支持新硬件<br>• 零侵入，应用无需修改<td>• 某些使用<code>CUDA IPC</code>的应用不兼容<br>• 直接调用<code>Driver API</code>的应用可能绕过<br>• 需要针对<code>CUDA</code>版本适配<tr><td><strong>开源与社区</strong><td>• <code>Apache 2.0</code>协议<br>• 社区活跃，持续更新<br>• 无版权风险<br>• <code>CNCF</code>沙箱项目<td>• 相比商业方案技术支持有限<br>• 部分高级特性需要社区贡献</table>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id=hami版本限制>HAMi版本限制<a href=#hami版本限制 class=hash-link aria-label="Direct link to HAMi版本限制" title="Direct link to HAMi版本限制">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id=兼容的cuda版本>兼容的CUDA版本<a href=#兼容的cuda版本 class=hash-link aria-label="Direct link to 兼容的CUDA版本" title="Direct link to 兼容的CUDA版本">​</a></h3>
<table><thead><tr><th>CUDA版本范围<th>支持状态<th>说明<tbody><tr><td><code>CUDA 9.0+</code><td>✅ 支持<td>早期版本支持<tr><td><code>CUDA 10.x</code><td>✅ 支持<td>完整支持<tr><td><code>CUDA 11.0-11.2</code><td>✅ 支持<td>完整支持<tr><td><code>CUDA 11.3+</code><td>✅ 支持<td><code>v2.2</code>版本优化了显存计数机制以兼容<code>CUDA 11.3+</code>编译的任务<tr><td><code>CUDA 11.6+</code><td>✅ 支持<td><code>v1.1.0.0</code>版本更新以兼容<code>CUDA 11.6</code>和<code>Driver 500+</code><tr><td><code>CUDA 12.x</code><td>✅ 支持<td>完整支持，包括<code>CUDA 12.0-12.6</code></table>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id=nvidia驱动版本要求>NVIDIA驱动版本要求<a href=#nvidia驱动版本要求 class=hash-link aria-label="Direct link to NVIDIA驱动版本要求" title="Direct link to NVIDIA驱动版本要求">​</a></h3>
<ul>
<li><strong>最低驱动版本</strong>：<code>>= 440</code></li>
<li><strong>推荐驱动版本</strong>：<code>>= 500</code> (更好的兼容性)</li>
<li><strong>最新驱动版本</strong>：<code>550+</code> (完整支持所有特性)</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id=hami整体架构>HAMi整体架构<a href=#hami整体架构 class=hash-link aria-label="Direct link to HAMi整体架构" title="Direct link to HAMi整体架构">​</a></h2>
<p><img decoding=async loading=lazy alt=HAMi关键组件详解 src=/assets/images/image-3-cabd4484c18781655b001906186b4fde.png width=1394 height=550 class=img_ev3q></p>
<p><code>HAMi</code>采用分层架构设计，由以下四个核心组件协同工作：</p>
<ul>
<li><strong>HAMi Mutating Webhook</strong>：<code>Pod</code>准入控制器，拦截并修改<code>Pod</code>定义</li>
<li><strong>HAMi Scheduler Extender</strong>：调度器扩展，实现智能<code>GPU</code>资源调度</li>
<li><strong>HAMi Device Plugin</strong>：设备插件，负责<code>GPU</code>资源注册与分配</li>
<li><strong>HAMi Core</strong>：容器内运行时库，实现资源隔离与配额控制</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id=hami-mutating-webhook>HAMi Mutating Webhook<a href=#hami-mutating-webhook class=hash-link aria-label="Direct link to HAMi Mutating Webhook" title="Direct link to HAMi Mutating Webhook">​</a></h3>
<p><strong>功能职责</strong>：</p>
<ul>
<li>拦截<code>Pod</code>创建请求，检查是否包含<code>GPU</code>资源需求</li>
<li>自动为<code>GPU Pod</code>注入必要的配置和环境变量</li>
<li>设置<code>schedulerName</code>为<code>hami-scheduler</code>，确保由<code>HAMi</code>调度器处理</li>
<li>注入<code>runtimeClassName</code>和<code>LD_PRELOAD</code>等运行时参数</li>
</ul>
<p><strong>工作流程</strong>：</p>
<ol>
<li><strong>Pod提交拦截</strong>：当用户提交包含<code>GPU</code>资源请求的<code>Pod</code>时，<code>Webhook</code>首先拦截该请求</li>
<li><strong>资源字段扫描</strong>：检查<code>Pod</code>的资源需求字段，识别是否为<code>HAMi</code>管理的<code>GPU</code>资源</li>
<li><strong>自动配置注入</strong>：为符合条件的<code>Pod</code>自动设置调度器名称和运行时配置</li>
<li><strong>环境变量预埋</strong>：注入<code>LD_PRELOAD</code>等环境变量，为后续的<code>API</code>劫持做准备</li>
</ol>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id=hami-scheduler-extender>HAMi Scheduler Extender<a href=#hami-scheduler-extender class=hash-link aria-label="Direct link to HAMi Scheduler Extender" title="Direct link to HAMi Scheduler Extender">​</a></h3>
<p><strong>功能职责</strong>：</p>
<ul>
<li>扩展<code>Kubernetes</code>默认调度器，实现<code>GPU</code>资源的智能调度</li>
<li>维护集群级别的<code>GPU</code>资源全局视图</li>
<li>根据显存、算力等多维度资源进行节点筛选和打分</li>
<li>支持拓扑感知、资源碎片优化等高级调度策略</li>
</ul>
<p><strong>调度策略</strong>：</p>
<ol>
<li>
<p><strong>Filter阶段</strong>：</p>
<ul>
<li>过滤显存不足的节点</li>
<li>过滤算力不足的节点</li>
<li>检查<code>GPU</code>型号匹配性</li>
</ul>
</li>
<li>
<p><strong>Score阶段</strong>：</p>
<ul>
<li>优先选择资源碎片少的节点</li>
<li>考虑<code>GPU</code>拓扑结构，减少跨卡通信</li>
<li>平衡节点负载，避免资源热点</li>
</ul>
</li>
<li>
<p><strong>Bind阶段</strong>：</p>
<ul>
<li>确定最优节点并绑定<code>Pod</code></li>
<li>更新资源分配记录到<code>Pod</code>注解</li>
</ul>
</li>
</ol>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id=hami-device-plugin>HAMi Device Plugin<a href=#hami-device-plugin class=hash-link aria-label="Direct link to HAMi Device Plugin" title="Direct link to HAMi Device Plugin">​</a></h3>
<p><strong>功能职责</strong>：</p>
<ul>
<li>发现节点上的<code>GPU</code>资源并向<code>Kubernetes</code>注册虚拟<code>GPU</code>资源</li>
<li>处理<code>Pod</code>的<code>GPU</code>资源分配请求</li>
<li>从调度结果的注解字段获取分配信息</li>
<li>将相应的<code>GPU</code>设备映射到容器，并注入配额环境变量</li>
</ul>
<p><strong>工作流程</strong>：</p>
<ol>
<li>
<p><strong>启动阶段</strong>：</p>
<ul>
<li>扫描节点<code>GPU</code>资源（型号、显存、数量等）</li>
<li>计算可分配的虚拟<code>GPU</code>数量</li>
<li>向<code>kubelet</code>注册设备资源</li>
</ul>
</li>
<li>
<p><strong>资源分配阶段</strong>：</p>
<ul>
<li>接收<code>kubelet</code>的<code>Allocate</code>请求</li>
<li>从<code>Pod</code>注解中读取调度器分配的<code>GPU</code>信息</li>
<li>生成环境变量（显存限制、算力配额等）</li>
<li>挂载<code>HAMi Core</code>库到容器</li>
<li>返回设备列表和环境变量</li>
</ul>
</li>
<li>
<p><strong>监控阶段</strong>：</p>
<ul>
<li>定期更新资源状态</li>
<li>上报<code>GPU</code>使用情况</li>
<li>处理设备异常情况</li>
</ul>
</li>
</ol>
<p><strong>使用示例</strong>：</p>
<div class="language-yaml codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#f8f8f2;--prism-background-color:#272822><div class=codeBlockContent_biex><pre tabindex=0 class="prism-code language-yaml codeBlock_bY9V thin-scrollbar" style=color:#f8f8f2;background-color:#272822><code class=codeBlockLines_e6Vv><span class=token-line style=color:#f8f8f2><span class="token key atrule">apiVersion</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"> v1</span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain"></span><span class="token key atrule">kind</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"> Pod</span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain"></span><span class="token key atrule">metadata</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">  </span><span class="token key atrule">name</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"> gpu</span><span class="token punctuation" style=color:#f8f8f2>-</span><span class="token plain">pod</span><span class="token punctuation" style=color:#f8f8f2>-</span><span class="token plain">example</span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain"></span><span class="token key atrule">spec</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">  </span><span class="token key atrule">schedulerName</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"> hami</span><span class="token punctuation" style=color:#f8f8f2>-</span><span class="token plain">scheduler  </span><span class="token comment" style=color:#8292a2;font-style:italic># 使用HAMi调度器</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">  </span><span class="token key atrule">containers</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">  </span><span class="token punctuation" style=color:#f8f8f2>-</span><span class="token plain"> </span><span class="token key atrule">name</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"> training</span><span class="token punctuation" style=color:#f8f8f2>-</span><span class="token plain">container</span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">    </span><span class="token key atrule">image</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"> nvidia/cuda</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain">11.8.0</span><span class="token punctuation" style=color:#f8f8f2>-</span><span class="token plain">runtime</span><span class="token punctuation" style=color:#f8f8f2>-</span><span class="token plain">ubuntu22.04</span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">    </span><span class="token key atrule">command</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"> </span><span class="token punctuation" style=color:#f8f8f2>[</span><span class="token string" style=color:#a6e22e>"python"</span><span class="token punctuation" style=color:#f8f8f2>,</span><span class="token plain"> </span><span class="token string" style=color:#a6e22e>"train.py"</span><span class="token punctuation" style=color:#f8f8f2>]</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">    </span><span class="token key atrule">resources</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">      </span><span class="token key atrule">limits</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">        </span><span class="token key atrule">nvidia.com/gpu</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"> </span><span class="token number" style=color:#ae81ff>1</span><span class="token plain">          </span><span class="token comment" style=color:#8292a2;font-style:italic># 请求1个GPU</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">        </span><span class="token key atrule">nvidia.com/gpumem</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"> </span><span class="token number" style=color:#ae81ff>8000</span><span class="token plain">    </span><span class="token comment" style=color:#8292a2;font-style:italic># 请求8GB显存</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">        </span><span class="token key atrule">nvidia.com/gpucores</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"> </span><span class="token number" style=color:#ae81ff>50</span><span class="token plain">    </span><span class="token comment" style=color:#8292a2;font-style:italic># 请求50%算力</span><br></span></code></pre><div class=buttonGroup__atx><button type=button aria-label="Copy code to clipboard" title=Copy class=clean-btn><span class=copyButtonIcons_eSgA aria-hidden=true><svg viewBox="0 0 24 24" class=copyButtonIcon_y97N><path fill=currentColor d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"/></svg><svg viewBox="0 0 24 24" class=copyButtonSuccessIcon_LjdS><path fill=currentColor d=M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z /></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id=hami-core-libvgpuso>HAMi Core (libvgpu.so)<a href=#hami-core-libvgpuso class=hash-link aria-label="Direct link to HAMi Core (libvgpu.so)" title="Direct link to HAMi Core (libvgpu.so)">​</a></h3>
<p>源码仓库：<a href=https://github.com/Project-HAMi/HAMi-core target=_blank rel="noopener noreferrer">https://github.com/Project-HAMi/HAMi-core</a></p>
<p><strong>功能职责</strong>：</p>
<ul>
<li>通过<code>LD_PRELOAD</code>机制劫持<code>CUDA Runtime API</code>调用</li>
<li>实现显存配额的硬隔离管理</li>
<li>提供算力使用的软限制功能</li>
<li>收集容器级别的<code>GPU</code>使用统计信息</li>
</ul>
<p><strong>工作原理</strong>：</p>
<p><code>HAMi Core</code>是一个动态链接库（<code>libvgpu.so</code>），通过<code>LD_PRELOAD</code>机制在应用程序启动时被加载。它拦截关键的<code>CUDA API</code>调用，在调用真正的<code>CUDA</code>函数之前进行资源检查和配额控制。</p>
<p><strong>核心拦截API</strong>：</p>
<ul>
<li><code>cudaMalloc</code> / <code>cudaFree</code>：显存分配与释放</li>
<li><code>cudaMemcpy</code> / <code>cudaMemcpyAsync</code>：显存拷贝操作</li>
<li><code>cudaLaunchKernel</code>：内核函数启动</li>
<li><code>cudaStreamCreate</code>：流管理</li>
</ul>
<p><strong>算力限制机制</strong>：</p>
<p>通过监控<code>kernel</code>启动频率和执行时间，实现算力使用的软限制。当容器的算力使用超过配额时，会延迟后续<code>kernel</code>的启动，从而控制整体算力占用。</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id=hami原理分析>HAMi原理分析<a href=#hami原理分析 class=hash-link aria-label="Direct link to HAMi原理分析" title="Direct link to HAMi原理分析">​</a></h2>
<p><img decoding=async loading=lazy alt=HAMi原理分析 src=/assets/images/image-6-109c44b1a4cb18a8e39094d3baa8f129.png width=2480 height=678 class=img_ev3q></p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id=pod调度阶段>Pod调度阶段<a href=#pod调度阶段 class=hash-link aria-label="Direct link to Pod调度阶段" title="Direct link to Pod调度阶段">​</a></h3>
<p>在<code>Kubernetes</code>集群中，<code>HAMi</code>扩展了<code>Pod</code>的调度与运行流程。整个过程可以分为以下几个阶段：</p>
<ol>
<li>
<p><strong><code>Pod</code>提交与<code>Mutating Webhook</code>拦截</strong></p>
<p>当用户提交一个带有<code>GPU</code>资源请求的<code>Pod</code>时，请求首先进入<code>API Server</code>。此时<code>Mutating Webhook</code>会拦截<code>Pod</code>对象，对其中的<code>GPU</code>资源声明进行补全和修正，例如：</p>
<ul>
<li>自动设置<code>schedulerName=hami-scheduler</code></li>
<li>注入<code>runtimeClassName=nvidia</code></li>
<li>为容器补齐必要的<code>GPU</code>资源字段和环境变量</li>
</ul>
<p>同时，<code>HAMi</code>还会通过<code>Pod</code>的环境变量和容器启动参数注入 <code>LD_PRELOAD</code>，确保在容器启动后，应用程序会自动加载<code>HAMi Core</code>的动态库。这样，就为后续的<code>GPU</code>调度与运行阶段预埋了“劫持” <code>CUDA API</code>的钩子。</p>
<p>这样，<code>Pod</code>被标记为交由<code>HAMi Scheduler</code>来处理，而不是默认调度器。</p>
</li>
<li>
<p><strong><code>HAMi Scheduler</code>调度</strong></p>
<p><code>Pod</code>被送入<code>HAMi Scheduler</code>的调度逻辑：</p>
<ul>
<li><strong>Filter</strong> <strong>阶段</strong>：解析<code>Pod</code>的资源需求，筛选出满足显存、算力等要求的候选节点。</li>
<li><strong>Score</strong> <strong>阶段</strong>：对候选节点进行多维度打分，包括资源利用率、碎片化程度、拓扑结构等。</li>
<li><strong>Bind</strong> <strong>阶段</strong>：选择最优节点，并将<code>Pod</code>绑定到该节点。</li>
</ul>
<p>这一流程保证了<code>Pod</code>能够在合适的<code>GPU</code>上运行，并提高集群整体的利用效率。</p>
</li>
<li>
<p><strong><code>HAMi Device Plugin</code>与环境变量注入</strong></p>
<p>当<code>Pod</code>被分配到节点后，<code>HAMi Device Plugin</code>接管了容器与<code>GPU</code>的连接过程。与 <code>NVIDIA</code>官方插件相比，<code>HAMi Device Plugin</code>不仅保留了驱动与API的兼容性，还新增了以下能力：</p>
<ul>
<li>为容器注入显存、算力、任务优先级等控制参数</li>
<li>挂载<code>HAMi Core</code>库，实现对<code>GPU</code>的虚拟化控制</li>
<li>精细化配置<code>CUDA_MEM_LIMIT</code>、<code>CUDA_CORE_LIMIT</code>等环境变量，实现资源隔离与共享</li>
</ul>
<p>最终，<code>Pod</code>内部的应用感知到的<code>GPU</code>是一个受控的虚拟化<code>GPU</code>，既保证了隔离性，也支持资源共享。</p>
</li>
</ol>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id=pod持续运行阶段>Pod持续运行阶段<a href=#pod持续运行阶段 class=hash-link aria-label="Direct link to Pod持续运行阶段" title="Direct link to Pod持续运行阶段">​</a></h3>
<p>在<code>Pod</code>启动后，<code>HAMi Core</code>通过<code>Linux</code>的<code>LD_PRELOAD</code>机制直接“嵌入”到应用进程中。</p>
<p><code>LD_PRELOAD</code>是<code>Linux</code>动态链接器的一种功能，允许开发者在运行时指定一个自定义的动态链接库，让它在系统标准库之前被加载。这时程序里调用的函数（比如<code>malloc</code>、<code>open</code>，或者在<code>CUDA</code>应用里调用的<code>cudaMalloc</code>）就会先经过自定义库的实现，从而实现“函数劫持”（<code>interception</code>）。<code>HAMi Core</code>正是利用这一点：它通过 <code>LD_PRELOAD</code> 注入一个定制的库到容器应用中，这个库拦截了关键的<code>CUDA Runtime API</code>（如<code>cudaMalloc</code>）。</p>
<p>关键工作流程如下：</p>
<ol>
<li><strong>拦截调用</strong>：当应用尝试调用<code>cudaMalloc</code>申请显存时，请求首先会进入<code>HAMi Core</code>的拦截逻辑，而不是直接进入<code>CUDA runtime API</code>。</li>
<li><strong>资源校验</strong>：<code>HAMi Core</code>会读取<code>Pod</code>下发的<code>GPU</code>配置（例如显存上限），检查本次申请是否超限。</li>
<li><strong>严格控制</strong>：若超出限制，则直接拒绝分配并返回错误码；若合法，则放行并记录分配情况。</li>
<li><strong>持续监管</strong>：所有显存分配和释放都会经过这种拦截校验机制，形成一个完整的<code>Pod</code>级“资源沙盒”。</li>
</ol>
<p>对比<code>NVIDIA MPS</code>仅能在<code>GPU</code>核心算力（<code>SM</code>）维度做时间片调度不同，<code>HAMi Core</code>能进一步在显存维度上做细粒度隔离。这样即便某个应用因为显存泄漏或异常崩溃，也不会像<code>MPS</code>下那样拖垮同节点的其他应用。</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id=hami配置说明>HAMi配置说明<a href=#hami配置说明 class=hash-link aria-label="Direct link to HAMi配置说明" title="Direct link to HAMi配置说明">​</a></h2>
<p>参考：<a href=https://github.com/Project-HAMi/HAMi/blob/master/docs/config_cn.md target=_blank rel="noopener noreferrer">https://github.com/Project-HAMi/HAMi/blob/master/docs/config_cn.md</a></p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id=全局设备配置>全局设备配置<a href=#全局设备配置 class=hash-link aria-label="Direct link to 全局设备配置" title="Direct link to 全局设备配置">​</a></h3>
<p>全局配置通过<code>hami-scheduler-device</code>的<code>ConfigMap</code>进行管理。<code>HAMi</code>采用<strong>厂商前缀</strong>的配置方式，支持多种智算卡厂商。配置项以厂商名称作为前缀（如<code>nvidia</code>、<code>cambricon</code>、<code>hygon</code>等），这样可以在同一集群中同时管理多种类型的智算卡。</p>
<p><strong>支持的厂商及配置前缀</strong>：</p>
<table><thead><tr><th>厂商名称<th>配置前缀<tbody><tr><td><code>NVIDIA</code><td><code>nvidia</code><tr><td>华为昇腾（<code>Huawei Ascend</code>）<td><code>ascend</code> 或 <code>vnpus</code><tr><td>寒武纪（<code>Cambricon</code>）<td><code>cambricon</code><tr><td>海光（<code>Hygon</code>）<td><code>hygon</code><tr><td>天数智芯（<code>Metax</code>）<td><code>metax</code><tr><td>摩尔线程（<code>Mthreads</code>）<td><code>mthreads</code><tr><td>燧原科技（<code>Enflame</code>）<td><code>enflame</code><tr><td>昆仑芯（<code>Kunlunxin</code>）<td><code>kunlun</code><tr><td>天垓（<code>Iluvatar</code>）<td><code>iluvatars</code><tr><td><code>AMD</code><td><code>amd</code><tr><td><code>AWS Neuron</code><td><code>awsneuron</code></table>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id=nvidia-gpu配置>NVIDIA GPU配置<a href=#nvidia-gpu配置 class=hash-link aria-label="Direct link to NVIDIA GPU配置" title="Direct link to NVIDIA GPU配置">​</a></h4>
<table><thead><tr><th>配置项<th>类型<th>默认值<th>说明<tbody><tr><td><code>deviceSplitCount</code><td>整数<td><code>10</code><td><code>GPU</code>分割数，每张<code>GPU</code>最多可同时运行的任务数<tr><td><code>deviceMemoryScaling</code><td>浮点数<td><code>1.0</code><td>显存使用比例，可大于1启用虚拟显存（实验功能）<tr><td><code>migStrategy</code><td>字符串<td><code>none</code><td><code>MIG</code>设备策略：<code>none</code>忽略<code>MIG</code>，<code>mixed</code>使用<code>MIG</code>设备<tr><td><code>disablecorelimit</code><td>字符串<td><code>false</code><td>是否关闭算力限制：<code>true</code>关闭，<code>false</code>启用<tr><td><code>defaultMem</code><td>整数<td><code>0</code><td>默认显存大小（<code>MB</code>），<code>0</code>表示使用全部显存<tr><td><code>defaultCores</code><td>整数<td><code>0</code><td>默认算力百分比(<code>0-100</code>)，<code>0</code>表示可分配到任意<code>GPU</code>，<code>100</code>表示独占<tr><td><code>defaultGPUNum</code><td>整数<td><code>1</code><td>未指定<code>GPU</code>数量时的默认值<tr><td><code>resourceCountName</code><td>字符串<td><code>nvidia.com/gpu</code><td><code>vGPU</code>个数的资源名称，生成到节点上<tr><td><code>resourceMemoryName</code><td>字符串<td><code>nvidia.com/gpumem</code><td><code>vGPU</code>显存大小的资源名称，生成到节点上<tr><td><code>resourceMemoryPercentageName</code><td>字符串<td><code>nvidia.com/gpumem-percentage</code><td><code>vGPU</code>显存比例的资源名称，仅用于<code>Pod</code>资源申请<tr><td><code>resourceCoreName</code><td>字符串<td><code>nvidia.com/gpucores</code><td><code>vGPU</code>算力的资源名称，生成到节点上<tr><td><code>resourcePriorityName</code><td>字符串<td><code>nvidia.com/priority</code><td>任务优先级的资源名称<tr><td><code>gpuCorePolicy</code><td>字符串<td><code>default</code><td>算力限制策略：<code>default</code>默认策略，<code>force</code>强制限制</table>
<p><strong>配置示例</strong>：</p>
<div class="language-yaml codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#f8f8f2;--prism-background-color:#272822><div class=codeBlockContent_biex><pre tabindex=0 class="prism-code language-yaml codeBlock_bY9V thin-scrollbar" style=color:#f8f8f2;background-color:#272822><code class=codeBlockLines_e6Vv><span class=token-line style=color:#f8f8f2><span class="token key atrule">apiVersion</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"> v1</span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain"></span><span class="token key atrule">kind</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"> ConfigMap</span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain"></span><span class="token key atrule">metadata</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">  </span><span class="token key atrule">name</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"> hami</span><span class="token punctuation" style=color:#f8f8f2>-</span><span class="token plain">scheduler</span><span class="token punctuation" style=color:#f8f8f2>-</span><span class="token plain">device</span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">  </span><span class="token key atrule">namespace</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"> hami</span><span class="token punctuation" style=color:#f8f8f2>-</span><span class="token plain">system</span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain"></span><span class="token key atrule">data</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">  </span><span class="token key atrule">device-config.yaml</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"> </span><span class="token punctuation" style=color:#f8f8f2>|</span><span class="token scalar string" style=color:#a6e22e></span><br></span><span class=token-line style=color:#f8f8f2><span class="token scalar string" style=color:#a6e22e>    nvidia:</span><br></span><span class=token-line style=color:#f8f8f2><span class="token scalar string" style=color:#a6e22e>      resourceCountName: "nvidia.com/gpu"</span><br></span><span class=token-line style=color:#f8f8f2><span class="token scalar string" style=color:#a6e22e>      resourceMemoryName: "nvidia.com/gpumem"</span><br></span><span class=token-line style=color:#f8f8f2><span class="token scalar string" style=color:#a6e22e>      resourceMemoryPercentageName: "nvidia.com/gpumem-percentage"</span><br></span><span class=token-line style=color:#f8f8f2><span class="token scalar string" style=color:#a6e22e>      resourceCoreName: "nvidia.com/gpucores"</span><br></span><span class=token-line style=color:#f8f8f2><span class="token scalar string" style=color:#a6e22e>      resourcePriorityName: "nvidia.com/priority"</span><br></span><span class=token-line style=color:#f8f8f2><span class="token scalar string" style=color:#a6e22e>      deviceSplitCount: 10</span><br></span><span class=token-line style=color:#f8f8f2><span class="token scalar string" style=color:#a6e22e>      deviceMemoryScaling: 1.0</span><br></span><span class=token-line style=color:#f8f8f2><span class="token scalar string" style=color:#a6e22e>      deviceCoreScaling: 1.0</span><br></span><span class=token-line style=color:#f8f8f2><span class="token scalar string" style=color:#a6e22e>      defaultMem: 0</span><br></span><span class=token-line style=color:#f8f8f2><span class="token scalar string" style=color:#a6e22e>      defaultCores: 0</span><br></span><span class=token-line style=color:#f8f8f2><span class="token scalar string" style=color:#a6e22e>      defaultGPUNum: 1</span><br></span><span class=token-line style=color:#f8f8f2><span class="token scalar string" style=color:#a6e22e>      gpuCorePolicy: default</span><br></span><span class=token-line style=color:#f8f8f2><span class="token scalar string" style=color:#a6e22e>      libCudaLogLevel: 1</span><br></span></code></pre><div class=buttonGroup__atx><button type=button aria-label="Copy code to clipboard" title=Copy class=clean-btn><span class=copyButtonIcons_eSgA aria-hidden=true><svg viewBox="0 0 24 24" class=copyButtonIcon_y97N><path fill=currentColor d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"/></svg><svg viewBox="0 0 24 24" class=copyButtonSuccessIcon_LjdS><path fill=currentColor d=M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z /></svg></span></button></div></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id=华为昇腾npu配置>华为昇腾NPU配置<a href=#华为昇腾npu配置 class=hash-link aria-label="Direct link to 华为昇�腾NPU配置" title="Direct link to 华为昇腾NPU配置">​</a></h4>
<p>华为昇腾<code>NPU</code>（如<code>910B</code>、<code>310P</code>）使用<code>ascend</code>前缀配置：</p>
<table><thead><tr><th>配置项<th>类型<th>默认值<th>说明<tbody><tr><td><code>resourceCountName</code><td>字符串<td><code>huawei.com/Ascend910B</code><td>昇腾设备个数的资源名称<tr><td><code>resourceMemoryName</code><td>字符串<td><code>huawei.com/Ascend910B-memory</code><td>昇腾设备显存的资源名称<tr><td><code>defaultMem</code><td>整数<td><code>0</code><td>默认显存大小（<code>MB</code>）<tr><td><code>defaultCores</code><td>整数<td><code>0</code><td>默认算力百分比(<code>0-100</code>)</table>
<p><strong>配置示例</strong>：</p>
<div class="language-yaml codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#f8f8f2;--prism-background-color:#272822><div class=codeBlockContent_biex><pre tabindex=0 class="prism-code language-yaml codeBlock_bY9V thin-scrollbar" style=color:#f8f8f2;background-color:#272822><code class=codeBlockLines_e6Vv><span class=token-line style=color:#f8f8f2><span class="token key atrule">apiVersion</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"> v1</span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain"></span><span class="token key atrule">kind</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"> ConfigMap</span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain"></span><span class="token key atrule">metadata</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">  </span><span class="token key atrule">name</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"> hami</span><span class="token punctuation" style=color:#f8f8f2>-</span><span class="token plain">scheduler</span><span class="token punctuation" style=color:#f8f8f2>-</span><span class="token plain">device</span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">  </span><span class="token key atrule">namespace</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"> hami</span><span class="token punctuation" style=color:#f8f8f2>-</span><span class="token plain">system</span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain"></span><span class="token key atrule">data</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">  </span><span class="token key atrule">device-config.yaml</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"> </span><span class="token punctuation" style=color:#f8f8f2>|</span><span class="token scalar string" style=color:#a6e22e></span><br></span><span class=token-line style=color:#f8f8f2><span class="token scalar string" style=color:#a6e22e>    ascend:</span><br></span><span class=token-line style=color:#f8f8f2><span class="token scalar string" style=color:#a6e22e>      resourceCountName: "huawei.com/Ascend910B3"</span><br></span><span class=token-line style=color:#f8f8f2><span class="token scalar string" style=color:#a6e22e>      resourceMemoryName: "huawei.com/Ascend910B3-memory"</span><br></span><span class=token-line style=color:#f8f8f2><span class="token scalar string" style=color:#a6e22e>      defaultMem: 0</span><br></span><span class=token-line style=color:#f8f8f2><span class="token scalar string" style=color:#a6e22e>      defaultCores: 0</span><br></span><span class=token-line style=color:#f8f8f2><span class="token scalar string" style=color:#a6e22e>      deviceSplitCount: 10</span><br></span></code></pre><div class=buttonGroup__atx><button type=button aria-label="Copy code to clipboard" title=Copy class=clean-btn><span class=copyButtonIcons_eSgA aria-hidden=true><svg viewBox="0 0 24 24" class=copyButtonIcon_y97N><path fill=currentColor d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"/></svg><svg viewBox="0 0 24 24" class=copyButtonSuccessIcon_LjdS><path fill=currentColor d=M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z /></svg></span></button></div></div></div>
<p><strong>Pod使用示例</strong>：</p>
<div class="language-yaml codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#f8f8f2;--prism-background-color:#272822><div class=codeBlockContent_biex><pre tabindex=0 class="prism-code language-yaml codeBlock_bY9V thin-scrollbar" style=color:#f8f8f2;background-color:#272822><code class=codeBlockLines_e6Vv><span class=token-line style=color:#f8f8f2><span class="token key atrule">apiVersion</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"> v1</span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain"></span><span class="token key atrule">kind</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"> Pod</span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain"></span><span class="token key atrule">metadata</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">  </span><span class="token key atrule">name</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"> ascend</span><span class="token punctuation" style=color:#f8f8f2>-</span><span class="token plain">test</span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain"></span><span class="token key atrule">spec</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">  </span><span class="token key atrule">schedulerName</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"> hami</span><span class="token punctuation" style=color:#f8f8f2>-</span><span class="token plain">scheduler</span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">  </span><span class="token key atrule">containers</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">  </span><span class="token punctuation" style=color:#f8f8f2>-</span><span class="token plain"> </span><span class="token key atrule">name</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"> app</span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">    </span><span class="token key atrule">image</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"> ascend</span><span class="token punctuation" style=color:#f8f8f2>-</span><span class="token plain">app</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain">latest</span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">    </span><span class="token key atrule">resources</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">      </span><span class="token key atrule">limits</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">        </span><span class="token key atrule">huawei.com/Ascend910B3</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"> </span><span class="token number" style=color:#ae81ff>1</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">        </span><span class="token key atrule">huawei.com/Ascend910B3-memory</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"> </span><span class="token number" style=color:#ae81ff>16000</span><span class="token plain">  </span><span class="token comment" style=color:#8292a2;font-style:italic># 16GB显存</span><br></span></code></pre><div class=buttonGroup__atx><button type=button aria-label="Copy code to clipboard" title=Copy class=clean-btn><span class=copyButtonIcons_eSgA aria-hidden=true><svg viewBox="0 0 24 24" class=copyButtonIcon_y97N><path fill=currentColor d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"/></svg><svg viewBox="0 0 24 24" class=copyButtonSuccessIcon_LjdS><path fill=currentColor d=M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z /></svg></span></button></div></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id=寒武纪mlu配置>寒武纪MLU配置<a href=#寒武纪mlu配置 class=hash-link aria-label="Direct link to 寒武纪MLU配置" title="Direct link to 寒武纪MLU配置">​</a></h4>
<p>寒武纪<code>MLU</code>（如<code>370</code>、<code>590</code>）使用<code>cambricon</code>前缀配置：</p>
<table><thead><tr><th>配置项<th>类型<th>默认值<th>说明<tbody><tr><td><code>resourceCountName</code><td>字符串<td><code>cambricon.com/vmlu</code><td><code>MLU</code>设备个数的资源名称<tr><td><code>resourceMemoryName</code><td>字符串<td><code>cambricon.com/mlu.smlu.vmemory</code><td><code>MLU</code>显存的资源名称<tr><td><code>resourceCoreName</code><td>字符串<td><code>cambricon.com/mlu.smlu.vcore</code><td><code>MLU</code>算力的资源名称<tr><td><code>defaultMem</code><td>整数<td><code>0</code><td>默认显存大小（<code>MB</code>）<tr><td><code>defaultCores</code><td>整数<td><code>0</code><td>默认算力百分比(<code>0-100</code>)</table>
<p><strong>配置示例</strong>：</p>
<div class="language-yaml codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#f8f8f2;--prism-background-color:#272822><div class=codeBlockContent_biex><pre tabindex=0 class="prism-code language-yaml codeBlock_bY9V thin-scrollbar" style=color:#f8f8f2;background-color:#272822><code class=codeBlockLines_e6Vv><span class=token-line style=color:#f8f8f2><span class="token key atrule">apiVersion</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"> v1</span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain"></span><span class="token key atrule">kind</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"> ConfigMap</span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain"></span><span class="token key atrule">metadata</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">  </span><span class="token key atrule">name</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"> hami</span><span class="token punctuation" style=color:#f8f8f2>-</span><span class="token plain">scheduler</span><span class="token punctuation" style=color:#f8f8f2>-</span><span class="token plain">device</span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">  </span><span class="token key atrule">namespace</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"> hami</span><span class="token punctuation" style=color:#f8f8f2>-</span><span class="token plain">system</span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain"></span><span class="token key atrule">data</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">  </span><span class="token key atrule">device-config.yaml</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"> </span><span class="token punctuation" style=color:#f8f8f2>|</span><span class="token scalar string" style=color:#a6e22e></span><br></span><span class=token-line style=color:#f8f8f2><span class="token scalar string" style=color:#a6e22e>    cambricon:</span><br></span><span class=token-line style=color:#f8f8f2><span class="token scalar string" style=color:#a6e22e>      resourceCountName: "cambricon.com/vmlu"</span><br></span><span class=token-line style=color:#f8f8f2><span class="token scalar string" style=color:#a6e22e>      resourceMemoryName: "cambricon.com/mlu.smlu.vmemory"</span><br></span><span class=token-line style=color:#f8f8f2><span class="token scalar string" style=color:#a6e22e>      resourceCoreName: "cambricon.com/mlu.smlu.vcore"</span><br></span><span class=token-line style=color:#f8f8f2><span class="token scalar string" style=color:#a6e22e>      defaultMem: 0</span><br></span><span class=token-line style=color:#f8f8f2><span class="token scalar string" style=color:#a6e22e>      defaultCores: 0</span><br></span><span class=token-line style=color:#f8f8f2><span class="token scalar string" style=color:#a6e22e>      deviceSplitCount: 10</span><br></span></code></pre><div class=buttonGroup__atx><button type=button aria-label="Copy code to clipboard" title=Copy class=clean-btn><span class=copyButtonIcons_eSgA aria-hidden=true><svg viewBox="0 0 24 24" class=copyButtonIcon_y97N><path fill=currentColor d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"/></svg><svg viewBox="0 0 24 24" class=copyButtonSuccessIcon_LjdS><path fill=currentColor d=M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z /></svg></span></button></div></div></div>
<p><strong>Pod使用示例</strong>：</p>
<div class="language-yaml codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#f8f8f2;--prism-background-color:#272822><div class=codeBlockContent_biex><pre tabindex=0 class="prism-code language-yaml codeBlock_bY9V thin-scrollbar" style=color:#f8f8f2;background-color:#272822><code class=codeBlockLines_e6Vv><span class=token-line style=color:#f8f8f2><span class="token key atrule">apiVersion</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"> v1</span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain"></span><span class="token key atrule">kind</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"> Pod</span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain"></span><span class="token key atrule">metadata</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">  </span><span class="token key atrule">name</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"> mlu</span><span class="token punctuation" style=color:#f8f8f2>-</span><span class="token plain">test</span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain"></span><span class="token key atrule">spec</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">  </span><span class="token key atrule">schedulerName</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"> hami</span><span class="token punctuation" style=color:#f8f8f2>-</span><span class="token plain">scheduler</span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">  </span><span class="token key atrule">containers</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">  </span><span class="token punctuation" style=color:#f8f8f2>-</span><span class="token plain"> </span><span class="token key atrule">name</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"> app</span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">    </span><span class="token key atrule">image</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"> cambricon</span><span class="token punctuation" style=color:#f8f8f2>-</span><span class="token plain">app</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain">latest</span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">    </span><span class="token key atrule">resources</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">      </span><span class="token key atrule">limits</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">        </span><span class="token key atrule">cambricon.com/vmlu</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"> </span><span class="token number" style=color:#ae81ff>1</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">        </span><span class="token key atrule">cambricon.com/mlu.smlu.vmemory</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"> </span><span class="token number" style=color:#ae81ff>8000</span><span class="token plain">  </span><span class="token comment" style=color:#8292a2;font-style:italic># 8GB显存</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">        </span><span class="token key atrule">cambricon.com/mlu.smlu.vcore</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"> </span><span class="token number" style=color:#ae81ff>50</span><span class="token plain">      </span><span class="token comment" style=color:#8292a2;font-style:italic># 50%算力</span><br></span></code></pre><div class=buttonGroup__atx><button type=button aria-label="Copy code to clipboard" title=Copy class=clean-btn><span class=copyButtonIcons_eSgA aria-hidden=true><svg viewBox="0 0 24 24" class=copyButtonIcon_y97N><path fill=currentColor d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"/></svg><svg viewBox="0 0 24 24" class=copyButtonSuccessIcon_LjdS><path fill=currentColor d=M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z /></svg></span></button></div></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id=海光dcu配置>海光DCU配置<a href=#海光dcu配置 class=hash-link aria-label="Direct link to 海光DCU配置" title="Direct link to 海光DCU配置">​</a></h4>
<p>海光<code>DCU</code>（如<code>Z100</code>、<code>Z100L</code>）使用<code>hygon</code>前缀配置：</p>
<table><thead><tr><th>配置项<th>类型<th>默认值<th>说明<tbody><tr><td><code>resourceCountName</code><td>字符串<td><code>hygon.com/dcunum</code><td><code>DCU</code>设备个数的资源名称<tr><td><code>resourceMemoryName</code><td>字符串<td><code>hygon.com/dcumem</code><td><code>DCU</code>显存的资源名称<tr><td><code>resourceCoreName</code><td>字符串<td><code>hygon.com/dcucores</code><td><code>DCU</code>算力的资源名称</table>
<p><strong>配置示例</strong>：</p>
<div class="language-yaml codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#f8f8f2;--prism-background-color:#272822><div class=codeBlockContent_biex><pre tabindex=0 class="prism-code language-yaml codeBlock_bY9V thin-scrollbar" style=color:#f8f8f2;background-color:#272822><code class=codeBlockLines_e6Vv><span class=token-line style=color:#f8f8f2><span class="token key atrule">apiVersion</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"> v1</span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain"></span><span class="token key atrule">kind</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"> ConfigMap</span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain"></span><span class="token key atrule">metadata</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">  </span><span class="token key atrule">name</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"> hami</span><span class="token punctuation" style=color:#f8f8f2>-</span><span class="token plain">scheduler</span><span class="token punctuation" style=color:#f8f8f2>-</span><span class="token plain">device</span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">  </span><span class="token key atrule">namespace</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"> hami</span><span class="token punctuation" style=color:#f8f8f2>-</span><span class="token plain">system</span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain"></span><span class="token key atrule">data</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">  </span><span class="token key atrule">device-config.yaml</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"> </span><span class="token punctuation" style=color:#f8f8f2>|</span><span class="token scalar string" style=color:#a6e22e></span><br></span><span class=token-line style=color:#f8f8f2><span class="token scalar string" style=color:#a6e22e>    hygon:</span><br></span><span class=token-line style=color:#f8f8f2><span class="token scalar string" style=color:#a6e22e>      resourceCountName: "hygon.com/dcunum"</span><br></span><span class=token-line style=color:#f8f8f2><span class="token scalar string" style=color:#a6e22e>      resourceMemoryName: "hygon.com/dcumem"</span><br></span><span class=token-line style=color:#f8f8f2><span class="token scalar string" style=color:#a6e22e>      resourceCoreName: "hygon.com/dcucores"</span><br></span><span class=token-line style=color:#f8f8f2><span class="token scalar string" style=color:#a6e22e>      defaultMem: 0</span><br></span><span class=token-line style=color:#f8f8f2><span class="token scalar string" style=color:#a6e22e>      defaultCores: 0</span><br></span></code></pre><div class=buttonGroup__atx><button type=button aria-label="Copy code to clipboard" title=Copy class=clean-btn><span class=copyButtonIcons_eSgA aria-hidden=true><svg viewBox="0 0 24 24" class=copyButtonIcon_y97N><path fill=currentColor d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"/></svg><svg viewBox="0 0 24 24" class=copyButtonSuccessIcon_LjdS><path fill=currentColor d=M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z /></svg></span></button></div></div></div>
<p><strong>Pod使用示例</strong>：</p>
<div class="language-yaml codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#f8f8f2;--prism-background-color:#272822><div class=codeBlockContent_biex><pre tabindex=0 class="prism-code language-yaml codeBlock_bY9V thin-scrollbar" style=color:#f8f8f2;background-color:#272822><code class=codeBlockLines_e6Vv><span class=token-line style=color:#f8f8f2><span class="token key atrule">apiVersion</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"> v1</span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain"></span><span class="token key atrule">kind</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"> Pod</span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain"></span><span class="token key atrule">metadata</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">  </span><span class="token key atrule">name</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"> dcu</span><span class="token punctuation" style=color:#f8f8f2>-</span><span class="token plain">test</span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain"></span><span class="token key atrule">spec</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">  </span><span class="token key atrule">schedulerName</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"> hami</span><span class="token punctuation" style=color:#f8f8f2>-</span><span class="token plain">scheduler</span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">  </span><span class="token key atrule">containers</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">  </span><span class="token punctuation" style=color:#f8f8f2>-</span><span class="token plain"> </span><span class="token key atrule">name</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"> app</span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">    </span><span class="token key atrule">image</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"> hygon</span><span class="token punctuation" style=color:#f8f8f2>-</span><span class="token plain">app</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain">latest</span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">    </span><span class="token key atrule">resources</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">      </span><span class="token key atrule">limits</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">        </span><span class="token key atrule">hygon.com/dcunum</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"> </span><span class="token number" style=color:#ae81ff>1</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">        </span><span class="token key atrule">hygon.com/dcumem</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"> </span><span class="token number" style=color:#ae81ff>16000</span><span class="token plain">    </span><span class="token comment" style=color:#8292a2;font-style:italic># 16GB显存</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">        </span><span class="token key atrule">hygon.com/dcucores</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"> </span><span class="token number" style=color:#ae81ff>80</span><span class="token plain">     </span><span class="token comment" style=color:#8292a2;font-style:italic># 80%算力</span><br></span></code></pre><div class=buttonGroup__atx><button type=button aria-label="Copy code to clipboard" title=Copy class=clean-btn><span class=copyButtonIcons_eSgA aria-hidden=true><svg viewBox="0 0 24 24" class=copyButtonIcon_y97N><path fill=currentColor d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"/></svg><svg viewBox="0 0 24 24" class=copyButtonSuccessIcon_LjdS><path fill=currentColor d=M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z /></svg></span></button></div></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id=其他国产智算卡配置>其他国产智算卡配置<a href=#其他国产智算卡配置 class=hash-link aria-label="Direct link to 其他国产�智算卡配置" title="Direct link to 其他国产智算卡配置">​</a></h4>
<p><code>HAMi</code>还支持以下国产智算卡，配置方式类似：</p>
<p><strong>天数智芯（Metax）</strong>：</p>
<div class="language-yaml codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#f8f8f2;--prism-background-color:#272822><div class=codeBlockContent_biex><pre tabindex=0 class="prism-code language-yaml codeBlock_bY9V thin-scrollbar" style=color:#f8f8f2;background-color:#272822><code class=codeBlockLines_e6Vv><span class=token-line style=color:#f8f8f2><span class="token key atrule">metax</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">  </span><span class="token key atrule">resourceCountName</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"> </span><span class="token string" style=color:#a6e22e>"metax-tech.com/sgpu"</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">  </span><span class="token key atrule">resourceMemoryName</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"> </span><span class="token string" style=color:#a6e22e>"metax-tech.com/vmemory"</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">  </span><span class="token key atrule">resourceCoreName</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"> </span><span class="token string" style=color:#a6e22e>"metax-tech.com/vcore"</span><br></span></code></pre><div class=buttonGroup__atx><button type=button aria-label="Copy code to clipboard" title=Copy class=clean-btn><span class=copyButtonIcons_eSgA aria-hidden=true><svg viewBox="0 0 24 24" class=copyButtonIcon_y97N><path fill=currentColor d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"/></svg><svg viewBox="0 0 24 24" class=copyButtonSuccessIcon_LjdS><path fill=currentColor d=M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z /></svg></span></button></div></div></div>
<p><strong>摩尔线程（Mthreads）</strong>：</p>
<div class="language-yaml codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#f8f8f2;--prism-background-color:#272822><div class=codeBlockContent_biex><pre tabindex=0 class="prism-code language-yaml codeBlock_bY9V thin-scrollbar" style=color:#f8f8f2;background-color:#272822><code class=codeBlockLines_e6Vv><span class=token-line style=color:#f8f8f2><span class="token key atrule">mthreads</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">  </span><span class="token key atrule">resourceCountName</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"> </span><span class="token string" style=color:#a6e22e>"mthreads.com/vgpu"</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">  </span><span class="token key atrule">resourceMemoryName</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"> </span><span class="token string" style=color:#a6e22e>"mthreads.com/sgpu-memory"</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">  </span><span class="token key atrule">resourceCoreName</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"> </span><span class="token string" style=color:#a6e22e>"mthreads.com/sgpu-core"</span><br></span></code></pre><div class=buttonGroup__atx><button type=button aria-label="Copy code to clipboard" title=Copy class=clean-btn><span class=copyButtonIcons_eSgA aria-hidden=true><svg viewBox="0 0 24 24" class=copyButtonIcon_y97N><path fill=currentColor d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"/></svg><svg viewBox="0 0 24 24" class=copyButtonSuccessIcon_LjdS><path fill=currentColor d=M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z /></svg></span></button></div></div></div>
<p><strong>燧原科技（Enflame）</strong>：</p>
<div class="language-yaml codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#f8f8f2;--prism-background-color:#272822><div class=codeBlockContent_biex><pre tabindex=0 class="prism-code language-yaml codeBlock_bY9V thin-scrollbar" style=color:#f8f8f2;background-color:#272822><code class=codeBlockLines_e6Vv><span class=token-line style=color:#f8f8f2><span class="token key atrule">enflame</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">  </span><span class="token key atrule">resourceCountName</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"> </span><span class="token string" style=color:#a6e22e>"enflame.com/vgcu"</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">  </span><span class="token key atrule">resourceMemoryPercentageName</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"> </span><span class="token string" style=color:#a6e22e>"enflame.com/vgcu-percentage"</span><br></span></code></pre><div class=buttonGroup__atx><button type=button aria-label="Copy code to clipboard" title=Copy class=clean-btn><span class=copyButtonIcons_eSgA aria-hidden=true><svg viewBox="0 0 24 24" class=copyButtonIcon_y97N><path fill=currentColor d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"/></svg><svg viewBox="0 0 24 24" class=copyButtonSuccessIcon_LjdS><path fill=currentColor d=M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z /></svg></span></button></div></div></div>
<p><strong>昆仑芯（Kunlunxin）</strong>：</p>
<div class="language-yaml codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#f8f8f2;--prism-background-color:#272822><div class=codeBlockContent_biex><pre tabindex=0 class="prism-code language-yaml codeBlock_bY9V thin-scrollbar" style=color:#f8f8f2;background-color:#272822><code class=codeBlockLines_e6Vv><span class=token-line style=color:#f8f8f2><span class="token key atrule">kunlunxin</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">  </span><span class="token key atrule">resourceCountName</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"> </span><span class="token string" style=color:#a6e22e>"kunlunxin.com/xpu"</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">  </span><span class="token key atrule">resourceVCountName</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"> </span><span class="token string" style=color:#a6e22e>"kunlunxin.com/vxpu"</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">  </span><span class="token key atrule">resourceVMemoryName</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"> </span><span class="token string" style=color:#a6e22e>"kunlunxin.com/vxpu-memory"</span><br></span></code></pre><div class=buttonGroup__atx><button type=button aria-label="Copy code to clipboard" title=Copy class=clean-btn><span class=copyButtonIcons_eSgA aria-hidden=true><svg viewBox="0 0 24 24" class=copyButtonIcon_y97N><path fill=currentColor d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"/></svg><svg viewBox="0 0 24 24" class=copyButtonSuccessIcon_LjdS><path fill=currentColor d=M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z /></svg></span></button></div></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id=多厂商混合配置>多厂商混合配置<a href=#多厂商混合配置 class=hash-link aria-label="Direct link to 多厂商混合配置" title="Direct link to 多厂商混合配置">​</a></h4>
<p>在异构集群中，可以同时配置多种智算卡：</p>
<div class="language-yaml codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#f8f8f2;--prism-background-color:#272822><div class=codeBlockContent_biex><pre tabindex=0 class="prism-code language-yaml codeBlock_bY9V thin-scrollbar" style=color:#f8f8f2;background-color:#272822><code class=codeBlockLines_e6Vv><span class=token-line style=color:#f8f8f2><span class="token comment" style=color:#8292a2;font-style:italic># NVIDIA GPU配置</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain"></span><span class="token key atrule">nvidia</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">  </span><span class="token key atrule">resourceCountName</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"> </span><span class="token string" style=color:#a6e22e>"nvidia.com/gpu"</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">  </span><span class="token key atrule">resourceMemoryName</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"> </span><span class="token string" style=color:#a6e22e>"nvidia.com/gpumem"</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">  </span><span class="token key atrule">resourceCoreName</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"> </span><span class="token string" style=color:#a6e22e>"nvidia.com/gpucores"</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">  </span><span class="token key atrule">deviceSplitCount</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"> </span><span class="token number" style=color:#ae81ff>10</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">  </span><span class="token key atrule">defaultMem</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"> </span><span class="token number" style=color:#ae81ff>0</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">  </span><span class="token key atrule">defaultCores</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"> </span><span class="token number" style=color:#ae81ff>0</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain"></span><span class="token comment" style=color:#8292a2;font-style:italic># 华为昇腾NPU配置</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain"></span><span class="token key atrule">ascend</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">  </span><span class="token key atrule">resourceCountName</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"> </span><span class="token string" style=color:#a6e22e>"huawei.com/Ascend910B3"</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">  </span><span class="token key atrule">resourceMemoryName</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"> </span><span class="token string" style=color:#a6e22e>"huawei.com/Ascend910B3-memory"</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">  </span><span class="token key atrule">deviceSplitCount</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"> </span><span class="token number" style=color:#ae81ff>8</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">  </span><span class="token key atrule">defaultMem</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"> </span><span class="token number" style=color:#ae81ff>0</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">  </span><span class="token key atrule">defaultCores</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"> </span><span class="token number" style=color:#ae81ff>0</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain"></span><span class="token comment" style=color:#8292a2;font-style:italic># 寒武纪MLU配置</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain"></span><span class="token key atrule">cambricon</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">  </span><span class="token key atrule">resourceCountName</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"> </span><span class="token string" style=color:#a6e22e>"cambricon.com/vmlu"</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">  </span><span class="token key atrule">resourceMemoryName</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"> </span><span class="token string" style=color:#a6e22e>"cambricon.com/mlu.smlu.vmemory"</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">  </span><span class="token key atrule">resourceCoreName</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"> </span><span class="token string" style=color:#a6e22e>"cambricon.com/mlu.smlu.vcore"</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">  </span><span class="token key atrule">deviceSplitCount</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"> </span><span class="token number" style=color:#ae81ff>10</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">  </span><span class="token key atrule">defaultMem</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"> </span><span class="token number" style=color:#ae81ff>0</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">  </span><span class="token key atrule">defaultCores</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"> </span><span class="token number" style=color:#ae81ff>0</span><br></span></code></pre><div class=buttonGroup__atx><button type=button aria-label="Copy code to clipboard" title=Copy class=clean-btn><span class=copyButtonIcons_eSgA aria-hidden=true><svg viewBox="0 0 24 24" class=copyButtonIcon_y97N><path fill=currentColor d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"/></svg><svg viewBox="0 0 24 24" class=copyButtonSuccessIcon_LjdS><path fill=currentColor d=M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z /></svg></span></button></div></div></div>
<p>这样配置后，<code>HAMi</code>会自动识别节点上的智算卡类型，并应用对应的配置策略。</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id=节点级配置>节点级配置<a href=#节点级配置 class=hash-link aria-label="Direct link to 节点级配置" title="Direct link to 节点级配置">​</a></h3>
<p>可以为每个节点配置不同的行为，通过编辑<code>hami-device-plugin</code>的<code>ConfigMap</code>。节点级配置会<strong>覆盖</strong>全局配置中的对应参数。</p>
<table><thead><tr><th>配置项<th>类型<th>默认值<th>说明<tbody><tr><td><code>name</code><td>字符串<td>-<td>要配置的节点名称<tr><td><code>operatingmode</code><td>字符串<td><code>hami-core</code><td>运行模式：<code>hami-core</code>、<code>mig</code>或<code>mps</code><tr><td><code>devicememoryscaling</code><td>浮点数<td>-<td>节点显存超配率，如<code>1.5</code>表示允许超配<code>50%</code><tr><td><code>devicecorescaling</code><td>浮点数<td>-<td>节点算力超配率<tr><td><code>devicesplitcount</code><td>整数<td>-<td>每个设备允许的任务数<tr><td><code>libcudaloglevel</code><td>整数<td>-<td><code>HAMi Core</code>日志级别：<code>0=Error,1=Warning,3=Info,4=Debug</code><tr><td><code>migstrategy</code><td>字符串<td>-<td><code>MIG</code>策略：<code>none</code>或<code>mixed</code><tr><td><code>filterdevices.uuid</code><td>字符串列表<td>-<td>要排除设备的<code>UUID</code>列表<tr><td><code>filterdevices.index</code><td>整数列表<td>-<td>要排除设备的索引列表</table>
<p><strong>配置示例</strong>：</p>
<div class="language-yaml codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#f8f8f2;--prism-background-color:#272822><div class=codeBlockContent_biex><pre tabindex=0 class="prism-code language-yaml codeBlock_bY9V thin-scrollbar" style=color:#f8f8f2;background-color:#272822><code class=codeBlockLines_e6Vv><span class=token-line style=color:#f8f8f2><span class="token key atrule">apiVersion</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"> v1</span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain"></span><span class="token key atrule">kind</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"> ConfigMap</span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain"></span><span class="token key atrule">metadata</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">  </span><span class="token key atrule">name</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"> hami</span><span class="token punctuation" style=color:#f8f8f2>-</span><span class="token plain">device</span><span class="token punctuation" style=color:#f8f8f2>-</span><span class="token plain">plugin</span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">  </span><span class="token key atrule">namespace</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"> hami</span><span class="token punctuation" style=color:#f8f8f2>-</span><span class="token plain">system</span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain"></span><span class="token key atrule">data</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">  </span><span class="token key atrule">config.json</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"> </span><span class="token punctuation" style=color:#f8f8f2>|</span><span class="token scalar string" style=color:#a6e22e></span><br></span><span class=token-line style=color:#f8f8f2><span class="token scalar string" style=color:#a6e22e>    {</span><br></span><span class=token-line style=color:#f8f8f2><span class="token scalar string" style=color:#a6e22e>      "nodeconfig": [</span><br></span><span class=token-line style=color:#f8f8f2><span class="token scalar string" style=color:#a6e22e>        {</span><br></span><span class=token-line style=color:#f8f8f2><span class="token scalar string" style=color:#a6e22e>          "name": "node1",</span><br></span><span class=token-line style=color:#f8f8f2><span class="token scalar string" style=color:#a6e22e>          "operatingmode": "hami-core",</span><br></span><span class=token-line style=color:#f8f8f2><span class="token scalar string" style=color:#a6e22e>          "devicesplitcount": 10,</span><br></span><span class=token-line style=color:#f8f8f2><span class="token scalar string" style=color:#a6e22e>          "devicememoryscaling": 1.0,</span><br></span><span class=token-line style=color:#f8f8f2><span class="token scalar string" style=color:#a6e22e>          "devicecorescaling": 1.0,</span><br></span><span class=token-line style=color:#f8f8f2><span class="token scalar string" style=color:#a6e22e>          "libcudaloglevel": 1</span><br></span><span class=token-line style=color:#f8f8f2><span class="token scalar string" style=color:#a6e22e>        },</span><br></span><span class=token-line style=color:#f8f8f2><span class="token scalar string" style=color:#a6e22e>        {</span><br></span><span class=token-line style=color:#f8f8f2><span class="token scalar string" style=color:#a6e22e>          "name": "node2",</span><br></span><span class=token-line style=color:#f8f8f2><span class="token scalar string" style=color:#a6e22e>          "operatingmode": "hami-core",</span><br></span><span class=token-line style=color:#f8f8f2><span class="token scalar string" style=color:#a6e22e>          "devicesplitcount": 5,</span><br></span><span class=token-line style=color:#f8f8f2><span class="token scalar string" style=color:#a6e22e>          "devicememoryscaling": 1.5,</span><br></span><span class=token-line style=color:#f8f8f2><span class="token scalar string" style=color:#a6e22e>          "devicecorescaling": 1.2,</span><br></span><span class=token-line style=color:#f8f8f2><span class="token scalar string" style=color:#a6e22e>          "libcudaloglevel": 0,</span><br></span><span class=token-line style=color:#f8f8f2><span class="token scalar string" style=color:#a6e22e>          "filterdevices": {</span><br></span><span class=token-line style=color:#f8f8f2><span class="token scalar string" style=color:#a6e22e>            "uuid": ["GPU-12345678-1234-1234-1234-123456789012"],</span><br></span><span class=token-line style=color:#f8f8f2><span class="token scalar string" style=color:#a6e22e>            "index": [0, 1]</span><br></span><span class=token-line style=color:#f8f8f2><span class="token scalar string" style=color:#a6e22e>          }</span><br></span><span class=token-line style=color:#f8f8f2><span class="token scalar string" style=color:#a6e22e>        },</span><br></span><span class=token-line style=color:#f8f8f2><span class="token scalar string" style=color:#a6e22e>        {</span><br></span><span class=token-line style=color:#f8f8f2><span class="token scalar string" style=color:#a6e22e>          "name": "node3",</span><br></span><span class=token-line style=color:#f8f8f2><span class="token scalar string" style=color:#a6e22e>          "operatingmode": "mig",</span><br></span><span class=token-line style=color:#f8f8f2><span class="token scalar string" style=color:#a6e22e>          "migstrategy": "mixed"</span><br></span><span class=token-line style=color:#f8f8f2><span class="token scalar string" style=color:#a6e22e>        }</span><br></span><span class=token-line style=color:#f8f8f2><span class="token scalar string" style=color:#a6e22e>      ]</span><br></span><span class=token-line style=color:#f8f8f2><span class="token scalar string" style=color:#a6e22e>    }</span><br></span></code></pre><div class=buttonGroup__atx><button type=button aria-label="Copy code to clipboard" title=Copy class=clean-btn><span class=copyButtonIcons_eSgA aria-hidden=true><svg viewBox="0 0 24 24" class=copyButtonIcon_y97N><path fill=currentColor d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"/></svg><svg viewBox="0 0 24 24" class=copyButtonSuccessIcon_LjdS><path fill=currentColor d=M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z /></svg></span></button></div></div></div>
<p><strong>配置说明</strong>：</p>
<ol>
<li>
<p><strong>node1</strong>：</p>
<ul>
<li>使用<code>hami-core</code>模式</li>
<li>每张<code>GPU</code>最多运行<code>10</code>个任务</li>
<li>不允许超配（显存和算力比例都是<code>1.0</code>）</li>
<li>日志级别为<code>Warning</code></li>
</ul>
</li>
<li>
<p><strong>node2</strong>：</p>
<ul>
<li>使用<code>hami-core</code>模式</li>
<li>每张<code>GPU</code>最多运行<code>5</code>个任务</li>
<li>允许显存超配<code>50%</code>（<code>1.5</code>倍）</li>
<li>允许算力超配<code>20%</code>（<code>1.2</code>倍）</li>
<li>日志级别为<code>Error</code>（仅显示错误）</li>
<li>过滤掉指定<code>UUID</code>的<code>GPU</code>和索引<code>0</code>、<code>1</code>的<code>GPU</code>（这些<code>GPU</code>不会被<code>HAMi</code>管理）</li>
</ul>
</li>
<li>
<p><strong>node3</strong>：</p>
<ul>
<li>使用<code>MIG</code>模式</li>
<li><code>MIG</code>策略为<code>mixed</code>（混合使用<code>MIG</code>设备）</li>
</ul>
</li>
</ol>
<p><strong>应用配置</strong>：</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#f8f8f2;--prism-background-color:#272822><div class=codeBlockContent_biex><pre tabindex=0 class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style=color:#f8f8f2;background-color:#272822><code class=codeBlockLines_e6Vv><span class=token-line style=color:#f8f8f2><span class="token comment" style=color:#8292a2;font-style:italic># 创建或更新ConfigMap</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">kubectl apply </span><span class="token parameter variable" style=color:#f8f8f2>-f</span><span class="token plain"> hami-device-plugin-config.yaml</span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain"></span><span class="token comment" style=color:#8292a2;font-style:italic># 重启device plugin使配置生效</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">kubectl rollout restart daemonset hami-device-plugin </span><span class="token parameter variable" style=color:#f8f8f2>-n</span><span class="token plain"> hami-system</span><br></span></code></pre><div class=buttonGroup__atx><button type=button aria-label="Copy code to clipboard" title=Copy class=clean-btn><span class=copyButtonIcons_eSgA aria-hidden=true><svg viewBox="0 0 24 24" class=copyButtonIcon_y97N><path fill=currentColor d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"/></svg><svg viewBox="0 0 24 24" class=copyButtonSuccessIcon_LjdS><path fill=currentColor d=M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z /></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id=调度策略配置>调度策略配置<a href=#调度策略配置 class=hash-link aria-label="Direct link to 调度策略配置" title="Direct link to 调度策略配置">​</a></h3>
<p>通过<code>Helm Chart</code>参数配置调度策略：</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#f8f8f2;--prism-background-color:#272822><div class=codeBlockContent_biex><pre tabindex=0 class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style=color:#f8f8f2;background-color:#272822><code class=codeBlockLines_e6Vv><span class=token-line style=color:#f8f8f2><span class="token plain">helm </span><span class="token function" style=color:#e6db74>install</span><span class="token plain"> vgpu vgpu-charts/vgpu </span><span class="token parameter variable" style=color:#f8f8f2>--set</span><span class="token plain"> </span><span class="token assign-left variable" style=color:#f8f8f2>scheduler.defaultSchedulerPolicy.nodeSchedulerPolicy</span><span class="token operator" style=color:#66d9ef>=</span><span class="token plain">binpack</span><br></span></code></pre><div class=buttonGroup__atx><button type=button aria-label="Copy code to clipboard" title=Copy class=clean-btn><span class=copyButtonIcons_eSgA aria-hidden=true><svg viewBox="0 0 24 24" class=copyButtonIcon_y97N><path fill=currentColor d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"/></svg><svg viewBox="0 0 24 24" class=copyButtonSuccessIcon_LjdS><path fill=currentColor d=M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z /></svg></span></button></div></div></div>
<table><thead><tr><th>配置项<th>类型<th>默认值<th>说明<th>可选值<tbody><tr><td><code>scheduler.defaultSchedulerPolicy.nodeSchedulerPolicy</code><td>字符串<td><code>binpack</code><td>节点调度策略：<code>binpack</code>尽量集中，<code>spread</code>尽量分散<td><code>binpack</code>/<code>spread</code><tr><td><code>scheduler.defaultSchedulerPolicy.gpuSchedulerPolicy</code><td>字符串<td><code>spread</code><td><code>GPU</code>调度策略：<code>binpack</code>尽量集中，<code>spread</code>尽量分散<td><code>binpack</code>/<code>spread</code></table>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id=pod注解配置>Pod注解配置<a href=#pod注解配置 class=hash-link aria-label="Direct link to Pod注解配置" title="Direct link to Pod注解配置">​</a></h3>
<p>在<code>Pod</code>的<code>metadata.annotations</code>中指定：</p>
<table><thead><tr><th>注解<th>类型<th>说明<th>示例值<tbody><tr><td><code>nvidia.com/use-gpuuuid</code><td>字符串<td>指定只能使用的<code>GPU UUID</code>列表，使用逗号分隔<td><code>GPU-AAA,GPU-BBB</code><tr><td><code>nvidia.com/nouse-gpuuuid</code><td>字符串<td>指定不能使用的<code>GPU UUID</code>列表，使用逗号分隔<td><code>GPU-AAA,GPU-BBB</code><tr><td><code>nvidia.com/use-gputype</code><td>字符串<td>指定只能使用的<code>GPU</code>型号，支持多个型号使用逗号分隔<td><code>A100,V100</code> 或 <code>Tesla V100-PCIE-32GB</code><tr><td><code>nvidia.com/nouse-gputype</code><td>字符串<td>指定不能使用的<code>GPU</code>型号（黑名单），支持多个型号使用逗号分隔<td><code>1080,2080</code> 或 <code>NVIDIA A10</code><tr><td><code>hami.io/gpu-scheduler-policy</code><td>字符串<td><code>Pod</code>级别的<code>GPU</code>调度策略<td><code>binpack</code>/<code>spread</code><tr><td><code>hami.io/node-scheduler-policy</code><td>字符串<td><code>Pod</code>级别的节点调度策略<td><code>binpack</code>/<code>spread</code><tr><td><code>nvidia.com/vgpu-mode</code><td>字符串<td>指定使用的<code>vGPU</code>类型<td><code>hami-core</code>/<code>mig</code></table>
<p><strong>使用示例</strong>：</p>
<div class="language-yaml codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#f8f8f2;--prism-background-color:#272822><div class=codeBlockContent_biex><pre tabindex=0 class="prism-code language-yaml codeBlock_bY9V thin-scrollbar" style=color:#f8f8f2;background-color:#272822><code class=codeBlockLines_e6Vv><span class=token-line style=color:#f8f8f2><span class="token comment" style=color:#8292a2;font-style:italic># 示例1: 指定单个GPU型号</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain"></span><span class="token key atrule">apiVersion</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"> v1</span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain"></span><span class="token key atrule">kind</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"> Pod</span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain"></span><span class="token key atrule">metadata</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">  </span><span class="token key atrule">name</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"> gpu</span><span class="token punctuation" style=color:#f8f8f2>-</span><span class="token plain">pod</span><span class="token punctuation" style=color:#f8f8f2>-</span><span class="token plain">single</span><span class="token punctuation" style=color:#f8f8f2>-</span><span class="token plain">type</span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">  </span><span class="token key atrule">annotations</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">    </span><span class="token key atrule">nvidia.com/use-gputype</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"> </span><span class="token string" style=color:#a6e22e>"Tesla V100-PCIE-32GB"</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">    </span><span class="token key atrule">hami.io/gpu-scheduler-policy</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"> </span><span class="token string" style=color:#a6e22e>"binpack"</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain"></span><span class="token key atrule">spec</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">  </span><span class="token key atrule">schedulerName</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"> hami</span><span class="token punctuation" style=color:#f8f8f2>-</span><span class="token plain">scheduler</span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">  </span><span class="token key atrule">containers</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">  </span><span class="token punctuation" style=color:#f8f8f2>-</span><span class="token plain"> </span><span class="token key atrule">name</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"> app</span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">    </span><span class="token key atrule">image</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"> nvidia/cuda</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain">11.8.0</span><span class="token punctuation" style=color:#f8f8f2>-</span><span class="token plain">runtime</span><span class="token punctuation" style=color:#f8f8f2>-</span><span class="token plain">ubuntu22.04</span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">    </span><span class="token key atrule">resources</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">      </span><span class="token key atrule">limits</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">        </span><span class="token key atrule">nvidia.com/gpu</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"> </span><span class="token number" style=color:#ae81ff>1</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">        </span><span class="token key atrule">nvidia.com/gpumem</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"> </span><span class="token number" style=color:#ae81ff>8000</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain"></span><span class="token punctuation" style=color:#f8f8f2>---</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain"></span><span class="token comment" style=color:#8292a2;font-style:italic># 示例2: 指定多个GPU型号（白名单），任务只会调度到A100或V100上</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain"></span><span class="token key atrule">apiVersion</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"> v1</span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain"></span><span class="token key atrule">kind</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"> Pod</span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain"></span><span class="token key atrule">metadata</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">  </span><span class="token key atrule">name</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"> gpu</span><span class="token punctuation" style=color:#f8f8f2>-</span><span class="token plain">pod</span><span class="token punctuation" style=color:#f8f8f2>-</span><span class="token plain">multi</span><span class="token punctuation" style=color:#f8f8f2>-</span><span class="token plain">type</span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">  </span><span class="token key atrule">annotations</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">    </span><span class="token comment" style=color:#8292a2;font-style:italic># 使用逗号分隔多个型号</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">    </span><span class="token key atrule">nvidia.com/use-gputype</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"> </span><span class="token string" style=color:#a6e22e>"NVIDIA-GeForce-RTX-4090,NVIDIA-GeForce-RTX-5090"</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">    </span><span class="token key atrule">hami.io/gpu-scheduler-policy</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"> </span><span class="token string" style=color:#a6e22e>"binpack"</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain"></span><span class="token key atrule">spec</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">  </span><span class="token key atrule">schedulerName</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"> hami</span><span class="token punctuation" style=color:#f8f8f2>-</span><span class="token plain">scheduler</span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">  </span><span class="token key atrule">containers</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">  </span><span class="token punctuation" style=color:#f8f8f2>-</span><span class="token plain"> </span><span class="token key atrule">name</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"> app</span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">    </span><span class="token key atrule">image</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"> nvidia/cuda</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain">11.8.0</span><span class="token punctuation" style=color:#f8f8f2>-</span><span class="token plain">runtime</span><span class="token punctuation" style=color:#f8f8f2>-</span><span class="token plain">ubuntu22.04</span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">    </span><span class="token key atrule">resources</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">      </span><span class="token key atrule">limits</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">        </span><span class="token key atrule">nvidia.com/gpu</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"> </span><span class="token number" style=color:#ae81ff>1</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">        </span><span class="token key atrule">nvidia.com/gpumem</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"> </span><span class="token number" style=color:#ae81ff>8000</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain"></span><span class="token punctuation" style=color:#f8f8f2>---</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain"></span><span class="token comment" style=color:#8292a2;font-style:italic># 示例3: 排除特定GPU型号（黑名单），任务不会调度到1080或2080上</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain"></span><span class="token key atrule">apiVersion</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"> v1</span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain"></span><span class="token key atrule">kind</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"> Pod</span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain"></span><span class="token key atrule">metadata</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">  </span><span class="token key atrule">name</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"> gpu</span><span class="token punctuation" style=color:#f8f8f2>-</span><span class="token plain">pod</span><span class="token punctuation" style=color:#f8f8f2>-</span><span class="token plain">blacklist</span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">  </span><span class="token key atrule">annotations</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">    </span><span class="token comment" style=color:#8292a2;font-style:italic># 使用逗号分隔多个型号</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">    </span><span class="token key atrule">nvidia.com/nouse-gputype</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"> </span><span class="token string" style=color:#a6e22e>"NVIDIA-H20,NVIDIA-H200"</span><span class="token plain">  </span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain"></span><span class="token key atrule">spec</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">  </span><span class="token key atrule">schedulerName</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"> hami</span><span class="token punctuation" style=color:#f8f8f2>-</span><span class="token plain">scheduler</span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">  </span><span class="token key atrule">containers</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">  </span><span class="token punctuation" style=color:#f8f8f2>-</span><span class="token plain"> </span><span class="token key atrule">name</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"> app</span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">    </span><span class="token key atrule">image</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"> nvidia/cuda</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain">11.8.0</span><span class="token punctuation" style=color:#f8f8f2>-</span><span class="token plain">runtime</span><span class="token punctuation" style=color:#f8f8f2>-</span><span class="token plain">ubuntu22.04</span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">    </span><span class="token key atrule">resources</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">      </span><span class="token key atrule">limits</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">        </span><span class="token key atrule">nvidia.com/gpu</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"> </span><span class="token number" style=color:#ae81ff>1</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">        </span><span class="token key atrule">nvidia.com/gpumem</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"> </span><span class="token number" style=color:#ae81ff>8000</span><br></span></code></pre><div class=buttonGroup__atx><button type=button aria-label="Copy code to clipboard" title=Copy class=clean-btn><span class=copyButtonIcons_eSgA aria-hidden=true><svg viewBox="0 0 24 24" class=copyButtonIcon_y97N><path fill=currentColor d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"/></svg><svg viewBox="0 0 24 24" class=copyButtonSuccessIcon_LjdS><path fill=currentColor d=M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z /></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id=容器环境变量配置>容器环境变量配置<a href=#容器环境变量配置 class=hash-link aria-label="Direct link to 容器环境变量配置" title="Direct link to 容器环境变量配置">​</a></h3>
<p>在容器的<code>env</code>中指定：</p>
<table><thead><tr><th>环境变量<th>类型<th>默认值<th>说明<th>可选值<tbody><tr><td><code>GPU_CORE_UTILIZATION_POLICY</code><td>字符串<td><code>default</code><td>算力限制策略：<code>default</code>默认，<code>force</code>强制限制，<code>disable</code>忽略限制<td><code>default</code>/<code>force</code>/<code>disable</code><tr><td><code>CUDA_DISABLE_CONTROL</code><td>布尔<td><code>false</code><td>是否屏蔽容器层资源隔离，一般用于调试<td><code>true</code>/<code>false</code></table>
<p><strong>使用示例</strong>：</p>
<div class="language-yaml codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#f8f8f2;--prism-background-color:#272822><div class=codeBlockContent_biex><pre tabindex=0 class="prism-code language-yaml codeBlock_bY9V thin-scrollbar" style=color:#f8f8f2;background-color:#272822><code class=codeBlockLines_e6Vv><span class=token-line style=color:#f8f8f2><span class="token key atrule">apiVersion</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"> v1</span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain"></span><span class="token key atrule">kind</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"> Pod</span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain"></span><span class="token key atrule">metadata</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">  </span><span class="token key atrule">name</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"> gpu</span><span class="token punctuation" style=color:#f8f8f2>-</span><span class="token plain">pod</span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain"></span><span class="token key atrule">spec</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">  </span><span class="token key atrule">schedulerName</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"> hami</span><span class="token punctuation" style=color:#f8f8f2>-</span><span class="token plain">scheduler</span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">  </span><span class="token key atrule">containers</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">  </span><span class="token punctuation" style=color:#f8f8f2>-</span><span class="token plain"> </span><span class="token key atrule">name</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"> app</span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">    </span><span class="token key atrule">image</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"> nvidia/cuda</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain">11.8.0</span><span class="token punctuation" style=color:#f8f8f2>-</span><span class="token plain">runtime</span><span class="token punctuation" style=color:#f8f8f2>-</span><span class="token plain">ubuntu22.04</span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">    </span><span class="token key atrule">env</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">    </span><span class="token punctuation" style=color:#f8f8f2>-</span><span class="token plain"> </span><span class="token key atrule">name</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"> GPU_CORE_UTILIZATION_POLICY</span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">      </span><span class="token key atrule">value</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"> </span><span class="token string" style=color:#a6e22e>"force"</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">    </span><span class="token key atrule">resources</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">      </span><span class="token key atrule">limits</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">        </span><span class="token key atrule">nvidia.com/gpu</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"> </span><span class="token number" style=color:#ae81ff>1</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">        </span><span class="token key atrule">nvidia.com/gpumem</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"> </span><span class="token number" style=color:#ae81ff>8000</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">        </span><span class="token key atrule">nvidia.com/gpucores</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"> </span><span class="token number" style=color:#ae81ff>50</span><br></span></code></pre><div class=buttonGroup__atx><button type=button aria-label="Copy code to clipboard" title=Copy class=clean-btn><span class=copyButtonIcons_eSgA aria-hidden=true><svg viewBox="0 0 24 24" class=copyButtonIcon_y97N><path fill=currentColor d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"/></svg><svg viewBox="0 0 24 24" class=copyButtonSuccessIcon_LjdS><path fill=currentColor d=M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z /></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id=hami-with-volcano>HAMi With Volcano<a href=#hami-with-volcano class=hash-link aria-label="Direct link to HAMi With Volcano" title="Direct link to HAMi With Volcano">​</a></h2>
<p><code>Volcano</code>原生支持<code>HAMi vGPU</code>，由于篇幅较长，具体请参考：<a href=/ai/vgpu-hami-with-volcano>HAMi With Volcano</a></p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id=使用示例>使用示例<a href=#使用示例 class=hash-link aria-label="Direct link to 使用示例" title="Direct link to 使用示例">​</a></h2>
<p>由于<code>HAMi</code>官方开源仓库以及提供了比较丰富的示例代码，这里不再赘述。仓库链接：<a href=https://github.com/Project-HAMi/HAMi/tree/master/examples target=_blank rel="noopener noreferrer">https://github.com/Project-HAMi/HAMi/tree/master/examples</a></p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id=参考资料>参考资料<a href=#参考资料 class=hash-link aria-label="Direct link to 参考资料" title="Direct link to 参考资料">​</a></h2>
<ul>
<li><a href=https://github.com/Project-HAMi/HAMi target=_blank rel="noopener noreferrer">https://github.com/Project-HAMi/HAMi</a></li>
<li><a href=https://dynamia.ai/ target=_blank rel="noopener noreferrer">https://dynamia.ai/</a></li>
</ul></div></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href=/ai/vgpu-introduction-and-comparison><div class=pagination-nav__sublabel>Previous</div><div class=pagination-nav__label>vGPU介绍及主流方案对比</div></a><a class="pagination-nav__link pagination-nav__link--next" href=/ai/vgpu-hami-with-volcano><div class=pagination-nav__sublabel>Next</div><div class=pagination-nav__label>HAMi With Volcano</div></a></nav><div class=docusaurus-mt-lg></div></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href=#hami项目概述 class="table-of-contents__link toc-highlight">HAMi项目概述</a><li><a href=#hami的优势与局限 class="table-of-contents__link toc-highlight">HAMi的优势与局限</a><li><a href=#hami版本限制 class="table-of-contents__link toc-highlight">HAMi版本限制</a><ul><li><a href=#兼容的cuda版本 class="table-of-contents__link toc-highlight">兼容的CUDA版本</a><li><a href=#nvidia驱动版本要求 class="table-of-contents__link toc-highlight">NVIDIA驱动版本要求</a></ul><li><a href=#hami整体架构 class="table-of-contents__link toc-highlight">HAMi整体架构</a><ul><li><a href=#hami-mutating-webhook class="table-of-contents__link toc-highlight">HAMi Mutating Webhook</a><li><a href=#hami-scheduler-extender class="table-of-contents__link toc-highlight">HAMi Scheduler Extender</a><li><a href=#hami-device-plugin class="table-of-contents__link toc-highlight">HAMi Device Plugin</a><li><a href=#hami-core-libvgpuso class="table-of-contents__link toc-highlight">HAMi Core (libvgpu.so)</a></ul><li><a href=#hami原理分析 class="table-of-contents__link toc-highlight">HAMi原理分析</a><ul><li><a href=#pod调度阶段 class="table-of-contents__link toc-highlight">Pod调度阶段</a><li><a href=#pod持续运行阶段 class="table-of-contents__link toc-highlight">Pod持续运行阶段</a></ul><li><a href=#hami配置说明 class="table-of-contents__link toc-highlight">HAMi配置说明</a><ul><li><a href=#全局设备配置 class="table-of-contents__link toc-highlight">全局设备配置</a><li><a href=#节点级配置 class="table-of-contents__link toc-highlight">节点级配置</a><li><a href=#调度策略配置 class="table-of-contents__link toc-highlight">调度策略配置</a><li><a href=#pod注解配置 class="table-of-contents__link toc-highlight">Pod注解配置</a><li><a href=#容器环境变量配置 class="table-of-contents__link toc-highlight">容器环境变量配置</a></ul><li><a href=#hami-with-volcano class="table-of-contents__link toc-highlight">HAMi With Volcano</a><li><a href=#使用示例 class="table-of-contents__link toc-highlight">使用示例</a><li><a href=#参考资料 class="table-of-contents__link toc-highlight">参考资料</a></ul></div></div></div></div></main></div></div></div><footer class=footer><div class="container container-fluid"><div class="footer__bottom text--center"><div class=footer__copyright>Copyright 2026 johng.cn</div></div></div></footer></div>