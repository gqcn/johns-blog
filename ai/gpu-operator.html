<!doctype html><html lang=en dir=ltr class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-docs/AI技术/NVIDIA/GPU Operator" data-has-hydrated=false><meta charset=UTF-8><meta name=generator content="Docusaurus v3.6.3"><title data-rh=true>GPU Operator | John's Blog</title><meta data-rh=true name=viewport content="width=device-width,initial-scale=1.0"><meta data-rh=true name=twitter:card content=summary_large_image><meta data-rh=true property=og:url content=https://johng.cn/ai/gpu-operator><meta data-rh=true property=og:locale content=en><meta data-rh=true name=docusaurus_locale content=en><meta data-rh=true name=docsearch:language content=en><meta data-rh=true name=docusaurus_version content=current><meta data-rh=true name=docusaurus_tag content=docs-default-current><meta data-rh=true name=docsearch:version content=current><meta data-rh=true name=docsearch:docusaurus_tag content=docs-default-current><meta data-rh=true property=og:title content="GPU Operator | John's Blog"><meta data-rh=true name=description content="本文详细介绍NVIDIA GPU Operator的主要作用、组件构成、与GPU DevicePlugin的区别、Kubernetes兼容性以及部署方法，帮助用户在Kubernetes环境中更轻松地管理GPU资源。"><meta data-rh=true property=og:description content="本文详细介绍NVIDIA GPU Operator的主要作用、组件构成、与GPU DevicePlugin的区别、Kubernetes兼容性以及部署方法，帮助用户在Kubernetes环境中更轻松地管理GPU资源。"><meta data-rh=true name=keywords content="GPU Operator,NVIDIA,Kubernetes,容器化,GPU管理,云原生,设备插件,驱动管理,AI基础设施,机器学习,深度学习"><link data-rh=true rel=icon href=/img/favicon.ico><link data-rh=true rel=canonical href=https://johng.cn/ai/gpu-operator><link data-rh=true rel=alternate href=https://johng.cn/ai/gpu-operator hreflang=en><link data-rh=true rel=alternate href=https://johng.cn/ai/gpu-operator hreflang=x-default><link data-rh=true rel=preconnect href=https://XGS1CPQERK-dsn.algolia.net crossorigin><link rel=search type=application/opensearchdescription+xml title="John's Blog" href=/opensearch.xml><script src=https://hm.baidu.com/hm.js?6b4ae23dc83ee5efe875b7172af6c7c1 async></script><script src=https://cdn.wwads.cn/js/makemoney.js async></script><link rel=stylesheet href=/assets/css/styles.208c11f9.css><script src=/assets/js/runtime~main.2980ef1a.js defer></script><script src=/assets/js/main.01697419.js defer></script><body class=navigation-with-keyboard><script>!function(){var t,e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();t=null!==e?e:"light",document.documentElement.setAttribute("data-theme",t)}(),function(){try{for(var[t,e]of new URLSearchParams(window.location.search).entries())if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id=__docusaurus><div role=region aria-label="Skip to main content"><a class=skipToContent_fXgn href=#__docusaurus_skipToContent_fallback>Skip to main content</a></div><nav aria-label=Main class="navbar navbar--fixed-top"><div class=navbar__inner><div class=navbar__items><button aria-label="Toggle navigation bar" aria-expanded=false class="navbar__toggle clean-btn" type=button><svg width=30 height=30 viewBox="0 0 30 30" aria-hidden=true><path stroke=currentColor stroke-linecap=round stroke-miterlimit=10 stroke-width=2 d="M4 7h22M4 15h22M4 23h22"/></svg></button><a class=navbar__brand href=/><b class="navbar__title text--truncate">John's Blog</b></a><a aria-current=page class="navbar__item navbar__link navbar__link--active" sidebarid=mainSidebar href=/ai>AI技术</a><a class="navbar__item navbar__link" sidebarid=mainSidebar href=/cloud-native>云原生</a><a class="navbar__item navbar__link" sidebarid=mainSidebar href=/notes>日常笔记</a><a class="navbar__item navbar__link" sidebarid=mainSidebar href=/programming>开发语言</a><a class="navbar__item navbar__link" sidebarid=mainSidebar href=/architecture>技术架构</a><a class="navbar__item navbar__link" sidebarid=mainSidebar href=/observability>可观测性</a><a class="navbar__item navbar__link" sidebarid=mainSidebar href=/database-and-middleware>数据库与中间件</a><a class="navbar__item navbar__link" href=/aboutme>关于我</a></div><div class="navbar__items navbar__items--right"><a href=https://goframe.org/ target=_blank rel="noopener noreferrer" class="navbar__item navbar__link header-goframe-link"></a><a href=https://github.com/gqcn target=_blank rel="noopener noreferrer" class="navbar__item navbar__link header-github-link"></a><div class=navbarSearchContainer_Bca1><button type=button class="DocSearch DocSearch-Button" aria-label="Search (Command+K)"><span class=DocSearch-Button-Container><svg width=20 height=20 class=DocSearch-Search-Icon viewBox="0 0 20 20" aria-hidden=true><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke=currentColor fill=none fill-rule=evenodd stroke-linecap=round stroke-linejoin=round /></svg><span class=DocSearch-Button-Placeholder>Search</span></span><span class=DocSearch-Button-Keys></span></button></div></div></div><div role=presentation class=navbar-sidebar__backdrop></div></nav><div id=__docusaurus_skipToContent_fallback class="main-wrapper mainWrapper_z2l0"><div class=docsWrapper_hBAB><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type=button></button><div class=docRoot_UBD9><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class=sidebarViewport_aRkj><div class=sidebar_njMd><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class=menu__list-item-collapsible><a class="menu__link menu__link--sublist menu__link--active" href=/ai>AI技术</a><button aria-label="Collapse sidebar category 'AI技术'" aria-expanded=true type=button class="clean-btn menu__caret"></button></div><ul style=display:block;overflow:visible;height:auto class=menu__list><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class=menu__list-item-collapsible><a class="menu__link menu__link--sublist menu__link--active" tabindex=0 href=/ai/nvidia>NVIDIA</a><button aria-label="Collapse sidebar category 'NVIDIA'" aria-expanded=true type=button class="clean-btn menu__caret"></button></div><ul style=display:block;overflow:visible;height:auto class=menu__list><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link menu__link--active" aria-current=page tabindex=0 href=/ai/gpu-operator>GPU Operator</a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class=menu__link tabindex=0 href=/ai/gpu-dcgm-exporter>GPU DCGM-Exporter监控方案</a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class=menu__link tabindex=0 href=/ai/gpu-share-mps-mig>GPU Share MPS&MIG具体操作与注意事项</a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class=menu__link tabindex=0 href=/ai/gpu-mig-docker-specify-subcard>GPU MIG拆卡后使用docker指定子卡执行</a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class=menu__link tabindex=0 href=/ai/gpu-mig-pod-pending-terminating-troubleshooting>GPU MIG拆卡后Pod偶发Pending/Terminating状态阻塞问题排查</a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class=menu__link tabindex=0 href=/ai/gpu-environment-setup-guide>GPU环境搭建指南：在裸机、Docker、K8S环境中使用GPU</a></ul><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="menu__link menu__link--sublist" tabindex=0 href=/ai/distributed-inference>分布式推理</a><button aria-label="Expand sidebar category '分布式推理'" aria-expanded=false type=button class="clean-btn menu__caret"></button></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="menu__link menu__link--sublist" tabindex=0 href=/ai/scheduling>算力资源调度</a><button aria-label="Expand sidebar category '算力资源调度'" aria-expanded=false type=button class="clean-btn menu__caret"></button></div><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class=menu__link tabindex=0 href=/ai/nfd-gfd>NFD&GFD</a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class=menu__link tabindex=0 href=/ai/common-acceleration-cards>常见智算加速卡汇总</a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class=menu__link tabindex=0 href=/ai/rdma>RDMA技术架构深度解析</a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class=menu__link tabindex=0 href=/ai/general-ai-model-and-reasoning-ai-model-difference>通用大模型和推理大模型区别</a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class=menu__link tabindex=0 href=/ai/common-ai-model-training-inference-framework>常见AI模型训练推理框架对比</a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class=menu__link tabindex=0 href=/ai/ai-training-inference-scenarios>AI模型训练推理常见业务场景痛点</a></ul><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="menu__link menu__link--sublist" href=/cloud-native>云原生</a><button aria-label="Expand sidebar category '云原生'" aria-expanded=false type=button class="clean-btn menu__caret"></button></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="menu__link menu__link--sublist" href=/notes>日常笔记</a><button aria-label="Expand sidebar category '日常笔记'" aria-expanded=false type=button class="clean-btn menu__caret"></button></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="menu__link menu__link--sublist" href=/programming>开发语言</a><button aria-label="Expand sidebar category '开发语言'" aria-expanded=false type=button class="clean-btn menu__caret"></button></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="menu__link menu__link--sublist" href=/architecture>技术架构</a><button aria-label="Expand sidebar category '技术架构'" aria-expanded=false type=button class="clean-btn menu__caret"></button></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="menu__link menu__link--sublist" href=/management>技术管理</a><button aria-label="Expand sidebar category '技术管理'" aria-expanded=false type=button class="clean-btn menu__caret"></button></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="menu__link menu__link--sublist" href=/observability>可观测性</a><button aria-label="Expand sidebar category '可观测性'" aria-expanded=false type=button class="clean-btn menu__caret"></button></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="menu__link menu__link--sublist" href=/database-and-middleware>数据库与中间件</a><button aria-label="Expand sidebar category '数据库与中间件'" aria-expanded=false type=button class="clean-btn menu__caret"></button></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="menu__link menu__link--sublist" href=/operating-systems-and-networks>操作系统和网络</a><button aria-label="Expand sidebar category '操作系统和网络'" aria-expanded=false type=button class="clean-btn menu__caret"></button></div></ul></nav></div></div></aside><main class=docMainContainer_TBSr><div class="container padding-top--md padding-bottom--lg"><div class=row><div class="col docItemCol_VOVn"><div class=docItemContainer_Djhp><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label=Breadcrumbs><ul class=breadcrumbs itemscope itemtype=https://schema.org/BreadcrumbList><li class=breadcrumbs__item><a aria-label="Home page" class=breadcrumbs__link href=/><svg viewBox="0 0 24 24" class=breadcrumbHomeIcon_YNFT><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill=currentColor /></svg></a><li itemscope itemprop=itemListElement itemtype=https://schema.org/ListItem class=breadcrumbs__item><a class=breadcrumbs__link itemprop=item href=/ai><span itemprop=name>AI技术</span></a><meta itemprop=position content=1><li itemscope itemprop=itemListElement itemtype=https://schema.org/ListItem class=breadcrumbs__item><a class=breadcrumbs__link itemprop=item href=/ai/nvidia><span itemprop=name>NVIDIA</span></a><meta itemprop=position content=2><li itemscope itemprop=itemListElement itemtype=https://schema.org/ListItem class="breadcrumbs__item breadcrumbs__item--active"><span class=breadcrumbs__link itemprop=name>GPU Operator</span><meta itemprop=position content=3></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type=button class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><h2 class="anchor anchorWithStickyNavbar_LWe7" id=1-gpu-operator的主要作用>1. GPU Operator的主要作用<a href=#1-gpu-operator的主要作用 class=hash-link aria-label="Direct link to 1. GPU Operator的主要作用" title="Direct link to 1. GPU Operator的主要作用">​</a></h2>
<p><img decoding=async loading=lazy alt="alt text" src=/assets/images/image-7b35f60219f4194a195edaa171ef5172.png width=742 height=353 class=img_ev3q></p>
<p><code>NVIDIA GPU Operator</code>是一个基于<code>Kubernetes Operator</code>框架开发的解决方案，旨在简化<code>Kubernetes</code>集群中<code>NVIDIA GPU</code>的管理和使用。在传统的<code>Kubernetes</code>环境中，要使用<code>GPU</code>资源，管理员需要手动完成多个复杂的配置步骤，包括：</p>
<ul>
<li>在每个<code>GPU</code>节点上安装<code>NVIDIA</code>驱动程序</li>
<li>配置容器运行时以支持<code>GPU</code>（如<code>NVIDIA Container Runtime</code>）</li>
<li>部署<code>Kubernetes Device Plugin</code>以暴露<code>GPU</code>资源</li>
<li>设置<code>GPU</code>监控和指标收集工具</li>
<li>管理<code>GPU</code>资源的版本更新和升级</li>
</ul>
<p>这些手动配置过程不仅繁琐且容易出错，还难以在大规模集群中保持一致性。<code>GPU Operator</code>通过自动化这些过程，解决了以下关键问题：</p>
<ol>
<li><strong>简化部署流程</strong>：使用标准的<code>Kubernetes API</code>自动部署所有必要的<code>NVIDIA</code>软件组件</li>
<li><strong>统一管理</strong>：提供一致的方式管理集群中的所有<code>GPU</code>节点</li>
<li><strong>自动化版本控制</strong>：简化组件的版本管理和升级流程</li>
<li><strong>降低操作复杂性</strong>：减少手动配置错误，提高系统可靠性</li>
<li><strong>支持异构集群</strong>：能够在同一集群中管理不同型号和配置的<code>GPU</code></li>
</ol>
<p>通过<code>GPU Operator</code>，管理员只需一个命令即可完成所有<code>GPU</code>相关组件的部署，大大简化了在<code>Kubernetes</code>环境中使用<code>NVIDIA GPU</code>的流程。</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id=2-gpu-operator与gpu-deviceplugin的区别>2. GPU Operator与GPU DevicePlugin的区别<a href=#2-gpu-operator与gpu-deviceplugin的区别 class=hash-link aria-label="Direct link to 2. GPU Operator与GPU DevicePlugin的区别" title="Direct link to 2. GPU Operator与GPU DevicePlugin的区别">​</a></h2>
<p>理解<code>GPU Operator</code>与<code>GPU DevicePlugin</code>的区别对于正确选择和使用这些工具至关重要。</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id=21-gpu-deviceplugin>2.1 GPU DevicePlugin<a href=#21-gpu-deviceplugin class=hash-link aria-label="Direct link to 2.1 GPU DevicePlugin" title="Direct link to 2.1 GPU DevicePlugin">​</a></h3>
<p><code>GPU DevicePlugin</code>是<code>Kubernetes</code>的一个组件，其主要功能是：</p>
<ul>
<li>向<code>Kubernetes</code>暴露<code>GPU</code>资源，使其可以被调度系统识别</li>
<li>跟踪<code>GPU</code>的健康状态和可用性</li>
<li>为容器分配<code>GPU</code>资源</li>
<li>实现<code>GPU</code>资源的隔离</li>
</ul>
<p>然而，<code>GPU DevicePlugin</code>仅解决了<code>GPU</code>资源暴露和分配的问题，它<strong>假设</strong>所有必要的<code>GPU</code>驱动和运行时环境已经正确配置。它不负责安装或管理这些底层组件。</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id=22-gpu-operator的扩展功能>2.2 GPU Operator的扩展功能<a href=#22-gpu-operator的扩展功能 class=hash-link aria-label="Direct link to 2.2 GPU Operator的扩展功能" title="Direct link to 2.2 GPU Operator的扩展功能">​</a></h3>
<p>相比之下，<code>GPU Operator</code>提供了更全面的解决方案：</p>
<table><thead><tr><th>功能<th><code>GPU DevicePlugin</code><th>GPU Operator<tbody><tr><td>暴露<code>GPU</code>资源<td>✓<td>✓ (包含<code>DevicePlugin</code>)<tr><td><code>GPU</code>驱动安装<td>✗<td>✓<tr><td>容器运行时配置<td>✗<td>✓<tr><td>自动节点标签<td>✗<td>✓<tr><td>监控集成<td>✗<td>✓<tr><td>版本管理<td>✗<td>✓<tr><td><code>MIG</code>支持<td>有限<td>完整支持</table>
<p><code>GPU Operator</code>实际上将<code>GPU DevicePlugin</code>作为其管理的组件之一，同时负责整个<code>GPU</code>软件栈的生命周期管理。可以将两者的关系理解为：<code>GPU DevicePlugin</code>是<code>GPU Operator</code>管理的众多组件之一。</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id=3-gpu-operator的工作流程>3. GPU Operator的工作流程<a href=#3-gpu-operator的工作流程 class=hash-link aria-label="Direct link to 3. GPU Operator的工作流程" title="Direct link to 3. GPU Operator的工作流程">​</a></h2>
<p><code>NVIDIA GPU Operator</code>基于<code>Kubernetes</code>的<code>Operator</code>框架实现，通过自定义资源定义(<code>CRD</code>)和相应的控制器来管理<code>GPU</code>组件的生命周期。了解其工作流程有助于理解它如何协调各组件的部署和管理。</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id=31-operator状态机>3.1 Operator状态机<a href=#31-operator状态机 class=hash-link aria-label="Direct link to 3.1 Operator状态机" title="Direct link to 3.1 Operator状态机">​</a></h3>
<p><code>GPU Operator</code>使用状态机模式来管理其生命周期，主要包括以下状态转换过程：</p>
<p><img decoding=async loading=lazy alt="alt text" src=/assets/images/image-1-027c5658c2ecd8fa26eca75fccadb4fa.png width=1376 height=476 class=img_ev3q></p>
<p>状态机按照以下顺序执行：</p>
<ol>
<li><strong>容器工具包状态</strong>：部署一个<code>DaemonSet</code>，在<code>GPU</code>节点上安装<code>NVIDIA Container Runtime</code></li>
<li><strong>驱动状态</strong>：部署一个<code>DaemonSet</code>，在<code>GPU</code>节点上安装容器化的<code>NVIDIA</code>驱动程序</li>
<li><strong>驱动验证状态</strong>：运行一个简单的<code>CUDA</code>工作负载，验证驱动是否正确安装</li>
<li><strong>设备插件状态</strong>：部署<code>NVIDIA Device Plugin</code>的<code>DaemonSet</code>，向<code>Kubernetes</code>注册<code>GPU</code>资源</li>
<li><strong>设备插件验证状态</strong>：请求分配<code>GPU</code>资源并运行<code>CUDA</code>工作负载，验证资源分配是否正常</li>
</ol>
<p>在每个状态之间，<code>Operator</code>都会执行验证步骤，确保当前组件已正确部署和配置，只有在验证成功后才会进入下一个状态。如果任何验证步骤失败，状态机将退出并报告错误。</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id=32-节点发现与选择>3.2 节点发现与选择<a href=#32-节点发现与选择 class=hash-link aria-label="Direct link to 3.2 节点发现与选择" title="Direct link to 3.2 节点发现与选择">​</a></h3>
<p><code>GPU Operator</code>依赖<code>Node Feature Discovery (NFD)</code>来识别集群中的<code>GPU</code>节点。<code>NFD</code>会检测节点上的硬件特性，并为节点添加标签。例如，对于具有<code>NVIDIA GPU</code>的节点，<code>NFD</code>会添加以下标签：</p>
<div class="language-go codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#f8f8f2;--prism-background-color:#272822><div class=codeBlockContent_biex><pre tabindex=0 class="prism-code language-go codeBlock_bY9V thin-scrollbar" style=color:#f8f8f2;background-color:#272822><code class=codeBlockLines_e6Vv><span class=token-line style=color:#f8f8f2><span class="token plain">feature</span><span class="token punctuation" style=color:#f8f8f2>.</span><span class="token plain">node</span><span class="token punctuation" style=color:#f8f8f2>.</span><span class="token plain">kubernetes</span><span class="token punctuation" style=color:#f8f8f2>.</span><span class="token plain">io</span><span class="token operator" style=color:#66d9ef>/</span><span class="token plain">pci</span><span class="token operator" style=color:#66d9ef>-</span><span class="token plain">10de</span><span class="token punctuation" style=color:#f8f8f2>.</span><span class="token plain">present</span><span class="token operator" style=color:#66d9ef>=</span><span class="token boolean" style=color:#ae81ff>true</span><br></span></code></pre><div class=buttonGroup__atx><button type=button aria-label="Copy code to clipboard" title=Copy class=clean-btn><span class=copyButtonIcons_eSgA aria-hidden=true><svg viewBox="0 0 24 24" class=copyButtonIcon_y97N><path fill=currentColor d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"/></svg><svg viewBox="0 0 24 24" class=copyButtonSuccessIcon_LjdS><path fill=currentColor d=M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z /></svg></span></button></div></div></div>
<p>其中<code>0x10DE</code>是<code>NVIDIA</code>的<code>PCI</code>供应商<code>ID</code>。<code>GPU Operator</code>使用这些标签来确定在哪些节点上部署<code>GPU</code>组件。</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id=33-组件部署与协调>3.3 组件部署与协调<a href=#33-组件部署与协调 class=hash-link aria-label="Direct link to 3.3 组件部署与协调" title="Direct link to 3.3 组件部署与协调">​</a></h3>
<p><code>Operator</code>在两个命名空间中工作：</p>
<ul>
<li><strong>gpu-operator命名空间</strong>：运行<code>Operator</code>本身</li>
<li><strong>gpu-operator-resources命名空间</strong>：部署和管理底层<code>NVIDIA</code>组件</li>
</ul>
<p>当<code>Operator</code>检测到带有<code>NVIDIA GPU</code>的节点时，它会按照状态机的顺序，在这些节点上部署必要的组件。<code>Operator</code>使用<code>Reconcile()</code>函数实现协调循环，持续监控组件状态并根据需要进行调整。</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id=34-版本管理与自定义>3.4 版本管理与自定义<a href=#34-版本管理与自定义 class=hash-link aria-label="Direct link to 3.4 版本管理与自定义" title="Direct link to 3.4 版本管理与自定义">​</a></h3>
<p><code>GPU Operator</code>使用<code>Helm</code>模板(<code>values.yaml</code>)来允许用户自定义各组件的版本。这提供了一定程度的参数化能力，使用户可以根据需要部署特定版本的驱动程序、设备插件等组件。</p>
<p>通过这种设计，<code>GPU Operator</code>能够以声明式方式管理<code>GPU</code>资源，简化了复杂的手动配置过程，并确保了组件之间的一致性和兼容性。</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id=4-gpu-operator包含的组件>4. GPU Operator包含的组件<a href=#4-gpu-operator包含的组件 class=hash-link aria-label="Direct link to 4. GPU Operator包含的组件" title="Direct link to 4. GPU Operator包含的组件">​</a></h2>
<p><img decoding=async loading=lazy alt="alt text" src=/assets/images/image-2-b6ebc5f34712d7725f6f4dea1d79e882.png width=2000 height=543 class=img_ev3q></p>
<p><code>GPU Operator</code>采用容器化方式部署和管理以下核心组件：</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id=41-nvidia驱动容器-driver-container>4.1 NVIDIA驱动容器 (Driver Container)<a href=#41-nvidia驱动容器-driver-container class=hash-link aria-label="Direct link to 4.1 NVIDIA驱动容器 (Driver Container)" title="Direct link to 4.1 NVIDIA驱动容器 (Driver Container)">​</a></h3>
<ul>
<li><strong>功能</strong>：在节点上安装和管理<code>NVIDIA GPU</code>驱动程序</li>
<li><strong>特点</strong>：以容器方式运行，但能够将驱动加载到主机内核中</li>
<li><strong>优势</strong>：简化驱动版本管理，避免直接在主机上安装驱动</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id=32-nvidia容器工具包-container-toolkit>3.2 NVIDIA容器工具包 (Container Toolkit)<a href=#32-nvidia容器工具包-container-toolkit class=hash-link aria-label="Direct link to 3.2 NVIDIA容器工具包 (Container Toolkit)" title="Direct link to 3.2 NVIDIA容器工具包 (Container Toolkit)">​</a></h3>
<ul>
<li><strong>功能</strong>：配置容器运行时以支持<code>GPU</code>访问</li>
<li><strong>组件</strong>：包含<code>nvidia-container-runtime</code>和相关配置</li>
<li><strong>作用</strong>：确保容器能够正确访问主机上的<code>GPU</code>设备和驱动</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id=33-kubernetes设备插件-device-plugin>3.3 Kubernetes设备插件 (Device Plugin)<a href=#33-kubernetes设备插件-device-plugin class=hash-link aria-label="Direct link to 3.3 Kubernetes设备插件 (Device Plugin)" title="Direct link to 3.3 Kubernetes设备插件 (Device Plugin)">​</a></h3>
<ul>
<li><strong>功能</strong>：向<code>Kubernetes API</code>服务器注册<code>GPU</code>资源</li>
<li><strong>作用</strong>：使<code>Kubernetes</code>调度器能够感知<code>GPU</code>资源并进行分配</li>
<li><strong>实现</strong>：以<code>DaemonSet</code>形式在每个<code>GPU</code>节点上运行</li>
</ul>
<p>详细介绍请参考文章：<a href=/cloud-native/kubernetes-device-plugin>Decvice Plugin</a></p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id=34-节点特性发现-node-feature-discovery-nfd>3.4 节点特性发现 (Node Feature Discovery, NFD)<a href=#34-节点特性发现-node-feature-discovery-nfd class=hash-link aria-label="Direct link to 3.4 节点特性发现 (Node Feature Discovery, NFD)" title="Direct link to 3.4 节点特性发现 (Node Feature Discovery, NFD)">​</a></h3>
<ul>
<li><strong>功能</strong>：自动检测节点上的硬件特性并添加标签</li>
<li><strong>作用</strong>：识别具有<code>GPU</code>的节点，为其添加标签如<code>feature.node.kubernetes.io/pci-10de.present=true</code></li>
<li><strong>优势</strong>：简化节点选择和工作负载调度</li>
</ul>
<p>详细介绍请参考文章：<a href=/ai/nfd-gfd>NFD&GFD技术介绍</a></p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id=35-gpu特性发现-gpu-feature-discovery-gfd>3.5 GPU特性发现 (GPU Feature Discovery, GFD)<a href=#35-gpu特性发现-gpu-feature-discovery-gfd class=hash-link aria-label="Direct link to 3.5 GPU特性发现 (GPU Feature Discovery, GFD)" title="Direct link to 3.5 GPU特性发现 (GPU Feature Discovery, GFD)">​</a></h3>
<ul>
<li><strong>功能</strong>：为节点添加详细的<code>GPU</code>特性标签</li>
<li><strong>标签示例</strong>：<code>GPU</code>型号、架构、<code>CUDA</code>版本等</li>
<li><strong>用途</strong>：支持基于特定<code>GPU</code>特性的精细化调度</li>
</ul>
<p>详细介绍请参考文章：[NFD&GFD技术介绍](../2000-NFD&GFD技术介绍.md</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id=36-dcgm导出器-dcgm-exporter>3.6 DCGM导出器 (DCGM Exporter)<a href=#36-dcgm导出器-dcgm-exporter class=hash-link aria-label="Direct link to 3.6 DCGM导出器 (DCGM Exporter)" title="Direct link to 3.6 DCGM导出器 (DCGM Exporter)">​</a></h3>
<ul>
<li><strong>功能</strong>：收集<code>GPU</code>指标并以<code>Prometheus</code>格式导出</li>
<li><strong>监控内容</strong>：<code>GPU</code>利用率、内存使用、温度、功耗等</li>
<li><strong>集成</strong>：可与<code>Prometheus</code>和<code>Grafana</code>等监控系统集成</li>
</ul>
<p>详细介绍请参考文章：<a href=/ai/gpu-dcgm-exporter>NVIDIA GPU DCGM-Exporter监控方案</a></p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id=37-mig管理器-mig-manager>3.7 MIG管理器 (MIG Manager)<a href=#37-mig管理器-mig-manager class=hash-link aria-label="Direct link to 3.7 MIG管理器 (MIG Manager)" title="Direct link to 3.7 MIG管理器 (MIG Manager)">​</a></h3>
<ul>
<li><strong>功能</strong>：管理<code>NVIDIA Multi-Instance GPU</code> (<code>MIG</code>)配置</li>
<li><strong>作用</strong>：允许将单个物理<code>GPU</code>分割为多个逻辑<code>GPU</code>实例</li>
<li><strong>优势</strong>：提高<code>GPU</code>利用率和隔离性</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id=38-验证器-validator>3.8 验证器 (Validator)<a href=#38-验证器-validator class=hash-link aria-label="Direct link to 3.8 验证器 (Validator)" title="Direct link to 3.8 验证器 (Validator)">​</a></h3>
<ul>
<li><strong>功能</strong>：验证<code>GPU</code>组件是否正确安装和配置</li>
<li><strong>作用</strong>：运行诊断测试确保<code>GPU</code>功能正常</li>
<li><strong>实现</strong>：在状态转换过程中执行验证</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id=4-gpu-operator与kubernetes版本的兼容性>4. GPU Operator与Kubernetes版本的兼容性<a href=#4-gpu-operator与kubernetes版本的兼容性 class=hash-link aria-label="Direct link to 4. GPU Operator与Kubernetes版本的兼容性" title="Direct link to 4. GPU Operator与Kubernetes版本的兼容性">​</a></h2>
<p><code>GPU Operator</code>对<code>Kubernetes</code>版本有特定的兼容性要求。根据最新文档，兼容性情况如下：</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id=41-支持的kubernetes版本>4.1 支持的Kubernetes版本<a href=#41-支持的kubernetes版本 class=hash-link aria-label="Direct link to 4.1 支持的Kubernetes版本" title="Direct link to 4.1 支持的Kubernetes版本">​</a></h3>
<p><code>GPU Operator</code>最新版本(<code>v25.3.0</code>)支持以下<code>Kubernetes</code>版本：</p>
<ul>
<li><strong>当前支持的版本</strong>：<code>Kubernetes 1.29 - 1.32</code></li>
<li><strong>最低支持版本</strong>：<code>Kubernetes 1.23</code>（较旧版本的<code>GPU Operator</code>）</li>
</ul>
<p>需要注意的是，<code>Kubernetes</code>社区通常只支持最近的三个次要版本。对于更旧的版本，可能需要通过企业级<code>Kubernetes</code>发行版（如<code>Red Hat OpenShift</code>）获得支持。</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id=42-操作系统兼容性>4.2 操作系统兼容性<a href=#42-操作系统兼容性 class=hash-link aria-label="Direct link to 4.2 操作系统兼容性" title="Direct link to 4.2 操作系统兼容性">​</a></h3>
<p><code>GPU Operator</code>在以下操作系统上经过验证：</p>
<ul>
<li><code>Ubuntu 20.04 LTS</code></li>
<li><code>Ubuntu 22.04 LTS</code></li>
<li><code>Ubuntu 24.04 LTS</code></li>
<li><code>Red Hat Core OS (RHCOS)</code></li>
<li><code>Red Hat Enterprise Linux 8</code></li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id=43-容器运行时兼容性>4.3 容器运行时兼容性<a href=#43-容器运行时兼容性 class=hash-link aria-label="Direct link to 4.3 容器运行时兼容性" title="Direct link to 4.3 容器运行时兼容性">​</a></h3>
<p><code>GPU Operator</code>支持以下容器运行时：</p>
<ul>
<li><code>Containerd 1.6 - 2.0</code>（<code>Ubuntu</code>所有支持版本）</li>
<li><code>CRI-O</code>（所有支持的操作系统）</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id=44-gpu兼容性>4.4 GPU兼容性<a href=#44-gpu兼容性 class=hash-link aria-label="Direct link to 4.4 GPU兼容性" title="Direct link to 4.4 GPU兼容性">​</a></h3>
<p><code>GPU Operator</code>支持多种<code>NVIDIA</code>数据中心<code>GPU</code>，包括但不限于：</p>
<ul>
<li><code>NVIDIA Hopper</code>架构：<code>H100</code>、<code>H800</code>、<code>H20</code>、<code>GH200</code>等</li>
<li><code>NVIDIA Ampere</code>架构：<code>A100</code>、<code>A30</code>、<code>A10</code>、<code>A2</code>等</li>
<li><code>NVIDIA Ada</code>架构：<code>L40</code>、<code>L4</code>等</li>
<li><code>NVIDIA Turing</code>架构：<code>T4</code>等</li>
<li><code>NVIDIA Volta</code>架构：<code>V100</code>等</li>
<li><code>NVIDIA Pascal</code>架构：<code>P100</code>、<code>P40</code>、<code>P4</code>等</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id=5-gpu-operator的部署方式>5. GPU Operator的部署方式<a href=#5-gpu-operator的部署方式 class=hash-link aria-label="Direct link to 5. GPU Operator的部署方式" title="Direct link to 5. GPU Operator的部署方式">​</a></h2>
<p><code>GPU Operator</code>的部署相对简单，主要通过<code>Helm Chart</code>完成。以下是详细的部署步骤：</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id=51-前提条件>5.1 前提条件<a href=#51-前提条件 class=hash-link aria-label="Direct link to 5.1 前提条件" title="Direct link to 5.1 前提条件">​</a></h3>
<p>在部署<code>GPU Operator</code>之前，需要确保：</p>
<ol>
<li>有一个正常运行的<code>Kubernetes</code>集群（版本兼容）</li>
<li>集群中至少有一个配备<code>NVIDIA GPU</code>的节点</li>
<li>已安装<code>Helm</code>（推荐<code>v3.x</code>或更高版本）</li>
<li>节点能够访问容器镜像仓库（如<code>NGC</code>、<code>Docker Hub</code>等）</li>
</ol>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id=52-使用helm部署>5.2 使用Helm部署<a href=#52-使用helm部署 class=hash-link aria-label="Direct link to 5.2 使用Helm部署" title="Direct link to 5.2 使用Helm部署">​</a></h3>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id=521-添加nvidia-helm仓库>5.2.1 添加NVIDIA Helm仓库<a href=#521-添加nvidia-helm仓库 class=hash-link aria-label="Direct link to 5.2.1 添加NVIDIA Helm仓库" title="Direct link to 5.2.1 添加NVIDIA Helm仓库">​</a></h4>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#f8f8f2;--prism-background-color:#272822><div class=codeBlockContent_biex><pre tabindex=0 class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style=color:#f8f8f2;background-color:#272822><code class=codeBlockLines_e6Vv><span class=token-line style=color:#f8f8f2><span class="token plain">$ helm repo </span><span class="token function" style=color:#e6db74>add</span><span class="token plain"> nvidia https://helm.ngc.nvidia.com/nvidia</span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">$ helm repo update</span><br></span></code></pre><div class=buttonGroup__atx><button type=button aria-label="Copy code to clipboard" title=Copy class=clean-btn><span class=copyButtonIcons_eSgA aria-hidden=true><svg viewBox="0 0 24 24" class=copyButtonIcon_y97N><path fill=currentColor d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"/></svg><svg viewBox="0 0 24 24" class=copyButtonSuccessIcon_LjdS><path fill=currentColor d=M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z /></svg></span></button></div></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id=522-基本安装>5.2.2 基本安装<a href=#522-基本安装 class=hash-link aria-label="Direct link to 5.2.2 基本安装" title="Direct link to 5.2.2 基本安装">​</a></h4>
<p>最简单的安装方式是使用默认配置：</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#f8f8f2;--prism-background-color:#272822><div class=codeBlockContent_biex><pre tabindex=0 class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style=color:#f8f8f2;background-color:#272822><code class=codeBlockLines_e6Vv><span class=token-line style=color:#f8f8f2><span class="token plain">$ helm </span><span class="token function" style=color:#e6db74>install</span><span class="token plain"> </span><span class="token parameter variable" style=color:#f8f8f2>--wait</span><span class="token plain"> --generate-name </span><span class="token punctuation" style=color:#f8f8f2>\</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">     </span><span class="token parameter variable" style=color:#f8f8f2>-n</span><span class="token plain"> gpu-operator --create-namespace </span><span class="token punctuation" style=color:#f8f8f2>\</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">     nvidia/gpu-operator </span><span class="token punctuation" style=color:#f8f8f2>\</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">     </span><span class="token parameter variable" style=color:#f8f8f2>--version</span><span class="token operator" style=color:#66d9ef>=</span><span class="token plain">v25.3.0</span><br></span></code></pre><div class=buttonGroup__atx><button type=button aria-label="Copy code to clipboard" title=Copy class=clean-btn><span class=copyButtonIcons_eSgA aria-hidden=true><svg viewBox="0 0 24 24" class=copyButtonIcon_y97N><path fill=currentColor d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"/></svg><svg viewBox="0 0 24 24" class=copyButtonSuccessIcon_LjdS><path fill=currentColor d=M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z /></svg></span></button></div></div></div>
<p>这个命令会：</p>
<ul>
<li>创建名为<code>gpu-operator</code>的命名空间</li>
<li>在该命名空间中安装<code>GPU Operator</code></li>
<li>使用版本<code>v25.3.0</code>的<code>Operator</code></li>
</ul>
<p>安装完成后，<code>GPU Operator</code>会自动检测集群中的<code>GPU</code>节点并部署必要的组件。</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id=53-�自定义部署选项>5.3 自定义部署选项<a href=#53-自定义部署选项 class=hash-link aria-label="Direct link to 5.3 自定义部署选项" title="Direct link to 5.3 自定义部署选项">​</a></h3>
<p><code>GPU Operator</code>提供了多种自定义选项，以适应不同的部署场景：</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id=531-使用预安装的驱动程序>5.3.1 使用预安装的驱动程序<a href=#531-使用预安装的驱动程序 class=hash-link aria-label="Direct link to 5.3.1 使用预安装的驱动程序" title="Direct link to 5.3.1 使用预安装的驱动程序">​</a></h4>
<p>如果节点上已经安装了<code>NVIDIA</code>驱动，可以配置<code>Operator</code>跳过驱动安装：</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#f8f8f2;--prism-background-color:#272822><div class=codeBlockContent_biex><pre tabindex=0 class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style=color:#f8f8f2;background-color:#272822><code class=codeBlockLines_e6Vv><span class=token-line style=color:#f8f8f2><span class="token plain">$ helm </span><span class="token function" style=color:#e6db74>install</span><span class="token plain"> </span><span class="token parameter variable" style=color:#f8f8f2>--wait</span><span class="token plain"> --generate-name </span><span class="token punctuation" style=color:#f8f8f2>\</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">     </span><span class="token parameter variable" style=color:#f8f8f2>-n</span><span class="token plain"> gpu-operator --create-namespace </span><span class="token punctuation" style=color:#f8f8f2>\</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">     nvidia/gpu-operator </span><span class="token punctuation" style=color:#f8f8f2>\</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">     </span><span class="token parameter variable" style=color:#f8f8f2>--version</span><span class="token operator" style=color:#66d9ef>=</span><span class="token plain">v25.3.0 </span><span class="token punctuation" style=color:#f8f8f2>\</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">     </span><span class="token parameter variable" style=color:#f8f8f2>--set</span><span class="token plain"> </span><span class="token assign-left variable" style=color:#f8f8f2>driver.enabled</span><span class="token operator" style=color:#66d9ef>=</span><span class="token plain">false</span><br></span></code></pre><div class=buttonGroup__atx><button type=button aria-label="Copy code to clipboard" title=Copy class=clean-btn><span class=copyButtonIcons_eSgA aria-hidden=true><svg viewBox="0 0 24 24" class=copyButtonIcon_y97N><path fill=currentColor d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"/></svg><svg viewBox="0 0 24 24" class=copyButtonSuccessIcon_LjdS><path fill=currentColor d=M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z /></svg></span></button></div></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id=532-使用预安装的容器工具包>5.3.2 使用预安装的容器工具包<a href=#532-使用预安装的容器工具包 class=hash-link aria-label="Direct link to 5.3.2 使用预安装的容器工具包" title="Direct link to 5.3.2 使用预安装的容器工具包">​</a></h4>
<p>同样，如果已经安装了<code>NVIDIA Container Toolkit</code>，可以跳过该组件的安装：</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#f8f8f2;--prism-background-color:#272822><div class=codeBlockContent_biex><pre tabindex=0 class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style=color:#f8f8f2;background-color:#272822><code class=codeBlockLines_e6Vv><span class=token-line style=color:#f8f8f2><span class="token plain">$ helm </span><span class="token function" style=color:#e6db74>install</span><span class="token plain"> </span><span class="token parameter variable" style=color:#f8f8f2>--wait</span><span class="token plain"> --generate-name </span><span class="token punctuation" style=color:#f8f8f2>\</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">     </span><span class="token parameter variable" style=color:#f8f8f2>-n</span><span class="token plain"> gpu-operator --create-namespace </span><span class="token punctuation" style=color:#f8f8f2>\</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">     nvidia/gpu-operator </span><span class="token punctuation" style=color:#f8f8f2>\</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">     </span><span class="token parameter variable" style=color:#f8f8f2>--version</span><span class="token operator" style=color:#66d9ef>=</span><span class="token plain">v25.3.0 </span><span class="token punctuation" style=color:#f8f8f2>\</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">     </span><span class="token parameter variable" style=color:#f8f8f2>--set</span><span class="token plain"> </span><span class="token assign-left variable" style=color:#f8f8f2>driver.enabled</span><span class="token operator" style=color:#66d9ef>=</span><span class="token plain">false </span><span class="token punctuation" style=color:#f8f8f2>\</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">     </span><span class="token parameter variable" style=color:#f8f8f2>--set</span><span class="token plain"> </span><span class="token assign-left variable" style=color:#f8f8f2>toolkit.enabled</span><span class="token operator" style=color:#66d9ef>=</span><span class="token plain">false</span><br></span></code></pre><div class=buttonGroup__atx><button type=button aria-label="Copy code to clipboard" title=Copy class=clean-btn><span class=copyButtonIcons_eSgA aria-hidden=true><svg viewBox="0 0 24 24" class=copyButtonIcon_y97N><path fill=currentColor d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"/></svg><svg viewBox="0 0 24 24" class=copyButtonSuccessIcon_LjdS><path fill=currentColor d=M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z /></svg></span></button></div></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id=533-指定特定版本的组件>5.3.3 指定特定版本的组件<a href=#533-指定特定版本的组件 class=hash-link aria-label="Direct link to 5.3.3 指定特定版本的组件" title="Direct link to 5.3.3 指定特定版本的组件">​</a></h4>
<p>可以为各个组件指定特定版本，例如：</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#f8f8f2;--prism-background-color:#272822><div class=codeBlockContent_biex><pre tabindex=0 class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style=color:#f8f8f2;background-color:#272822><code class=codeBlockLines_e6Vv><span class=token-line style=color:#f8f8f2><span class="token plain">$ helm </span><span class="token function" style=color:#e6db74>install</span><span class="token plain"> </span><span class="token parameter variable" style=color:#f8f8f2>--wait</span><span class="token plain"> --generate-name </span><span class="token punctuation" style=color:#f8f8f2>\</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">     </span><span class="token parameter variable" style=color:#f8f8f2>-n</span><span class="token plain"> gpu-operator --create-namespace </span><span class="token punctuation" style=color:#f8f8f2>\</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">     nvidia/gpu-operator </span><span class="token punctuation" style=color:#f8f8f2>\</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">     </span><span class="token parameter variable" style=color:#f8f8f2>--version</span><span class="token operator" style=color:#66d9ef>=</span><span class="token plain">v25.3.0 </span><span class="token punctuation" style=color:#f8f8f2>\</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">     </span><span class="token parameter variable" style=color:#f8f8f2>--set</span><span class="token plain"> </span><span class="token assign-left variable" style=color:#f8f8f2>toolkit.version</span><span class="token operator" style=color:#66d9ef>=</span><span class="token plain">v1.16.1-ubi8</span><br></span></code></pre><div class=buttonGroup__atx><button type=button aria-label="Copy code to clipboard" title=Copy class=clean-btn><span class=copyButtonIcons_eSgA aria-hidden=true><svg viewBox="0 0 24 24" class=copyButtonIcon_y97N><path fill=currentColor d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"/></svg><svg viewBox="0 0 24 24" class=copyButtonSuccessIcon_LjdS><path fill=currentColor d=M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z /></svg></span></button></div></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id=534-启用mig支持>5.3.4 启用MIG支持<a href=#534-启用mig支持 class=hash-link aria-label="Direct link to 5.3.4 启用MIG支持" title="Direct link to 5.3.4 启用MIG支持">​</a></h4>
<p>对于支持<code>MIG</code>的<code>GPU</code>（如<code>A100</code>），可以启用<code>MIG</code>管理器：</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#f8f8f2;--prism-background-color:#272822><div class=codeBlockContent_biex><pre tabindex=0 class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style=color:#f8f8f2;background-color:#272822><code class=codeBlockLines_e6Vv><span class=token-line style=color:#f8f8f2><span class="token plain">$ helm </span><span class="token function" style=color:#e6db74>install</span><span class="token plain"> </span><span class="token parameter variable" style=color:#f8f8f2>--wait</span><span class="token plain"> --generate-name </span><span class="token punctuation" style=color:#f8f8f2>\</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">     </span><span class="token parameter variable" style=color:#f8f8f2>-n</span><span class="token plain"> gpu-operator --create-namespace </span><span class="token punctuation" style=color:#f8f8f2>\</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">     nvidia/gpu-operator </span><span class="token punctuation" style=color:#f8f8f2>\</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">     </span><span class="token parameter variable" style=color:#f8f8f2>--version</span><span class="token operator" style=color:#66d9ef>=</span><span class="token plain">v25.3.0 </span><span class="token punctuation" style=color:#f8f8f2>\</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">     </span><span class="token parameter variable" style=color:#f8f8f2>--set</span><span class="token plain"> </span><span class="token assign-left variable" style=color:#f8f8f2>mig.strategy</span><span class="token operator" style=color:#66d9ef>=</span><span class="token plain">mixed</span><br></span></code></pre><div class=buttonGroup__atx><button type=button aria-label="Copy code to clipboard" title=Copy class=clean-btn><span class=copyButtonIcons_eSgA aria-hidden=true><svg viewBox="0 0 24 24" class=copyButtonIcon_y97N><path fill=currentColor d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"/></svg><svg viewBox="0 0 24 24" class=copyButtonSuccessIcon_LjdS><path fill=currentColor d=M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z /></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id=54-验证部署>5.4 验证部署<a href=#54-验证部署 class=hash-link aria-label="Direct link to 5.4 验证部署" title="Direct link to 5.4 验证部署">​</a></h3>
<p>部署完成后，可以通过以下命令验证<code>GPU Operator</code>是否正常工作：</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#f8f8f2;--prism-background-color:#272822><div class=codeBlockContent_biex><pre tabindex=0 class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style=color:#f8f8f2;background-color:#272822><code class=codeBlockLines_e6Vv><span class=token-line style=color:#f8f8f2><span class="token comment" style=color:#8292a2;font-style:italic># 检查GPU Operator的Pod状态</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">$ kubectl get pods </span><span class="token parameter variable" style=color:#f8f8f2>-n</span><span class="token plain"> gpu-operator</span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain"></span><span class="token comment" style=color:#8292a2;font-style:italic># 检查GPU资源是否可用</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">$ kubectl get nodes </span><span class="token parameter variable" style=color:#f8f8f2>-o</span><span class="token plain"> json </span><span class="token operator" style=color:#66d9ef>|</span><span class="token plain"> jq </span><span class="token string" style=color:#a6e22e>'.items[].status.capacity["nvidia.com/gpu"]'</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain"></span><span class="token comment" style=color:#8292a2;font-style:italic># 运行示例工作负载测试GPU功能</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">$ kubectl run nvidia-smi </span><span class="token parameter variable" style=color:#f8f8f2>--rm</span><span class="token plain"> </span><span class="token parameter variable" style=color:#f8f8f2>-t</span><span class="token plain"> </span><span class="token parameter variable" style=color:#f8f8f2>-i</span><span class="token plain"> </span><span class="token parameter variable" style=color:#f8f8f2>--restart</span><span class="token operator" style=color:#66d9ef>=</span><span class="token plain">Never </span><span class="token punctuation" style=color:#f8f8f2>\</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">    </span><span class="token parameter variable" style=color:#f8f8f2>--image</span><span class="token operator" style=color:#66d9ef>=</span><span class="token plain">nvidia/cuda:11.6.2-base-ubuntu20.04 </span><span class="token punctuation" style=color:#f8f8f2>\</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">    </span><span class="token parameter variable" style=color:#f8f8f2>--overrides</span><span class="token operator" style=color:#66d9ef>=</span><span class="token string" style=color:#a6e22e>'{"spec": { "nodeSelector": {"nvidia.com/gpu.present": "true"}}}'</span><span class="token plain"> </span><span class="token punctuation" style=color:#f8f8f2>\</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">    -- nvidia-smi</span><br></span></code></pre><div class=buttonGroup__atx><button type=button aria-label="Copy code to clipboard" title=Copy class=clean-btn><span class=copyButtonIcons_eSgA aria-hidden=true><svg viewBox="0 0 24 24" class=copyButtonIcon_y97N><path fill=currentColor d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"/></svg><svg viewBox="0 0 24 24" class=copyButtonSuccessIcon_LjdS><path fill=currentColor d=M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z /></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id=6-总结>6. 总结<a href=#6-总结 class=hash-link aria-label="Direct link to 6. 总结" title="Direct link to 6. 总结">​</a></h2>
<p><code>NVIDIA GPU Operator</code>极大地简化了在<code>Kubernetes</code>环境中管理<code>GPU</code>资源的复杂性。通过自动化部署和管理<code>NVIDIA</code>软件组件，它使得<code>AI</code>和高性能计算工作负载能够更轻松地在<code>Kubernetes</code>中运行。与单独使用<code>GPU DevicePlugin</code>相比，<code>GPU Operator</code>提供了更全面的解决方案，覆盖了从驱动安装到监控的整个<code>GPU</code>管理生命周期。</p>
<p>对于任何需要在<code>Kubernetes</code>中大规模管理<code>GPU</code>资源的组织，<code>GPU Operator</code>都是一个值得考虑的工具，它能够显著降低运维复杂度，提高资源利用效率，并确保<code>GPU</code>工作负载的可靠运行。</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id=7-参考资料>7. 参考资料<a href=#7-参考资料 class=hash-link aria-label="Direct link to 7. 参考资料" title="Direct link to 7. 参考资料">​</a></h2>
<ul>
<li><a href=https://developer.nvidia.com/blog/nvidia-gpu-operator-simplifying-gpu-management-in-kubernetes/ target=_blank rel="noopener noreferrer">NVIDIA GPU Operator: Simplifying GPU Management in Kubernetes</a></li>
<li><a href=https://docs.nvidia.com/datacenter/cloud-native/gpu-operator/latest/index.html target=_blank rel="noopener noreferrer">NVIDIA GPU Operator官方文档</a></li>
<li><a href=https://kubernetes.io/docs/concepts/extend-kubernetes/compute-storage-net/device-plugins/ target=_blank rel="noopener noreferrer">Kubernetes Device Plugin文档</a></li>
</ul></div></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href=/ai/nvidia><div class=pagination-nav__sublabel>Previous</div><div class=pagination-nav__label>NVIDIA</div></a><a class="pagination-nav__link pagination-nav__link--next" href=/ai/gpu-dcgm-exporter><div class=pagination-nav__sublabel>Next</div><div class=pagination-nav__label>GPU DCGM-Exporter监控方案</div></a></nav><div class=docusaurus-mt-lg></div></div></div><div class="col col--3"><div class=tocContainer_PXzm><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href=#1-gpu-operator的主要作用 class="table-of-contents__link toc-highlight">1. GPU Operator的主要作用</a><li><a href=#2-gpu-operator与gpu-deviceplugin的区别 class="table-of-contents__link toc-highlight">2. GPU Operator与GPU DevicePlugin的区别</a><ul><li><a href=#21-gpu-deviceplugin class="table-of-contents__link toc-highlight">2.1 GPU DevicePlugin</a><li><a href=#22-gpu-operator的扩展功能 class="table-of-contents__link toc-highlight">2.2 GPU Operator的扩展功能</a></ul><li><a href=#3-gpu-operator的工作流程 class="table-of-contents__link toc-highlight">3. GPU Operator的工作流程</a><ul><li><a href=#31-operator状态机 class="table-of-contents__link toc-highlight">3.1 Operator状态机</a><li><a href=#32-节点发现与选择 class="table-of-contents__link toc-highlight">3.2 节点发现与选择</a><li><a href=#33-组件部署与协调 class="table-of-contents__link toc-highlight">3.3 组件部署与协调</a><li><a href=#34-版本管理与自定义 class="table-of-contents__link toc-highlight">3.4 版本管理与自定义</a></ul><li><a href=#4-gpu-operator包含的组件 class="table-of-contents__link toc-highlight">4. GPU Operator包含的组件</a><ul><li><a href=#41-nvidia驱动容器-driver-container class="table-of-contents__link toc-highlight">4.1 NVIDIA驱动容器 (Driver Container)</a><li><a href=#32-nvidia容器工具包-container-toolkit class="table-of-contents__link toc-highlight">3.2 NVIDIA容器工具包 (Container Toolkit)</a><li><a href=#33-kubernetes设备插件-device-plugin class="table-of-contents__link toc-highlight">3.3 Kubernetes设备插件 (Device Plugin)</a><li><a href=#34-节点特性发现-node-feature-discovery-nfd class="table-of-contents__link toc-highlight">3.4 节点特性发现 (Node Feature Discovery, NFD)</a><li><a href=#35-gpu特性发现-gpu-feature-discovery-gfd class="table-of-contents__link toc-highlight">3.5 GPU特性发现 (GPU Feature Discovery, GFD)</a><li><a href=#36-dcgm导出器-dcgm-exporter class="table-of-contents__link toc-highlight">3.6 DCGM导出器 (DCGM Exporter)</a><li><a href=#37-mig管理器-mig-manager class="table-of-contents__link toc-highlight">3.7 MIG管理器 (MIG Manager)</a><li><a href=#38-验证器-validator class="table-of-contents__link toc-highlight">3.8 验证器 (Validator)</a></ul><li><a href=#4-gpu-operator与kubernetes版本的兼容性 class="table-of-contents__link toc-highlight">4. GPU Operator与Kubernetes版本的兼容性</a><ul><li><a href=#41-支持的kubernetes版本 class="table-of-contents__link toc-highlight">4.1 支持的Kubernetes版本</a><li><a href=#42-操作系统兼容性 class="table-of-contents__link toc-highlight">4.2 操作系统兼容性</a><li><a href=#43-容器运行时兼容性 class="table-of-contents__link toc-highlight">4.3 容器运行时兼容性</a><li><a href=#44-gpu兼容性 class="table-of-contents__link toc-highlight">4.4 GPU兼容性</a></ul><li><a href=#5-gpu-operator的部署方式 class="table-of-contents__link toc-highlight">5. GPU Operator的部署方式</a><ul><li><a href=#51-前提条件 class="table-of-contents__link toc-highlight">5.1 前提条件</a><li><a href=#52-使用helm部署 class="table-of-contents__link toc-highlight">5.2 使用Helm部署</a><li><a href=#53-自定义部署选项 class="table-of-contents__link toc-highlight">5.3 自定义部署选项</a><li><a href=#54-验证部署 class="table-of-contents__link toc-highlight">5.4 验证部署</a></ul><li><a href=#6-总结 class="table-of-contents__link toc-highlight">6. 总结</a><li><a href=#7-参考资料 class="table-of-contents__link toc-highlight">7. 参考资料</a></ul></div><div class=tocAdBanner_imxD></div></div></div></div></div></main></div></div></div><footer class=footer><div class="container container-fluid"><div class="footer__bottom text--center"><div class=footer__copyright>Copyright 2025 johng.cn</div></div></div></footer></div>